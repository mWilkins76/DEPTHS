{
"version":3,
"file":"builder.js",
"sourceRoot":"file:///",
"sources":["C:/HaxeToolkit/haxe/std/js/_std/EReg.hx","C:/HaxeToolkit/haxe/std/js/_std/HxOverrides.hx","C:/HaxeToolkit/haxe/std/Lambda.hx","C:/HaxeToolkit/haxe/std/List.hx","C:/HaxeToolkit/haxe/lib/perf,js/1,1,8/src/Perf.hx","C:/HaxeToolkit/haxe/std/js/_std/Reflect.hx","C:/HaxeToolkit/haxe/std/js/_std/Std.hx","C:/HaxeToolkit/haxe/std/StringBuf.hx","C:/HaxeToolkit/haxe/std/StringTools.hx","C:/HaxeToolkit/haxe/std/js/_std/Type.hx","C:/HaxeToolkit/haxe/std/UInt.hx","C:/HaxeToolkit/haxe/std/Xml.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/Main.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/GameManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/Spawner.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/controller/Controller.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/controller/MouseController.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/controller/TouchController.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/player/MissionsManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/player/Player.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/GameObject.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/StateMachine.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/StateGraphic.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/FlumpStateGraphic.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/pooling/PoolObject.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/aliens/Alien.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SpecialFeatureAliens.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/aliens/AlienType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/aliens/Bomber.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/aliens/Driller.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/aliens/Healer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/aliens/Tank.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFAliensEventManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFAliensManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFEventsManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFGameManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFGridManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SFTilesManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/UIComponent.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/Screen.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/SmartScreen.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/screens/SmartScreenRegister.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/managers/SpecialFeatureScreen.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/Tile.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/AlienSpawn.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/Clue.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/HardBrick.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/Lava.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/SpecialFeatureItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/specialFeature/tiles/classes/Walls.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/loader/GameLoader.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/Config.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/GameElement.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/Building.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/AlienCryoCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/AlienIncubator.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/AlienPaddock.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/AlienResearchCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/AlienTrainingCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/paddocks/AlienPaddockBig.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/paddocks/AlienPaddockMedium.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/paddocks/AlienPaddockSmall.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/alienbuilding/paddocks/AlienPaddockTiny.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/aliens/AlienEsthetique.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/aliens/alienspaddockable/AlienPaddockable.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/aliens/alienspaddockable/AlienBuffer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/aliens/alienspaddockable/AlienProducer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/CosmeticBuilding.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticCapsule1.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticCapsule2.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticCapsule3.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticPlant1.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticPlant2.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/cosmeticbuilding/cosmetictype/BuildingCosmeticPlant3.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/destructible/Destructible.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/drillingbuilding/DrillingBuilding.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/drillingbuilding/DrillingAutoOutPost.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/drillingbuilding/DrillingCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/drillingbuilding/DrillingOutPost.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/BuildingEnergyProducer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/UrbanAntenna.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/UrbanCommunication.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/UrbanHeadQuarter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/UrbanPowerStation.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/urbanbuilding/UrbanTranslation.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/RessourceEffect.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/ressources/Bubble.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/ressources/RessourceHardCurrency.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/ressources/RessourceSoftCurrency.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/Background.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/Layer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/MapInteractor.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/Region.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/RegionContainer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/UnlockButtonContainer.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/world/World.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/juicy/bullesxp/Bulle.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/juicy/bullesxp/BullesManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/UIMovie.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/preloadgame/Helix.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/preloadgame/LoadingBar.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/preloadgame/PreloadBulle.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/preloadgame/PreloadMiniGame.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/CheatPanel.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/GraphicLoader.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/LocalizationByType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/Slider.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/UIManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/ftue/Arrow.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/ftue/BouleHighlight.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/ftue/FTUEManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/Popin.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/SmartPopin.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/SmartPopinRegister.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/ftue/FTUEPopin.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/ftue/FocusManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/hud/Hud.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/MenuClosable.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Menu.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/hud/InfosBatiment.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/hud/XpBar.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/SmartComponent.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/Item.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/DrillingFriendItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/SwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/SwitchGroupItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/DrillingXenoItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/ItemAsset.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/BuildingMenuSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/BuildingMenuSwitchTab.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/CodexSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/CodexSwitchTab.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/DrillingButtonSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/MissionSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/ShopSwitchTab.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/SpecialFeatureSwitchSkill.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/UpgradeCenterSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/XenoSlotSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/XenoSocialSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/XenosPanelSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/items/switchItems/XenosPanelSwitchTab.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Confirm.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/contextual/ContextualPopin.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/ConfirmationPose.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/DailyReward.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Deplacement.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Destruction.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/DynamicPopin.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Friendlist.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/IsartPoints.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/RewardNotifications.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/Settings.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/TimeBased.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/TutoSpecialFeature.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/XenoPage.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/XenosPanel.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/building/BuildingMenu.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/building/BuildingPanel.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/building/datas/BuildingMenuData.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/buyRegion/BuyRegion.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/buyRegion/RegionSwitch.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/centreForage/CentreForage.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/codex/Codex.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/codex/CodexData.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/contextual/BuildingContextualMenu.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/contextual/YesNoPose.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/enclos/Enclos.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/enclos/EnclosSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/GeneButton.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/GeneSpot.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/Incubator.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/Inseminator.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/SchemaSwitchItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/SmartButton.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/incubator/TimerIncubator.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/shop/Shop.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/shop/ShopItem.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/shop/ShopItemBig.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/shop/ShopItemMedium.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/shop/datas/ShopData.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/translationCenter/TranslationCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/upgradeCenter/TankUpgrade.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/popin/upgradeCenter/UpgradeCenter.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/screens/PubImage.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/screens/PubVideo.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/screens/TitleCard.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/specialButtons/SlotButton.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/ui/specialButtons/Textbutton.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/BezierCurve.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/ColorFilterManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/Focus.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/ParticleManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/RessourcesEffectManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/SmartShaker.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/utils/TimeManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/deltaDNA/DeltaDNA.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/facebook/Facebook.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/monetization/Ads.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/monetization/Bank.hx","C:/HaxeToolkit/haxe/std/haxe/Http.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/monetization/HttpService.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/monetization/Wallet.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/Debug.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/Camera.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/CollisionManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/GameStage.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/clipping/Cell.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/clipping/CellManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/clipping/ClippingManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/clipping/DisplayManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/factory/AnimFactory.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/factory/FlumpMovieAnimFactory.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/factory/FlumpSpriteAnimFactory.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/factory/MovieClipAnimFactory.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/filtersManagement/TwistFilterManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/iso/IsoManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/game/pooling/PoolManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/save/DataBaseAction.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/save/DataManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/sounds/SoundManager.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/system/DeviceCapabilities.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/system/Localization.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/Button.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/SmartText.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/UIPosition.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/TextSprite.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/UIBuilder.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/ui/smart/UISprite.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/DisplayObjectKey.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/MoviePlayer.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/filters/AnimateTintFilter.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/json/FlumpJSON.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/FlumpLibrary.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Keyframe.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Label.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Layer.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Symbol.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/MovieSymbol.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Point.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/Rectangle.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/flump/library/SpriteSymbol.hx","C:/HaxeToolkit/haxe/std/haxe/Log.hx","C:/HaxeToolkit/haxe/std/haxe/Timer.hx","C:/HaxeToolkit/haxe/std/haxe/ds/ArraySort.hx","C:/HaxeToolkit/haxe/std/js/_std/haxe/ds/IntMap.hx","C:/HaxeToolkit/haxe/std/js/_std/haxe/ds/ObjectMap.hx","C:/HaxeToolkit/haxe/std/js/_std/haxe/ds/StringMap.hx","C:/HaxeToolkit/haxe/std/haxe/xml/Parser.hx","C:/HaxeToolkit/haxe/std/js/Boot.hx","C:/HaxeToolkit/haxe/std/js/Browser.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/pixi/flump/Movie.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/pixi/flump/Parser.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/pixi/flump/Resource.hx","C:/HaxeToolkit/haxe/lib/pixi-flump-runtime/0,3,1/src/pixi/flump/Sprite.hx","C:/HaxeToolkit/haxe/std/js/_std/Math.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/player/XpToLevel.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/ruby/game/sprites/elements/ElementType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/events/EventType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/services/facebook/events/FacebookEventType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/events/LoadEventType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/events/MouseEventType.hx","E:/11GDP3/BUILDER_SVN/dev/gold/src/com/isartdigital/utils/events/TouchEventType.hx"],
"sourcesContent":["/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : HaxeRegExp;\n\n\tpublic inline function new( r : String, opt : String ) : Void {\n\t\tthis.r = new HaxeRegExp(r, opt.split(\"u\").join(\"\")); // 'u' (utf8) depends on page encoding\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic inline function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n\n@:native(\"RegExp\")\nprivate extern class HaxeRegExp extends js.RegExp {\n\tvar m:js.RegExp.RegExpMatch;\n\tvar s:String;\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\tvar x = (cast s).charCodeAt(index);\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn js.Lib.undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif (len == null) {\n\t\t\tlen = s.length;\n\t\t} else if (len < 0) {\n\t\t\tif (pos == 0)\n\t\t\t\tlen = s.length + len;\n\t\t\telse\n\t\t\t\treturn \"\";\n\t\t}\n\n\t\t#if (js_es < 5)\n\t\tif (pos < 0) {\n\t\t\tpos = s.length + pos;\n\t\t\tif (pos < 0)\n\t\t\t\tpos = 0;\n\t\t}\n\t\t#end\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if (js_es < 5)\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n/**\n\tThe `Lambda` class is a collection of methods to support functional\n\tprogramming. It is ideally used with `using Lambda` and then acts as an\n\textension to Iterable types.\n\n\tOn static platforms, working with the Iterable structure might be slower\n\tthan performing the operations directly on known types, such as Array and\n\tList.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n\n\t@see http://haxe.org/manual/std-Lambda.html\n**/\nclass Lambda {\n\n\t/**\n\t\tCreates an Array from Iterable `it`.\n\n\t\tIf `it` is an Array, this function returns a copy of it.\n\t**/\n\tpublic static function array<A>( it : Iterable<A> ) : Array<A> {\n\t\tvar a = new Array<A>();\n\t\tfor(i in it)\n\t\t\ta.push(i);\n\t\treturn a;\n\t}\n\n\t/**\n\t\tCreates a List form Iterable `it`.\n\n\t\tIf `it` is a List, this function returns a copy of it.\n\t**/\n\tpublic static function list<A>( it : Iterable<A> ) : List<A> {\n\t\tvar l = new List<A>();\n\t\tfor(i in it)\n\t\t\tl.add(i);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tCreates a new List by applying function `f` to all elements of `it`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function map<A,B>( it : Iterable<A>, f : A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tfor( x in it )\n\t\t\tl.add(f(x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tSimilar to map, but also passes the index of each element to `f`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function mapi<A,B>( it : Iterable<A>, f : Int -> A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tvar i = 0;\n\t\tfor( x in it )\n\t\t\tl.add(f(i++,x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tConcatenate a list of lists.\n\n\t\tThe order of elements is preserved.\n\t**/\n\tpublic static function flatten<A>( it : Iterable<Iterable<A>> ) : List<A> {\n\t\tvar l = new List<A>();\n\t\tfor (e in it)\n\t\t\tfor (x in e)\n\t\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tA composition of map and flatten.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function flatMap<A,B>( it : Iterable<A>, f: A -> Iterable<B> ) : List<B> {\n\t\treturn Lambda.flatten(Lambda.map(it, f));\n\t}\n\n\t/**\n\t\tTells if `it` contains `elt`.\n\n\t\tThis function returns true as soon as an element is found which is equal\n\t\tto `elt` according to the `==` operator.\n\n\t\tIf no such element is found, the result is false.\n\t**/\n\tpublic static function has<A>( it : Iterable<A>, elt : A ) : Bool {\n\t\tfor( x in it )\n\t\t\tif( x == elt )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `it` contains an element for which `f` is true.\n\n\t\tThis function returns true as soon as an element is found for which a\n\t\tcall to `f` returns true.\n\n\t\tIf no such element is found, the result is false.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function exists<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `f` is true for all elements of `it`.\n\n\t\tThis function returns false as soon as an element is found for which a\n\t\tcall to `f` returns false.\n\n\t\tIf no such element is found, the result is true.\n\n\t\tIn particular, this function always returns true if `it` is empty.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function foreach<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( !f(x) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/**\n\t\tCalls `f` on all elements of `it`, in order.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function iter<A>( it : Iterable<A>, f : A -> Void ) {\n\t\tfor( x in it )\n\t\t\tf(x);\n\t}\n\n\t/**\n\t\tReturns a List containing those elements of `it` for which `f` returned\n\t\ttrue.\n\n\t\tIf `it` is empty, the result is the empty List even if `f` is null.\n\n\t\tOtherwise if `f` is null, the result is unspecified.\n\t**/\n\tpublic static function filter<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tvar l = new List<A>();\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tFunctional fold on Iterable `it`, using function `f` with start argument\n\t\t`first`.\n\n\t\tIf `it` has no elements, the result is `first`.\n\n\t\tOtherwise the first element of `it` is passed to `f` alongside `first`.\n\t\tThe result of that call is then passed to `f` with the next element of\n\t\t`it`, and so on until `it` has no more elements.\n\n\t\tIf `it` or `f` are null, the result is unspecified.\n\t**/\n\tpublic static function fold<A,B>( it : Iterable<A>, f : A -> B -> B, first : B ) : B {\n\t\tfor( x in it )\n\t\t\tfirst = f(x,first);\n\t\treturn first;\n\t}\n\n\t/**\n\t\tReturns the number of elements in `it` for which `pred` is true, or the\n\t\ttotal number of elements in `it` if `pred` is null.\n\n\t\tThis function traverses all elements.\n\t**/\n\tpublic static function count<A>( it : Iterable<A>, ?pred : A -> Bool ) {\n\t\tvar n = 0;\n\t\tif( pred == null )\n\t\t\tfor( _ in it )\n\t\t\t\tn++;\n\t\telse\n\t\t\tfor( x in it )\n\t\t\t\tif( pred(x) )\n\t\t\t\t\tn++;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tTells if Iterable `it` does not contain any element.\n\t**/\n\tpublic static function empty<T>( it : Iterable<T> ) : Bool {\n\t\treturn !it.iterator().hasNext();\n\t}\n\n\t/**\n\t\tReturns the index of the first element `v` within Iterable `it`.\n\n\t\tThis function uses operator `==` to check for equality.\n\n\t\tIf `v` does not exist in `it`, the result is -1.\n\t**/\n\tpublic static function indexOf<T>( it : Iterable<T>, v : T ) : Int {\n\t\tvar i = 0;\n\t\tfor( v2 in it ) {\n\t\t\tif( v == v2 )\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\t/**\n\t\tReturns the first element of `it` for which `f` is true.\n\n\t\tThis function returns as soon as an element is found for which a call to\n\t\t`f` returns true.\n\n\t\tIf no such element is found, the result is null.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function find<T>( it : Iterable<T>, f : T -> Bool ) : Null<T> {\n\t\tfor( v in it ) {\n\t\t\tif(f(v)) return v;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tReturns a new List containing all elements of Iterable `a` followed by\n\t\tall elements of Iterable `b`.\n\n\t\tIf `a` or `b` are null, the result is unspecified.\n\t**/\n\tpublic static function concat<T>( a : Iterable<T>, b : Iterable<T> ) : List<T> {\n\t\tvar l = new List();\n\t\tfor( x in a )\n\t\t\tl.add(x);\n\t\tfor( x in b )\n\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n/**\n\tA linked-list of elements. The list is composed of element container objects\n\tthat are chained together. It is optimized so that adding or removing an\n\telement does not imply copying the whole list content every time.\n\n\t@see http://haxe.org/manual/std-List.html\n**/\nclass List<T> {\n\n\tprivate var h : ListNode<T>;\n\tprivate var q : ListNode<T>;\n\n\t/**\n\t\tThe length of `this` List.\n\t**/\n\tpublic var length(default,null) : Int;\n\n\t/**\n\t\tCreates a new empty list.\n\t**/\n\tpublic function new() {\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tAdds element `item` at the end of `this` List.\n\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function add( item : T ) {\n\t\tvar x = ListNode.create(item, null);\n\t\tif( h == null )\n\t\t\th = x;\n\t\telse\n\t\t\tq.next = x;\n\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tAdds element `item` at the beginning of `this` List.\n\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function push( item : T ) {\n\t\tvar x = ListNode.create(item, h);\n\t\th = x;\n\t\tif( q == null )\n\t\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function first() : Null<T> {\n\t\treturn if( h == null ) null else h.item;\n\t}\n\n\t/**\n\t\tReturns the last element of `this` List, or null if no elements exist.\n\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function last() : Null<T> {\n\t\treturn if( q == null ) null else q.item;\n\t}\n\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\n\t\tThe element is removed from `this` List.\n\t**/\n\tpublic function pop() : Null<T> {\n\t\tif( h == null )\n\t\t\treturn null;\n\t\tvar x = h.item;\n\t\th = h.next;\n\t\tif( h == null )\n\t\t\tq = null;\n\t\tlength--;\n\t\treturn x;\n\t}\n\n\t/**\n\t\tTells if `this` List is empty.\n\t**/\n\tpublic function isEmpty() : Bool {\n\t\treturn (h == null);\n\t}\n\n\t/**\n\t\tEmpties `this` List.\n\n\t\tThis function does not traverse the elements, but simply sets the\n\t\tinternal references to null and `this.length` to 0.\n\t**/\n\tpublic function clear() : Void {\n\t\th = null;\n\t\tq = null;\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tRemoves the first occurence of `v` in `this` List.\n\n\t\tIf `v` is found by checking standard equality, it is removed from `this`\n\t\tList and the function returns true.\n\n\t\tOtherwise, false is returned.\n\t**/\n\tpublic function remove( v : T ) : Bool {\n\t\tvar prev:ListNode<T> = null;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( l.item == v ) {\n\t\t\t\tif( prev == null )\n\t\t\t\t\th = l.next;\n\t\t\t\telse\n\t\t\t\t\tprev.next = l.next;\n\t\t\t\tif( q == l )\n\t\t\t\t\tq = prev;\n\t\t\t\tlength--;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tprev = l;\n\t\t\tl = l.next;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t\tReturns an iterator on the elements of the list.\n\t**/\n\tpublic inline function iterator() : ListIterator<T> {\n\t\treturn new ListIterator<T>(h);\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List.\n\n\t\tThe result is enclosed in { } with the individual elements being\n\t\tseparated by a comma.\n\t**/\n\tpublic function toString() {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\ts.add(\"{\");\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(\", \");\n\t\t\ts.add(Std.string(l.item));\n\t\t\tl = l.next;\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List, with `sep` separating\n\t\teach element.\n\t**/\n\tpublic function join(sep : String) {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(sep);\n\t\t\ts.add(l.item);\n\t\t\tl = l.next;\n\t\t}\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a list filtered with `f`. The returned list will contain all\n\t\telements for which `f(x) == true`.\n\t**/\n\tpublic function filter( f : T -> Bool ) {\n\t\tvar l2 = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l.item;\n\t\t\tl = l.next;\n\t\t\tif( f(v) )\n\t\t\t\tl2.add(v);\n\t\t}\n\t\treturn l2;\n\t}\n\n\t/**\n\t\tReturns a new list where all elements have been converted by the\n\t\tfunction `f`.\n\t**/\n\tpublic function map<X>(f : T -> X) : List<X> {\n\t\tvar b = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l.item;\n\t\t\tl = l.next;\n\t\t\tb.add(f(v));\n\t\t}\n\t\treturn b;\n\t}\n\n}\n\n#if neko\nprivate extern class ListNode<T> extends neko.NativeArray<Dynamic> {\n\tvar item(get,set):T;\n\tvar next(get,set):ListNode<T>;\n\tprivate inline function get_item():T return this[0];\n\tprivate inline function set_item(v:T):T return this[0] = v;\n\tprivate inline function get_next():ListNode<T> return this[1];\n\tprivate inline function set_next(v:ListNode<T>):ListNode<T> return this[1] = v;\n\tinline static function create<T>(item:T, next:ListNode<T>):ListNode<T> {\n\t\treturn untyped __dollar__array(item, next);\n\t}\n}\n#else\nprivate class ListNode<T> {\n\tpublic var item:T;\n\tpublic var next:ListNode<T>;\n\tpublic function new(item:T, next:ListNode<T>) {\n\t\tthis.item = item;\n\t\tthis.next = next;\n\t}\n\t@:extern public inline static function create<T>(item:T, next:ListNode<T>):ListNode<T> {\n\t\treturn new ListNode(item, next);\n\t}\n}\n#end\n\nprivate class ListIterator<T> {\n\tvar head:ListNode<T>;\n\n\tpublic inline function new(head:ListNode<T>) {\n\t\tthis.head = head;\n\t}\n\n\tpublic inline function hasNext():Bool {\n\t\treturn head != null;\n\t}\n\n\tpublic inline function next():T {\n\t\tvar val = head.item;\n\t\thead = head.next;\n\t\treturn val;\n\t}\n}\n","import js.html.Performance;\nimport js.html.DivElement;\nimport js.Browser;\n\n@:expose class Perf {\n\n\tpublic static var MEASUREMENT_INTERVAL:Int = 1000;\n\n\tpublic static var FONT_FAMILY:String = \"Helvetica,Arial\";\n\n\tpublic static var FPS_BG_CLR:String = \"#00FF00\";\n\tpublic static var FPS_WARN_BG_CLR:String = \"#FF8000\";\n\tpublic static var FPS_PROB_BG_CLR:String = \"#FF0000\";\n\n\tpublic static var MS_BG_CLR:String = \"#FFFF00\";\n\tpublic static var MEM_BG_CLR:String = \"#086A87\";\n\tpublic static var INFO_BG_CLR:String = \"#00FFFF\";\n\tpublic static var FPS_TXT_CLR:String = \"#000000\";\n\tpublic static var MS_TXT_CLR:String = \"#000000\";\n\tpublic static var MEM_TXT_CLR:String = \"#FFFFFF\";\n\tpublic static var INFO_TXT_CLR:String = \"#000000\";\n\n\tpublic static var TOP_LEFT:String = \"TL\";\n\tpublic static var TOP_RIGHT:String = \"TR\";\n\tpublic static var BOTTOM_LEFT:String = \"BL\";\n\tpublic static var BOTTOM_RIGHT:String = \"BR\";\n\n\tstatic var DELAY_TIME:Int = 4000;\n\n\tpublic var fps:DivElement;\n\tpublic var ms:DivElement;\n\tpublic var memory:DivElement;\n\tpublic var info:DivElement;\n\n\tpublic var lowFps:Float;\n\tpublic var avgFps:Float;\n\tpublic var currentFps:Float;\n\tpublic var currentMs:Float;\n\tpublic var currentMem:String;\n\n\tvar _time:Float;\n\tvar _startTime:Float;\n\tvar _prevTime:Float;\n\tvar _ticks:Int;\n\tvar _fpsMin:Float;\n\tvar _fpsMax:Float;\n\tvar _memCheck:Bool;\n\tvar _pos:String;\n\tvar _offset:Float;\n\tvar _measureCount:Int;\n\tvar _totalFps:Float;\n\n\tvar _perfObj:Performance;\n\tvar _memoryObj:Memory;\n\tvar _raf:Int;\n\n\tvar RAF:Dynamic;\n\tvar CAF:Dynamic;\n\n\tpublic function new(?pos = \"TR\", ?offset:Float = 0) {\n\t\t_perfObj = Browser.window.performance;\n\t\tif (Reflect.field(_perfObj, \"memory\") != null) _memoryObj = Reflect.field(_perfObj, \"memory\");\n\t\t_memCheck = (_perfObj != null && _memoryObj != null && _memoryObj.totalJSHeapSize > 0);\n\n\t\t_pos = pos;\n\t\t_offset = offset;\n\n\t\t_init();\n\t\t_createFpsDom();\n\t\t_createMsDom();\n\t\tif (_memCheck) _createMemoryDom();\n\n\t\tif (Browser.window.requestAnimationFrame != null) RAF = Browser.window.requestAnimationFrame;\n\t\telse if (untyped __js__(\"window\").mozRequestAnimationFrame != null) RAF = untyped __js__(\"window\").mozRequestAnimationFrame;\n\t\telse if (untyped __js__(\"window\").webkitRequestAnimationFrame != null) RAF = untyped __js__(\"window\").webkitRequestAnimationFrame;\n\t\telse if (untyped __js__(\"window\").msRequestAnimationFrame != null) RAF = untyped __js__(\"window\").msRequestAnimationFrame;\n\n\t\tif (Browser.window.cancelAnimationFrame != null) CAF = Browser.window.cancelAnimationFrame;\n\t\telse if (untyped __js__(\"window\").mozCancelAnimationFrame != null) CAF = untyped __js__(\"window\").mozCancelAnimationFrame;\n\t\telse if (untyped __js__(\"window\").webkitCancelAnimationFrame != null) CAF = untyped __js__(\"window\").webkitCancelAnimationFrame;\n\t\telse if (untyped __js__(\"window\").msCancelAnimationFrame != null) CAF = untyped __js__(\"window\").msCancelAnimationFrame;\n\n\t\tif (RAF != null) _raf = Reflect.callMethod(Browser.window, RAF, [_tick]);\n\t}\n\n\tinline function _init() {\n\t\tcurrentFps = 60;\n\t\tcurrentMs = 0;\n\t\tcurrentMem = \"0\";\n\n\t\tlowFps = 60;\n\t\tavgFps = 60;\n\n\t\t_measureCount = 0;\n\t\t_totalFps = 0;\n\t\t_time = 0;\n\t\t_ticks = 0;\n\t\t_fpsMin = 60;\n\t\t_fpsMax = 60;\n\t\t_startTime = _now();\n\t\t_prevTime = -MEASUREMENT_INTERVAL;\n\t}\n\n\tinline function _now():Float {\n\t\treturn (_perfObj != null && _perfObj.now != null) ? _perfObj.now() : Date.now().getTime();\n\t}\n\n\tfunction _tick(val:Float) {\n\t\tvar time = _now();\n\t\t_ticks++;\n\n\t\tif (_raf != null && time > _prevTime + MEASUREMENT_INTERVAL) {\n\t\t\tcurrentMs = Math.round(time - _startTime);\n\t\t\tms.innerHTML = \"MS: \" + currentMs;\n\n\t\t\tcurrentFps = Math.round((_ticks * 1000) / (time - _prevTime));\n\t\t\tif (currentFps > 0 && val > DELAY_TIME) {\n\t\t\t\t_measureCount++;\n\t\t\t\t_totalFps += currentFps;\n\t\t\t\tlowFps = _fpsMin = Math.min(_fpsMin, currentFps);\n\t\t\t\t_fpsMax = Math.max(_fpsMax, currentFps);\n\t\t\t\tavgFps = Math.round(_totalFps / _measureCount);\n\t\t\t}\n\n\t\t\tfps.innerHTML =  \"FPS: \" + currentFps + \" (\" + _fpsMin + \"-\" + _fpsMax + \")\";\n\n\t\t\tif (currentFps >= 30) fps.style.backgroundColor = FPS_BG_CLR;\n\t\t\telse if (currentFps >= 15) fps.style.backgroundColor = FPS_WARN_BG_CLR;\n\t\t\telse fps.style.backgroundColor = FPS_PROB_BG_CLR;\n\n\t\t\t_prevTime = time;\n\t\t\t_ticks = 0;\n\n\t\t\tif (_memCheck) {\n\t\t\t\tcurrentMem = _getFormattedSize(_memoryObj.usedJSHeapSize, 2);\n\t\t\t\tmemory.innerHTML = \"MEM: \" + currentMem;\n\t\t\t}\n\t\t}\n\t\t_startTime =  time;\n\n\t\tif (_raf != null) _raf = Reflect.callMethod(Browser.window, RAF, [_tick]);\n\t}\n\n\tfunction _createDiv(id:String, ?top:Float = 0):DivElement {\n\t\tvar div:DivElement = Browser.document.createDivElement();\n\t\tdiv.id = id;\n\t\tdiv.className = id;\n\t\tdiv.style.position = \"absolute\";\n\n\t\tswitch (_pos) {\n\t\t\tcase \"TL\":\n\t\t\t\tdiv.style.left = _offset + \"px\";\n\t\t\t\tdiv.style.top = top + \"px\";\n\t\t\tcase \"TR\":\n\t\t\t\tdiv.style.right = _offset + \"px\";\n\t\t\t\tdiv.style.top = top + \"px\";\n\t\t\tcase \"BL\":\n\t\t\t\tdiv.style.left = _offset + \"px\";\n\t\t\t\tdiv.style.bottom = ((_memCheck) ? 48 : 32) - top + \"px\";\n\t\t\tcase \"BR\":\n\t\t\t\tdiv.style.right = _offset + \"px\";\n\t\t\t\tdiv.style.bottom = ((_memCheck) ? 48 : 32) - top + \"px\";\n\t\t}\n\n\t\tdiv.style.width = \"80px\";\n\t\tdiv.style.height = \"12px\";\n\t\tdiv.style.lineHeight = \"12px\";\n\t\tdiv.style.padding = \"2px\";\n\t\tdiv.style.fontFamily = FONT_FAMILY;\n\t\tdiv.style.fontSize = \"9px\";\n\t\tdiv.style.fontWeight = \"bold\";\n\t\tdiv.style.textAlign = \"center\";\n\t\tBrowser.document.body.appendChild(div);\n\t\treturn div;\n\t}\n\n\tfunction _createFpsDom() {\n\t\tfps = _createDiv(\"fps\");\n\t\tfps.style.backgroundColor = FPS_BG_CLR;\n\t\tfps.style.zIndex = \"995\";\n\t\tfps.style.color = FPS_TXT_CLR;\n\t\tfps.innerHTML = \"FPS: 0\";\n\t}\n\n\tfunction _createMsDom() {\n\t\tms = _createDiv(\"ms\", 16);\n\t\tms.style.backgroundColor = MS_BG_CLR;\n\t\tms.style.zIndex = \"996\";\n\t\tms.style.color = MS_TXT_CLR;\n\t\tms.innerHTML = \"MS: 0\";\n\t}\n\n\tfunction _createMemoryDom() {\n\t\tmemory = _createDiv(\"memory\", 32);\n\t\tmemory.style.backgroundColor = MEM_BG_CLR;\n\t\tmemory.style.color = MEM_TXT_CLR;\n\t\tmemory.style.zIndex = \"997\";\n\t\tmemory.innerHTML = \"MEM: 0\";\n\t}\n\n\tfunction _getFormattedSize(bytes:Float, ?frac:Int = 0):String {\n\t\tvar sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\tif (bytes == 0) return \"0\";\n\t\tvar precision = Math.pow(10, frac);\n\t\tvar i = Math.floor(Math.log(bytes) / Math.log(1024));\n\t\treturn Math.round(bytes * precision / Math.pow(1024, i)) / precision + \" \" + sizes[i];\n\t}\n\n\tpublic function addInfo(val:String) {\n\t\tinfo = _createDiv(\"info\", (_memCheck) ? 48 : 32);\n\t\tinfo.style.backgroundColor = INFO_BG_CLR;\n\t\tinfo.style.color = INFO_TXT_CLR;\n\t\tinfo.style.zIndex = \"998\";\n\t\tinfo.innerHTML = val;\n\t}\n\n\tpublic function clearInfo() {\n\t\tif (info != null) {\n\t\t\tBrowser.document.body.removeChild(info);\n\t\t\tinfo = null;\n\t\t}\n\t}\n\n\tpublic function destroy() {\n\t\t_cancelRAF();\n\t\t_perfObj = null;\n\t\t_memoryObj = null;\n\t\tif (fps != null) {\n\t\t\tBrowser.document.body.removeChild(fps);\n\t\t\tfps = null;\n\t\t}\n\t\tif (ms != null) {\n\t\t\tBrowser.document.body.removeChild(ms);\n\t\t\tms = null;\n\t\t}\n\t\tif (memory != null) {\n\t\t\tBrowser.document.body.removeChild(memory);\n\t\t\tmemory = null;\n\t\t}\n\t\tclearInfo();\n\t\t_init();\n\t}\n\n\tinline function _cancelRAF() {\n\t\tReflect.callMethod(Browser.window, CAF, [_raf]);\n\t\t_raf = null;\n\t}\n}\n\ntypedef Memory = {\n\tvar usedJSHeapSize:Float;\n\tvar totalJSHeapSize:Float;\n\tvar jsHeapSizeLimit:Float;\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\t@:pure\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic {\n\t\ttry return untyped o[field] catch( e : Dynamic ) return null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : haxe.Constraints.Function, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static inline function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if (js_es < 5)\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tA String buffer is an efficient way to build a big string by appending small\n\telements together.\n\n\tIts cross-platform implementation uses String concatenation internally, but\n\tStringBuf may be optimized for different targets.\n\n\tUnlike String, an instance of StringBuf is not immutable in the sense that\n\tit can be passed as argument to functions which modify it by appending more\n\tvalues. However, the internal buffer cannot be modified.\n**/\nclass StringBuf {\n\n\tvar b:String;\n\n\t/**\n\t\tThe length of `this` StringBuf in characters.\n\t**/\n\tpublic var length(get,never) : Int;\n\n\t/**\n\t\tCreates a new StringBuf instance.\n\n\t\tThis may involve initialization of the internal buffer.\n\t**/\n\tpublic inline function new() {\n\t\tb = \"\";\n\t}\n\n\tinline function get_length() : Int {\n\t\treturn b.length;\n\t}\n\n\t/**\n\t\tAppends the representation of `x` to `this` StringBuf.\n\n\t\tThe exact representation of `x` may vary per platform. To get more\n\t\tconsistent behavior, this function should be called with\n\t\tStd.string(x).\n\n\t\tIf `x` is null, the String \"null\" is appended.\n\t**/\n\tpublic inline function add<T>( x : T ) : Void {\n\t\tb += x;\n\t}\n\n\t/**\n\t\tAppends the character identified by `c` to `this` StringBuf.\n\n\t\tIf `c` is negative or has another invalid value, the result is\n\t\tunspecified.\n\t**/\n\tpublic inline function addChar( c : Int ) : Void {\n\t\tb += String.fromCharCode(c);\n\t}\n\n\t/**\n\t\tAppends a substring of `s` to `this` StringBuf.\n\n\t\tThis function expects `pos` and `len` to describe a valid substring of\n\t\t`s`, or else the result is unspecified. To get more robust behavior,\n\t\t`this.add(s.substr(pos,len))` can be used instead.\n\n\t\tIf `s` or `pos` are null, the result is unspecified.\n\n\t\tIf `len` is omitted or null, the substring ranges from `pos` to the end\n\t\tof `s`.\n\t**/\n\tpublic inline function addSub( s : String, pos : Int, ?len : Int) : Void {\n\t\tb += (len == null ? s.substr(pos) : s.substr(pos, len));\n\t}\n\n\t/**\n\t\tReturns the content of `this` StringBuf as String.\n\n\t\tThe buffer is not emptied by this operation.\n\t**/\n\tpublic inline function toString() : String {\n\t\treturn b;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tThis class provides advanced methods on Strings. It is ideally used with\n\t`using StringTools` and then acts as an [extension](http://haxe.org/manual/lf-static-extension.html)\n\tto the `String` class.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\n#if cpp\nusing cpp.NativeString;\n#end\nclass StringTools {\n\t/**\n\t\tEncode an URL by using the standard format.\n\t**/\n\t#if (!java && !cpp && !lua) inline #end public static function urlEncode( s : String ) : String {\n\t\t#if flash\n\t\t\treturn untyped __global__[\"encodeURIComponent\"](s);\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlEncode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped encodeURIComponent(s);\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLEncode();\n\t\t#elseif java\n\t\t\treturn postProcessUrlEncode(java.net.URLEncoder.encode(s, \"UTF-8\"));\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.EscapeDataString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.quote(s, \"\");\n\t\t#elseif hl\n\t\t\tvar len = 0;\n\t\t\tvar b = @:privateAccess s.bytes.urlEncode(len);\n\t\t\treturn @:privateAccess String.__alloc__(b,len);\n\t\t#elseif lua\n\t\t\ts = lua.NativeStringTools.gsub(s, \"\\n\", \"\\r\\n\");\n\t\t\ts = lua.NativeStringTools.gsub(s, \"([^%w %-%_%.%~])\", function (c) {\n\t\t\t\treturn lua.NativeStringTools.format(\"%%%02X\", lua.NativeStringTools.byte(c) + '');\n\t\t\t});\n\t\t\ts = lua.NativeStringTools.gsub(s, \" \", \"+\");\n\t\t\treturn s;\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n#if java\n\tprivate static function postProcessUrlEncode( s : String ) : String {\n\t\tvar ret = new StringBuf();\n\t\tvar i = 0,\n\t\t    len = s.length;\n\t\twhile (i < len) {\n\t\t\tswitch(_charAt(s, i++)) {\n\t\t\tcase '+'.code:\n\t\t\t\tret.add('%20');\n\t\t\tcase '%'.code if (i <= len - 2):\n\t\t\t\tvar c1 = _charAt(s, i++),\n\t\t\t\t    c2 = _charAt(s, i++);\n\t\t\t\tswitch[c1, c2] {\n\t\t\t\tcase ['2'.code, '1'.code]:\n\t\t\t\t\tret.addChar('!'.code);\n\t\t\t\tcase ['2'.code, '7'.code]:\n\t\t\t\t\tret.addChar('\\''.code);\n\t\t\t\tcase ['2'.code, '8'.code]:\n\t\t\t\t\tret.addChar('('.code);\n\t\t\t\tcase ['2'.code, '9'.code]:\n\t\t\t\t\tret.addChar(')'.code);\n\t\t\t\tcase ['7'.code, 'E'.code]:\n\t\t\t\t\tret.addChar('-'.code);\n\t\t\t\tcase _:\n\t\t\t\t\tret.addChar('%'.code);\n\t\t\t\t\tret.addChar(cast c1);\n\t\t\t\t\tret.addChar(cast c2);\n\t\t\t\t}\n\t\t\tcase chr:\n\t\t\t\tret.addChar(cast chr);\n\t\t\t}\n\t\t}\n\t\treturn ret.toString();\n\t}\n#end\n\n\t/**\n\t\tDecode an URL using the standard format.\n\t**/\n\t#if (!java && !cpp && !lua) inline #end public static function urlDecode( s : String ) : String {\n\t\t#if flash\n\t\t\treturn untyped __global__[\"decodeURIComponent\"](s.split(\"+\").join(\" \"));\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlDecode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped decodeURIComponent(s.split(\"+\").join(\" \"));\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLDecode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLDecoder.decode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.UnescapeDataString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.unquote(s);\n\t\t#elseif hl\n\t\t\tvar len = 0;\n\t\t\tvar b = @:privateAccess s.bytes.urlDecode(len);\n\t\t\treturn @:privateAccess String.__alloc__(b,len);\n\t\t#elseif lua\n\t\t\ts = lua.NativeStringTools.gsub (s, \"+\", \" \");\n\t\t\ts = lua.NativeStringTools.gsub (s, \"%%(%x%x)\",\n\t\t\t\tfunction(h) {return lua.NativeStringTools.char(lua.Lua.tonumber(h,16));});\n\t\t\ts = lua.NativeStringTools.gsub (s, \"\\r\\n\", \"\\n\");\n\t\t\treturn s;\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tEscapes HTML special characters of the string `s`.\n\n\t\tThe following replacements are made:\n\n\t\t- `&` becomes `&amp`;\n\t\t- `<` becomes `&lt`;\n\t\t- `>` becomes `&gt`;\n\n\t\tIf `quotes` is true, the following characters are also replaced:\n\n\t\t- `\"` becomes `&quot`;\n\t\t- `'` becomes `&#039`;\n\t**/\n\tpublic static function htmlEscape( s : String, ?quotes : Bool ) : String {\n\t\ts = s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t\treturn quotes ? s.split('\"').join(\"&quot;\").split(\"'\").join(\"&#039;\") : s;\n\t}\n\n\t/**\n\t\tUnescapes HTML special characters of the string `s`.\n\n\t\tThis is the inverse operation to htmlEscape, i.e. the following always\n\t\tholds: `htmlUnescape(htmlEscape(s)) == s`\n\n\t\tThe replacements follow:\n\n\t\t- `&amp;` becomes `&`\n\t\t- `&lt;` becomes `<`\n\t\t- `&gt;` becomes `>`\n\t\t- `&quot;` becomes `\"`\n\t\t- `&#039;` becomes `'`\n\t**/\n\tpublic static function htmlUnescape( s : String ) : String {\n\t\treturn s.split(\"&gt;\").join(\">\").split(\"&lt;\").join(\"<\").split(\"&quot;\").join('\"').split(\"&#039;\").join(\"'\").split(\"&amp;\").join(\"&\");\n\t}\n\n\t/**\n\t\tTells if the string `s` starts with the string `start`.\n\n\t\tIf `start` is `null`, the result is unspecified.\n\n\t\tIf `start` is the empty String `\"\"`, the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function startsWith( s : String, start : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.startsWith(start);\n\t\t#elseif cs\n\t\treturn untyped s.StartsWith(start);\n\t\t#elseif cpp\n\t\tif (s.length<start.length)\n\t\t\treturn false;\n\t\tvar p0 = s.c_str();\n\t\tvar p1 = start.c_str();\n\t\tfor(i in 0...start.length)\n\t\t\tif ( p0.at(i) != p1.at(i) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t\t#elseif hl\n\t\treturn @:privateAccess (s.length >= start.length && s.bytes.compare(0,start.bytes,0,start.length<<1) == 0);\n\t\t#else\n\t\treturn( s.length >= start.length && s.substr(0, start.length) == start );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the string `s` ends with the string `end`.\n\n\t\tIf `end` is `null`, the result is unspecified.\n\n\t\tIf `end` is the empty String `\"\"`, the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function endsWith( s : String, end : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.endsWith(end);\n\t\t#elseif cs\n\t\treturn untyped s.EndsWith(end);\n\t\t#elseif cpp\n\t\tif (s.length<end.length)\n\t\t\treturn false;\n\t\tvar p0 = s.c_str().add( s.length-end.length );\n\t\tvar p1 = end.c_str();\n\t\tfor(i in 0...end.length)\n\t\t\tif ( p0.at(i) != p1.at(i) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t\t#elseif hl\n\t\tvar elen = end.length;\n\t\tvar slen = s.length;\n\t\treturn @:privateAccess (slen >= elen && s.bytes.compare((slen - elen) << 1, end.bytes, 0, elen << 1) == 0);\n\t\t#else\n\t\tvar elen = end.length;\n\t\tvar slen = s.length;\n\t\treturn( slen >= elen && s.substr(slen - elen, elen) == end );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the character in the string `s` at position `pos` is a space.\n\n\t\tA character is considered to be a space character if its character code\n\t\tis 9,10,11,12,13 or 32.\n\n\t\tIf `s` is the empty String `\"\"`, or if pos is not a valid position within\n\t\t`s`, the result is false.\n\t**/\n\tpublic static function isSpace( s : String, pos : Int ) : Bool {\n\t\t#if (python || lua)\n\t\tif (s.length == 0 || pos < 0 || pos >= s.length) return false;\n\t\t#end\n\t\tvar c = s.charCodeAt( pos );\n\t\treturn (c > 8 && c < 14) || c == 32;\n\t}\n\n\t/**\n\t\tRemoves leading space characters of `s`.\n\n\t\tThis function internally calls `isSpace()` to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String `\"\"` or consists only of space characters, the\n\t\tresult is the empty String `\"\"`.\n\t**/\n\tpublic #if cs inline #end static function ltrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimStart();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,r) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 )\n\t\t\treturn s.substr(r, l-r);\n\t\telse\n\t\t\treturn s;\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves trailing space characters of `s`.\n\n\t\tThis function internally calls `isSpace()` to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String `\"\"` or consists only of space characters, the\n\t\tresult is the empty String `\"\"`.\n\t**/\n\tpublic #if cs inline #end static function rtrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimEnd();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,l-r-1) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 ){\n\t\t\treturn s.substr(0, l-r);\n\t\t}else{\n\t\t\treturn s;\n\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves leading and trailing space characters of `s`.\n\n\t\tThis is a convenience function for `ltrim(rtrim(s))`.\n\t**/\n\tpublic #if (cs || java) inline #end static function trim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.Trim();\n\t\t#elseif java\n\t\treturn untyped s.trim();\n\t\t#else\n\t\treturn ltrim(rtrim(s));\n\t\t#end\n\t}\n\n\t/**\n\t\tConcatenates `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String `\"\"` or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function lpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = c + s;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tAppends `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String `\"\"` or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function rpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = s + c;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReplace all occurences of the String `sub` in the String `s` by the\n\t\tString `by`.\n\n\t\tIf `sub` is the empty String `\"\"`, `by` is inserted after each character\n\t\tof `s`. If `by` is also the empty String `\"\"`, `s` remains unchanged.\n\n\t\tThis is a convenience function for `s.split(sub).join(by)`.\n\n\t\tIf `sub` or `by` are null, the result is unspecified.\n\t**/\n\tpublic static function replace( s : String, sub : String, by : String ) : String {\n\t\t#if java\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.replace(sub, by);\n\t\t#elseif cs\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.Replace(sub, by);\n\t\t#else\n\t\treturn s.split(sub).join(by);\n\t\t#end\n\t}\n\n\t/**\n\t\tEncodes `n` into a hexadecimal representation.\n\n\t\tIf `digits` is specified, the resulting String is padded with \"0\" until\n\t\tits `length` equals `digits`.\n\t**/\n\tpublic static function hex( n : Int, ?digits : Int ) {\n\t\t#if flash\n\t\t\tvar n : UInt = n;\n\t\t\tvar s : String = untyped n.toString(16);\n\t\t\ts = s.toUpperCase();\n\t\t#else\n\t\t\tvar s = \"\";\n\t\t\tvar hexChars = \"0123456789ABCDEF\";\n\t\t\tdo {\n\t\t\t\ts = hexChars.charAt(n&15) + s;\n\t\t\t\tn >>>= 4;\n\t\t\t} while( n > 0 );\n\t\t#end\n\t\t#if python\n\t\tif (digits != null && s.length < digits) {\n\t\t\tvar diff = digits - s.length;\n\t\t\tfor (_ in 0...diff) {\n\t\t\t\ts = \"0\" + s;\n\t\t\t}\n\t\t}\n\t\t#else\n\t\tif( digits != null )\n\t\t\twhile( s.length < digits )\n\t\t\t\ts = \"0\"+s;\n\t\t#end\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReturns the character code at position `index` of String `s`, or an\n\t\tend-of-file indicator at if `position` equals `s.length`.\n\n\t\tThis method is faster than `String.charCodeAt()` on some platforms, but\n\t\tthe result is unspecified if `index` is negative or greater than\n\t\t`s.length`.\n\n\t\tEnd of file status can be checked by calling `StringTools.isEof()` with\n\t\tthe returned value as argument.\n\n\t\tThis operation is not guaranteed to work if `s` contains the `\\0`\n\t\tcharacter.\n\t**/\n\tpublic static inline function fastCodeAt( s : String, index : Int ) : Int {\n\t\t#if neko\n\t\treturn untyped __dollar__sget(s.__s, index);\n\t\t#elseif cpp\n\t\treturn untyped s.cca(index);\n\t\t#elseif flash\n\t\treturn untyped s.cca(index);\n\t\t#elseif java\n\t\treturn ( index < s.length ) ? cast(_charAt(s, index), Int) : -1;\n\t\t#elseif cs\n\t\treturn ( cast(index, UInt) < s.length ) ? cast(s[index], Int) : -1;\n\t\t#elseif js\n\t\treturn (untyped s).charCodeAt(index);\n\t\t#elseif python\n\t\treturn if (index >= s.length) -1 else python.internal.UBuiltins.ord(python.Syntax.arrayAccess(s, index));\n\t\t#elseif hl\n\t\treturn @:privateAccess s.bytes.getUI16(index << 1);\n\t\t#elseif lua\n\t\treturn lua.NativeStringTools.byte(s,index+1);\n\t\t#else\n\t\treturn untyped s.cca(index);\n\t\t#end\n\t}\n\n\t/*\n\t\tTells if `c` represents the end-of-file (EOF) character.\n\t*/\n\t@:noUsing public static inline function isEof( c : Int ) : Bool {\n\t\t#if (flash || cpp || hl)\n\t\treturn c == 0;\n\t\t#elseif js\n\t\treturn c != c; // fast NaN\n\t\t#elseif (neko || lua)\n\t\treturn c == null;\n\t\t#elseif cs\n\t\treturn c == -1;\n\t\t#elseif java\n\t\treturn c == -1;\n\t\t#elseif python\n\t\treturn c == -1;\n\t\t#else\n\t\treturn false;\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns a String that can be used as a single command line argument\n\t\ton Unix.\n\t\tThe input will be quoted, or escaped if necessary.\n\t*/\n\tpublic static function quoteUnixArg(argument:String):String {\n\t\t// Based on cpython's shlex.quote().\n\t\t// https://hg.python.org/cpython/file/a3f076d4f54f/Lib/shlex.py#l278\n\n\t\tif (argument == \"\")\n\t\t\treturn \"''\";\n\n\t\tif (!~/[^a-zA-Z0-9_@%+=:,.\\/-]/.match(argument))\n\t\t\treturn argument;\n\n\t\t// use single quotes, and put single quotes into double quotes\n\t\t// the string $'b is then quoted as '$'\"'\"'b'\n\t\treturn \"'\" + replace(argument, \"'\", \"'\\\"'\\\"'\") + \"'\";\n\t}\n\n\t/**\n\t\tCharacter codes of the characters that will be escaped by `quoteWinArg(_, true)`.\n\t*/\n\tpublic static var winMetaCharacters = [\" \".code, \"(\".code, \")\".code, \"%\".code, \"!\".code, \"^\".code, \"\\\"\".code, \"<\".code, \">\".code, \"&\".code, \"|\".code, \"\\n\".code, \"\\r\".code];\n\n\t/**\n\t\tReturns a String that can be used as a single command line argument\n\t\ton Windows.\n\t\tThe input will be quoted, or escaped if necessary, such that the output\n\t\twill be parsed as a single argument using the rule specified in\n\t\thttp://msdn.microsoft.com/en-us/library/ms880421\n\n\t\tExamples:\n\t\t```\n\t\tquoteWinArg(\"abc\") == \"abc\";\n\t\tquoteWinArg(\"ab c\") == '\"ab c\"';\n\t\t```\n\t*/\n\tpublic static function quoteWinArg(argument:String, escapeMetaCharacters:Bool):String {\n\t\t// If there is no space, tab, back-slash, or double-quotes, and it is not an empty string.\n\t\tif (!~/^[^ \\t\\\\\"]+$/.match(argument)) {\n\n\t\t\t// Based on cpython's subprocess.list2cmdline().\n\t\t\t// https://hg.python.org/cpython/file/50741316dd3a/Lib/subprocess.py#l620\n\n\t\t\tvar result = new StringBuf();\n\t\t\tvar needquote = argument.indexOf(\" \") != -1 || argument.indexOf(\"\\t\") != -1 || argument == \"\";\n\n\t\t\tif (needquote)\n\t\t\t\tresult.add('\"');\n\n\t\t\tvar bs_buf = new StringBuf();\n\t\t\tfor (i in 0...argument.length) {\n\t\t\t\tswitch (argument.charCodeAt(i)) {\n\t\t\t\t\tcase \"\\\\\".code:\n\t\t\t\t\t\t// Don't know if we need to double yet.\n\t\t\t\t\t\tbs_buf.add(\"\\\\\");\n\t\t\t\t\tcase '\"'.code:\n\t\t\t\t\t\t// Double backslashes.\n\t\t\t\t\t\tvar bs = bs_buf.toString();\n\t\t\t\t\t\tresult.add(bs);\n\t\t\t\t\t\tresult.add(bs);\n\t\t\t\t\t\tbs_buf = new StringBuf();\n\t\t\t\t\t\tresult.add('\\\\\"');\n\t\t\t\t\tcase c:\n\t\t\t\t\t\t// Normal char\n\t\t\t\t\t\tif (bs_buf.length > 0) {\n\t\t\t\t\t\t\tresult.add(bs_buf.toString());\n\t\t\t\t\t\t\tbs_buf = new StringBuf();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.addChar(c);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add remaining backslashes, if any.\n\t\t\tresult.add(bs_buf.toString());\n\n\t\t\tif (needquote) {\n\t\t\t\tresult.add(bs_buf.toString());\n\t\t\t\tresult.add('\"');\n\t\t\t}\n\n\t\t\targument = result.toString();\n\t\t}\n\n\t\tif (escapeMetaCharacters) {\n\t\t\tvar result = new StringBuf();\n\t\t\tfor (i in 0...argument.length) {\n\t\t\t\tvar c = argument.charCodeAt(i);\n\t\t\t\tif (winMetaCharacters.indexOf(c) >= 0) {\n\t\t\t\t\tresult.addChar(\"^\".code);\n\t\t\t\t}\n\t\t\t\tresult.addChar(c);\n\t\t\t}\n\t\t\treturn result.toString();\n\t\t} else {\n\t\t\treturn argument;\n\t\t}\n\t}\n\n\t#if java\n\tprivate static inline function _charAt(str:String, idx:Int):java.StdTypes.Char16 return untyped str._charAt(idx);\n\t#end\n\n\t#if neko\n\tprivate static var _urlEncode = neko.Lib.load(\"std\",\"url_encode\",1);\n\tprivate static var _urlDecode = neko.Lib.load(\"std\",\"url_decode\",1);\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static inline function getClass<T>( o : T ) : Class<T> {\n\t\treturn if (o == null) null else @:privateAccess js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\tif (a == null)\n\t\t\treturn null;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tcase 9:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8]);\n\t\tcase 10:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9]);\n\t\tcase 11:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10]);\n\t\tcase 12:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11]);\n\t\tcase 13:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11],args[12]);\n\t\tcase 14:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11],args[12],args[13]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f:Dynamic = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"__meta__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static inline function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\treturn ((cast e).__constructs__ : Array<String>).copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic inline static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped __define_feature__(\"Type.allEnums\", e.__empty_constructs__);\n\t}\n\n}\n\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n#if ((flash || flash9doc || cs || hl) && !doc_gen)\n/**\n\tThe unsigned `Int` type is only defined for Flash and C#. It's currently\n\thandled the same as a normal Int.\n\n\t@see http://haxe.org/manual/types-basic-types.html\n**/\n@:coreType\n@:notNull\n@:runtimeValue\n@:analyzer(no_const_propagation)\nabstract UInt to Int from Int\n{\n\t@:commutative @:op(A+B) private static function addI(lhs:UInt, rhs:Int):UInt;\n\t@:commutative @:op(A+B) private static function addF(lhs:UInt, rhs:Float):Float;\n\t@:op(A+B) private static function add(lhs:UInt, rhs:UInt):UInt;\n\n\t@:commutative @:op(A*B) private static function mulI(lhs:UInt, rhs:Int):UInt;\n\t@:commutative @:op(A*B) private static function mulF(lhs:UInt, rhs:Float):Float;\n\t@:op(A*B) private static function mul(lhs:UInt, rhs:UInt):UInt;\n\n\t@:op(A%B) private static function modI(lhs:UInt, rhs:Int):UInt;\n\t@:op(A%B) private static function modF(lhs:UInt, rhs:Float):Float;\n\t@:op(A%B) private static function mod(lhs:UInt, rhs:UInt):UInt;\n\n\t@:op(A-B) private static function subI(lhs:UInt, rhs:Int):UInt;\n\t@:op(A-B) private static function subF(lhs:UInt, rhs:Float):Float;\n\t@:op(A-B) private static function sub(lhs:UInt, rhs:UInt):UInt;\n\n\t@:op(A/B) private static function divI(lhs:UInt, rhs:Int):Float;\n\t@:op(A/B) private static function divF(lhs:UInt, rhs:Float):Float;\n\t@:op(A/B) private static function div(lhs:UInt, rhs:UInt):Float;\n\n\t@:commutative @:op(A|B) private static function orI(lhs:UInt, rhs:Int):UInt;\n\t@:op(A|B) private static function or(lhs:UInt, rhs:UInt):UInt;\n\n\t@:commutative @:op(A^B) private static function xorI(lhs:UInt, rhs:Int):UInt;\n\t@:op(A^B) private static function xor(lhs:UInt, rhs:UInt):UInt;\n\n\t@:commutative @:op(A&B) private static function andI(lhs:UInt, rhs:Int):UInt;\n\t@:op(A&B) private static function and(lhs:UInt, rhs:UInt):UInt;\n\n\t@:op(A<<B) private static function shl(lhs:UInt, rhs:Int):UInt;\n\t@:op(A>>B) private static inline function shr(lhs:UInt, rhs:Int):UInt return lhs >>> rhs;\n\t@:op(A>>>B) private static function ushr(lhs:UInt, rhs:Int):UInt;\n\n\t@:op(A>B) private static function gt(lhs:UInt, rhs:UInt):Bool;\n\t@:op(A>=B) private static function gte(lhs:UInt, rhs:UInt):Bool;\n\t@:op(A<B) private static function lt(lhs:UInt, rhs:UInt):Bool;\n\t@:op(A<=B) private static function lte(lhs:UInt, rhs:UInt):Bool;\n\n\t@:op(A>B) private static function gtf(lhs:UInt, rhs:Float):Bool;\n\t@:op(A>B) private static function gtf2(lhs:Float, rhs:UInt):Bool;\n\t@:op(A>=B) private static function gtef(lhs:UInt, rhs:Float):Bool;\n\t@:op(A>=B) private static function gtef2(lhs:Float, rhs:UInt):Bool;\n\t@:op(A<B) private static function ltf(lhs:UInt, rhs:Float):Bool;\n\t@:op(A<B) private static function ltf2(lhs:Float, rhs:UInt):Bool;\n\t@:op(A<=B) private static function ltef(lhs:UInt, rhs:Float):Bool;\n\t@:op(A<=B) private static function ltef2(lhs:Float, rhs:UInt):Bool;\n\n\t@:op(~A) private static function bneg(t:UInt):UInt;\n\n\t@:commutative @:op(A == B) private static function equalsInt<T:Int>(a:UInt, b:T):Bool;\n\t@:commutative @:op(A != B) private static function notEqualsInt<T:Int>(a:UInt, b:T):Bool;\n\t@:commutative @:op(A == B) private static function equalsFloat<T:Float>(a:UInt, b:T):Bool;\n\t@:commutative @:op(A != B) private static function notEqualsFloat<T:Float>(a:UInt, b:T):Bool;\n\n\t@:op(++A) private function prefixIncrement():UInt;\n\t@:op(A++) private function postfixIncrement():UInt;\n\t@:op(--A) private function prefixDecrement():UInt;\n\t@:op(A--) private function postfixDecrement():UInt;\n}\n#else\n/**\n\tThe unsigned `Int` type is only defined for Flash and C#.\n\tSimulate it for other platforms.\n\n\t@see http://haxe.org/manual/types-basic-types.html\n**/\nabstract UInt(Int) from Int to Int {\n\n\t@:op(A + B) private static inline function add(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() + b.toInt();\n\t}\n\n\t@:op(A / B) private static inline function div(a:UInt, b:UInt):Float {\n\t\treturn a.toFloat() / b.toFloat();\n\t}\n\n\t@:op(A * B) private static inline function mul(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() * b.toInt();\n\t}\n\n\t@:op(A - B) private static inline function sub(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() - b.toInt();\n\t}\n\n\t@:op(A > B) private static #if !js inline #end function gt(a:UInt, b:UInt):Bool {\n\t\tvar aNeg = a.toInt() < 0;\n\t\tvar bNeg = b.toInt() < 0;\n\t\treturn\n\t\t\tif( aNeg != bNeg ) aNeg;\n\t\t\telse a.toInt() > b.toInt();\n\t}\n\n\t@:op(A >= B) private static #if !js inline #end function gte(a:UInt, b:UInt):Bool {\n\t\tvar aNeg = a.toInt() < 0;\n\t\tvar bNeg = b.toInt() < 0;\n\t\treturn\n\t\t\tif( aNeg != bNeg ) aNeg;\n\t\t\telse a.toInt() >= b.toInt();\n\t}\n\n\t@:op(A < B) private static inline function lt(a:UInt, b:UInt):Bool {\n\t\treturn gt(b, a);\n\t}\n\n\t@:op(A <= B) private static inline function lte(a:UInt, b:UInt):Bool {\n\t\treturn gte(b, a);\n\t}\n\n\t@:op(A & B) private static inline function and(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() & b.toInt();\n\t}\n\n\t@:op(A | B) private static inline function or(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() | b.toInt();\n\t}\n\n\t@:op(A ^ B) private static inline function xor(a:UInt, b:UInt):UInt {\n\t\treturn a.toInt() ^ b.toInt();\n\t}\n\n\t@:op(A << B) private static inline function shl(a:UInt, b:Int):UInt {\n\t\treturn a.toInt() << b;\n\t}\n\n\t@:op(A >> B) private static inline function shr(a:UInt, b:Int):UInt {\n\t\treturn a.toInt() >>> b;\n\t}\n\n\t@:op(A >>> B) private static inline function ushr(a:UInt, b:Int):UInt {\n\t\treturn a.toInt() >>> b;\n\t}\n\n\t@:op(A % B) private static inline function mod(a:UInt, b:UInt):UInt {\n\t\treturn Std.int( a.toFloat() % b.toFloat() );\n\t}\n\n\t@:commutative @:op(A + B) private static inline function addWithFloat(a:UInt, b:Float):Float {\n\t\treturn a.toFloat() + b;\n\t}\n\n\t@:commutative @:op(A * B) private static inline function mulWithFloat(a:UInt, b:Float):Float {\n\t\treturn a.toFloat() * b;\n\t}\n\n\t@:op(A / B) private static inline function divFloat(a:UInt, b:Float):Float {\n\t\treturn a.toFloat() / b;\n\t}\n\n\t@:op(A / B) private static inline function floatDiv(a:Float, b:UInt):Float {\n\t\treturn a / b.toFloat();\n\t}\n\n\t@:op(A - B) private static inline function subFloat(a:UInt, b:Float):Float {\n\t\treturn a.toFloat() - b;\n\t}\n\n\t@:op(A - B) private static inline function floatSub(a:Float, b:UInt):Float {\n\t\treturn a - b.toFloat();\n\t}\n\n\t@:op(A > B) private static inline function gtFloat(a:UInt, b:Float):Bool {\n\t\treturn a.toFloat() > b;\n\t}\n\n\t@:commutative @:op(A == B) private static inline function equalsInt<T:Int>(a:UInt, b:T):Bool {\n\t\treturn a.toInt() == b;\n\t}\n\n\t@:commutative @:op(A != B) private static inline function notEqualsInt<T:Int>(a:UInt, b:T):Bool {\n\t\treturn a.toInt() != b;\n\t}\n\n\t@:commutative @:op(A == B) private static inline function equalsFloat<T:Float>(a:UInt, b:T):Bool {\n\t\treturn a.toFloat() == b;\n\t}\n\n\t@:commutative @:op(A != B) private static inline function notEqualsFloat<T:Float>(a:UInt, b:T):Bool {\n\t\treturn a.toFloat() != b;\n\t}\n\n\t@:op(A >= B) private static inline function gteFloat(a:UInt, b:Float):Bool {\n\t\treturn a.toFloat() >= b;\n\t}\n\n\n\t@:op(A > B) private static inline function floatGt(a:Float, b:UInt):Bool {\n\t\treturn a > b.toFloat();\n\t}\n\n\t@:op(A >= B) private static inline function floatGte(a:Float, b:UInt):Bool {\n\t\treturn a >= b.toFloat();\n\t}\n\n\t@:op(A < B) private static inline function ltFloat(a:UInt, b:Float):Bool {\n\t\treturn a.toFloat() < b;\n\t}\n\n\t@:op(A <= B) private static inline function lteFloat(a:UInt, b:Float):Bool {\n\t\treturn a.toFloat() <= b;\n\t}\n\n\t@:op(A < B) private static inline function floatLt(a:Float, b:UInt):Bool {\n\t\treturn a < b.toFloat();\n\t}\n\n\t@:op(A <= B) private static inline function floatLte(a:Float, b:UInt):Bool {\n\t\treturn a <= b.toFloat();\n\t}\n\n\t@:op(A % B) private static inline function modFloat(a:UInt, b:Float):Float {\n\t\treturn a.toFloat() % b;\n\t}\n\n\t@:op(A % B) private static inline function floatMod(a:Float, b:UInt):Float {\n\t\treturn a % b.toFloat();\n\t}\n\n\t@:op(~A) private inline function negBits():UInt {\n\t\treturn ~this;\n\t}\n\n\t@:op(++A) private inline function prefixIncrement():UInt {\n\t\treturn ++this;\n\t}\n\n\t@:op(A++) private inline function postfixIncrement():UInt {\n\t\treturn this++;\n\t}\n\n\t@:op(--A) private inline function prefixDecrement():UInt {\n\t\treturn --this;\n\t}\n\n\t@:op(A--) private inline function postfixDecrement():UInt {\n\t\treturn this--;\n\t}\n\n\t// TODO: radix is just defined to deal with doc_gen issues\n\tprivate inline function toString(?radix:Int):String {\n\t\treturn Std.string(toFloat());\n\t}\n\n\tprivate inline function toInt():Int {\n\t\treturn this;\n\t}\n\n\t@:to private #if (!js || analyzer) inline #end function toFloat():Float {\n\t\tvar int = toInt();\n\t\tif (int < 0) {\n\t\t\treturn 4294967296.0 + int;\n\t\t}\n\t\telse {\n\t\t\t// + 0.0 here to make sure we promote to Float on some platforms\n\t\t\t// In particular, PHP was having issues when comparing to Int in the == op.\n\t\t\treturn int + 0.0;\n\t\t}\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n/**\n\tXml node types.\n\n\t@see http://haxe.org/manual/std-Xml.html\n**/\n@:enum abstract XmlType(Int) {\n\t/**\n\t\tRepresents an XML element type.\n\t**/\n\tvar Element = 0;\n\t/**\n\t\tRepresents XML parsed character data type.\n\t**/\n\tvar PCData = 1;\n\t/**\n\t\tRepresents XML character data type.\n\t**/\n\tvar CData = 2;\n\t/**\n\t\tRepresents an XML comment type.\n\t**/\n\tvar Comment = 3;\n\t/**\n\t\tRepresents an XML doctype element type.\n\t**/\n\tvar DocType = 4;\n\t/**\n\t \tRepresents an XML processing instruction type.\n\t**/\n\tvar ProcessingInstruction = 5;\n\t/**\n\t\tRepresents an XML document type.\n\t**/\n\tvar Document = 6;\n}\n\n/**\n\tCrossplatform Xml API.\n\n\t@see http://haxe.org/manual/std-Xml.html\n**/\nclass Xml {\n\t/**\n\t\tXML element type.\n\t**/\n\tstatic public var Element(default,never) = XmlType.Element;\n\t/**\n\t\tXML parsed character data type.\n\t**/\n\tstatic public var PCData(default,never) = XmlType.PCData;\n\t/**\n\t\tXML character data type.\n\t**/\n\tstatic public var CData(default,never) = XmlType.CData;\n\t/**\n\t\tXML comment type.\n\t**/\n\tstatic public var Comment(default,never) = XmlType.Comment;\n\t/**\n\t\tXML doctype element type.\n\t**/\n\tstatic public var DocType(default,never) = XmlType.DocType;\n\t/**\n\t \tXML processing instruction type.\n\t**/\n\tstatic public var ProcessingInstruction(default,never) = XmlType.ProcessingInstruction;\n\t/**\n\t\tXML document type.\n\t**/\n\tstatic public var Document(default,never) = XmlType.Document;\n\n\t/**\n\t\tParses the String into an Xml document.\n\t**/\n\tstatic public function parse( str : String ) : Xml {\n\t\treturn haxe.xml.Parser.parse(str);\n\t}\n\n\t/**\n\t\tReturns the type of the Xml Node. This should be used before\n\t\taccessing other functions since some might raise an exception\n\t\tif the node type is not correct.\n\t**/\n\tpublic var nodeType(default, null) : XmlType;\n\n\t/**\n\t\tReturns the node name of an Element.\n\t**/\n\t@:isVar public var nodeName(get, set) : String;\n\n\t/**\n\t\tReturns the node value. Only works if the Xml node is not an Element or a Document.\n\t**/\n\t@:isVar public var nodeValue(get, set) : String;\n\n\t/**\n\t\tReturns the parent object in the Xml hierarchy.\n\t\tThe parent can be `null`, an Element or a Document.\n\t**/\n\tpublic var parent(default, null) : Xml;\n\n\tvar children:Array<Xml>;\n\tvar attributeMap:Map<String, String>;\n\n\t#if !cppia inline #end function get_nodeName() {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn nodeName;\n\t}\n\n\t#if !cppia inline #end function set_nodeName(v) {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn this.nodeName = v;\n\t}\n\n\t#if !cppia inline #end function get_nodeValue() {\n\t\tif (nodeType == Document || nodeType == Element) {\n\t\t\tthrow 'Bad node type, unexpected $nodeType';\n\t\t}\n\t\treturn nodeValue;\n\t}\n\n\t#if !cppia inline #end function set_nodeValue(v) {\n\t\tif (nodeType == Document || nodeType == Element) {\n\t\t\tthrow 'Bad node type, unexpected $nodeType';\n\t\t}\n\t\treturn this.nodeValue = v;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createElement( name : String ) : Xml {\n\t\tvar xml = new Xml(Element);\n\t\txml.nodeName = name;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createPCData( data : String ) : Xml {\n\t\tvar xml = new Xml(PCData);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createCData( data : String ) : Xml {\n\t\tvar xml = new Xml(CData);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createComment( data : String ) : Xml {\n\t\tvar xml = new Xml(Comment);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createDocType( data : String ) : Xml {\n\t\tvar xml = new Xml(DocType);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createProcessingInstruction( data : String ) : Xml {\n\t\tvar xml = new Xml(ProcessingInstruction);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createDocument() : Xml {\n\t\treturn new Xml(Document);\n\t}\n\n\t/**\n\t\tGet the given attribute of an Element node. Returns `null` if not found.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function get( att : String ) : String {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap[att];\n\t}\n\n\t/**\n\t\tSet the given attribute value for an Element node.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function set( att : String, value : String ) : Void {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\tattributeMap.set(att, value);\n\t}\n\n\t/**\n\t\tRemoves an attribute for an Element node.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function remove( att : String ) : Void {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\tattributeMap.remove(att);\n\t}\n\n\t/**\n\t\tTells if the Element node has a given attribute.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function exists( att : String ) : Bool {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap.exists(att);\n\t}\n\n\t/**\n\t\tReturns an `Iterator` on all the attribute names.\n\t**/\n\tpublic function attributes() : Iterator<String> {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap.keys();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic #if !cppia inline #end function iterator() : Iterator<Xml> {\n\t\tensureElementType();\n\t\treturn children.iterator();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes which are Elements.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic function elements() : Iterator<Xml> {\n\t\tensureElementType();\n\t\tvar ret = [for (child in children) if (child.nodeType == Element) child];\n\t\treturn ret.iterator();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes which are Elements with the given nodeName.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic function elementsNamed( name : String ) : Iterator<Xml> {\n\t\tensureElementType();\n\t\tvar ret = [for (child in children) if (child.nodeType == Element && child.nodeName == name) child];\n\t\treturn ret.iterator();\n\t}\n\n\t/**\n\t\tReturns the first child node.\n\t**/\n\tpublic #if !cppia inline #end function firstChild() : Xml {\n\t\tensureElementType();\n\t\treturn children[0];\n\t}\n\n\t/**\n\t\tReturns the first child node which is an Element.\n\t**/\n\tpublic function firstElement() : Xml {\n\t\tensureElementType();\n\t\tfor (child in children) {\n\t\t\tif (child.nodeType == Element) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tAdds a child node to the Document or Element.\n\t\tA child node can only be inside one given parent node, which is indicated by the `parent` property.\n\t\tIf the child is already inside this Document or Element, it will be moved to the last position among the Document or Element's children.\n\t\tIf the child node was previously inside a different node, it will be moved to this Document or Element.\n\t**/\n\tpublic function addChild( x : Xml ) : Void {\n\t\tensureElementType();\n\t\tif (x.parent != null) {\n\t\t\tx.parent.removeChild(x);\n\t\t}\n\t\tchildren.push(x);\n\t\tx.parent = this;\n\t}\n\n\t/**\n\t\tRemoves a child from the Document or Element.\n\t\tReturns true if the child was successfuly removed.\n\t**/\n\tpublic function removeChild( x : Xml ) : Bool {\n\t\tensureElementType();\n\t\tif (children.remove(x)) {\n\t\t\tx.parent = null;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t\tInserts a child at the given position among the other childs.\n\t\tA child node can only be inside one given parent node, which is indicated by the [parent] property.\n\t\tIf the child is already inside this Document or Element, it will be moved to the new position among the Document or Element's children.\n\t\tIf the child node was previously inside a different node, it will be moved to this Document or Element.\n\t**/\n\tpublic function insertChild( x : Xml, pos : Int ) : Void {\n\t\tensureElementType();\n\t\tif (x.parent != null) {\n\t\t\tx.parent.children.remove(x);\n\t\t}\n\t\tchildren.insert(pos, x);\n\t\tx.parent = this;\n\t}\n\n\t/**\n\t\tReturns a String representation of the Xml node.\n\t**/\n\tpublic #if !cppia inline #end function toString() : String {\n\t\treturn haxe.xml.Printer.print(this);\n\t}\n\n\tfunction new(nodeType:XmlType) {\n\t\tthis.nodeType = nodeType;\n\t\tchildren = [];\n\t\tattributeMap = new Map();\n\t}\n\n\tinline function ensureElementType() {\n\t\tif (nodeType != Document && nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element or Document but found $nodeType';\n\t\t}\n\t}\n}\n","package com.isartdigital.ruby;\n\nimport com.isartdigital.ruby.game.GameManager;\nimport com.isartdigital.ruby.game.controller.MouseController;\nimport com.isartdigital.ruby.game.player.MissionsManager;\nimport com.isartdigital.ruby.game.player.Player;\nimport com.isartdigital.ruby.game.sprites.elements.destructible.Destructible;\nimport com.isartdigital.ruby.preloadgame.LoadingBar;\nimport com.isartdigital.ruby.preloadgame.PreloadMiniGame;\nimport com.isartdigital.ruby.ui.GraphicLoader;\nimport com.isartdigital.ruby.ui.items.DrillingXenoItem;\nimport com.isartdigital.ruby.ui.items.switchItems.SpecialFeatureSwitchSkill;\n\nimport com.isartdigital.ruby.ui.items.switchItems.UpgradeCenterSwitchItem;\nimport com.isartdigital.ruby.ui.items.switchItems.XenosPanelSwitchItem;\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchTab;\nimport com.isartdigital.ruby.ui.items.DrillingFriendItem;\nimport com.isartdigital.ruby.ui.items.switchItems.DrillingButtonSwitchItem;\nimport com.isartdigital.ruby.ui.items.switchItems.MissionSwitchItem;\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\nimport com.isartdigital.ruby.ui.hud.XpBar;\nimport com.isartdigital.ruby.ui.hud.XpBar;\nimport com.isartdigital.ruby.ui.items.switchItems.XenoSlotSwitchItem;\nimport com.isartdigital.ruby.ui.items.switchItems.XenoSocialSwitchItem;\nimport com.isartdigital.ruby.ui.popin.IsartPoints;\nimport com.isartdigital.ruby.ui.popin.buyRegion.RegionSwitch;\nimport com.isartdigital.ruby.ui.popin.enclos.EnclosSwitchItem;\nimport com.isartdigital.ruby.ui.popin.incubator.GeneButton;\nimport com.isartdigital.ruby.ui.popin.incubator.GeneSpot;\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchItem;\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuData;\nimport com.isartdigital.ruby.ui.popin.codex.CodexData;\nimport com.isartdigital.ruby.ui.popin.incubator.Inseminator;\nimport com.isartdigital.ruby.ui.popin.incubator.TimerIncubator;\nimport com.isartdigital.ruby.ui.popin.shop.ShopItem;\nimport com.isartdigital.ruby.ui.popin.shop.ShopItemBig;\nimport com.isartdigital.ruby.ui.popin.shop.ShopItemMedium;\nimport com.isartdigital.ruby.ui.items.switchItems.ShopSwitchTab;\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopData;\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\nimport com.isartdigital.ruby.ui.popin.upgradeCenter.TankUpgrade;\nimport com.isartdigital.ruby.ui.specialButtons.Textbutton;\nimport com.isartdigital.ruby.utils.TimeManager;\nimport com.isartdigital.services.deltaDNA.DeltaDNA;\nimport com.isartdigital.utils.system.Localization;\nimport com.isartdigital.utils.system.Localization;\nimport haxe.Http;\nimport haxe.Json;\nimport js.html.CanvasElement;\nimport pixi.core.math.Point;\n\nimport com.isartdigital.utils.save.DataBaseAction;\n\nimport com.isartdigital.ruby.ui.hud.Hud;\nimport com.isartdigital.ruby.ui.screens.TitleCard;\nimport com.isartdigital.ruby.ui.UIManager;\nimport com.isartdigital.services.facebook.Facebook;\nimport com.isartdigital.utils.Config;\nimport com.isartdigital.utils.Debug;\nimport com.isartdigital.utils.events.EventType;\nimport com.isartdigital.utils.events.LoadEventType;\nimport com.isartdigital.utils.game.GameStage;\nimport com.isartdigital.utils.game.GameStageScale;\nimport com.isartdigital.utils.game.StateGraphic;\nimport com.isartdigital.utils.game.factory.MovieClipAnimFactory;\nimport com.isartdigital.utils.loader.GameLoader;\nimport com.isartdigital.utils.system.DeviceCapabilities;\nimport haxe.Timer;\nimport js.Browser;\nimport js.Lib;\nimport pixi.core.display.Container;\nimport pixi.core.renderers.Detector;\nimport pixi.core.renderers.webgl.WebGLRenderer;\nimport eventemitter3.EventEmitter;\nimport pixi.interaction.EventTarget;\nimport pixi.loaders.Loader;\n\n/**\n * Classe d'initialisation et lancement du jeu\n * @author Mathieu ANTHOINE\n */\n\nclass Main extends EventEmitter\n{\n\n\tprivate static inline var FPS:UInt = 16; //Math.floor(1000/60);\n\t\n\tpublic var frame(default, null):Int = 10;\n\t\n\tprivate var isLoaded:Bool = false;\n\tprivate var isLogged:Bool = false;\n\tpublic var isAnimLoadingDone:Bool = false;\n\n\n\t\n\t/**\n\t * chemin vers le fichier de configuration\n\t */\n\tprivate static var configPath:String = \"config.json\";\n\n\t/**\n\t * instance unique de la classe Main\n\t */\n\tprivate static var instance: Main;\n\n\t/**\n\t * renderer (WebGL ou Canvas)\n\t */\n\tpublic var renderer:WebGLRenderer;\n\n\t/**\n\t * Element racine de la displayList\n\t */\n\tpublic var stage:Container;\n\n\t/**\n\t * initialisation gnrale\n\t */\n\tprivate static function main ():Void\n\t{\n\t\tMain.getInstance();\n\t}\n\n\t/**\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\n\t * @return instance unique\n\t */\n\tpublic static function getInstance (): Main\n\t{\n\t\tif (instance == null) instance = new Main();\n\t\treturn instance;\n\t}\n\n\t/**\n\t * cration du jeu et lancement du chargement du fichier de configuration\n\t */\n\tprivate function new ()\n\t{\n\n\t\tsuper();\n\t\tvar lOptions:RenderingOptions = { };\n\t\t//lOptions.antialias = true;\n\t\t//lOptions.autoResize = true;\n\t\tlOptions.backgroundColor = 0x0d3561;\n\t\t//lOptions.resolution = 1;\n\t\t//lOptions.transparent = false;\n\t\t//lOptions.preserveDrawingBuffer (pour dataToURL)\n\t\t\n\t\tDeviceCapabilities.scaleViewport();\n\t\t\n\t\trenderer = Detector.autoDetectRenderer(DeviceCapabilities.width, DeviceCapabilities.height,lOptions);\n\t\t//renderer.roundPixels = true;\n\n\t\tBrowser.document.body.appendChild(renderer.view);\n\n\t\tstage = new Container();\n\n\t\tvar lConfig:Loader = new Loader();\n\t\tconfigPath += \"?\" + Date.now().getTime();\n\t\tlConfig.add(configPath);\n\t\tlConfig.once(LoadEventType.COMPLETE, preloadAssets);\n\n\t\tFacebook.onLogin = onLogin;\n\t\tFacebook.load(\"1007819322696165\");\n\t\t//isLogged = true;\n\t\t//DataBaseAction.getInstance().connexionPlayer(\"10154767559052348\", \"Mike\");\n\t\t\n\t\t\n\t\tlConfig.load();\n\t\t\n\t}\n\t\n\tprivate static function importClasses():Void {\n\t\tShopItem;\n\t\tBuildingMenuSwitchItem;\n\t\tShopItemMedium;\n\t\tShopItemBig;\n\t\tSwitchItem;\n\t\tShopSwitchTab;\n\t\tDrillingXenoItem;\n\t\tDrillingFriendItem;\n\t\tDrillingButtonSwitchItem;\n\t\tMissionSwitchItem;\n\t\tXenoSocialSwitchItem;\n\t\tXenosPanelSwitchItem;\n\t\tXenoSlotSwitchItem;\n\t\tBuildingMenuSwitchTab;\n\t\tGeneButton;\n\t\tGeneSpot;\n\t\tInseminator;\n\t\tXpBar;\n\t\tPreloadMiniGame; \n\t\tTextbutton;\n\t\tTankUpgrade;\n\t\tUpgradeCenterSwitchItem;\n\t\tEnclosSwitchItem;\n\t\tRegionSwitch;\n\t\tTimerIncubator;\n\t\tIsartPoints;\n\t\tSpecialFeatureSwitchSkill;\n\t}\n\n\t/**\n\t * charge les assets graphiques du preloader principal\n\t */\n\tprivate function preloadAssets(pLoader:Loader):Void\n\t{\n\n\t\t// initialise les paramtres de configuration\n\t\tConfig.init(Reflect.field(pLoader.resources,configPath).data);\n\n\t\t// Active le mode debug\n\t\tif (Config.debug) Debug.getInstance().init();\n\t\t// dfini l'alpha des Boxes de collision\n\t\tif (Config.debug && Config.data.boxAlpha != null) StateGraphic.boxAlpha = Config.data.boxAlpha;\n\t\t// dfini l'alpha des anims\n\t\tif (Config.debug && Config.data.animAlpha != null) StateGraphic.animAlpha = Config.data.animAlpha;\n\n        DeviceCapabilities.init(1, 0.75, 0.5);\n\t\t// initialise le GameStage et dfini la taille de la safeZone\n\t\tif (DeviceCapabilities.system == DeviceCapabilities.SYSTEM_DESKTOP)\n\t\t{\n\t\t\tGameStage.getInstance().scaleMode = GameStageScale.NO_SCALE;\n\t\t\tuntyped DeviceCapabilities.textureRatio = 0.5;\n\t\t\tuntyped DeviceCapabilities.textureType = DeviceCapabilities.TEXTURE_LD;\n\t\t}\n\t\telse {\n\t\t\tGameStage.getInstance().scaleMode = GameStageScale.SHOW_ALL;\n\t\t}\n\n\t\t// initialise le GameStage et dfini la taille de la safeZone\n\t\tGameStage.getInstance().init(render,2048, 1366, false,false, true, true, true);\n\t\t//GameStage.getInstance().init(render,4080, 2700, false ,false, true, true, true);\n\n\t\t// Ajoute le GameStage au stage\n\t\tstage.addChild(GameStage.getInstance());\n\n\t\t// ajoute Main en tant qu'couteur des venements de redimensionnement\n\t\tBrowser.window.addEventListener(EventType.RESIZE, resize);\n\t\tresize();\n\n\t\t// lance le chargement des assets graphiques du preloader\n\t\tvar lLoader:GameLoader = new GameLoader();\n\t\tlLoader.addAssetFile(\"ld/bulles/library.json\");\n\t\tlLoader.addAssetFile(\"black_bg.png\");\n\t\tlLoader.addAssetFile(\"preload.png\");\n\t\tlLoader.addAssetFile(\"preload_bg.png\");\n\t\tlLoader.addAssetFile(\"Curseur.png\");\n\t\t//lLoader.addAssetFile(\"SplashScreen.png\");\n\n\t\tlLoader.once(LoadEventType.COMPLETE, loadAssets);\n\t\tlLoader.load();\n\t\tPreloadMiniGame.getInstance().start();\n\t\t\n\t}\n\n\t/**\n\t * lance le chargement principal\n\t */\n\tprivate function loadAssets (pLoader:GameLoader): Void\n\t{\n\t\tvar lLoader:GameLoader = new GameLoader();\n\t\tvar levelMax:Int = SFGameManager.TOTAL_MAPS + 1;\n\t\tvar regionsDestructiblesMax:Int = Destructible.totalConfig;\n\t\t\n\t\t//FileSystem\n\t\tlLoader.addTxtFile(\"../localization/localisation.json\");\n\t\tlLoader.addTxtFile(\"boxes.json\");\n\t\tlLoader.addTxtFile(\"pool.json\");\n\t\tlLoader.addTxtFile(\"caracBuilding.json\");\n\t\tlLoader.addTxtFile(\"descriptionAlien.json\");\n\t\tlLoader.addTxtFile(\"Region.json\");\n\t\tlLoader.addTxtFile(\"schemas.json\");\n\t\tlLoader.addSoundFile(\"sounds.json\");\n\t\tlLoader.addTxtFile(\"FTUE.json\");\n\t\tlLoader.addTxtFile(\"Shop.json\");\n\t\tlLoader.addTxtFile(\"BuildingMenuData.json\");\n\t\tlLoader.addTxtFile(\"xenosCodex.json\");\n\t\tlLoader.addTxtFile(\"../balance/alienBalance.json\");\n\t\tlLoader.addTxtFile(\"missions.json\");\n\t\t\n\t\t//lLoader.addTxtFile(\"Map1.json\");\n\t\tfor (i in 1...regionsDestructiblesMax)\n\t\t{\n\t\t\tlLoader.addTxtFile(\"RegionsJSON/Config\" + i + \".json\");\n\t\t\tDestructible.arrayConfigDestructible.push(\"RegionsJSON/Config\" + i + \".json\");\n\t\t}\n\t\tfor (i in 1...levelMax) \n\t\t{\t\n\t\t\tlLoader.addTxtFile(\"specialFeatureMaps/Map\"+i+\".json\");\n\t\t}\n\t\t\n\t\tlLoader.addAssetFile(\"alpha_bg.png\");\n\t\tlLoader.addAssetFile(\"sft.png\");\n\t\tlLoader.addAssetFile(\"TitleCard_bg.png\");\n\t\tlLoader.addAssetFile(\"Confirm.png\");\n\t\tlLoader.addAssetFile(\"ftue_bg.png\");\n\t\tlLoader.addAssetFile(\"ftue2_bg.png\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/placeholder/library.json\");\n\t\t\n\t\t\n\t\t//lLoader.addAssetFile(DeviceCapabilities.textureType+\"/Buildings/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Buildings_Alien/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Buildings_Drilling/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Buildings_Urban/library.json\");\t\t\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Buildings_Cosmetic/library.json\");\t\t\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/BuildingMenu/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/BuyRegion/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/TutoSpecialFeature/library.json\");\n\t\t\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Aliens_Producers/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Aliens_foreurs/library.json\");\n\t\t\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/BuildingContextualMenu/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/CentreForage/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Codex/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/ItemAsset/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/TabAsset/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Missionthumbnail/library.json\");\n\t\t//lLoader.addAssetFile(DeviceCapabilities.textureType+\"/ConfirmationPose/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/ConfirmationPose_02/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Deplacement/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Destruction/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/DailyReward/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Enclos/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Friendlist/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/HUD/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Incubator/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/InfosBatiments/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Shop/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/TeamSelect/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/TimeBased/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/TranslationCenter/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/XenoPage/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/XenosPanel/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Background/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Destructible/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/FTUE/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/Settings/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/PubImage/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/PubVideo/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/UpgradeCenter/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/YesNoPose/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/RewardNotification/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/WarFog/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/IsartPoints/library.json\");\n\t\t\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/RessourcesEffect/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/SpecialFeatureScreen/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/SpecialFeatureTiles/library.json\");\n\t\tlLoader.addAssetFile(DeviceCapabilities.textureType+\"/SpecialFeatureAliens/library.json\");\n\t\t\n\t\t// PARTICLES ASSET\n\t\tlLoader.addAssetFile(\"particles/assets/bubble.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/smoke01.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/smoke02.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/smoke03.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/sparks1.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/sparks2.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/sparks3.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/bloc1.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/bloc2.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/bloc3.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/bloc4.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/stars1.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/stars2.png\");\n\t\tlLoader.addAssetFile(\"particles/assets/stars3.png\");\n\t\t\n\t\t// PARTICLES JSON\n\t\tlLoader.addTxtFile(\"particles/json/bubble.json\");\n\t\tlLoader.addTxtFile(\"particles/json/smoke.json\");\n\t\tlLoader.addTxtFile(\"particles/json/ressources.json\");\n\t\tlLoader.addTxtFile(\"particles/json/bomb.json\");\n\t\tlLoader.addTxtFile(\"particles/json/trail.json\");\n\t\tlLoader.addTxtFile(\"particles/json/trail2.json\");\n\t\tlLoader.addTxtFile(\"particles/json/trail3.json\");\n\t\tlLoader.addTxtFile(\"particles/json/bubbleCircle.json\");\n\t\tlLoader.addTxtFile(\"particles/json/dig.json\");\n\t\tlLoader.addTxtFile(\"particles/json/starsTrail.json\");\n\t\tlLoader.addTxtFile(\"particles/json/explosionStars.json\");\n\t\tlLoader.addTxtFile(\"particles/json/explosionStars2.json\");\n\t\tlLoader.addTxtFile(\"particles/json/destroy.json\");\n\t\t\n\t\t//lLoader.addAssetFile(DeviceCapabilities.textureType+\"/bulles/library.json\");\n\t\tlLoader.addFontFile(\"fonts.css\");\n\n\t\tlLoader.on(LoadEventType.PROGRESS, onLoadProgress);\n\t\tlLoader.once(LoadEventType.COMPLETE, onLoadComplete);\n\n\t\t// affiche l'cran de prchargement\n\t\tUIManager.getInstance().openScreen(LoadingBar.getInstance());\n\n\t\tBrowser.window.requestAnimationFrame(gameLoop);\n\n\t\tlLoader.load();\n\n\t}\n\n\t/**\n\t * transmet les paramtres de chargement au prchargeur graphique\n\t * @param\tpEvent evenement de chargement\n\t */\n\tprivate function onLoadProgress (pLoader:GameLoader): Void\n\t{\n\t\tLoadingBar.getInstance().update(pLoader.progress);\n\t}\n\n\t/**\n\t * initialisation du jeu\n\t * @param\tpEvent evenement de chargement\n\t */\n\tprivate function onLoadComplete (pLoader:GameLoader):Void\n\t{\n\t\t//Cell.setJson(\"Map\" + SpecialFeatureManager.getInstance().currentLevel + \".json\");\n\t\tpLoader.off(LoadEventType.PROGRESS, onLoadProgress);\n\n\t\t// transmet  MovieClipAnimFactory la description des planches de Sprites utilises par les anim MovieClip des instances de StateGraphic\n\t\t//MovieClipAnimFactory.addTextures(GameLoader.getContent(\"Template.json\"));\n\n\t\t// transmet au StateGraphic la description des boxes de collision utilises par les instances de StateGraphic\n\t\tStateGraphic.addBoxes(GameLoader.getContent(\"boxes.json\"));\n\n\t\t// affiche le bouton FullScreen quand c'est ncessaire\n\t\tDeviceCapabilities.displayFullScreenButton();\n\t\t//initialisation de la localisation et de la langue\n\t\tLocalization.init(GameLoader.getContent(\"../localization/localisation.json\"), \"fr\");\n\t\t//Ouvre la TitleClard\n\t\tisLoaded = true;\n\t\t\n\t\tif (isLogged && isAnimLoadingDone) launchGame();\n\t}\n\t\n\tpublic function verifyLaunch():Void {\n\t\n\t\tif (isLogged && isLoaded) launchGame();\n\t}\n\t\n\tprivate function launchGame():Void {\n\t\n\t\tPreloadMiniGame.getInstance().destroy();\n\t\tFTUEManager.init(GameLoader.getContent(\"FTUE.json\"));\n\t\tShopData.getInstance().init(GameLoader.getContent(\"Shop.json\"));\n\t\tMissionsManager.getInstance().init(GameLoader.getContent(\"missions.json\"));\n\t\tBuildingMenuData.getInstance().init(GameLoader.getContent(\"BuildingMenuData.json\"));\t\t\n\t\tDeltaDNA.init(\"15182680138937855659639893914855\", \"15182686734822464480389743914855\", \"https://collect107252018r.deltadna.net/collect/api\", \"https://engage107252018r.deltadna.net\", Std.string(Player.getInstance().id), Std.string(Player.getInstance().id + Std.string(Date.now().getTime())));\n\t\tsendEventConnect();\n\t\tGameManager.getInstance().start();\n\t}\n\t\n\tprivate function sendEventConnect():Void\n\t{\n\t\tvar lEvent:Dynamic ={\n\t\t\teventName:\"newPlayer\",\n\t\t\tuserID:Player.getInstance().idFb,\n\t\t\tsessionID:Player.getInstance().idFb + TimeManager.getInstance().timeServer.getTime(),\n\t\t\teventParams: {\n\t\t\t\tplatform: \"PC_CLIENT\"\n\t\t\t}\n\t\t};\n\n\t\t//TODO: remplacer collect--- par l'url de Collect et --- par la cl Dev ou Live\n\t\tvar lRequest:Http = new Http(\"https://collect107252018r.deltadna.net/collect/api/15182680138937855659639893914855\");\n\t\tlRequest.addHeader(\"Content-Type\",\"application/json\");\n\t\tlRequest.setPostData(Json.stringify(lEvent));\n\t\t/*lRequest.onData = onData;\n\t\tlRequest.onError = onError;*/\n\t\tlRequest.request(true);\n\t\ttrace(\"eventConnexionPlayer\");\n\t}\n\t\n\tpublic function onSaveLoaded():Void\n\t{\n\t\tisLogged = true;\n\t\tif (isLoaded) {\n\t\t\tPreloadMiniGame.getInstance().destroy();\n\t\t\tFTUEManager.init(GameLoader.getContent(\"FTUE.json\"));\n\t\t\tShopData.getInstance().init(GameLoader.getContent(\"Shop.json\"));\n\t\t\t\n\t\t\tBuildingMenuData.getInstance().init(GameLoader.getContent(\"BuildingMenuData.json\"));\n\t\t\tGameManager.getInstance().start();\n\t\t}\n\t}\n\n\tprivate function onLogin():Void\n\t{\n\t\t\n\t\t\n\t\t//Facebook.api(Facebook.uid + \"?fields=first_name\", callBackApi);\n\t\t// Au passage ici on voit qu'on accde pas  toutes les infos parce qu'on est pas autoriss (https://developers.facebook.com/docs/graph-api/reference/user/)\n\t\t//Facebook.api(Facebook.uid, { fields: \"first_name,last_name,favorite_athletes\"}, callBackApi);\n\t\t\n\t\t//Facebook.api(Facebook.uid+\"/friends\", callBackApi);\n\t\t//Facebook.api(Facebook.uid+\"/invitable_friends\", callBackApi);\n\t\t\n\t\t//Facebook.ui( { method: 'share', href: 'https://developers.facebook.com/docs/' },callBackUI );\n\t\t//Facebook.ui( { method: 'apprequests', message: 'Yeah \\\\o/' },callBackUI );\n\t\t\n\t\t/*\n\t\tFacebook.ui(\n\t\t\t{\n\t\t\t\tmethod: 'share_open_graph',\n\t\t\t\taction_type: 'og.shares',\n\t\t\t\taction_properties: Json.stringify({\n\t\t\t\t\tobject:\t{\n\t\t\t\t\t\t'og:url':'https://developers.facebook.com/docs/',\n\t\t\t\t\t\t'og:title': 'Documentation Facebook',\n\t\t\t\t\t\t'og:description': 'trop bien !',\n\t\t\t\t\t\t'og:image':'http://www.pixelstalk.net/wp-content/uploads/2016/04/Download-desktop-spongebob-wallpaper-HD-620x388.jpg'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tcallBackUI);\n\t\t*/\n\t\n\t\t/*\n\t\tFacebook.ui(\n\t\t\t{\n\t\t\t\tmethod: 'share_open_graph',\n\t\t\t\taction_type: 'og.likes',\n\t\t\t\taction_properties: Json.stringify({\n\t\t\t\t\tobject:'https://developers.facebook.com/docs/',\n\t\t\t\t})\n\t\t\t},\n\t\t\tcallBackUI);\n\t\t*/\n\t\t\n\t\tFacebook.api(Facebook.uid + \"?fields=first_name\", callBackApi);\n\t\tFacebook.api(Facebook.uid + \"?fields=email\", callBackEmail);\n\t\tFacebook.api(Facebook.uid+\"/friends\", callBackFriends);\n\t}\n\t\n\tprivate function callBackApi(pData:Dynamic):Void\n\t{\n\t\tif (pData == null) trace(\"erreur facebook.api\");\n\t\telse if (pData.error != null) trace (pData.error);\n\t\telse {\n\t\t\t//commenter la ligne suivante pour desactiver les intraction avec la base de donne !!!!\n\t\t\tDataBaseAction.getInstance().activeData = true;\n\t\t\tDataBaseAction.getInstance().connexionPlayer(Facebook.uid, pData.first_name);\n\t\t}\n\t}\n\t\n\tprivate function callBackEmail(pData:Dynamic):Void\n\t{\n\t\tif (pData == null) trace(\"erreur facebook.api email\");\n\t\telse if (pData.error != null) trace (pData.error);\n\t\telse {\n\t\t\tPlayer.getInstance().email = Reflect.field(pData, \"email\");\n\t\t}\n\t}\n\t\n\tprivate function callBackFriends(pData:Dynamic):Void\n\t{\n\t\tif (pData == null) trace(\"erreur friends Api\");\n\t\telse if (pData.error_message != null) trace (pData.error_message);\n\t\telse \n\t\t{\n\t\t\tvar lArray:Array<Dynamic> = new Array<Dynamic>();\n\t\t\tvar lFriends:Dynamic = Reflect.field(pData, \"data\");\n\t\t\tfor (friend in Reflect.fields(lFriends))\n\t\t\t{\n\t\t\t\tlArray.push(Reflect.field(Reflect.field(lFriends, friend), \"id\"));\n\t\t\t} \n\t\t\tvar lFriendsID:Dynamic = Json.stringify(lArray);\n\t\t\tDataBaseAction.getInstance().getFriends(lFriendsID);\n\t\t}\t\t\n\t}\n\t\t\n\tprivate function callBackUI(pData:Dynamic):Void\n\t{\n\t\tif (pData == null) trace(\"erreur facebook.ui\");\n\t\telse if (pData.error_message != null) trace (pData.error_message);\n\t\telse \n\t\t{\n\t\t\ttrace(pData);\n\t\t}\n\t}\n\t\n\t/**\n\t * game loop\n\t */\n\tprivate function gameLoop(pID:Float):Void\n\t{\t\t\n\t\t//Timer.delay(gameLoop, FPS);\n\t\tBrowser.window.requestAnimationFrame(gameLoop);\n\t\t\n\t\trender();\n\t\temit(EventType.GAME_LOOP);\n\n\t}\n\n\t/**\n\t * Ecouteur du redimensionnement\n\t * @param\tpEvent evenement de redimensionnement\n\t */\n\tpublic function resize (pEvent:EventTarget = null): Void\n\t{\n\t\trenderer.resize(DeviceCapabilities.width, DeviceCapabilities.height);\n\t\tGameStage.getInstance().resize();\n\t}\n\n\t/**\n\t * fait le rendu de l'cran\n\t */\n\tprivate function render (): Void\n\t{\n\t\t//renderer.render(stage);\n\t\tif (frame++ % 2 == 0){\n\t\t\trenderer.render(stage);\n\t\t}\n\t\telse{\n\t\t\tGameStage.getInstance().updateTransform();\n\t\t}\n\t}\n\n\t/**\n\t * dtruit l'instance unique et met sa rfrence interne  null\n\t */\n\tpublic function destroy (): Void\n\t{\n\t\tBrowser.window.removeEventListener(EventType.RESIZE, resize);\n\t\tinstance = null;\n\t}\n\n}","package com.isartdigital.ruby.game;\n\nimport com.isartdigital.ruby.game.controller.Controller;\nimport com.isartdigital.ruby.game.controller.MouseController;\nimport com.isartdigital.ruby.game.controller.TouchController;\nimport com.isartdigital.ruby.game.player.MissionsManager;\nimport com.isartdigital.ruby.game.player.Player;\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\nimport com.isartdigital.ruby.game.specialFeature.managers.SFAliensManager;\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\nimport com.isartdigital.ruby.game.sprites.elements.Building;\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\nimport com.isartdigital.ruby.game.world.Layer;\nimport com.isartdigital.ruby.game.world.MapInteractor;\nimport com.isartdigital.ruby.game.world.Region;\nimport com.isartdigital.ruby.game.world.UnlockButtonContainer;\nimport com.isartdigital.ruby.game.world.World;\nimport com.isartdigital.ruby.ui.CheatPanel;\nimport com.isartdigital.ruby.ui.UIManager;\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\nimport com.isartdigital.ruby.ui.hud.Hud;\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\nimport com.isartdigital.ruby.ui.popin.ConfirmationPose;\nimport com.isartdigital.ruby.ui.popin.DailyReward;\nimport com.isartdigital.ruby.ui.popin.TimeBased;\nimport com.isartdigital.ruby.ui.popin.buyRegion.BuyRegion;\nimport com.isartdigital.ruby.ui.popin.contextual.ContextualPopin;\nimport com.isartdigital.ruby.ui.popin.incubator.Inseminator;\nimport com.isartdigital.ruby.ui.popin.translationCenter.TranslationCenter;\nimport com.isartdigital.ruby.ui.specialButtons.SlotButton;\nimport com.isartdigital.ruby.utils.ParticleManager;\nimport com.isartdigital.ruby.utils.RessourceEffect;\nimport com.isartdigital.services.deltaDNA.DeltaDNA;\nimport com.isartdigital.services.facebook.Facebook;\nimport com.isartdigital.services.monetization.Ads;\nimport com.isartdigital.services.monetization.Bank;\nimport com.isartdigital.services.monetization.Wallet;\nimport com.isartdigital.utils.Config;\nimport com.isartdigital.ruby.utils.ColorFilterManager;\nimport com.isartdigital.ruby.utils.SmartShaker;\nimport com.isartdigital.utils.events.EventType;\nimport com.isartdigital.utils.game.Camera;\nimport com.isartdigital.ruby.utils.Focus;\nimport com.isartdigital.utils.game.GameStage;\nimport com.isartdigital.utils.game.clipping.ClippingManager;\nimport com.isartdigital.utils.game.filtersManagement.TwistFilterManager;\nimport com.isartdigital.utils.game.iso.IsoManager;\nimport com.isartdigital.utils.game.pooling.PoolManager;\nimport com.isartdigital.utils.game.pooling.PoolObject;\nimport com.isartdigital.utils.loader.GameLoader;\nimport com.isartdigital.utils.save.DataBaseAction;\nimport com.isartdigital.utils.save.DataManager;\nimport com.isartdigital.utils.sounds.SoundManager;\nimport com.isartdigital.utils.system.DeviceCapabilities;\nimport haxe.Http;\nimport js.Browser;\nimport js.Lib;\nimport pixi.core.display.Container;\nimport pixi.core.display.DisplayObject;\nimport pixi.core.graphics.Graphics;\nimport pixi.core.math.Point;\nimport pixi.core.renderers.webgl.managers.FilterManager;\nimport pixi.filters.twist.TwistFilter;\nimport pixi.interaction.EventTarget;\nimport pixi.loaders.Loader;\n\n\n/**\n * Manager (Singleton) en charge de grer le droulement d'une partie\n * @author Mathieu ANTHOINE\n */\nclass GameManager\n{\n\n\t/**\n\t * instance unique de la classe GameManager\n\t */\n\tprivate static var instance: GameManager;\n\n\t//taille des Tile\n\tpublic inline static var TILE_WIDTH:Int = 200;\n\tpublic inline static var TILE_HEIGHT:Int = 100;\n\t\n\tpublic var godMode:Bool = false;\n\t\n\tprivate var world:World;\n\tpublic var controller:Controller = cast(DeviceCapabilities.system != DeviceCapabilities.SYSTEM_DESKTOP ? TouchController.getInstance() : MouseController.getInstance(), Controller);\n\tpublic static inline var MODE_NORMAL:String = \"Normal\";\n\tpublic static inline var MODE_SPECIAL_FEATURE:String = \"Spcial\";\n\tpublic static inline var MODE_FTUE:String = \"FTUE\";\n\t\n\tpublic static var currentMode:String; \n\t\n\t\n\t/**\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\n\t * @return instance unique\n\t */\n\tpublic static function getInstance (): GameManager\n\t{\n\t\tif (instance == null) instance = new GameManager();\n\t\treturn instance;\n\t}\n\n\tprivate function new()\n\t{\n\n\t}\n\n\tpublic function start (): Void\n\t{\n\t\t\n\n\t\tsetModeNormal();\n\t\t\n\t\tDeltaDNA.init(\"15182680138937855659639893914855\", \"15182686734822464480389743914855\", \"https://collect107252018r.deltadna.net/collect/api\", \"https://engage107252018r.deltadna.net\", Std.string(Player.getInstance().id), Std.string(Player.getInstance().id + Std.string(Date.now().getTime())));\n\t\t\n\t\tGameStage.getInstance().getGameContainer().addChild(UnlockButtonContainer.getInstance().getUnlockContainer());\n\t\t//UnlockButtonContainer.getInstance().getUnlockContainer().position = GameStage.getInstance().getGameContainer().position;\n\t\tGameElement.JSON_CONFIG = GameLoader.getContent(\"caracBuilding.json\");\n\t\t// demande au Manager d'interface de se mettre en mode \"jeu\"\n\t\tUIManager.getInstance().startGame();\n\t\t\n\t\tIsoManager.init(TILE_WIDTH, TILE_HEIGHT);\n\t\t\n\n\t\t//commenter la ligne suivante pour desactiver les intraction avec la base de donne !!!!\n\t\t//DataBaseAction.getInstance().activeData = true;\n\n\t\tworld = World.getInstance();\n\t\t\n\t\tDataManager.getInstance().loadData();\n\t\t\n\t\t//Browser.getLocalStorage().clear();\n\t\tRegion.sortAllContainer();\n\t\t\n\n\t\t//Controller.getInstance().init();\n\t\tif (DeviceCapabilities.system == DeviceCapabilities.SYSTEM_DESKTOP)\n\t\t\tinitDesktop();\n\t\telse\n\t\t\tinitMobile();\n\n\t\t//Spawner.getInstance().start();\n\t\t/////////////////////\n\t\t\n\t\t//Focus.getInstance().x = DeviceCapabilities.getScreenRect(GameStage.getInstance().getGameContainer()).width / 2;\n\t\t//Focus.getInstance().y = DeviceCapabilities.getScreenRect(GameStage.getInstance().getGameContainer()).height / 2;\n\t\t//Focus.getInstance().position = new Point(World.getInstance().getRegion(0, 0).regionContainer.x+ (TILE_WIDTH * Region.WIDTH) / 2, World.getInstance().getRegion(0, 0).regionContainer.y+ (TILE_HEIGHT * Region.HEIGHT) / 2);\n\t\tFocus.getInstance().position = new Point(GameStage.getInstance().getGameContainer().x, GameStage.getInstance().getGameContainer().y + (Region.HEIGHT * TILE_HEIGHT)/2);\n\t\tCamera.getInstance().setFocus(Focus.getInstance());\n\t\tCamera.getInstance().setTarget(GameStage.getInstance().getInfoBulleContainer());\n\t\tCamera.getInstance().setPosition();\n\n\t\tPoolManager.init(GameLoader.getContent(\"pool.json\"));\n\t\tClippingManager.getInstance().init(DeviceCapabilities.getScreenRect(GameStage.getInstance().getInfoBulleContainer()));\n\t\tMissionsManager.getInstance().init(GameLoader.getContent(\"missions.json\"));\n\t\tfor (paddock in AlienPaddock.alienPaddockList) cast(paddock.instance, AlienPaddock).getBuildingOnAera(true);\n\t\t// enregistre le GameManager en tant qu'couteur de la gameloop principale\n\t\tMain.getInstance().on(EventType.GAME_LOOP, gameLoop);\n\t\t\n\t\t//pub\n\t\t//addAdsImage();\n\t\t//portefeuille\n\t\t//displayWallet();\n\t\t// bank\n\t\t//displayAccount();\n\t\tif (Player.getInstance().ftueSteps < FTUEManager.steps.length)\n\t\t{\n\t\t\tif (Player.getInstance().ftueSteps == 0) FTUEManager.nextStep();\n\t\t\telse \n\t\t\t{\n\t\t\t\tFTUEManager.currentStep = Player.getInstance().ftueSteps + 1;\n\t\t\t\tFTUEManager.nextStep();\n\t\t\t}\n\t\t}\n\t\t\n\t\t//UIManager.getInstance().openPopin(DailyReward.getInstance());\n\t\tCheatPanel.getInstance().ingame();\n\n\t\tController.getInstance().init();\n\t\tfor (popin in UIManager.getInstance().regionPopins) cast(popin, BuyRegion).displayCost();\n\t\t\n\t\tSoundManager.getSound(\"soundAtmosphere\").play();\n\t}\n\t\n\tprivate function addAdsImage():Void{\n\t\tAds.getImage(callBackAd);\n\t}\n\t\n\tprivate function callBackAd(pData:Dynamic):Void{\n\t\tif (pData == null) trace(\"erreur service\");\n\t\telse if (pData.error != null) trace (pData.error);\n\t\telse trace(pData);\n\t}\n\n\tprivate function displayWallet():Void\n\t{\n\t\tWallet.getMoney(\"coucou\",callBackWallet);\n\t}\n\t\n\tprivate function callBackWallet(pData:Dynamic):Void{\n\t\tif (pData == null) trace(\"erreur service\");\n\t\telse if (pData.error != null) trace (pData.error);\n\t\telse trace(pData);\n\t}\n\t\n\tprivate function displayAccount():Void\n\t{\n\t\tBank.account(callBackBank);\n\t}\n\t\n\tprivate function callBackBank(pData:Dynamic):Void{\n\t\tif (pData == null) trace(\"erreur service\");\n\t\telse if (pData.error != null) trace (pData.error);\n\t\telse trace(pData);\n\t}\n\t\n\tprivate function initDesktop():Void\n\t{\n\t\tMouseController.getInstance().init();\n\t\t//initStarsParticle();\n\t}\n\n\tprivate function initMobile():Void\n\t{\n\t\tTouchController.getInstance().init();\n\t}\n\n\tprivate function testMap(pX:Int, pY:Int, pObject:String):Void\n\t{\n\t\tvar lRegion:Region = world.worldMap.get(pX).get(pY);\n\t\tvar lLayer:Layer = lRegion.layers[0];\n\t\tvar lBuilding:FlumpStateGraphic;\n\t\tvar lPoint:Point;\n\t\tfor (i in 0...lLayer.width)\n\t\t{\n\t\t\tfor (j in 0...lLayer.width)\n\t\t\t{\n\t\t\t\t/*lBuilding = new FlumpStateGraphic(pObject);\n\t\t\t\tGameStage.getInstance().getGameContainer().addChild(lBuilding);\n\t\t\t\tlBuilding.start();\n\t\t\t\tlPoint = new Point(i + lRegion.width * lRegion.x, j + lRegion.height * lRegion.y);\n\n\t\t\t\tvar lPoint2:Point = IsoManager.modelToIsoView(lPoint);\n\t\t\t\tlBuilding.x = lPoint2.x;\n\t\t\t\tlBuilding.y = lPoint2.y;*/\n\n\t\t\t\tlBuilding = new FlumpStateGraphic(pObject);\n\t\t\t\tlRegion = World.getInstance().getRegion(pX, pY);\n\t\t\t\tlPoint = new Point(i, j);\n\t\t\t\t//lPoint = new Point(i + lRegion.width * lRegion.x, j + lRegion.height * lRegion.y);\n\t\t\t\tvar lPoint2:Point = IsoManager.modelToIsoView(lPoint);\n\t\t\t\tlBuilding.x = lPoint2.x;\n\t\t\t\tlBuilding.y = lPoint2.y;\n\t\t\t\tlBuilding.start();\n\t\t\t\tlRegion.regionContainer.addChild(lBuilding);\n\t\t\t}\n\t\t}\n\t}\n\n\t\n/*\tpublic function initStarsParticle():Void\n\t{\n\t\tRessourceEffect.starsParticle = ParticleManager.getInstance().createParticle(\"explosionStars2\", [\"stars1\", \"stars2\", \"stars3\", \"smoke03\"], 10000);\n\t\t\n\t\tGameStage.getInstance().getGameContainer().addChild(RessourceEffect.starsParticle);\n\n\t\t\n\t}\n\t*/\n\t/**\n\t * boucle de jeu (rpte  la cadence du jeu en fps)\n\t */\n\tpublic function gameLoop (pEvent:EventTarget): Void\n\t{\n\t\t// le renderer possde une proprit plugins qui contient une proprit interaction de type InteractionManager\n\t\t// les instances d'InteractionManager fournissent un certain nombre d'informations comme les coordonnes globales de la souris\n\t\tMouseController.getInstance().doAction();\n\t\tClippingManager.getInstance().clipping(DeviceCapabilities.getScreenRect(GameStage.getInstance().getGameContainer()));\n\t\tMapInteractor.getInstance().doAction();\n\t\tfor (popin in UIManager.getInstance().regionPopins) cast(popin, BuyRegion).tooltip.count();\n\t\tCamera.getInstance().move();\n\t\t//Focus.getInstance().draw();\n\t\tTimeBased.getInstance().refreshText();\n\t\tColorFilterManager.getInstance().doAction();\n\t\tController.getInstance().detectClicLength();\n\t\t\n\t\tfor (i in 0...PoolObject.activeObjectList.length){\n\t\t\tif (PoolObject.activeObjectList[i] == null) continue;\t\n\t\t\tPoolObject.activeObjectList[i].doAction();\n\t\t}\n\t\t\n\t\tfor (j in 0...SFAliensManager.getInstance().activatedAlienList.length) \n\t\t{\n\t\t\tif (SFAliensManager.getInstance().activatedAlienList[j] == null) continue;\n\t\t\tSFAliensManager.getInstance().activatedAlienList[j].doAction();\n\t\t}\n\t\t\n\t\tif (Inseminator.list.length > 0)\n\t\t{\n\t\t\tfor (ins in Inseminator.list) ins.doAction();\n\t\t}\n\t\t\n\t\tif (TranslationCenter.getInstance().schemaInDecryptMode.length > 0)\n\t\t{\n\t\t\tfor (schema in TranslationCenter.getInstance().schemaInDecryptMode) \n\t\t\t{\n\t\t\t\tTranslationCenter.getInstance().doAction();\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tParticleManager.getInstance().update();\n\t\tSmartShaker.getInstance().doAction();\n\t\t\n\t\tif (SwitchItem.list != null)\n\t\t\t\tfor (switchItem in SwitchItem.list)\n\t\t\t\t\tswitchItem.setAsset();\n\t\t\t\t\t\n\t\tif (SlotButton.list != null)\n\t\t\tfor (slot in SlotButton.list) {\n\t\t\t\tslot.invisibleGreySquare();\n\t\t\t\tslot.setAsset();\n\t\t\t}\n\t\t\n\t\n\t\t//TwistFilterManager.getInstance().doAction();\n\t\t\n/*\t\tinitStarsParticle();\n\t\t\t\tRessourceEffect.starsParticle.position = MouseController.getInstance().getPosFrom(GameStage.getInstance().getGameContainer());*/\n\n\t\t\n\t}\n\t\n\tpublic function setModeNormal():Void\n\t{\n\t\tcurrentMode = MODE_NORMAL;\n\t}\n\t\n\tpublic function setModeSpecial():Void\n\t{\n\t\tcurrentMode = MODE_SPECIAL_FEATURE;\n\t}\n\t\n\tpublic function setModeFtue():Void\n\t{\n\t\tcurrentMode = MODE_FTUE;\n\t}\n\t\n\tpublic function getCurrentMode():String\n\t{\n\t\treturn currentMode;\n\t}\n\n\t/**\n\t * dtruit l'instance unique et met sa rfrence interne  null\n\t */\n\tpublic function destroy (): Void\n\t{\n\t\tMain.getInstance().off(EventType.GAME_LOOP,gameLoop);\n\t\tinstance = null;\n\t}\n\n}","package com.isartdigital.ruby.game;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.BuildingEnergyProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanPowerStation;\r\nimport com.isartdigital.ruby.utils.ParticleManager;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.juicy.bullesxp.BullesManager;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.ftue.FocusManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.ConfirmationPose;\r\nimport com.isartdigital.ruby.ui.popin.Deplacement;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.ruby.ui.popin.contextual.YesNoPose;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\nimport com.isartdigital.ruby.utils.ColorFilterManager;\r\nimport com.isartdigital.ruby.utils.SmartShaker;\r\nimport com.isartdigital.ruby.utils.SmartShaker.ShakerParams;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.ruby.utils.Focus;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.clipping.CellManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport js.Browser;\r\nimport js.Lib;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.textures.Texture;\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Spawner extends DisplayObject\r\n{\r\n\tpublic var toSpawn:GameElement;\r\n\tprivate var ftueTargetingElement:GameElement;\r\n\t//public var graphicMargin:Graphics;\r\n\t\r\n\t\r\n\tpublic var isPayingWithHC:Bool = false;\r\n\t\r\n\tpublic var currentRegion:Region;\r\n\t\r\n\t\r\n\tprivate var isUnfixRequested:Bool = false;\r\n\tprivate var isElementToSpawnFixed:Bool = false;\r\n\tprivate var isCameraLockingDone:Bool = true;\r\n\tprivate var isCameraUnlockingDone:Bool = true;\r\n\tprivate var centerOfScreen:DisplayObject = new DisplayObject();\r\n\tprivate var currentAsset:String;\r\n\tprivate var globalPosition:Point;\r\n\t\r\n\tpublic var justMovingaBuilding:Bool = false;\r\n\t\r\n\tpublic var godMode:Bool = GameManager.getInstance().godMode;\r\n\t/**\r\n\t * instance unique de la classe Spawner\r\n\t */\r\n\tprivate static var instance: Spawner;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Spawner {\r\n\t\tif (instance == null) instance = new Spawner();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper();\r\n\t\tcurrentRegion = World.getInstance().getRegion(0, 0);\t\r\n\t\t//graphicMargin = new Graphics();\r\n\t\t//graphicMargin.alpha = 0.3;\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\tpublic function doAction():Void {\r\n\t\t\r\n\t\t//drawIsoMargin(graphicMargin, toSpawn);\r\n\t\tisElementToSpawnFixed ? fixedMode() : dragMode();\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function dragMode():Void {\r\n\t\t//lockCamera();\r\n\t\tmakeElementToSpawnFollowMouse();\r\n\t\t\r\n\t\tisNotObstructed() ? toSpawn.removeRedFilter() : toSpawn.applyRedFilter();\r\n\t\t\r\n\t\tif(!isUnfixRequested) {\r\n\t\t\tif (Controller.shortClic) {\r\n\t\t\t\r\n\t\t\tisNotObstructed() ? fixElementToSpawn() : launchObstructedFeedback();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\telse {\r\n\t\t\r\n\t\t\tif (Controller.shortClic) {\r\n\t\t\t\t\r\n\t\t\t\tisUnfixRequested = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function fixedMode():Void {\r\n\t\tif (Controller.shortClic) {\r\n\t\t\tSoundManager.getSound(\"soundPlayerCrossV2\").play();\r\n\t\t\tif (!FTUEManager.isFTUEon()) {\r\n\t\t\t\tmakeElementToSpawnFollowMouse();\r\n\t\t\t\tjustMovingaBuilding ? openMovePopin() : openSpawnPopin();\r\n\t\t\t}\r\n\t\t\tif (!isNotObstructed()) {\r\n\t\t\t\tlaunchObstructedFeedback();\r\n\t\t\t\tunfixElementToSpawn();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tprivate function fixElementToSpawn():Void {\r\n\t\tisElementToSpawnFixed = true;\r\n\t\tjustMovingaBuilding ? openMovePopin() : openSpawnPopin();\r\n\t\ttoSpawn.alpha = 1;\r\n\t\tisCameraLockingDone = false;\r\n\t\t\r\n\t\tSoundManager.getSound(\"soundPlayerCrossV2\").play();\r\n\t\tcurrentAsset = toSpawn.CONSTRUCTING_STATE;\r\n\t\ttoSpawn.changeAsset(currentAsset);\r\n\t\t\r\n\t\ttoSpawn.on(MouseEventType.MOUSE_DOWN, unfixElementToSpawn);\r\n\t\ttoSpawn.on(TouchEventType.TOUCH_START, unfixElementToSpawn);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function unfixElementToSpawn():Void {\r\n\t\tisUnfixRequested = true;\r\n\t\tisElementToSpawnFixed = false;\r\n\t\ttoSpawn.alpha = 0.5;\r\n\t\tisCameraLockingDone = false;\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tcurrentAsset = toSpawn.SPAWNING_STATE;\r\n\t\ttoSpawn.changeAsset(currentAsset);\r\n\t\tSoundManager.getSound(\"soundPlayerClic\").play();\r\n\t\ttoSpawn.off(MouseEventType.MOUSE_DOWN, unfixElementToSpawn);\r\n\t\ttoSpawn.off(TouchEventType.TOUCH_START, unfixElementToSpawn);\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\t\r\n\t\r\n\tpublic function setElementToSpawn(pElement:String):Void {\r\n\t\tif (toSpawn != null) toSpawn.dispose();\r\n\t\ttoSpawn = cast(PoolManager.getFromPool(pElement), Building);\t\r\n\t\t//nice2have ftue \r\n\t\t/*if (FTUEManager.isFTUEon()) ftueTargetingElement = cast(PoolManager.getFromPool(pElement), Building);\r\n\t\telse ftueTargetingElement = null;*/\r\n\t\tif (canAffordIt()) displayElementToSpawn();\r\n\t}\r\n\t\r\n\tprivate function placeFtue():Void {\r\n\t\r\n\t\tvar lModelPoint:Point = new Point(10, 10);\r\n\t\ttoSpawn.changePosition(cast(lModelPoint.x, Int), cast(lModelPoint.y, Int)); \r\n\t\t\r\n\t    if (!isNotObstructed()) lModelPoint = pointWhereThereIsRoom();\r\n\t\t\r\n\t\tvar lGlobalModelPoint:Point = new Point(0, 0);\r\n\t\tlGlobalModelPoint.x = currentRegion.x * Region.WIDTH + lModelPoint.x;\r\n\t\tlGlobalModelPoint.y = currentRegion.y * Region.HEIGHT + lModelPoint.y;\r\n\t\t\r\n\t\t\r\n\t\tvar lGlobalIsoPoint = IsoManager.modelToIsoView(lGlobalModelPoint);\r\n\t\t\r\n\t\tsetPosition(lGlobalIsoPoint);\r\n\t\ttoSpawn.position = position;\r\n\t\tFocus.getInstance().position = position;\r\n\t\tfixElementToSpawn();\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function displayElementToSpawn():Void {\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tcurrentRegion =  World.getInstance().getRegion(cast(Focus.getInstance().getRegionOn().x, Int), cast(Focus.getInstance().getRegionOn().y, Int));\r\n\t\ttoSpawn.alpha = 0.5;\r\n\t\tcurrentAsset = toSpawn.SPAWNING_STATE;\r\n\t\t//GameStage.getInstance().getGameContainer().addChild(graphicMargin);\r\n\t\tGameStage.getInstance().getGameContainer().addChild(toSpawn);\r\n\t\t\r\n\t\ttoSpawn.start();\r\n\t\t//FTUEManager.isFTUEon() ? placeFtue() : makeElementToSpawnFollowMouse();\r\n\t\tmakeElementToSpawnFollowMouse();\r\n\t\tMapInteractor.getInstance().activateSpawner();\r\n\t\tcheckForSpecialBehavior();\r\n\t\t\r\n\t\t//nice to have ( spawn du batiment dans le container ftue)\r\n\t\t//if (ftueTargetingElement != null) {\r\n\t\t\t//\r\n\t\t\t//\r\n\t\t\t//\r\n\t\t\t//GameStage.getInstance().getFtueContainer().addChild(ftueTargetingElement);\r\n\t\t\t//ftueTargetingElement.position = convertPositionInFtueContainer();\r\n\t\t\t//ftueTargetingElement.on(MouseEventType.MOUSE_DOWN, setDrag);\r\n\t\t\t//ftueTargetingElement.on(TouchEventType.TOUCH_START, setDrag);\r\n\t\t//}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function openSpawnPopin():Void {\r\n\t\tvar lCostSC:Int = cast(toSpawn, Building).costSC;\r\n\t\tvar lCostMN:Int = cast(toSpawn, Building).costMN;\r\n\t\tvar lCostHC:Int = cast(toSpawn, Building).costHC;\r\n\t\tglobalPosition = new Point(0, 0);\r\n\t\tglobalPosition.x = currentRegion.x * Region.WIDTH + toSpawn.colMin;\r\n\t\tglobalPosition.y = currentRegion.y * Region.HEIGHT + toSpawn.rowMin;\r\n\t\tglobalPosition = IsoManager.modelToIsoView(globalPosition);\r\n\t\ttoSpawn.globalPosition = globalPosition;\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tUIManager.getInstance().openPopin(ConfirmationPose.getInstance());\r\n\t\tConfirmationPose.getInstance().target = cast(toSpawn, Building);\r\n\t\tConfirmationPose.getInstance().init(toSpawn);\r\n\t\tConfirmationPose.getInstance().updateValues(lCostSC, lCostMN, lCostHC);\r\n\t}\r\n\t\r\n\tprivate function openMovePopin():Void {\r\n\t\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tUIManager.getInstance().openPopin(YesNoPose.getInstance());\r\n\t\tYesNoPose.getInstance().target = cast(toSpawn, Building);\r\n\t}\r\n\t\r\n\tpublic function moveBuilding(pBuilding:Building):Void {\r\n\t\r\n\t\tjustMovingaBuilding = true;\r\n\t\ttoSpawn = pBuilding;\r\n\t\tcurrentRegion = World.getInstance().getRegion(toSpawn.elem.regionX, toSpawn.elem.regionY); \r\n\t\t\r\n\t\t/*var lPoint =  new Point(toSpawn.elem.globalX, toSpawn.elem.globalY);\r\n\t\tsetPosition(lPoint);*/\r\n\t\tmakeElementToSpawnFollowMouse();\r\n\t\tunfixElementToSpawn();\r\n\t\tcheckForSpecialBehavior();\r\n\t\t//GameStage.getInstance().getGameContainer().addChild(graphicMargin);\r\n\t\tGameStage.getInstance().getGameContainer().addChild(toSpawn);\r\n\t\ttoSpawn.position = position;\r\n\t\t\r\n\t\tMapInteractor.getInstance().activateSpawner();\r\n\t\t//UIManager.getInstance().openPopin(Deplacement.getInstance());\r\n\t\t//UIManager.getInstance().openPopin(YesNoPose.getInstance());\r\n\t\t//toSpawn.on(MouseEventType.MOUSE_DOWN, setDrag);\r\n\t\t//toSpawn.on(TouchEventType.TOUCH_START, setDrag);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tprivate function placeBuildingOnTheGround(?isCanceled : Bool):Void {\r\n\t\r\n\t\t \r\n\t\ttoSpawn.off(MouseEventType.MOUSE_DOWN, unfixElementToSpawn);\r\n\t\ttoSpawn.off(TouchEventType.TOUCH_START, unfixElementToSpawn);\r\n\t\ttoSpawn.changeAsset(toSpawn.currentState);\r\n\t\t\r\n\t\tGameStage.getInstance().getGameContainer().removeChild(toSpawn);\r\n\t\t//GameStage.getInstance().getGameContainer().removeChild(graphicMargin);\r\n\t\t\r\n\t\t\r\n\t\tif (isCanceled) cast(toSpawn, Building).saveNewPosition(toSpawn.elem.x, toSpawn.elem.y, toSpawn.elem.regionX, toSpawn.elem.regionY);\r\n\t\telse cast(toSpawn, Building).saveNewPosition(toSpawn.colMin, toSpawn.rowMin);\r\n\t\tjustMovingaBuilding = false;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\ttoSpawn = null;\r\n\t\tMapInteractor.getInstance().deactivateSpawner();\r\n\t\tBuilding.updateBuildingsCarac();\r\n\t\t\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setSpawnerIsoPosition():Void {\r\n\t\t\r\n\t\t\r\n\t\tvar lPosition:Point = Controller.getInstance().getPosFrom(GameStage.getInstance().getGameContainer());\r\n\t\tvar lRegionContainer:Container;\r\n\t\tvar lCooRegion:Point = Controller.getInstance().getPosRegion();\r\n\t\tif (World.getInstance().getRegion(cast(lCooRegion.x, Int), cast(lCooRegion.y, Int)) == null) return;\r\n\t\tif (!World.getInstance().getRegion(cast(lCooRegion.x, Int), cast(lCooRegion.y, Int)).isActive) return;\r\n\t\tsetPosition(IsoManager.localToIso(lPosition));\r\n\t\tvar lRegion = World.getInstance().getRegion(cast(lCooRegion.x, Int), cast(lCooRegion.y, Int));\r\n\t\tif (lRegion == null) return;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t//si on change de region\r\n\t\tif (lRegion != currentRegion) {\r\n\t\t\tcurrentRegion = lRegion;\r\n\t\t\tcheckForSpecialBehavior();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function checkForSpecialBehavior():Void {\r\n\t\r\n\tif (Std.is(toSpawn, UrbanAntenna)) {\r\n\t\t\t\r\n\t\t\t\tvar lHasLeveledPowerStation:Bool = false;\r\n\t\t\t\tfor (station in currentRegion.powerStationsInRegion) {\r\n\t\t\t\t\r\n\t\t\t\t\tif (station.level == 2) lHasLeveledPowerStation = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (lHasLeveledPowerStation) toSpawn.level = 2;\r\n\t\t\t\telse toSpawn.level = 1;\r\n\t\t\t\ttoSpawn.changeAsset(currentAsset);\r\n\t\t\t}\r\n\t}\r\n\tprivate function positionElementToSpawn():Void {\r\n\t\r\n\t\ttoSpawn.changePosition(cast(getPosInRegion().x, Int), cast(getPosInRegion().y, Int));\r\n\t\ttoSpawn.position = position;\r\n\t\t\r\n\t\t//if (ftueTargetingElement != null) ftueTargetingElement.position = convertPositionInFtueContainer();\r\n\t\t\r\n\t\t//if (justMovingaBuilding) {\r\n\t\t//\r\n\t\t\t//YesNoPose.getInstance().position = toLocal(getGlobalPosition(toSpawn.position));\r\n\t\t//}\r\n\t\t\r\n\t\t//toSpawn.alpha = isNotObstructed() ? 1 : 0.2;\r\n\t\tif (Std.is(toSpawn, Building)) {\r\n\t\t\tif (cast(toSpawn, Building).timerContainer != null) cast(toSpawn, Building).timerContainer.position = position;\r\n\t\t\t\r\n\t\t}\r\n\t\tif (Std.is(toSpawn, AlienPaddock)) {\r\n\t\t\tif (cast(toSpawn, AlienPaddock).timerContainer != null) cast(toSpawn, AlienPaddock).prodContainer.position = position;\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tprivate function pointWhereThereIsRoom():Point {\r\n\t\r\n\t\tfor (x in 0...Region.WIDTH) {\r\n\t\t\r\n\t\t\tfor (y in 0...Region.HEIGHT) {\r\n\t\t\t\r\n\t\t\t\ttoSpawn.changePosition(x, y); \r\n\t\t\t\tif (isNotObstructed()) return new Point(x, y);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn new Point(10, 10);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tprivate function getPosInRegion():Point {\r\n\t\r\n\t\tvar lCoorInRegion:Point = Controller.getInstance().getPosFrom(currentRegion.layers[1].container);\r\n\t\tlCoorInRegion = IsoManager.localToModel(lCoorInRegion);\r\n\t\treturn lCoorInRegion;\r\n\t}\r\n\t\r\n\tprivate function isNotObstructed():Bool {\r\n\t\r\n\t\tif (currentRegion.powerStationsInRegion.length > 0 && Std.is(toSpawn, UrbanPowerStation)) {\r\n\t\t\r\n\t\t\tif (justMovingaBuilding) {\r\n\t\t\t\r\n\t\t\t\tif (currentRegion != World.getInstance().getRegion(toSpawn.elem.regionX, toSpawn.elem.regionY)) return false;\r\n\t\t\t}\r\n\t\t\telse return false;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tif (currentRegion.powerStationsInRegion.length <= 0 && Std.is(toSpawn, UrbanAntenna)) return false;\r\n\t\treturn currentRegion.layers[1].canAdd(toSpawn);\r\n\t}\r\n\t\r\n\tpublic function setPosition(pPosition:Point) : Void {\r\n\t\tposition = pPosition;\r\n\t}\r\n\t\r\n\t\r\n\tprivate function canAffordIt():Bool {\r\n\t\r\n\t\tif (godMode) return true;\r\n\t\telse {\r\n\t\t\t\r\n\t\t\tvar lHasEnoughEnergy:Bool = true;\r\n\t\t\tif (Std.is(toSpawn, Building) && !Std.is(toSpawn, UrbanAntenna) && !Std.is(toSpawn, UrbanPowerStation)) lHasEnoughEnergy = Player.getInstance().hasEnoughEnergy(cast(toSpawn, Building).energyCost);\r\n\t\t\tif (!lHasEnoughEnergy) {\r\n\t\t\t\tHud.getInstance().noEnergyAnimation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar lHasEnoughSC:Bool = Player.getInstance().hasEnoughQuantity(cast(toSpawn, Building).costSC, Player.getInstance().softCurrency);\r\n\t\t\tvar lHasEnoughMN:Bool = Player.getInstance().hasEnoughQuantity(cast(toSpawn, Building).costMN, Player.getInstance().ressource);\r\n\t\t\tvar lHasEnoughHC:Bool = Player.getInstance().hasEnoughQuantity(cast(toSpawn, Building).costHC, Player.getInstance().hardCurrency);\r\n\t\t\t\r\n\t\t\tif ((!lHasEnoughMN || !lHasEnoughSC) && !lHasEnoughHC) {\r\n\t\t\t\tif (!lHasEnoughMN) Hud.getInstance().noMaterialAnimation();\r\n\t \t\t\tif (!lHasEnoughSC) Hud.getInstance().noSCAnimation();\r\n\t\t\t\t//Hud.getInstance().noHCAnimation(); // a voir si on garde (confusion?)\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif ((lHasEnoughMN && lHasEnoughSC) || lHasEnoughHC) {\r\n\t\t\t\r\n\t\t\t\tif (!lHasEnoughMN) ConfirmationPose.getInstance().noMN = true;\r\n\t\t\t\tif(!lHasEnoughHC) ConfirmationPose.getInstance().noHC = true;\r\n\t\t\t\tif (!lHasEnoughSC) ConfirmationPose.getInstance().noSC = true;\r\n\t\t\t\t\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\treturn false;\r\n\t}\t\r\n\t\r\n\tpublic function cancel():Void {\r\n\t\tif (justMovingaBuilding) placeBuildingOnTheGround(true);\r\n\t\telse {\r\n\t\t\tif (toSpawn != null) {\r\n\t\t\r\n\t\t\ttoSpawn.dispose();\r\n\t\t\t//GameStage.getInstance().getGameContainer().removeChild(graphicMargin);\r\n\t\t\ttoSpawn = null;\r\n\t\t\tMapInteractor.getInstance().deactivateSpawner();\r\n\t\t\tisElementToSpawnFixed = false;\r\n\t\t}\r\n\t\t}\r\n\t\t\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function drawIsoMargin(pGraphic:Graphics, pGameObject:GameElement) {\r\n\t\t//graphicMargin.clear();\r\n\t\t//var lColor:Int;\r\n\t\t//if (isNotObstructed()) lColor = 0x06ff00;\r\n\t\t//else lColor = 0xff0000;\r\n\t\t//pGraphic.beginFill(lColor);\r\n\t\t//\r\n\t\t//var lStart = IsoManager.isoViewToModel(position);\r\n\t\t//var lMargin = pGameObject.margin;\r\n\t\t//var lWidth = pGameObject.localWidth;\r\n\t\t//var lHeight = pGameObject.localHeight;\r\n\t\t//var lIsoTop:Point = IsoManager.modelToIsoView(new Point(lStart.x - lMargin, lStart.y - lMargin));\r\n\t\t//var lIsoRight:Point = IsoManager.modelToIsoView(new Point(lStart.x + lWidth  + lMargin, lStart.y - lMargin));\r\n\t\t//var lIsoBottom:Point = IsoManager.modelToIsoView(new Point(lStart.x + lWidth + lMargin, lStart.y + lHeight + lMargin));\r\n\t\t//var lIsoLeft:Point = IsoManager.modelToIsoView(new Point(lStart.x - lMargin, lStart.y + lHeight + lMargin));\r\n\t\t//\r\n\t\t//pGraphic.drawPolygon\r\n\t\t//([\r\n\t\t\t//lIsoTop.x, lIsoTop.y,\r\n\t\t\t//lIsoRight.x, lIsoRight.y,\r\n\t\t\t//lIsoBottom.x, lIsoBottom.y,\r\n\t\t\t//lIsoLeft.x, lIsoLeft.y\r\n        //]);\t\r\n\t\t//\r\n\t\t//pGraphic.endFill();\r\n\t}\r\n\t\r\n\tpublic function onClick():Void {\r\n\t\t\r\n\t\tif (isNotObstructed()) {\r\n\t\t\tjustMovingaBuilding ? placeBuildingOnTheGround() : spawnGameElement();\r\n\t\t\ttoSpawn = null;\r\n\t\t\t//GameStage.getInstance().getGameContainer().removeChild(graphicMargin);\r\n\t\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\t\tMapInteractor.getInstance().deactivateSpawner();\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function spawnGameElement():Void {\r\n\t\t\r\n\t\tvar lClassName:String = Type.getClassName(Type.getClass(toSpawn)).split(\".\").pop();\r\n\t\tvar lToSpawn:GameElement = cast(PoolManager.getFromPool(lClassName), GameElement);\r\n\t\t\r\n\t\t\r\n\t\tif (!godMode) {\r\n\t\t\tif (!isPayingWithHC) {\r\n\t\t\t\tPlayer.getInstance().changePlayerValue(-cast(lToSpawn, Building).costSC, Player.TYPE_SOFTCURRENCY, true);\r\n\t\t\t\tPlayer.getInstance().changePlayerValue(-cast(lToSpawn, Building).costMN, Player.TYPE_RESSOURCE, true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tPlayer.getInstance().changePlayerValue(-cast(lToSpawn, Building).costHC, Player.TYPE_HARDCURRENCY, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreateNewGameElement(lToSpawn, toSpawn.colMin, toSpawn.rowMin);\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function launchObstructedFeedback():Void {\r\n\t\r\n\t\t//var redParams:ColorFilterParams = \r\n\t\t//{\r\n\t\t\t//colorAmount:1,\r\n\t\t\t//colorToApply: \"red\",\r\n\t\t\t//duration :1\r\n\t\t//}\r\n\r\n\t\tvar shakeParams : ShakerParams = \r\n\t\t{\r\n\t\t\toriginalPosition: toSpawn.position.clone(),\r\n\t\t\tsmoothness:5,\r\n\t\t\tamplitude:10,\r\n\t\t\tduration:40,\r\n\t\t\txQuantity: 1.5,\r\n\t\t\tyQuantity: 0.5,\r\n\t\t\tfadeOut: 0.95,\r\n\t\t\trandomShake: true,\r\n\t\t\tsound:\"no\"\r\n\t\t}\r\n\t\t\r\n\t\t//ColorFilterManager.getInstance().applyFilter(toSpawn, redParams);\r\n\t\tSmartShaker.getInstance().SetShaker(toSpawn, shakeParams);\r\n\t}\r\n\t\r\n\t\r\n\tpublic function createNewGameElement(pGameElem:GameElement, pX:Int , pY:Int):Void \r\n\t{\r\n\t\tvar lInstanceID = newID(pGameElem.name);\r\n\t\tvar lPoint:Point = new Point(pX, pY);\r\n\t\tpGameElem.position = IsoManager.modelToIsoView(lPoint);\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tvar lElem:Element = { instanceID : lInstanceID,\r\n\t\t\t\t\t\t\ttype : pGameElem.name,\r\n\t\t\t\t\t\t\twidth : pGameElem.width, \r\n\t\t\t\t\t\t\theight : pGameElem.height, \r\n\t\t\t\t\t\t\tx : pX,\r\n\t\t\t\t\t\t\ty : pY,\r\n\t\t\t\t\t\t\tglobalX : globalPosition.x,\r\n\t\t\t\t\t\t\tglobalY : globalPosition.y,\r\n\t\t\t\t\t\t\tregionX : currentRegion.x,\r\n\t\t\t\t\t\t\tregionY : currentRegion.y,\r\n \t\t\t\t\t\t\tlayer : 1,\r\n\t\t\t\t\t\t\tlevelUpGrade : toSpawn.level,\r\n\t\t\t\t\t\t\tmode : pGameElem.CONSTRUCTING_STATE\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\tpGameElem.init(lElem);\r\n\t\tpGameElem.start();\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t//var shakeParams : ShakerParams = \r\n\t\t//{\r\n\t\t\t//originalPosition: GameStage.getInstance().getGameContainer().position.clone(),\r\n\t\t\t//smoothness:3,\r\n\t\t\t//amplitude:10,\r\n\t\t\t//duration:30,\r\n\t\t\t//xQuantity: 1,\r\n\t\t\t//yQuantity: 0.5,\r\n\t\t\t//fadeOut: 0.95,\r\n\t\t\t//randomShake: true,\r\n\t\t\t//sound:\"build\"\r\n\t\t//}\r\n\t\t//SmartShaker.getInstance().SetShaker(GameStage.getInstance().getGameContainer(), shakeParams);\r\n\t\t\r\n\t\tcast(pGameElem, Building).addEnergyToPlayer();\r\n\t\tif (Std.is(pGameElem, BuildingEnergyProducer)) cast(pGameElem, BuildingEnergyProducer).increasePlayerMaxEnergy();\r\n\t\t\r\n\t\tcurrentRegion.layers[1].add(pGameElem);\r\n\t\tcurrentRegion.layers[1].container.addChild(pGameElem);\r\n\t\t\r\n\t\tPoolObject.elementList.set(lInstanceID, lElem);\r\n\t\tCellManager.getInstance().setCell(lElem);\r\n\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\tcurrentRegion.layers[1].container.children = IsoManager.sortTiles(currentRegion.layers[1].container.children);\r\n\t\t\r\n\t\tvar lCost:Int;\r\n\t\tvar lMNCost:Int = cast(pGameElem, Building).costMN;\r\n\t\tisPayingWithHC ? lCost = cast(pGameElem, Building).costHC : lCost = cast(pGameElem, Building).costSC;\r\n\t\tif (godMode) {\r\n\t\t\tlCost = 0;\r\n\t\t\tlMNCost = 0;\r\n\t\t}\r\n\t\tif (isPayingWithHC) DataBaseAction.getInstance().addBuildingAndChangeRessource(Player.getInstance().id, \"hardCurrency\", lCost, pGameElem.name, pGameElem.instanceID, currentRegion.x, currentRegion.y, pX, pY, globalPosition.x, globalPosition.y, 1);\r\n\t\telse DataBaseAction.getInstance().addBuildingAndChangeRessource(Player.getInstance().id, \"softCurrency\", lCost, pGameElem.name, pGameElem.instanceID, currentRegion.x, currentRegion.y, pX, pY, globalPosition.x, globalPosition.y, 1,lMNCost);\r\n\t\t\r\n\t\t//if (Std.is(pGameElem, UrbanAntenna)) {\r\n\t\t\tDataBaseAction.getInstance().changeBuildingLevel(lInstanceID, toSpawn.level);\r\n\t\t//}\r\n\t\tisPayingWithHC = false;\r\n\t\t\r\n\t\tSoundManager.getSound(\"soundPlayerStartCreateBuilding\").play();\r\n\t\t\r\n\t\tBuilding.updateBuildingsCarac();\r\n\t\t//toSpawn.off(MouseEventType.MOUSE_DOWN, setDrag);\r\n\t\t//toSpawn.off(TouchEventType.TOUCH_START, setDrag);\r\n\t\t\r\n\t\tcancel();\r\n\t\tspwanEffect(cast(pGameElem, Building));\r\n\r\n\r\n\t}\r\n\t\r\n\tprivate function spwanEffect(pBuilding:Building):Void\r\n\t{\r\n\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"bubble\", [\"bubble\"], 5000);\r\n\t\tvar lSmoke:Container = ParticleManager.getInstance().createParticle(\"smoke\", [\"smoke01\",\"bubble\",\"smoke03\"], 5000);\r\n\t\tlParticle.position = new Point(pBuilding.position.x+pBuilding.width/4,pBuilding.position.y+pBuilding.height/4);\r\n\t\tlSmoke.position = new Point(pBuilding.position.x+pBuilding.width/4,pBuilding.position.y+pBuilding.height/4);\r\n\t\tGameStage.getInstance().getInfoBulleContainer().addChild(lParticle);\r\n\t\tGameStage.getInstance().getInfoBulleContainer().addChild(lSmoke);\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function newID(pType:String):String\r\n\t{\r\n\t\tvar lInstanceID:String = pType + Date.now().getTime();\r\n\t\treturn lInstanceID;\r\n\t}\r\n\t\r\n\tprivate function makeElementToSpawnFollowMouse():Void {\r\n\t\r\n\t\tsetSpawnerIsoPosition();\r\n\t\tpositionElementToSpawn();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.controller;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEPopin;\r\nimport com.isartdigital.ruby.ui.popin.ConfirmationPose;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\nimport com.isartdigital.utils.events.EventType;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.ruby.utils.Focus;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport js.Browser;\r\nimport js.html.Event;\r\nimport js.html.TouchEvent;\r\nimport js.html.UIEvent;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.InteractionManager;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier && Jordan Dachicourt\r\n */\r\nclass Controller\r\n{\r\n\tpublic static var isDown: Bool;\r\n\tpublic static var isIn:Bool;\r\n\tpublic static var isMoving: Bool;\r\n\tpublic static var isTap: Bool;\r\n\tpublic static var isUp: Bool;\r\n\tpublic static var isClicked: Bool;\r\n\t\r\n\tprivate var oldPos:Point;\r\n\tprivate var clamp:Float = 50;\r\n\t\r\n\tprivate var speed:Float = 0.6;\r\n\t\r\n\tprivate static var clicCounter:Int = 0;\r\n\tprivate var maxClic:Int = 20;\r\n\tpublic static var  shortClic:Bool;\r\n\t\r\n\t\r\n\r\n\t\r\n\tpublic var deltaX:Float = 0;\r\n\tpublic var deltaY:Float = 0;\r\n\tpublic var gameContainer:Container = GameStage.getInstance().getGameContainer();\r\n\tpublic var alienContainer:Container = GameStage.getInstance().getAlienContainer();\r\n\r\n\t/**\r\n\t * instance unique de la classe TouchController\r\n\t */\r\n\tprivate static var instance: Controller;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Controller\r\n\t{\r\n\t\tif (instance == null) instance = new Controller();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tprivate function new()\r\n\t{\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Initialise le Controller\r\n\t */\r\n\tpublic function init():Void\r\n\t{\r\n\r\n\t\tgameContainer.interactive = true;\r\n\t\tgameContainer.buttonMode = true;\r\n\t\tgameContainer.defaultCursor = \"url(assets/Curseur.png), auto\";\r\n\t\t\r\n\t\tisDown = false;\r\n\t\tisIn = true;\r\n\t}\r\n\r\n\t\r\n\r\n\tpublic function detectClicLength():Void {\r\n\t\t\r\n\t\tif (isTap) clicCounter++;\r\n\t\tif (BuildingMenu.getInstance().isOpened) clicCounter = maxClic;\r\n\t\t\r\n\t\tif (shortClic) {\r\n\t\t\tshortClic = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Les controlles sont avant tout pens sur une logique mobile et est adapt pc\r\n\t * c'est pourquoi les nom Tap on t gard pour fonctions\r\n\t */\r\n\r\n\t/**\r\n\t * Callback\r\n\t */\r\n\r\n\tprivate function onTap():Void\r\n\t{\r\n\t\tisTap = true;\r\n\t\tisUp = false;\r\n\t\tclicCounter = 0;\r\n\t\tshortClic = false;\r\n\t\t\r\n\t}\r\n\r\n\tprivate function onUntap():Void\r\n\t{\r\n\r\n\t\t\r\n\t\tif (clicCounter < maxClic) shortClic = true;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tisUp = true;\r\n\t\tisTap = false;\r\n\t\t\r\n\t}\r\n\r\n\tprivate function onDown(pEvent:TouchEvent):Void\r\n\t{\r\n\t\tisDown = true;\r\n\t\toldPos = getPosFrom(GameStage.getInstance(),pEvent);\r\n\t}\r\n\r\n\tprivate function onOut():Void\r\n\t{\r\n\t\tisDown = false;\r\n\t\tisIn = false;\r\n\t}\r\n\t\r\n\tprivate function onOver():Void\r\n\t{\r\n\t\tisIn = true;\r\n\t}\r\n\r\n\tprivate function onUp():Void\r\n\t{\r\n\t\tisDown = false;\r\n\t}\r\n\t/**\r\n\t * deplace le focus si(onDown)\r\n\t */\r\n\tprivate function onMove(pEvent:TouchEvent):Void\r\n\t{\r\n\t\tif (isDown)\r\n\t\t{\r\n\t\t\tisMoving = true;\r\n\t\t\tvar currentPos = getPosFrom(GameStage.getInstance(), pEvent);\r\n\r\n\t\t\tdeltaX = (oldPos.x - currentPos.x)*speed;\r\n\t\t\tdeltaY = (oldPos.y - currentPos.y)*speed;\r\n\r\n\t\t\tvar newX:Float =  Focus.getInstance().x - ((Math.abs(deltaX) > clamp) ? clamp *  (Math.abs(deltaX)/deltaX): deltaX);\r\n\t\t\tvar newY:Float =  Focus.getInstance().y - ((Math.abs(deltaY) > clamp) ? clamp * (Math.abs(deltaY) / deltaY) : deltaY);\r\n\r\n\t\t\t//important ici de mettre une nouvelle rfrence de Point, pour eviter que le oldPos et position de Focus pointe sur la mme rfrence\r\n\t\t\t\r\n\t\t\tFocus.getInstance().toMove(new Point(deltaX, deltaY));\r\n\r\n\t\t\toldPos = currentPos;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdeltaX = 0;\r\n\t\t\tdeltaY = 0;\r\n\t\t\tisMoving = false;\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Donne la region en dessous de la souris\r\n\t * @return la region\r\n\t */\r\n\tpublic function getMouseRegion():Region\r\n\t{\r\n\r\n\t\treturn World.getInstance().getRegion(cast(getPosRegion().x, Int), cast(getPosRegion().y, Int));\r\n\t}\r\n\r\n\t/**\r\n\t * Donne la position de la souris relative  un container\r\n\t * @param\tpContainer le container parent\r\n\t * @return la position relative\r\n\t */\r\n\tpublic function getPosFrom(pContainer:Container, ?pEvent:TouchEvent = null):Point\r\n\t{\r\n\t\t//if (pEvent == null) return;\r\n\t\t/*if (DeviceCapabilities.system != DeviceCapabilities.SYSTEM_DESKTOP)\r\n\t\t{\r\n\t\t\t//var pTouchEvent = cast(pEvent, TouchEvent);\r\n\t\t\treturn new Point(pEvent.targetTouches[pEvent.targetTouches.length - 1].clientX, pEvent.targetTouches[pEvent.targetTouches.length - 1].clientY);\r\n\t\t}\r\n\t\telse */\r\n\t\t\r\n\t\treturn new Point(cast(Main.getInstance().renderer.plugins.interaction, InteractionManager).mouse.getLocalPosition(pContainer).x, cast(Main.getInstance().renderer.plugins.interaction, InteractionManager).mouse.getLocalPosition(pContainer).y);\r\n\t}\r\n\r\n\t/**\r\n\t * Position relative  un container en Iso\r\n\t * @param\tpContainer\r\n\t * @return\r\n\t */\r\n\tpublic function getIsoPosFrom(pContainer:Container):Point\r\n\t{\r\n\t\treturn IsoManager.modelToIsoView(getPosFrom(pContainer));\r\n\t}\r\n\r\n\t/**\r\n\t * Donne les coordonn region actuelle\r\n\t * @return\r\n\t */\r\n\tpublic function getPosRegion():Point\r\n\t{\r\n\t\tvar lPoint:Point = IsoManager.localToModel(getPosFrom(gameContainer));\r\n\r\n\t\tlPoint.x /= Region.WIDTH;\r\n\t\tlPoint.y /= Region.HEIGHT;\r\n\t\tlPoint.x = Math.floor(lPoint.x);\r\n\t\tlPoint.y = Math.floor(lPoint.y);\r\n\t\treturn lPoint;\r\n\t}\r\n\r\n\tpublic function doAction() {\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n}","package com.isartdigital.ruby.game.controller;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.RegionContainer;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.ruby.utils.Focus;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.ui.Button;\r\nimport js.Browser;\r\nimport js.html.MouseEvent;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.InteractionManager;\r\n \r\n   \r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass MouseController extends Controller\r\n{\r\n    \r\n\t\r\n\t\r\n    /**\r\n     * instance unique de la classe MouseController\r\n     */\r\n    private static var instance: MouseController;\r\n   \r\n    /**\r\n     * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n     * @return instance unique\r\n     */\r\n    public static function getInstance (): MouseController {\r\n        if (instance == null) instance = new MouseController();\r\n        return instance;\r\n    }\r\n   \r\n    /**\r\n     * constructeur priv pour viter qu'une instance soit cre directement\r\n     */\r\n    private function new()\r\n    {\r\n\t\tsuper();\r\n       \r\n    }\r\n\t\r\n\t/**\r\n\t * Initialise les couteurs\r\n\t */\r\n\toverride public function init():Void \r\n\t{\r\n\t\tsuper.init();\r\n\t\t\r\n\t\t\r\n\t\tgameContainer.on(MouseEventType.MOUSE_DOWN, onTap);\r\n\t\talienContainer.on(MouseEventType.MOUSE_DOWN, onTap);\r\n\t\tgameContainer.on(MouseEventType.MOUSE_UP, onUntap);\r\n\t\talienContainer.on(MouseEventType.MOUSE_UP, onUntap);\r\n        gameContainer.on(MouseEventType.MOUSE_MOVE, onMove);\r\n\t\tgameContainer.on(MouseEventType.MOUSE_OUT, onOut);\r\n\t\tgameContainer.on(MouseEventType.MOUSE_OVER, onOver);\r\n\t\tgameContainer.on(MouseEventType.MOUSE_DOWN, onDown);\r\n\t\tgameContainer.on(MouseEventType.MOUSE_UP, onUp);\r\n\t\t\r\n\t}    \r\n\t\r\n    /**\r\n     * dtruit l'instance unique et met sa rfrence interne  null\r\n     */\r\n    public function destroy (): Void {\r\n        instance = null;\r\n\t\t\r\n        gameContainer.off(MouseEventType.CLICK, onTap);\r\n        gameContainer.off(MouseEventType.MOUSE_UP, onUntap);\r\n        gameContainer.off(MouseEventType.MOUSE_MOVE, onMove);\r\n\t\tgameContainer.off(MouseEventType.MOUSE_OUT, onOut);\r\n\t\tgameContainer.off(MouseEventType.MOUSE_DOWN, onDown);\r\n\t\tgameContainer.off(MouseEventType.MOUSE_UP, onUp);\r\n    }\r\n\t\r\n   \r\n \r\n}","package com.isartdigital.ruby.game.controller;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.ui.Button;\r\nimport js.html.MouseEvent;\r\nimport js.html.TouchEvent;\r\nimport js.html.UIEvent;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.InteractionManager;\r\n \r\n   \r\n/**\r\n * ...\r\n * @author Julien Fournier && Jordan Dachicourt\r\n */\r\nclass TouchController extends Controller\r\n{\r\n    /**\r\n     * instance unique de la classe TouchController\r\n     */\r\n    private static var instance: TouchController;\r\n   \r\n    /**\r\n     * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n     * @return instance unique\r\n     */\r\n    public static function getInstance (): TouchController {\r\n        if (instance == null) instance = new TouchController();\r\n        return instance;\r\n    }\r\n   \r\n    /**\r\n     * constructeur priv pour viter qu'une instance soit cre directement\r\n     */\r\n    private function new()\r\n    {\r\n       super();\r\n    }\r\n\t\r\n\t\r\n\toverride public function init():Void \r\n\t{\r\n\t\tsuper.init();\r\n\t\t\r\n\t\tgameContainer.on(TouchEventType.TAP, onTap);\r\n\t\talienContainer.on(TouchEventType.TAP, onTap);\r\n        gameContainer.on(TouchEventType.TOUCH_START, onDown);\r\n        gameContainer.on(TouchEventType.TOUCH_END, onUp);\r\n\t\tgameContainer.on(TouchEventType.TOUCH_END_OUTSIDE, onOut);\r\n        gameContainer.on(TouchEventType.TOUCH_MOVE, onMove);\r\n\r\n\t\t\r\n\t}\r\n   \r\n\t/**\r\n\t * Initialise les couteurs\r\n\t */\r\n\toverride function onUp():Void \r\n\t{\r\n\t\tsuper.onUp();\r\n\t\tController.isTap = false;\r\n\t}\r\n      \r\n    /**\r\n     * dtruit l'instance unique et met sa rfrence interne  null\r\n     */\r\n    public function destroy (): Void {\r\n        instance = null;\r\n\t\t\r\n\t\tgameContainer.off(TouchEventType.TAP, onTap);\r\n        gameContainer.off(TouchEventType.TOUCH_START, onDown);\r\n        gameContainer.off(TouchEventType.TOUCH_END, onUp);\r\n\t\tgameContainer.off(TouchEventType.TOUCH_END_OUTSIDE, onOut);\r\n        gameContainer.off(TouchEventType.TOUCH_MOVE, onMove);\r\n    }\r\n   \r\n \r\n}","package com.isartdigital.ruby.game.player;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.Missions;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass MissionsManager\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe MissionsManager\r\n\t */\r\n\tprivate static var instance: MissionsManager;\r\n\r\n\tpublic var missions:Array<Missions>;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): MissionsManager\r\n\t{\r\n\t\tif (instance == null) instance = new MissionsManager();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\r\n\t}\r\n\r\n\tpublic function init (pMission: Dynamic): Void\r\n\t{\r\n\t\tmissions = new Array<Missions>();\r\n\t\tmissions = pMission.missions;\t\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.player;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.RewardNotifications;\r\nimport com.isartdigital.services.facebook.Facebook;\r\nimport com.isartdigital.services.monetization.Wallet;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport haxe.Json;\r\nimport haxe.macro.Expr.Unop;\r\nimport js.Browser;\r\n\r\ntypedef PlayerSave =\r\n{\r\n\tvar id:Int;\r\n\tvar fbID:String;\r\n\tvar level:UInt;\r\n\tvar xp:UInt;\r\n\tvar hardCurrency:UInt;\r\n\tvar softCurrency:UInt;\r\n\tvar currentEnergy:UInt;\r\n\tvar ressource:UInt;\r\n\tvar maxEnergy:UInt;\r\n\tvar ftueSteps:Int;\r\n\t@:optional var gene1:UInt;\r\n\t@:optional var gene2:UInt;\r\n\t@:optional var gene3:UInt;\r\n\t@:optional var gene4:UInt;\r\n\t@:optional var gene5:UInt;\r\n\t@:optional var schemas:Int;\r\n}\r\n/**\r\n * Player : Gestion de l'xp, des resources et des information du player;\r\n * @author Adrien Bourdon\r\n */\r\nclass Player\r\n{\r\n\t/**\r\n\t * instance unique de la classe Player\r\n\t */\r\n\tprivate static var instance: Player;\r\n\r\n\t//\r\n\tpublic var id(default, null):Int;\r\n\tpublic var idFb(default, null):String;\r\n\t\r\n\tpublic var email(default, set):String;\r\n\t\r\n\tfunction set_email(pEmail:String):String\r\n\t{\r\n\t\treturn email = pEmail;\r\n\t}\r\n\t// Resources\r\n\tpublic static inline var TYPE_SOFTCURRENCY:String = \"softCurrency\";\r\n\tpublic static inline var TYPE_HARDCURRENCY:String = \"hardCurrency\";\r\n\tpublic static inline var TYPE_RESSOURCE:String = \"ressource\";\r\n\r\n\tpublic var hardCurrency(default, null):Int;\r\n\tpublic var softCurrency(default, null):Int;\r\n\tpublic var ressource(default, null):Int;\r\n\tpublic var currentEnergy(default, null):Int;\r\n\tpublic var maxEnergy(default, null):Int;\r\n\tpublic var ftueSteps(default, null):Int;\r\n\r\n\t// Experience\r\n\tpublic var experience(default, null):Int;\r\n\tpublic var level(default, null):Int;\r\n\tpublic var xpToLevel(default, null):Int;\r\n\tpublic var levelAdvance(default, null):Float;\r\n\r\n\t//cellules/genes\r\n\r\n\tpublic var gene1(default,null):UInt;\r\n\tpublic var gene2(default,null):UInt;\r\n\tpublic var gene3(default,null):UInt;\r\n\tpublic var gene4(default,null):UInt;\r\n\tpublic var gene5(default, null):UInt;\r\n\t\r\n\tpublic var schemas(default, null):UInt;\r\n\tpublic var geneArray:Array<UInt>;\r\n\t\r\n\tpublic var currentIsartPoint:Float;\r\n\r\n\r\n\t// Save\r\n\tprivate var save:PlayerSave;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Player\r\n\t{\r\n\t\tif (instance == null) instance = new Player();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * initialisation du player par default ou du player sauvegard\r\n\t * @param\tpSave : sauvegarde des donnes du player\r\n\t */\r\n\tpublic function loadSave(?pSave:PlayerSave):Void\r\n\t{\r\n\t\tif (pSave != null)\r\n\t\t{\r\n\t\t\tid = pSave.id;\r\n\t\t\tidFb = pSave.fbID;\r\n\t\t\tsave = pSave;\r\n\t\t\tlevel = pSave.level;\r\n\t\t\texperience = pSave.xp;\r\n\t\t\txpToLevel = XpToLevel.ref[level];\r\n\t\t\thardCurrency = pSave.hardCurrency;\r\n\t\t\tsoftCurrency = pSave.softCurrency;\r\n\t\t\tcurrentEnergy = pSave.currentEnergy;\r\n\t\t\tmaxEnergy = pSave.maxEnergy;\r\n\t\t\tressource = pSave.ressource;\r\n\t\t\tftueSteps = pSave.ftueSteps;\r\n\r\n\t\t\tgene1 = pSave.gene1;\r\n\t\t\tgene2 = pSave.gene2;\r\n\t\t\tgene3 = pSave.gene3;\r\n\t\t\tgene4 = pSave.gene4;\r\n\t\t\tgene5 = pSave.gene5;\r\n\t\t\tschemas = pSave.schemas;\r\n\r\n\t\t}\r\n\t\tcalculateLevelAdvance();\r\n\t\tHud.getInstance().update();\r\n\r\n\t\tgeneArray = [gene1, gene2, gene3, gene4, gene5];\r\n\t\tWallet.getMoney(email, callBackWallet);\r\n\t}\r\n\t\r\n\tprivate function callBackWallet (pData:Dynamic):Void\r\n\t{\r\n\r\n\t\tif (pData == null) trace (\"Erreur Service\");\r\n\r\n\t\telse if (pData.error != null) trace (pData.error);\r\n\r\n\t\telse \r\n\t\t{\r\n\t\t\tcurrentIsartPoint = Std.parseFloat(Reflect.field(pData, \"money\"));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * met la savegarde  jour ( a voir avec la bdd)\r\n\t */\r\n\tprivate function releaseSave():Void\r\n\t{\r\n\t\tsave.xp = experience;\r\n\t\tsave.level = level;\r\n\t\tsave.hardCurrency = hardCurrency;\r\n\t\tsave.softCurrency = softCurrency;\r\n\t\tsave.ressource = ressource;\r\n\t\tsave.currentEnergy = currentEnergy;\r\n\t\tsave.maxEnergy = maxEnergy;\r\n\t\tsave.gene1;\r\n\t\tsave.gene2;\r\n\t\tsave.gene3;\r\n\t\tsave.gene4;\r\n\t\tsave.gene5;\r\n\t\tsave.schemas;\r\n\t\t//save bdd a revoir\r\n\t}\r\n\r\n\t//// XP ////\r\n\t/**\r\n\t * Ajoute de l'experience au joueur et modifie son level si besoin\r\n\t * @param\tpXp : exprience ajout\r\n\t */\r\n\tpublic function addExp(pXp:Int):Void\r\n\t{\r\n\t\t\r\n\t\tif (level == 20) {\r\n\t\t\tBrowser.alert(\"Bravo ! Vous tes arrivs au niveau max !\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (experience + pXp < xpToLevel) experience += pXp;\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar numberLevel:UInt = Math.floor((experience + pXp)/ xpToLevel);\r\n\t\t\tlevel += numberLevel;\r\n\t\t\txpToLevel = XpToLevel.ref[level];\r\n\t\t\t//experience = (experience + pXp) % xpToLevel;\r\n\t\t\texperience = experience + pXp;\r\n\t\t\tUIManager.getInstance().openPopin(RewardNotifications.getInstance());\r\n\t\t\tRewardNotifications.getInstance().initLevelUp(level);\r\n\t\t\tSoundManager.getSound(\"soundLevelUp\").play();\r\n\t\t}\r\n\t\t\r\n\t\tcalculateLevelAdvance();\r\n\t\tHud.getInstance().update();\r\n\t\tDataBaseAction.getInstance().changeExperience(experience, level);\r\n\t\treleaseSave();\r\n\t}\r\n\r\n\t/**\r\n\t * calcule le pourcentage d'avancement d'un niveau\r\n\t * @return le pourcentage\r\n\t */\r\n\tpublic function calculateLevelAdvance():Float\r\n\t{\r\n\t\t\r\n\t\tvar lPercent:Float = ((experience - XpToLevel.ref[level - 1]) / XpToLevel.xpToNextLevel[level]) * 100;\r\n\t\treturn lPercent;\r\n\t}\r\n\r\n\t/**\r\n\t * test si la quantit d'une ressource est suffisante\r\n\t * @param\tpQuantity : quantit  tester\r\n\t * @param\tpType : ressources  tester\r\n\t * @return true si il y a assez de ressources\r\n\t */\r\n\tpublic function hasEnoughQuantity(pQuantity:Int, pType:Int):Bool\r\n\t{\r\n\t\treturn pType >= pQuantity;\r\n\t}\r\n\t\r\n\tprivate function calculateXpToLevel(pLevel:Int):Int {\r\n\t\r\n\t\treturn pLevel * 1000;\r\n\t}\r\n\r\n\t/**\r\n\t * ajoute/retire une valeur de soft, hard ou ressource au player\r\n\t * cot client et serveur\r\n\t * @param\tpValue : valeur  retirer ou ajouter\r\n\t * @param\tpValueType : type de la valeur (soft, hard ou ressource)\r\n\t * @param\tpIsAddingBuilding : si c'est lors de l'ajout d'un building passer  true\r\n\t */\r\n\tpublic function changePlayerValue(pValue:Float, pValueType:String, ?pIsAddingBuilding:Bool = false):Void\r\n\t{\r\n\r\n\t\tif (Reflect.getProperty(this, pValueType) == null) return;\r\n\t\tif (pValue < 0)\r\n\t\t{\r\n\t\t\tif (!hasEnoughQuantity(cast(pValue, Int), Reflect.getProperty(this, pValueType))) return;\r\n\t\t\t//descrease hud\r\n\t\t}\r\n\r\n\t\tvar oldValue:Int = Reflect.getProperty(this, pValueType);\r\n\t\tvar newValue:Int = Reflect.getProperty(this, pValueType) + cast(pValue, Int);\r\n\t\tReflect.setProperty(this, pValueType, newValue);\r\n\t\tif (!pIsAddingBuilding) DataBaseAction.getInstance().changeCurrency(id, pValueType, -cast(pValue, Int));\r\n\r\n\t\treleaseSave();\r\n\t\tHud.getInstance().update();\r\n\t\t//var updatedValue:Int = oldValue + pValue;\r\n\r\n\t\t//increase Hud\r\n\t\t/*if(oldValue < updatedValue)\r\n\t\t{\r\n\t\t\toldValue += 1;\r\n\t\t\tHud.getInstance().update();\r\n\t\t}*/\r\n\r\n\t}\r\n\r\n\t//// ENERGY ////\r\n\tpublic function hasEnoughEnergy(pEnergy:Int):Bool\r\n\t{\r\n\t\tif ((pEnergy + currentEnergy) <= maxEnergy) return true;\r\n\t\telse return false;\r\n\t}\r\n\r\n\tpublic function increaseEnergyConsumed(pEnergy:Int):Void\r\n\t{\r\n\t\tif (hasEnoughEnergy(pEnergy))\r\n\t\t{\r\n\t\t\tcurrentEnergy += pEnergy;\r\n\t\t\tDataBaseAction.getInstance().changeEnergy(id, currentEnergy);\r\n\t\t}\r\n\t\treleaseSave();\r\n\t\tHud.getInstance().update();\r\n\t}\r\n\r\n\tpublic function increaseMaxEnergy(pMaxEnergy:Int):Void\r\n\t{\r\n\t\tmaxEnergy += pMaxEnergy;\r\n\t\tDataBaseAction.getInstance().changeMaxEnergy(id, maxEnergy);\r\n\t\treleaseSave();\r\n\t\tHud.getInstance().update();\r\n\t}\r\n\t\r\n\tpublic function setSchema(pSchema:Int):Void\r\n\t{\r\n\t\tschemas = pSchema;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game;\r\n\r\nimport com.isartdigital.utils.events.EventType;\r\nimport pixi.core.display.Container;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\n\r\n/**\r\n * Classe de base des objets interactifs dans le jeu\r\n * Met  jour automatiquement ses donnes internes de position et transformation\r\n * \r\n * @author Mathieu ANTHOINE\r\n */\r\nclass GameObject extends Container\r\n{\r\n\tpublic var colorFilter:ColorMatrixFilter = new ColorMatrixFilter();\r\n\t\r\n\t\r\n\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\t// Force la mise  jour de la matrices de transformation des lments constituant le GameObject\r\n\t\ton(EventType.ADDED, updateTransform);\r\n\t\tbuttonMode = true;\r\n\t\tinteractive = true;\r\n\t\tdefaultCursor = \"url(assets/Curseur.png), auto\";\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * nettoie et dtruit l'instance\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\toff(EventType.ADDED, updateTransform);\r\n\t\tsuper.destroy(true);\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game;\r\nimport pixi.core.display.Container;\r\n\r\n/**\r\n * Implmentation de base d'une Machine  tat\r\n * expose de faon publique sa mthode doAction qui peut faire rfrence  diffrentes mthodes prvues (doActionVoid, doActionNormal) ou spcifiques dfinies par ses classes filles\r\n * Par convention le changement de rfrence de doAction se fait via des mthodes setMode (setModeVoid, setModeAction) qui peuvent aussi contenir des paramtres d'initialisation\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass StateMachine extends GameObject implements IStateMachine \r\n{\r\n\t\r\n\t/**\r\n\t * mthode appele  chaque gameLoop. Elle peut faire rfrence  diffrentes mthodes au cours du temps\r\n\t */\r\n\tpublic var doAction:Void->Void;\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tsetModeVoid();\t\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * applique le mode \"ne fait rien\"\r\n\t */\r\n\tprivate function setModeVoid (): Void {\r\n\t\tdoAction = doActionVoid;\r\n\t}\r\n\t\r\n\t/**\r\n\t * fonction vide destine  maintenir la rfrence de doAction sans rien faire\r\n\t */\r\n\tprivate function doActionVoid (): Void {}\r\n\r\n\t\r\n\t/**\r\n\t * applique le mode normal (mode par defaut)\r\n\t */\r\n\tprivate function setModeNormal(): Void {\r\n\t\tdoAction = doActionNormal;\r\n\t}\r\n\t\r\n\t/**\r\n\t * fonction destine  appliquer un comportement par defaut\r\n\t */\r\n\tprivate function doActionNormal (): Void {}\r\n\t\r\n\t/**\r\n\t * Activation\r\n\t */\r\n\tpublic function start (): Void {\r\n\t\tsetModeNormal();\r\n\t}\r\n\t\r\n\t/**\r\n\t * nettoie et dtruit l'instance\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tsetModeVoid();\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\t\r\n}","package com.isartdigital.utils.game;\r\n\r\nimport com.isartdigital.utils.game.factory.AnimFactory;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Json;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Circle;\r\nimport pixi.core.math.shapes.Ellipse;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\r\n/**\r\n * Classe de base des objets interactifs ayant plusieurs tats graphiques\r\n * Gre la reprsentation graphique (anim) et les conteneurs utiles au gamePlay (box) qui peuvent tre de simples boites de collision ou beaucoup plus\r\n * suivant l'implmentation faite par le dveloppeur dans les classes filles\r\n * @author Mathieu ANTHOINE\r\n * @version 0.12.0\r\n */\r\nclass StateGraphic extends StateMachine\r\n{\r\n\r\n\t/**\r\n\t * Fabrique d'anim\r\n\t */\r\n\tprivate var factory:AnimFactory;\r\n\t \r\n\t/**\r\n\t * anim de l'tat courant\r\n\t */\r\n\tprivate var anim:Container;\r\n\t\r\n\t/**\r\n\t * box de l'tat courant\r\n\t */\r\n\tprivate var box:Container;\r\n\t\r\n\t/**\r\n\t * suffixe du nom d'export des symboles Anims\r\n\t */\r\n\tprivate var ANIM_SUFFIX (default,null):String = \"\";\r\n\t\r\n\t/**\r\n\t * suffixe du nom d'export des symboles Box\r\n\t */\r\n\tprivate var BOX_SUFFIX (default,null):String = \"box\";\t\r\n\t\r\n\t/**\r\n\t * etat par dfaut\r\n\t */\r\n\tprivate var DEFAULT_STATE (default, null): String = \"\";\r\n\t\r\n\t/**\r\n\t * Nom de l'asset (sert  identifier les textures  utiliser)\r\n\t * Prend le nom de la classe Fille par dfaut\r\n\t */\r\n\tprivate var assetName:String;\r\n\t\r\n\t/**\r\n\t * tat en cours\r\n\t */\r\n\tprivate var state:String;\r\n\t\r\n\t/**\r\n\t * Type de box de collision\r\n\t * Si boxType est gal  BoxType.NONE, aucune collision ne se fait, il n'est pas ncessaire d'avoir une boite de collision dfinie\r\n\t * Si boxType est gal  BoxType.SIMPLE, seul un symbole sert de Box pour tous les tats, son nom d'export etant assetName+\"_\"+BOX_SUFFIX\r\n\t * Si boxType est gal  BoxType.MULTIPLE, chaque state correspond  une boite de collision, chaque state va cherche la boite assetName+\"_\"+ANIM_SUFFIX+\"_\"+BOX_SUFFIX\r\n\t * Si boxType est gal  BoxType.SELF, hitBox retourne le MovieClip anim\r\n\t */\r\n\tprivate var boxType:BoxType=BoxType.NONE;\r\n\t\r\n\t/**\r\n\t * niveau d'alpha des anim\r\n\t */\r\n\tpublic static var animAlpha:Float = 1;\r\n\t\r\n\t/**\r\n\t * niveau d'alpha des Boxes\r\n\t */\r\n\tpublic static var boxAlpha:Float = 0;\r\n\t\r\n\t/**\r\n\t * cache des boxes de tous les StateGraphic\r\n\t */\r\n\tprivate static var boxesCache:Map<String,Map<String,Dynamic>>;\r\n\t\r\n\t/**\r\n\t * l'anim est-elle termine ?\r\n\t */\r\n\tpublic var isAnimEnd (default, null):Bool;\r\n\t\r\n\tprivate function setAnimEnd ():Void {\r\n\t\tisAnimEnd = true;\r\n\t}\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dfini l'tat courant du StateGraphic\r\n\t * @param\tpState nom de l'tat (run, walk...)\r\n\t * @param\tpLoop l'anim boucle (isAnimEnd sera toujours false) ou pas\r\n\t * @param\tpAutoPlay lance l'anim automatiquement\r\n\t * @param\tpStart lance l'anim  cette frame\r\n\t */\r\n\tprivate function setState (pState:String, ?pLoop:Bool = false, ?pAutoPlay:Bool=true, ?pStart:UInt = 0): Void {\r\n\t\t\r\n\t\tvar lClassName:String = Type.getClassName(Type.getClass(this));\r\n\t\t\r\n\t\tif (factory == null) throw lClassName+\" :: proprit factory non dfinie\";\r\n\t\t\r\n\t\tif (state == pState) {\r\n\t\t\tif (anim!=null) setBehavior (pLoop,pAutoPlay,pStart);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (assetName == null) assetName = lClassName.split(\".\").pop();\r\n\t\t\r\n\t\tstate = pState;\r\n\t\t\r\n\t\tanim = factory.getAnim();\r\n\t\t\r\n\t\tif (anim == null) {\t\t\t\r\n\t\t\tif (boxType == BoxType.SELF) {\r\n\t\t\t\tif (box !=null) removeChild(box);\r\n\t\t\t\tbox = null;\r\n\t\t\t}\r\n\t\t\tanim = factory.create(getID(state));\r\n\t\t\tanim.scale.set(1 /DeviceCapabilities.textureRatio , 1 / DeviceCapabilities.textureRatio);\r\n\t\t\tif (animAlpha < 1) anim.alpha = animAlpha;\r\n\t\t\taddChild(anim);\r\n\t\t} else {\r\n\t\t\tfactory.update(getID(state));\r\n\t\t}\r\n\r\n\t\tisAnimEnd = false;\r\n\t\t\r\n\t\tsetBehavior(pLoop, pAutoPlay, pStart);\r\n\t\t\r\n\t\tif (box == null) {\r\n\t\t\tif (boxType == BoxType.SELF) {\r\n\t\t\t\tbox = anim;\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tbox = new Container();\r\n\t\t\t\tif (boxType != BoxType.NONE) createBox();\r\n\t\t\t}\r\n\t\t\taddChild(box);\r\n\t\t} else if (boxType == BoxType.MULTIPLE) {\r\n\t\t\tremoveChild(box);\r\n\t\t\tbox = new Container();\r\n\t\t\tcreateBox();\r\n\t\t\taddChild(box);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setBehavior (?pLoop:Bool = false, ?pAutoPlay:Bool = true, ?pStart:UInt = 0):Void {\r\n\t\tuntyped anim.loop = pLoop;\r\n\t\tfactory.setFrame(pAutoPlay, pStart);\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne l'identifiant complet de l'animation\r\n\t * @param\tpState etat de l'anim\r\n\t * @return identifiant\r\n\t */\r\n\tprivate function getID(pState:String): String {\r\n\t\tif (pState == DEFAULT_STATE) return assetName+ANIM_SUFFIX;\r\n\t\treturn assetName+\"_\" + pState+ANIM_SUFFIX;\r\n\t}\r\n\t\r\n\t/**\r\n\t * cre la ou les box de collision de l'tat\r\n\t */\r\n\tprivate function createBox ():Void {\r\n\t\tvar lBoxes:Map<String,Dynamic> = getBox((boxType == BoxType.MULTIPLE ? state+ \"_\": \"\" )  + BOX_SUFFIX);\r\n\t\tvar lChild:Graphics;\r\n\t\t\r\n\t\tfor (lBox in lBoxes.keys()) {\r\n\t\t\tlChild = new Graphics();\r\n\t\t\tlChild.beginFill(0xFF2222);\r\n\t\t\tif (Std.is(lBoxes[lBox], Rectangle)) {\r\n\t\t\t\tlChild.drawRect(lBoxes[lBox].x, lBoxes[lBox].y, lBoxes[lBox].width, lBoxes[lBox].height);\r\n\t\t\t}\r\n\t\t\telse if (Std.is(lBoxes[lBox], Ellipse)) {\r\n\t\t\t\tlChild.drawEllipse(lBoxes[lBox].x, lBoxes[lBox].y, lBoxes[lBox].width, lBoxes[lBox].height);\r\n\t\t\t}\r\n\t\t\telse if (Std.is(lBoxes[lBox], Circle)) {\r\n\t\t\t\tlChild.drawCircle(lBoxes[lBox].x,lBoxes[lBox].y,lBoxes[lBox].radius);\r\n\t\t\t}\r\n\t\t\telse if (Std.is(lBoxes[lBox], Point)) {\r\n\t\t\t\tlChild.drawCircle(0, 0, 10);\r\n\t\t\t}\r\n\t\t\tlChild.endFill();\r\n\t\t\t\r\n\t\t\tlChild.name = lBox;\r\n\t\t\tif (Std.is(lBoxes[lBox], Point)) lChild.position.set(lBoxes[lBox].x, lBoxes[lBox].y);\r\n\t\t\telse lChild.hitArea = lBoxes[lBox];\r\n\t\t\t \r\n\t\t\tbox.addChild(lChild);\r\n\t\t}\r\n\t\tif (boxAlpha == 0) box.renderable = false;\r\n\t\telse box.alpha= boxAlpha;\r\n\t}\t\t\r\n\t\r\n\t/**\r\n\t * Crer toutes les Boxes\r\n\t * @param\tpJson Nom du fichier contenant la description des boxes\r\n\t */\r\n\tstatic public function addBoxes (pJson:Json): Void {\r\n\t\t\r\n\t\tif (boxesCache == null) boxesCache = new Map<String,Map<String,Dynamic>>();\r\n\t\t\r\n\t\tvar lItem;\r\n\t\tvar lObj;\r\n\t\t\r\n\t\tfor (lName in Reflect.fields(pJson)) {\r\n\t\t\tlItem = Reflect.field(pJson, lName);\r\n\t\t\tboxesCache[lName] = new Map<String,Dynamic>();\t\t\t\r\n\t\t\t\r\n\t\t\tfor (lObjName in Reflect.fields(lItem)) {\r\n\t\t\t\tlObj = Reflect.field(lItem, lObjName);\r\n\t\t\t\t\r\n\t\t\t\tif (lObj.type == \"Rectangle\") boxesCache[lName][lObjName] = new Rectangle(lObj.x, lObj.y, lObj.width, lObj.height);\r\n\t\t\t\telse if (lObj.type == \"Ellipse\") boxesCache[lName][lObjName] = new Ellipse(lObj.x, lObj.y, lObj.width/2, lObj.height/2);\r\n\t\t\t\telse if (lObj.type == \"Circle\") boxesCache[lName][lObjName] = new Circle(lObj.x, lObj.y, lObj.radius);\r\n\t\t\t\telse if (lObj.type == \"Point\") boxesCache[lName][lObjName] = new Point(lObj.x, lObj.y);\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Cherche dans le cache gnral des boxes, celle correspondant au state demand\r\n\t * @param\tpState State de l'instance\r\n\t * @return\tla box correspondante\r\n\t * @return\r\n\t */\r\n\tpublic function getBox (pState:String):Map<String,Dynamic> {\r\n\t\treturn boxesCache[assetName+\"_\" +pState];\r\n\t}\t\t\r\n\t\r\n\t/**\r\n\t * met en pause l'anim\r\n\t */\r\n\tpublic function pause ():Void {\r\n\t\tif (anim != null) untyped anim.stop();\r\n\t}\r\n\t\r\n\t/**\r\n\t * relance l'anim\r\n\t */\r\n\tpublic function resume ():Void {\r\n\t\tif (anim != null) untyped anim.play();\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne la zone de hit de l'objet\r\n\t */\r\n\tpublic var hitBox (get, null):Container;\r\n\t \r\n\tprivate function get_hitBox (): Container {\r\n\t\treturn box;\r\n\t\t// Si on veut cibler une box plus prcise: return box.getChildByName(\"nom d'instance du MovieClip de type Rectangle ou Circle dans Flash IDE\");\r\n\t}\r\n\r\n\t/**\r\n\t * retourne un tableau de points de collision dont les coordonnes sont exprimes dans le systeme global\r\n\t */\r\n\tpublic var hitPoints (get, null): Array<Point>;\r\n\t \r\n\tprivate function get_hitPoints (): Array<Point> {\r\n\t\treturn null;\r\n\t\t// liste de Points : return [box.toGlobal(box.getChildByName(\"nom d'instance du MovieClip de type Point dans Flash IDE\").position,box.toGlobal(box.getChildByName(\"nom d'instance du MovieClip de type Point dans Flash IDE\").position];\r\n\t}\r\n\t\r\n\t/**\r\n\t * nettoyage et suppression de l'instance\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tif (untyped anim.stop!=null) untyped anim.stop();\r\n\t\tremoveChild(anim);\r\n\t\tanim.destroy();\t\t\r\n\t\tif (box != anim) {\r\n\t\t\tremoveChild(box);\r\n\t\t\tbox.destroy();\r\n\t\t\tbox = null;\r\n\t\t}\r\n\t\tanim = null;\r\n\t\t\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites;\r\n\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass FlumpStateGraphic extends StateGraphic\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper();\r\n\t\tif (pAsset != null) assetName = pAsset;\r\n\t\tname = assetName;\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tfactory = new FlumpMovieAnimFactory();\r\n\t\tsuper.start();\r\n\t\tsetState(DEFAULT_STATE);\r\n\t\tboxType = BoxType.SELF;\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game.pooling;\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.utils.game.clipping.IClippable;\r\n\r\n/**\r\n * ...\r\n * @author dachicourt jordan\r\n */\r\nclass PoolObject extends FlumpStateGraphic implements IClippable\r\n{\r\n\tpublic static var activeObjectList:Array<PoolObject> = new Array<PoolObject>();\r\n\tpublic static var elementList:Map<String, Element> = new Map<String, Element>();\r\n\t\r\n\tpublic var elem(default, default):Element;\t\r\n\tpublic var instanceID:String;\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper();\r\n\t\tassetName = pAsset;\t\r\n\t}\r\n\t\r\n\tpublic function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tif (pElem != null)\r\n\t\t{\r\n\t\t\telem = pElem;\r\n\t\t\telem.instance = this;\r\n\t\t\tinstanceID = pElem.instanceID;\r\n\t\t}\r\n\t\t\r\n\t\tactiveObjectList.push(this);\r\n\t}\r\n\t\r\n\tprivate function releaseElementList():Void \r\n\t{\r\n\t\tif(elementList.get(instanceID) != null) elementList.set(instanceID, elem);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gere l'enlevement graphique et d'ecoute, l'arret, de l'objet de pooling\r\n\t */\r\n\tpublic function dispose():Void {\r\n\t\t//var lClassName:String = Type.getClassName(Type.getClass(this));\r\n\t\t//PoolManager.addToPool(lClassName.split(\".\").pop(), this);\r\n\t\treleaseElementList();\r\n\t\tremoveAllListeners();\r\n\t\tsetModeVoid();\r\n\t\tif(parent != null) parent.removeChild(this);\r\n\t\tactiveObjectList.remove(this);\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tdispose();\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.aliens;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass Alien extends PoolObject\r\n{\r\n\tpublic static var alienList:Array<Alien> = new Array<Alien>();\r\n\r\n\tpublic static var alienElementList:Array<AlienElement> = new Array<AlienElement>();\r\n\t\r\n\tpublic var level(default, null):Int;\r\n\tpublic var mode(default, null):String;\r\n\tpublic var nomPropre(default, null):String;\r\n\tpublic var idBuilding(default, null):String;\r\n\tpublic var type:Dynamic;\r\n\r\n\tpublic function new(?pAsset:String)\r\n\t{\r\n\t\tsuper(pAsset);\r\n\t}\r\n\t\r\n\r\n\tpublic static function getAlienType(pType:String, pTypes:Array<Dynamic>):Dynamic\r\n\t{\r\n\t\tif (pTypes == null) return null;\r\n\t\tvar data:Dynamic;\r\n\t\tfor (alien in pTypes)\r\n\t\t{\r\n\t\t\tif (alien.name == pType)\r\n\t\t\t{\r\n\t\t\t\tdata = alien;\r\n\t\t\t\treturn data;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t\r\n\tpublic static function countAliensByName(pName:String):Int\r\n\t{\r\n\t\tvar counter:Int = 0;\r\n\t\tfor (alien in alienElementList) \r\n\t\t{\r\n\t\t\tif (alien.name == pName) counter++;\r\n\t\t}\r\n\t\treturn counter;\r\n\t}\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.ui.popin.Confirm;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.AlienTypes.AlienForeurTypes;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SpecialFeatureAliens extends Alien\r\n{\r\n\tpublic var SELECTED_STATE(default, never):String = \"Selected\";\r\n\tpublic var NORMAL_STATE(default, never):String = \"\";\r\n\t\r\n\tpublic var positionInGrid:Point = new Point(0, 0);\r\n\tpublic var alienID:Int;\r\n\tpublic var alienName:String;\r\n\tpublic var alienType:String;\r\n\tpublic var stamina:Int;\r\n\tpublic var maxStamina:Int;\r\n\tpublic var bombNumber:Int = 0;\r\n\tpublic var powerRange:Int = 2;\r\n\t\r\n\tpublic static var speFeatTypes:Array<AlienForeurTypes> = new Array<AlienForeurTypes>();\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\t\r\n\t}\r\n\t\r\n\tpublic function getAssetName():String{\r\n\t\treturn assetName;\r\n\t}\r\n\t\r\n\tpublic function changeAssetName(pName:String):Void\r\n\t{\r\n\t\tassetName = pName;\r\n\t}\r\n\t\r\n\tpublic function changeAsset(pState:String, ?pAutoPlay:Bool = true):Void \r\n\t{\t\r\n\t\tif (pState != SELECTED_STATE) pState = NORMAL_STATE;\r\n\t\telse pState == SELECTED_STATE;\r\n\t\tsetState(pState, true, pAutoPlay);\r\n\t}\r\n\t\r\n\tpublic static function loadTypes(pTypes:Dynamic):Void \r\n\t{\r\n\t\tspeFeatTypes = pTypes;\r\n\t}\r\n\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tsuper.destroy();\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.aliens;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass AlienType extends SpecialFeatureAliens\r\n{\r\n\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tstate = \"1_Normal\";\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.aliens;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Bomber extends SpecialFeatureAliens\r\n{\r\n\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tmaxStamina = 4;\r\n\t\tbombNumber = 4;\r\n\t\tstamina = maxStamina;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.aliens;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Driller extends SpecialFeatureAliens\r\n{\r\n\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tmaxStamina = 10;\r\n\t\tstamina = maxStamina;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.aliens;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Healer extends SpecialFeatureAliens\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tmaxStamina = 8;\r\n\t\tstamina = maxStamina;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.aliens;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Tank extends SpecialFeatureAliens\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tmaxStamina = 6;\r\n\t\tstamina = maxStamina;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport cloudkid.Emitter;\r\nimport com.greensock.TweenMax;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGridManager.Vector3;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.utils.ParticleManager;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager.RessourcesEffectParams;\r\nimport com.isartdigital.ruby.utils.SmartShaker;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport haxe.Json;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFAliensEventManager\r\n{\r\n\tpublic var currentMode:String = \"\";\r\n\tpublic var delay:Float = 0;\r\n\r\n\t/**\r\n\t * instance unique de la classe SpecialFeatureManager\r\n\t */\r\n\tprivate static var instance: SFAliensEventManager;\r\n\t\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Check le current mode (Move,Skill) et lance les bonnes actions\r\n\t */\r\n\tpublic function actions():Void\r\n\t{\r\n\t\tvar lAlien :SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\t\tSFGridManager.getInstance().globalMousePos = SFGridManager.getInstance().getGlobalMouseCoords(SFGameManager.getInstance().ressourcesContainer);\r\n\t\tSFGridManager.getInstance().gridMousePos = SFGridManager.getInstance().getGridCoords(SFGridManager.getInstance().globalMousePos);\r\n\r\n\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien != null)\r\n\t\t{\t\r\n\t\t\tvar lAlienPos:Point = SFGridManager.getInstance().getGridCoords(lAlien.position);\r\n\r\n\t\t\tif (currentMode == SFEventsManager.MODE_MOVE)\r\n\t\t\t{\r\n\t\t\t\tif (SFGridManager.getInstance().checkWallinNextPos(lAlienPos, SFGridManager.getInstance().gridMousePos)) return;\r\n\t\t\t\tif (canMove(SFGridManager.getInstance().gridMousePos)) move();\r\n\t\t\t\telse dig(SFGridManager.getInstance().gridMousePos);\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse if (currentMode == SFEventsManager.MODE_SKILL)\r\n\t\t\t{\r\n\t\t\t\tif (SFAliensManager.getInstance().selectedAlien.alienType == ElementType.ALIEN_BOMBER)\r\n\t\t\t\t{\r\n\t\t\t\t\t\r\n\t\t\t\t\tcanBomb(SFGridManager.getInstance().gridMousePos);\r\n\t\t\t\t}\r\n\t\t\t\tif (SFAliensManager.getInstance().selectedAlien.alienType == ElementType.ALIEN_HEALER)\r\n\t\t\t\t{\r\n\t\t\t\t\tcanHeal(SFGridManager.getInstance().gridMousePos);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFAliensEventManager {\r\n\t\tif (instance == null) instance = new SFAliensEventManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\t/**\r\n\t * Lance le mode move, active le mode propagation du mouvement d'un alien\r\n\t */\r\n\tpublic function setModeMove():Void\r\n\t{\r\n\t\tcurrentMode = SFEventsManager.MODE_MOVE;\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\t\tvar lVector3Array:Array<Vector3>;\r\n\t\tvar lAction:String;\t\r\n\t\t\r\n\t\tlVector3Array =\tSFGridManager.getInstance().getPropagationPath(lAlien.alienType, lAlien.positionInGrid, lAlien.stamina);\r\n\r\n\t\tSFTilesManager.getInstance().removeSpecialTile();\r\n\t\tfor (vector in lVector3Array) \r\n\t\t{\r\n\t\t\tlAction = (lAlien.stamina - vector.z) == 1 ? \"dig\":\"move\";\r\n\t\t\tSFTilesManager.getInstance().addSpecialTile(lAction, new Point(vector.x*SFGridManager.CELL_WIDTH ,vector.y*SFGridManager.CELL_HEIGHT));\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Lance le mode skill, active le mode propagation du skill d'un alien\r\n\t */\r\n\tpublic function setModeSkill():Void\r\n\t{\r\n\t\tcurrentMode = SFEventsManager.MODE_SKILL;\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\t\t\r\n\t\tif (lAlien.alienType == ElementType.ALIEN_TANK\r\n\t\t|| lAlien.alienType == ElementType.ALIEN_DRILLER\r\n\t\t|| (lAlien.alienType == ElementType.ALIEN_BOMBER && lAlien.bombNumber == 0)\r\n\t\t|| (lAlien.alienType == ElementType.ALIEN_HEALER && lAlien.stamina == 0))\r\n\t\t{\r\n\t\t\tsetModeMove();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar lAlienPos:Point = SFGridManager.getInstance().getGridCoords(lAlien.position);\r\n\r\n\t\tvar lTile:Tile;\r\n\t\tvar lSkillTile:Tile;\r\n\t\tvar distance:Int;\r\n\t\tvar counter:Int=0;\r\n\t\t\r\n\t\tSFTilesManager.getInstance().removeSpecialTile();\r\n\t\tvar length:Int = SFTilesManager.getInstance().tileList.length;\r\n\t\tvar tilePos:Point;\r\n\t\t\r\n\t\tfor (j in 0...SFGridManager.COLS) \r\n\t\t{\r\n\t\t\tfor (k in 0...SFGridManager.ROWS) \r\n\t\t\t{\r\n\t\t\t\ttilePos = new Point(j, k);\r\n\t\t\t\tdistance = Math.floor(Math.abs(lAlienPos.x - tilePos.x) + Math.abs(lAlienPos.y - tilePos.y));\r\n\r\n\t\t\t\tif (distance <= lAlien.powerRange)\r\n\t\t\t\t{\r\n\t\t\t\t\tSFTilesManager.getInstance().addSpecialTile(\"skill\", SFGridManager.getInstance().getGlobalGridCoords(tilePos));\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\t/**\r\n\t * Bouge l'alien au clic/tap\r\n\t */\r\n\tprivate function move():Void\r\n\t{\r\n\t\tvar gridMousePos:Point = SFGridManager.getInstance().gridMousePos;\r\n\t\tdelay = 0;\r\n\t\tmoveAtCoord(gridMousePos);\r\n\t}\r\n\t\r\n\r\n\t\r\n\tpublic function moveAtCoord(pTarget:Point):Void\r\n\t{\r\n\t\t//dplace l'alien  la position du clic mais dans le modle de la grille\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\t\tvar newPos:Point = SFGridManager.getInstance().getGlobalGridCoords(SFGridManager.getInstance().getGridCoords(SFGridManager.getInstance().globalMousePos));\r\n\t\tvar jsonList:Array<Dynamic> = SFGridManager.getInstance().jsonGrid[Math.floor(pTarget.x)][Math.floor(pTarget.y)];\r\n\r\n\t\tif (jsonList != null)\r\n\t\t{\t\t\t\r\n\t\t\t//parcour chaque object dans la case clique\r\n\t\t\tfor (object in 0...jsonList.length) \r\n\t\t\t{\t\t\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.ITEM && SFAliensManager.getInstance().isAlienNextToTile(pTarget))\r\n\t\t\t\t{\r\n\t\t\t\t\trewardAnimation(jsonList[object], pTarget);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar lDelay:Float = currentMode == \"dig\" ? 0.2:0; \r\n\t\t//lAlien.position = newPos;\r\n\t\tsetModeMove();\r\n\t\ttrace(delay);\r\n\t\tTweenMax.to(lAlien, 0.2 , {x:newPos.x, y:newPos.y,delay:delay});\r\n\t\tSpecialFeatureScreen.getInstance().updateAlienHud();\r\n\t}\r\n\t\r\n\tprivate function rewardAnimation(pRessource:Dynamic, pTarget:Point):Void\r\n\t{\r\n\t\tvar effectParams:RessourcesEffectParams =\r\n\t\t{\r\n\t\t\toriginalPosition:SFGridManager.getInstance().getGlobalGridCoords(pTarget),\r\n\t\t\tdestinationPosition:SFGameManager.getInstance().rewardContainer.toLocal(SpecialFeatureScreen.getInstance().getRessourceHudPosition(pRessource.type)),\r\n\t\t\twhereToAddchild:SFGameManager.getInstance().rewardContainer,\r\n\t\t\tnumObjectsToInstanciate:20,\r\n\t\t\tduration:1,\r\n\t\t\tsecondsBtwnaddchilds:1,\r\n\t\t\tspeed:0.2,\r\n\t\t\tanimationType:\"dispersionToCurve\",\r\n\t\t\tressource:pRessource.type,\r\n\t\t}\r\n\t\t\r\n\t\tRessourcesEffectManager.getInstance().SetEffect(effectParams);\r\n\t\t\r\n\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"bubble\", [\"bubble\"], 5000);\r\n\t\tlParticle.position = SFGridManager.getInstance().getGlobalGridCoords(pTarget);\r\n\t\tSFGameManager.getInstance().particleContainer.addChild(lParticle);\r\n\r\n\t\t\r\n\t\tSFGameManager.getInstance().giveRewardToPlayer(pRessource.type);\r\n\t\tSFTilesManager.getInstance().removeInTileList(pRessource);\r\n\t}\r\n\t\r\n\r\n\t\r\n\t\t\r\n\t/**\r\n\t * creuse une tile\r\n\t * @param\tpMousePos\r\n\t */\r\n\tprivate function dig(pMousePos:Point):Void\r\n\t{\r\n\t\tvar jsonList:Array<Dynamic> = SFGridManager.getInstance().jsonGrid[Math.floor(pMousePos.x)][Math.floor(pMousePos.y)];\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\r\n\t\tif (!SFAliensManager.getInstance().hasEnoughStamina()) return;\r\n\t\t\r\n\t\tif (jsonList != null)\r\n\t\t{\t\t\t\r\n\t\t\t//parcour chaque object dans la case clique\r\n\t\t\tfor (object in 0...jsonList.length) \r\n\t\t\t{\t\r\n\t\t\t\t// si l'object est un bloc\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.CLUE)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(SFAliensManager.getInstance().isAlienNextToTile(pMousePos)) // si l'alien est  une case  ct du bloc\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"dig\", [\"bloc1\",\"bloc2\",\"bloc3\",\"bloc4\",\"smoke4\"], 5000);\r\n\t\t\t\t\t\tlParticle.position = SFGridManager.getInstance().getGlobalGridCoords(pMousePos);\r\n\t\t\t\t\t\tSFGameManager.getInstance().particleContainer.addChild(lParticle);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar params:ShakerParams =\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toriginalPosition: SpecialFeatureScreen.getInstance().position.clone(),\r\n\t\t\t\t\t\t\tsmoothness:3,\r\n\t\t\t\t\t\t\tamplitude:10,\r\n\t\t\t\t\t\t\tduration:30,\r\n\t\t\t\t\t\t\txQuantity: 0.5,\r\n\t\t\t\t\t\t\tyQuantity: 0.5,\r\n\t\t\t\t\t\t\tfadeOut: 1,\r\n\t\t\t\t\t\t\trandomShake: true,\r\n\t\t\t\t\t\t\tsound:null\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tSmartShaker.getInstance().SetShaker(SpecialFeatureScreen.getInstance(), params);\r\n\t\t\t\t\t\tSoundManager.getSound(\"soundXenosDrillShort\").play();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tSFTilesManager.getInstance().removeInTileList(jsonList[object]);\r\n\t\t\t\t\t\tSFAliensManager.getInstance().decreaseStamina(lAlien);\r\n\t\t\t\t\t\tdelay = 0.1;\r\n\t\t\t\t\t\tmoveAtCoord(pMousePos);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tSpecialFeatureScreen.getInstance().updateAlienHud();\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Vrifie si le joueur peut se dplacer\r\n\t * @param\tpMousePos\r\n\t * @return\r\n\t */\r\n\tprivate function canMove(pMousePos:Point):Bool\r\n\t{\r\n\t\tvar jsonList:Array<Dynamic> = SFGridManager.getInstance().jsonGrid[Math.round(pMousePos.x)][Math.round(pMousePos.y)];\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\r\n\t\tif (!SFAliensManager.getInstance().isAlienNextToTile(pMousePos)) return false;\r\n\r\n\t\tif (jsonList != null)\r\n\t\t{\r\n\t\t\tfor (object in 0...jsonList.length) \r\n\t\t\t{\r\n\r\n\t\t\t\tif(jsonList[object].type.substring(0, 4) == ElementType.LAVA && lAlien.alienType != ElementType.ALIEN_TANK)\r\n\t\t\t\t{\r\n\t\t\t\t   return false;\r\n\t\t\t\t}\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.LAVA && lAlien.alienType == ElementType.ALIEN_TANK)\r\n\t\t\t\t{\r\n\t\t\t\t\tSoundManager.getSound(\"soundTankWalkLava\").play();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.CLUE|| jsonList[object].type.substring(0, 9) == ElementType.HARDBRICK)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Vrifie si le Bomber peut bombarder une zone en fonction de sa stamina disponible\r\n\t * @param\tpTarget\r\n\t * @return\r\n\t */\r\n\tprivate function canBomb(pTarget:Point):Bool\r\n\t{\r\n\t\tvar jsonList:Array<Dynamic> = SFGridManager.getInstance().jsonGrid[Math.floor(pTarget.x)][Math.floor(pTarget.y)];\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\r\n\t\tif (lAlien.bombNumber <=0) return false;\r\n\t\t\r\n\t\tif (jsonList != null)\r\n\t\t{\t\r\n\r\n\t\t\t\r\n\t\t\tfor (object in 0...jsonList.length) \r\n\t\t\t{\t\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.ITEM)\r\n\t\t\t\t{\r\n\t\t\t\t\trewardAnimation(jsonList[object], pTarget);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (SFTilesManager.getInstance().isTileInRange(pTarget) &&\r\n\t\t\t\t(jsonList[object].type.substring(0, 4) == ElementType.CLUE ||\r\n\t\t\t\tjsonList[object].type.substring(0, 9) == ElementType.HARDBRICK))\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tvar params:ShakerParams =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toriginalPosition: SpecialFeatureScreen.getInstance().position.clone(),\r\n\t\t\t\t\t\tsmoothness:7,\r\n\t\t\t\t\t\tamplitude:15,\r\n\t\t\t\t\t\tduration:30,\r\n\t\t\t\t\t\txQuantity: 0.5,\r\n\t\t\t\t\t\tyQuantity: 0.5,\r\n\t\t\t\t\t\tfadeOut: 1,\r\n\t\t\t\t\t\trandomShake: true,\r\n\t\t\t\t\t\tsound:null\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tSmartShaker.getInstance().SetShaker(SpecialFeatureScreen.getInstance(), params);\t\r\n\r\n\t\t\t\t\tSoundManager.getSound(\"soundXenosBomberPower\").play();\r\n\r\n\t\t\t\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"dig\", [\"bloc1\",\"bloc2\",\"bloc3\",\"bloc4\",\"smoke4\"], 5000);\r\n\t\t\t\t\tlParticle.position = SFGridManager.getInstance().getGlobalGridCoords(pTarget);\r\n\t\t\t\t\tSFGameManager.getInstance().particleContainer.addChild(lParticle);\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar lParticle2:Container = ParticleManager.getInstance().createParticle(\"bomb\", [\"bloc1\",\"bloc2\",\"bloc3\",\"bloc4\",\"smoke4\"], 5000);\r\n\t\t\t\t\tlParticle2.position = SFGridManager.getInstance().getGlobalGridCoords(pTarget);\r\n\t\t\t\t\tSFGameManager.getInstance().particleContainer.addChild(lParticle2);\r\n\t\t\t\t\t\r\n\t\t\t\t\tSFTilesManager.getInstance().removeInTileList(jsonList[object]);\r\n\t\t\t\t\tjsonList[object].type = \"destroyed\";\r\n\t\t\t\t\tlAlien.bombNumber--;\r\n\t\t\t\t\tsetModeSkill();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\t\t\r\n\r\n\t/**\r\n\t * Vrifie si le Healer peut donner de la stamina  tous les aliens d'une zone une zone en fonction de sa stamina disponible\r\n\t * @param\tpTarget\r\n\t * @return\r\n\t */\r\n\tprivate function canHeal(pTarget:Point):Bool\r\n\t{\r\n\t\tvar result:Bool = false;\r\n\t\tvar lPos:Point;\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\r\n\t\tif (lAlien.stamina > 0)\r\n\t\t{\r\n\t\t\tfor (alien in SFAliensManager.getInstance().activatedAlienList) \r\n\t\t\t{\r\n\t\t\t\tlPos = SFGridManager.getInstance().getGridCoords(alien.position);\r\n\t\t\t\tif (lPos.x == pTarget.x && lPos.y == pTarget.y)\r\n\t\t\t\t{\r\n\t\t\t\t\tSFAliensManager.getInstance().increaseStamina(1, alien);\r\n\t\t\t\t\tSpecialFeatureScreen.getInstance().updateAlienHud();\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif (result)\r\n\t\t\t{\r\n\t\t\t\tSFAliensManager.getInstance().decreaseStamina(lAlien);\r\n\t\t\t\tSpecialFeatureScreen.getInstance().updateAlienHud();\r\n\t\t\t\tSoundManager.getSound(\"soundXenosHealerPower\").play();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse return false;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tsetModeMove();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}\t\r\n\t\r\n\t\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t\r\n\t\t//suppression de l'couteur de clic\r\n\t}\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.AlienSpawn;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFAliensManager\r\n{\r\n\r\n\t\r\n\tpublic var inactiveAlienList:Array<SpecialFeatureAliens> = new Array<SpecialFeatureAliens>();\r\n\tpublic var activatedAlienList:Array<SpecialFeatureAliens> = new Array<SpecialFeatureAliens>();\r\n\t\r\n\tpublic var selectedAlien:SpecialFeatureAliens;\r\n\t\r\n\tpublic static inline var TANK_CLASSNAME:String = ElementType.ALIEN_TANK;\r\n\tpublic static inline var BOMBER_CLASSNAME:String = ElementType.ALIEN_BOMBER;\r\n\tpublic static inline var HEALER_CLASSNAME:String = ElementType.ALIEN_HEALER;\r\n\tpublic static inline var DRILLER_CLASSNAME:String = ElementType.ALIEN_DRILLER;\r\n\t\r\n\t\r\n\tprivate static var instance: SFAliensManager;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFAliensManager {\r\n\t\tif (instance == null) instance = new SFAliensManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * fonction d'initialisation des aliens\r\n\t * @param\tpList liste d'alienElement\r\n\t */\r\n\tpublic function initAliensList(pList:Array<AlienElement>):Void\r\n\t{\r\n\r\n\t\tvar lAlien:SpecialFeatureAliens = null;\r\n\t\tvar lAlienNameLength:Int;\r\n\t\tvar lAlienId:Int;\r\n\t\tfor (alien in pList)\r\n\t\t{\r\n\t\t\tif (alien != null)\r\n\t\t\t{\r\n\t\t\t\tlAlienNameLength = alien.name.length;\t\r\n\t\t\t\tlAlienId = Std.parseInt(alien.name.substring(lAlienNameLength - 1));\r\n\t\t\t\tlAlien = cast(PoolManager.getFromPool(alien.carac.power+lAlienId), SpecialFeatureAliens);\r\n\t\t\t\t//lAlien.powerRange = alien.carac.range;\r\n\t\t\t\tlAlien.alienID = lAlienId;\r\n\t\t\t\tlAlien.alienType = alien.carac.power;\r\n\t\t\t\tlAlien.alienName = alien.carac.name;\r\n\t\t\t\tlAlien.stamina = alien.carac.stamina;\r\n\t\t\t\tlAlien.maxStamina = lAlien.stamina;\r\n\t\t\t\tinactiveAlienList.push(lAlien);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * Initilaisation de l'alien\r\n\t * @param\tpX\r\n\t * @param\tpY\r\n\t */\r\n\tpublic function instanciateAlien():Void\r\n\t{\r\n\t\tif (inactiveAlienList.length == 0) return;\r\n\t\t\r\n\t\tvar lAlien:SpecialFeatureAliens=null;\r\n\t\tfor (tile in SFTilesManager.getInstance().tileList)\r\n\t\t{\r\n\t\t\tif (Std.is(tile, AlienSpawn) && inactiveAlienList.length > 0)\r\n\t\t\t{\r\n\t\t\t\tlAlien = inactiveAlienList.shift();\r\n\t\t\t\tlAlien.x = tile.x;\r\n\t\t\t\tlAlien.y = tile.y;\r\n\t\t\t\tlAlien.positionInGrid = tile.positionInGrid;\t\r\n\t\t\t\t\r\n\t\t\t\tactivatedAlienList.push(lAlien);\r\n\r\n\t\t\t\tSFGameManager.getInstance().alienContainer.addChild(lAlien);\r\n\t\t\t\tlAlien.start();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renvoie un string avec le Type d'alien\r\n\t * @param\tpIndex\r\n\t * @return\r\n\t */\r\n\tpublic function getAlienType(pIndex:Int):String\r\n\t{\r\n\t\tif (pIndex > activatedAlienList.length - 1)\r\n\t\t{\r\n\t\t\treturn \"NO TYPE\";\r\n\t\t}\r\n\t\treturn activatedAlienList[pIndex].alienType;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renvoie un string avec le Nom d'un alien\r\n\t * @param\tpIndex\r\n\t * @return\r\n\t */\r\n\tpublic function getAlienName(pIndex:Int):String\r\n\t{\r\n\t\tif (pIndex > activatedAlienList.length - 1)\r\n\t\t{\r\n\t\t\treturn \"NO NAME\";\r\n\t\t}\r\n\t\treturn activatedAlienList[pIndex].nomPropre;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renvoie la current stamina d'un alien\r\n\t * @param\tpIndex\r\n\t * @return\r\n\t */\r\n\tpublic function getStamina(pIndex:Int):Int\r\n\t{\r\n\t\t\r\n\t\treturn activatedAlienList[pIndex].stamina;\r\n\t}\r\n\r\n\tpublic function getMaxStamina(pIndex:Int):Int\r\n\t{\r\n\t\treturn activatedAlienList[pIndex].maxStamina;\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * Vrifie si l'alien se trouve sur une case  ct de la case qu'il veut creuser\r\n\t * @param\tpMousePos\r\n\t * @return\r\n\t */\r\n\tpublic function isAlienNextToTile(pMousePos:Point):Bool\r\n\t{\r\n\t\tvar lAlienPos:Point = SFGridManager.getInstance().getGridCoords(selectedAlien.position);\r\n\t\t\r\n\t\tif (Math.abs(lAlienPos.x - pMousePos.x) + Math.abs(lAlienPos.y - pMousePos.y) == 1) return true;\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * vrifie que l'alien dispose d'assez de stamina\r\n\t * @return\r\n\t */\r\n\tpublic function hasEnoughStamina():Bool\r\n\t{\r\n\t\tif (selectedAlien.stamina <= 0)\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * enlve un point de stamina pour l'alien en paramtre\r\n\t * @param\tpAlien\r\n\t */\r\n\tpublic function decreaseStamina(pAlien:SpecialFeatureAliens):Void\r\n\t{\r\n\t\tpAlien.stamina--;\r\n\t\tSpecialFeatureScreen.getInstance().updateRessourceHud();\r\n\r\n\t\tif(!SFGameManager.getInstance().checkIfAliensStillHasStamina())\r\n\t\t{\r\n\t\t\t//SpecialFeatureScreen.getInstance().closeFlag = true;\r\n\t\t\tSFGameManager.getInstance().openEndMissionPoppin();\r\n\t\t\tSpecialFeatureScreen.getInstance().onClose();\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\t\r\n\t\r\n\t/**\r\n\t * ajoute pAmount de stamina \r\n\t * @param\tpAmount\r\n\t * @param\tpAlien\r\n\t */\r\n\tpublic function increaseStamina(pAmount:Int, pAlien:SpecialFeatureAliens):Void\r\n\t{\r\n\t\tpAlien.stamina += pAmount;\r\n\t\tpAlien.stamina = Math.floor(Math.min(pAlien.stamina, pAlien.maxStamina));\r\n\t\tSpecialFeatureScreen.getInstance().updateRessourceHud();\r\n\t}\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t\r\n\t\t//suppression de l'couteur de clic\r\n\t}\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.utils.ColorFilterManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFEventsManager \r\n{\r\n\tpublic static inline var MODE_MOVE:String = \"Move\";\r\n\tpublic static inline var MODE_SKILL:String = \"Skill\";\r\n\tprivate var oldAlien:SpecialFeatureAliens;\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe SpecialFeatureManagerEvents\r\n\t */\r\n\tprivate static var instance: SFEventsManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFEventsManager {\r\n\t\tif (instance == null) instance = new SFEventsManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Fonction Callback qui gre les events de selection d'aliens par le Hud \r\n\t * @param\tpAlienIndex\r\n\t * @param\tpMode\r\n\t */\r\n\tpublic function selectAlienOnHud(pAlienIndex:Int, pMode:String):Void\r\n\t{\r\n\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien != null)\r\n\t\t{\t\t\t\r\n\t\t\tSFGameManager.getInstance().tileContainer.off(MouseEventType.CLICK,SFAliensEventManager.getInstance().actions);\r\n\t\t\tSFGameManager.getInstance().tileContainer.off(TouchEventType.TAP,SFAliensEventManager.getInstance().actions);\r\n\t\t}\r\n\t\t\r\n\t\tif (oldAlien != null)\r\n\t\t{\r\n\t\t\toldAlien.changeAssetName(oldAlien.alienType+Std.string(oldAlien.alienID));\r\n\t\t\toldAlien.changeAsset(\"Normal\");\r\n\t\t}\r\n\t\t\r\n\t\tSFAliensManager.getInstance().selectedAlien = SFAliensManager.getInstance().activatedAlienList[pAlienIndex];\r\n\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien.alienType == ElementType.ALIEN_BOMBER) SoundManager.getSound(\"soundPlayerChooseXenosBomber\").play();\t\t\t\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien.alienType  == ElementType.ALIEN_DRILLER) SoundManager.getSound(\"soundPlayerChooseXenosForeur\").play();\t\t\t\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien.alienType  == ElementType.ALIEN_HEALER) SoundManager.getSound(\"soundPlayerChooseXenosHealer\").play();\t\t\t\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien.alienType  == ElementType.ALIEN_TANK) SoundManager.getSound(\"soundPlayerChooseXenosTank\").play();\t\t\t\t\t\r\n\t\t\r\n\t\t\r\n\t\toldAlien = SFAliensManager.getInstance().selectedAlien;\r\n\t\tSFAliensManager.getInstance().selectedAlien.changeAssetName(SFAliensManager.getInstance().selectedAlien.alienType+Std.string(SFAliensManager.getInstance().selectedAlien.alienID));\r\n\t\tSFAliensManager.getInstance().selectedAlien.changeAsset(\"Selected\");\r\n\t\t\r\n\t\tif (SFAliensManager.getInstance().selectedAlien != null)\r\n\t\t{\r\n\t\t\tif (pMode == MODE_MOVE) SFAliensEventManager.getInstance().setModeMove();\r\n\t\t\tif (pMode == MODE_SKILL) SFAliensEventManager.getInstance().setModeSkill();\r\n\t\t\tSFGameManager.getInstance().tileContainer.on(MouseEventType.CLICK,SFAliensEventManager.getInstance().actions);\r\n\t\t\tSFGameManager.getInstance().tileContainer.on(TouchEventType.TAP, SFAliensEventManager.getInstance().actions);\t\t\t\r\n\t\t\r\n\t\t}\r\n\t\telse{\t\t\r\n\t\t\tSFGameManager.getInstance().tileContainer.off(MouseEventType.CLICK,SFAliensEventManager.getInstance().actions);\r\n\t\t\tSFGameManager.getInstance().tileContainer.off(TouchEventType.TAP,SFAliensEventManager.getInstance().actions);\r\n\t\t}\r\n\t\t\r\n\t\tvar params:ColorFilterParams =\r\n\t\t{\r\n\t\t\tcolorToApply:\"orange\",\r\n\t\t\tcolorAmount:1,\r\n\t\t\tduration:1\r\n\t\t}\r\n\t\tColorFilterManager.getInstance().applyFilter(SFAliensManager.getInstance().selectedAlien, params);\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGridManager.Vector3;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFAliensManager;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Clue;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.HardBrick;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.SpecialFeatureItem;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Lava;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.translationClass.Schemas;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.RewardNotifications;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.Missions;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.ruby.utils.ColorFilterManager;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport haxe.Json;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\n\r\n\r\n\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFGameManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe SpecialFeatureManager\r\n\t */\r\n\tprivate static var instance: SFGameManager;\r\n\r\n\tpublic static inline var TOTAL_MAPS:Int = 78;\r\n\r\n\tpublic var missionParam:Missions;\r\n\tpublic var currentMap:Int = 1;\r\n\tpublic var rewardHC:Int;\r\n\tpublic var rewardSC:Int;\r\n\tpublic var rewardGene1:Int;\r\n\tpublic var rewardGene2:Int;\r\n\tpublic var rewardGene3:Int;\r\n\tpublic var rewardGene4:Int;\r\n\tpublic var rewardGene5:Int;\r\n\tpublic var rewardSchema:Int = 0;\r\n\tpublic var rewardDarkMatter:Int;\r\n\t\r\n\tpublic var tileContainer:SmartComponent;\r\n\tpublic var globalContainer:Container = new Container();\r\n\tpublic var particleContainer:Container = new Container();\r\n\tpublic var rewardContainer:Container = new Container();\r\n\tpublic var alienContainer:Container = new Container();\r\n\tpublic var wallsContainer:Container = new Container();\r\n\tpublic var skillContainer:Container = new Container();\r\n\tpublic var moveContainer:Container = new Container();\t\r\n\tpublic var blocsContainer:Container = new Container();\t\r\n\tpublic var ressourcesContainer:Container = new Container();\r\n\tpublic var alienSpawnNumber:Int;\r\n\t\r\n\tpublic var collectedReward:Reward;\r\n\t\r\n\tpublic var xenoList:Array<AlienElement> = [];\r\n\r\n\r\n\tpublic var isInit:Bool = false;\r\n\t\t\r\n\r\n\t\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFGameManager {\r\n\t\tif (instance == null) instance = new SFGameManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\r\n\t/**\r\n\t * Initialisation de la spciale feature\r\n\t * (init de la current map, des aliens, gnration de la grille, du hud, ...)\r\n\t * @param\tpMission numro de la map  charger\r\n\t * @param\tpXenoList liste d'alien  charger dans la special feature\r\n\t */\r\n\tpublic function init(pMission:Missions, pXenoList:Array<AlienElement>):Void\r\n\t{\r\n\t\tinitReward();\r\n\t\tGameManager.getInstance().setModeSpecial();\r\n\t\tSoundManager.getSound(\"soundAtmosphere\").stop();\r\n\t\tSoundManager.getSound(\"soundMusicSpecialFeature\").play();\r\n\t\tmissionParam = pMission;\r\n\t\txenoList = pXenoList;\r\n\t\tcurrentMap = Std.parseInt(missionParam.map);\r\n\t\talienSpawnNumber = missionParam.alienSpawner;\r\n\r\n\t\t\r\n\t\tif (isInit) return;\r\n\t\telse isInit = true;\r\n\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tUIManager.getInstance().closeHud();\r\n\t\tUIManager.getInstance().openScreen(SpecialFeatureScreen.getInstance());\r\n\t\t\t\t\r\n\t\tSFGridManager.getInstance().generateGrid();\r\n\t\tSFAliensManager.getInstance().initAliensList(pXenoList);\r\n\t\tSFAliensManager.getInstance().instanciateAlien();\r\n\t\tSpecialFeatureScreen.getInstance().initContainers();\r\n\t\t\r\n\r\n\t\ttileContainer = SpecialFeatureScreen.getInstance().tilesContainer;\r\n\t\tvar tileContainerPosition:Point = new Point\r\n\t\t\t\t(\r\n\t\t\t\t\ttileContainer.position.x - (tileContainer.width / 2) + (SFGridManager.CELL_WIDTH)-5, \r\n\t\t\t\t\ttileContainer.position.y - (tileContainer.height/ 2) + (SFGridManager.CELL_HEIGHT / 2)-5\r\n\t\t\t\t);\r\n\t\t\t\t\r\n\t\trewardContainer.position = tileContainerPosition;\r\n\t\tparticleContainer.position = tileContainerPosition;\r\n\t\talienContainer.position = tileContainerPosition;\t\t\r\n\t\twallsContainer.position = tileContainerPosition;\t\t\r\n\t\tskillContainer.position = tileContainerPosition;\t\t\r\n\t\tmoveContainer.position = tileContainerPosition;\t\t\r\n\t\tblocsContainer.position = tileContainerPosition;\t\t\r\n\t\tressourcesContainer.position = tileContainerPosition;\r\n\t\t\r\n\t\ttileContainer.addChild(ressourcesContainer);\r\n\t\ttileContainer.addChild(blocsContainer);\t\r\n\t\ttileContainer.addChild(moveContainer);\t\r\n\t\ttileContainer.addChild(skillContainer);\t\t\r\n\t\ttileContainer.addChild(wallsContainer);\r\n\t\ttileContainer.addChild(particleContainer);\r\n\t\ttileContainer.addChild(alienContainer);\r\n\t\ttileContainer.addChild(rewardContainer);\r\n\t\t\r\n\t\ttileContainer.interactive = true;\r\n\r\n\t\tSpecialFeatureScreen.getInstance().initHud();\r\n\t\tSpecialFeatureScreen.getInstance().updateRessourceHud();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initReward():Void\r\n\t{\r\n\t\tcollectedReward = {\r\n\t\t\r\n\t\t\thc:0,\r\n\t\t\tsc:0,\r\n\t\t\tgene1:0,\r\n\t\t\tgene2:0,\r\n\t\t\tgene3:0,\r\n\t\t\tgene4:0,\r\n\t\t\tgene5:0,\r\n\t\t\tschema:0,\r\n\t\t\tdarkMatter:0\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tpublic function checkIfAliensStillHasStamina():Bool\r\n\t{\r\n\t\tSpecialFeatureScreen.getInstance().closeFlag = true;\r\n\t\tvar haveStamina:Bool = false;\r\n\t\tfor (alien in SFAliensManager.getInstance().activatedAlienList)\r\n\t\t{\r\n\t\t\t//alien.stamina = 0;\r\n\t\t\tif (alien.stamina > 0) {\r\n\t\t\t\thaveStamina = true;\r\n\t\t\t\treturn haveStamina;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\thaveStamina = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn haveStamina;\r\n\t}\r\n\t\r\n\tpublic function openEndMissionPoppin():Void\r\n\t{\r\n\t\tRewardNotifications.getInstance().initMissionEnd(collectedReward, xenoList);\r\n\t\tUIManager.getInstance().openPopin(RewardNotifications.getInstance());\r\n\t\tSoundManager.getSound(\"soundMissionEnd\").play();\r\n\t\r\n\t}\r\n\r\n\t/**\r\n\t * Donne des ressources au player et update le hud\r\n\t * @param\tpRewardType\r\n\t */\r\n\tpublic function giveRewardToPlayer(pRewardType:String):Void\r\n\t{\r\n\t\tif (pRewardType == ElementType.ITEM_GENEONE)\r\n\t\t{\r\n\t\t\trewardGene1 = Std.int(missionParam.rewards.gene1);\t\t\t\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardGene1, \"gene1\");\r\n\t\t\tcollectedReward.gene1 += rewardGene1;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_GENETWO)\r\n\t\t{\r\n\t\t\trewardGene2 = Std.int(missionParam.rewards.gene2);\t\t\t\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardGene2, \"gene2\");\r\n\t\t\tcollectedReward.gene2 += rewardGene2;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_GENETHREE)\r\n\t\t{\r\n\t\t\trewardGene3 = Std.int(missionParam.rewards.gene3);\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardGene3, \"gene3\");\r\n\t\t\tcollectedReward.gene3 += rewardGene3;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_GENEFOUR)\r\n\t\t{\r\n\t\t\trewardGene4 = Std.int(missionParam.rewards.gene4);\t\t\t\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardGene4, \"gene4\");\r\n\t\t\tcollectedReward.gene4 += rewardGene4;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_GENEFIVE)\r\n\t\t{\r\n\t\t\trewardGene5 = Std.int(missionParam.rewards.gene5);\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardGene5, \"gene5\");\r\n\t\t\tcollectedReward.gene5 += rewardGene5;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_DARKMATTER)\r\n\t\t{\r\n\t\t\trewardDarkMatter = Std.int(missionParam.rewards.darkMatter);\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardDarkMatter, \"ressource\");\r\n\t\t\tcollectedReward.darkMatter += rewardDarkMatter;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_HC)\r\n\t\t{\r\n\t\t\trewardHC = Std.int(missionParam.rewards.hc);\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardHC, \"hardCurrency\");  \r\n\t\t\tcollectedReward.hc += rewardHC;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_SC)\r\n\t\t{\r\n\t\t\trewardSC = Std.int(missionParam.rewards.sc);\r\n\t\t\tPlayer.getInstance().changePlayerValue(rewardSC, \"softCurrency\"); \r\n\t\t\tcollectedReward.sc += rewardSC;\r\n\t\t}\r\n\t\tif (pRewardType == ElementType.ITEM_BLUEPRINT)\r\n\t\t{\r\n\t\t\tgiveLockedSchema();\r\n\t\t\tSpecialFeatureScreen.getInstance().playerSchema++;\r\n\t\t\tcollectedReward.schema++;\t \r\n\t\t}\r\n\t\tSpecialFeatureScreen.getInstance().updateRessourceHud();\r\n\t}\r\n\r\n\r\n\tpublic function giveLockedSchema():Void\r\n\t{\r\n\t\tvar schemaJson:Dynamic = GameLoader.getContent(\"schemas.json\");\r\n\t\tDataManager.getInstance().addSchema(Std.int(Reflect.field(schemaJson, Std.string(currentMap))));\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.AlienType;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.AlienSpawn;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Clue;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.HardBrick;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.SpecialFeatureItem;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Lava;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Walls;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport haxe.Json;\r\nimport haxe.ds.Vector;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\n\r\ntypedef Vector3 =\r\n{\r\n\tvar x:Int;\r\n\tvar y:Int;\r\n\tvar z:Int;\r\n}\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFGridManager \r\n{\r\n\r\n\tpublic static inline var COLS : Int = 9;\r\n\tpublic static inline var ROWS : Int = 5;\r\n\tpublic static inline var PROPAGATION_COLS:Int = COLS * 2 - 1;\r\n\tpublic static inline var PROPAGATION_ROWS:Int = ROWS * 2 - 1;\r\n\tpublic static inline var CELL_WIDTH : Int = 200;\r\n\tpublic static inline var CELL_HEIGHT : Int = 150;\r\n\t\r\n\tprivate static inline var ALIEN_CLASSNAME:String = \"Alien\";\r\n\tprivate static inline var ALIEN_TYPE_CLASSNAME:String = \"AlienType\";\r\n\t\r\n\tprivate static inline var JSON_MAP_PATH:String = \"specialFeatureMaps/Map\";\r\n\tprivate static inline var JSON_EXTENSION:String = \".json\";\r\n\t\r\n\tpublic var propagationGrid:Array<Array<Int>>;\r\n\tprivate var propagationPath:Array<Vector3>;\r\n\tpublic var jsonGrid:Array<Array<Array<Dynamic>>>;\r\n\r\n\t\r\n\tpublic var globalMousePos:Point;\r\n\tpublic var gridMousePos:Point;\r\n\t\r\n\t/*public var multiAssetNameList:Array<String> = [\r\n\t\tElementType.LAVA,\r\n\t\tElementType.CLUE_EMPTY,\r\n\t\tElementType.CLUE_RESSOURCE,\r\n\t\tElementType.CLUE_BLUEPRINT,\r\n\t\tElementType.HARDBRICK];*/\r\n\t\r\n\tpublic static var jSon:Json;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Grid\r\n\t */\r\n\tprivate static var instance: SFGridManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFGridManager {\r\n\t\tif (instance == null) instance = new SFGridManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\r\n\t}\r\n\t\r\n\t\t\r\n\r\n\t/**\r\n\t * Initialise la grille logique et la grille de propagation (pathfinding pour le mode skill et le mode move) avec des tableaux vides\r\n\t */\r\n\tpublic function initGrid():Void\r\n\t{\r\n\r\n\r\n\t\tjsonGrid = new Array<Array<Array<Dynamic>>>();\r\n\t\tfor (x in 0...COLS) \r\n\t\t{\r\n\t\t\tvar lArrayCols:Array<Array<Dynamic>> = new Array<Array<Dynamic>>();\r\n\t\t\t\r\n\t\t\tfor (y in 0...ROWS) \r\n\t\t\t{\r\n\t\t\t\tvar lArrayRows:Array<Dynamic> = new Array<Dynamic>();\r\n\t\t\t\tlArrayCols.push(lArrayRows);\r\n\t\t\t}\r\n\t\t\tjsonGrid.push(lArrayCols);\r\n\t\t}\r\n\t\t\r\n\t\tpropagationGrid = new Array<Array<Int>>();\r\n\t\r\n\t\tfor (x in 0...PROPAGATION_COLS) \r\n\t\t{\r\n\t\t\tpropagationGrid.push(new Array<Int>());\r\n\t\t\tfor (y in 0...PROPAGATION_ROWS) \r\n\t\t\t{\r\n\t\t\t\t//si les deux sont impairs a retourne 1 (pour viter les dplacements en diagonales\r\n\t\t\t\t// dans la grille logique ddouble\r\n\t\t\t\tpropagationGrid[x].push(-1 *(x % 2) * (y % 2));\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Lis le json (specialFeatureMap) et remplie la grille logique avec les bons lements\r\n\t */\r\n\tpublic function initJsonGrid():Void\r\n\t{\t\r\n\r\n\t\tvar lInstance:Dynamic;\r\n\t\tvar lType:String = null;\r\n\t\tvar lX: Int;\r\n\t\tvar lY: Int;\r\n\t\tvar globalX:Int;\r\n\t\tvar globalY:Int;\r\n\t\tvar lElement:Element;\r\n\t\tvar lIndex:Int;\r\n\t\r\n\t\tfor (object in Reflect.fields(jSon)) \r\n\t\t{\r\n\t\t\tlInstance = Reflect.field(jSon, object);\r\n\r\n\t\t\tlType = Reflect.field(lInstance, \"type\");\r\n\t\t\tlX = Std.int(Reflect.field(lInstance, \"x\"));// - 1;\r\n\t\t\tlY = Std.int(Reflect.field(lInstance, \"y\"));// - 1;\r\n\t\t\tglobalX = Std.int(Reflect.field(lInstance, \"globalX\"));\r\n\t\t\tglobalY = Std.int(Reflect.field(lInstance, \"globalY\"));\r\n\t\t\tlIndex = Std.int(Reflect.field(lInstance, \"index\"));\r\n\t\t\t\r\n\t\t\tlElement = \r\n\t\t\t{ \r\n\t\t\t\tinstanceID : lType,\r\n\t\t\t\ttype : lType,\r\n\t\t\t\twidth : CELL_WIDTH, \r\n\t\t\t\theight : CELL_HEIGHT, \r\n\t\t\t\tx : lX,\r\n\t\t\t\ty : lY,\r\n\t\t\t\tglobalX : lX*CELL_WIDTH,\r\n\t\t\t\tglobalY : lY * CELL_HEIGHT,\r\n\t\t\t\tindex : lIndex,\r\n\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif (jsonGrid[lX] == null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (jsonGrid[lX][lY] != null) jsonGrid[lX][lY].push(lElement);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * gnre la grille de la special feature en fonction du contenu du Json\r\n\t * @return\r\n\t */\r\n\tpublic function generateGrid():Void\r\n\t{\r\n\t\tvar lTile:Tile=null;\r\n\t\tvar lTileType:String;\r\n\r\n\t\tjSon = GameLoader.getContent(JSON_MAP_PATH+SFGameManager.getInstance().currentMap+JSON_EXTENSION);\r\n\r\n\t\tinitGrid();\r\n\t\tinitJsonGrid();\r\n\t\tfor (x in 0...COLS) \r\n\t\t{\r\n\t\t\tfor (y in 0...ROWS)\r\n\t\t\t{\r\n\t\t\t\tfor (object in 0...jsonGrid[x][y].length) \r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tlTile = cast(PoolManager.getFromPool(jsonGrid[x][y][object].type), Tile);\r\n\t\t\t\t\tlTile.type = jsonGrid[x][y][object].type;\r\n\t\t\t\t\tlTile.index = jsonGrid[x][y][object].index;\r\n\t\t\t\t\tlTile.x = jsonGrid[x][y][object].globalX;\r\n\t\t\t\t\tlTile.y = jsonGrid[x][y][object].globalY;\r\n\t\t\t\t\tlTile.positionInGrid = new Point(x, y);\r\n\t\t\t\t\t\r\n\t\t\t\t\taddTileInRightContainer(lTile);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gnre la grille (ddouble) de propagation\r\n\t * @param\tpAlienType\r\n\t */\r\n\tpublic function generatePropagationGrid(pAlienType:String):Void\r\n\t{\r\n\t\tvar lCell:Array<Dynamic>;\r\n\r\n\t\tfor (x in 0...PROPAGATION_COLS) \r\n\t\t{\r\n\t\t\tfor (y in 0...PROPAGATION_ROWS) \r\n\t\t\t{\r\n\t\t\t\tpropagationGrid[x][y] = -1 * (x % 2) * (y % 2);\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (x in 0...COLS) \r\n\t\t{\r\n\t\t\tfor (y in 0...ROWS) \r\n\t\t\t{\r\n\t\t\t\tlCell = jsonGrid[x][y];\r\n\t\t\t\tfor (object in lCell) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (object.type.substring(0, 4) == ElementType.CLUE) propagationGrid[2 * x][2 * y] = 1;\r\n\t\t\t\t\telse if (object.type == ElementType.WALL_BOT) \tpropagationGrid[2 * x][2 * y + 1] = -1; \t\r\n\t\t\t\t\telse if (object.type == ElementType.WALL_TOP) \tpropagationGrid[2 * x][2 * y - 1] = -1;\r\n\t\t\t\t\telse if (object.type == ElementType.WALL_LEFT) \tpropagationGrid[2 * x - 1][2 * y] = -1;\r\n\t\t\t\t\telse if (object.type == ElementType.WALL_RIGHT)\tpropagationGrid[2 * x + 1][2 * y] = -1;\r\n\t\t\t\t\telse if (object.type == ElementType.HARDBRICK) propagationGrid[2 * x][2 * y] = -1;\r\n\t\t\t\t\telse if (object.type == ElementType.LAVA)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (pAlienType == ElementType.ALIEN_TANK) propagationGrid[2 * x][2 * y] = 0;\r\n\t\t\t\t\t\telse propagationGrid[2 * x][2 * y] = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Push chaque tile dans leur bon container graphique\r\n\t * @param\tpTile\r\n\t */\r\n\tpublic function addTileInRightContainer(pTile:Tile):Void\r\n\t{\r\n\t\tif (Std.is(pTile, AlienSpawn))\r\n\t\t{\r\n\t\t\tpTile.start();\r\n\t\t\tSFTilesManager.getInstance().tileList.push(pTile);\r\n\t\t\tSFGameManager.getInstance().wallsContainer.addChild(pTile);\r\n\t\t}\r\n\t\tif (Std.is(pTile, Walls)|| Std.is(pTile, Lava))\r\n\t\t{\r\n\t\t\tpTile.start();\r\n\t\t\tSFTilesManager.getInstance().tileList.push(pTile);\r\n\t\t\tSFGameManager.getInstance().wallsContainer.addChild(pTile);\r\n\t\t}\r\n\t\telse if (Std.is(pTile, Clue) || Std.is(pTile, HardBrick))\r\n\t\t{\r\n\t\t\tpTile.start();\r\n\t\t\tSFTilesManager.getInstance().tileList.push(pTile);\r\n\t\t\tSFGameManager.getInstance().blocsContainer.addChild(pTile);\r\n\t\t}\r\n\t\telse if (Std.is(pTile, SpecialFeatureItem))\r\n\t\t{\r\n\t\t\tpTile.start();\r\n\t\t\tSFTilesManager.getInstance().tileList.push(pTile);\r\n\t\t\tSFGameManager.getInstance().ressourcesContainer.addChild(pTile);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\r\n\t\r\n\t/**\r\n\t * Calcul du pathfinding de propagation\r\n\t * @param\tpAlienPos\r\n\t * @param\tpStamina\r\n\t * @param\tpfirstTime\r\n\t */\r\n\tpublic function calculatePropagation(pAlienPos:Point, pStamina:Int, ?pfirstTime:Bool=true):Void\r\n\t{\t\r\n\t\tvar lVector3:Vector3; \r\n\t\t\r\n\t\tif (pfirstTime)\r\n\t\t{\r\n\t\t\tpropagationPath = new Array<Vector3>();\r\n\t\t\tlVector3 = {\r\n\t\t\t\tx:Math.floor(pAlienPos.x),\r\n\t\t\t\ty:Math.floor(pAlienPos.y),\r\n\t\t\t\tz:pStamina\r\n\t\t\t}\r\n\t\t\tpropagationPath.push(lVector3);\r\n\t\t}\r\n\t\t\t\t\r\n\t\tvar deltaX:Int;\r\n\t\tvar deltaY:Int;\r\n\t\tvar staminaCost:Int;\r\n\t\tvar lX:Int;\r\n\t\tvar lY:Int;\r\n\r\n\t\tfor (i in 0...4) \r\n\t\t{\r\n\t\t\tdeltaX = (1 - i % 2) * (1-Math.floor(i/2)*2); // 1 , 0 , -1 , 0\r\n\t\t\tdeltaY = (1 - (i + 1) % 2) * (1 - Math.floor(i / 2) * 2); // 0 , 1 , 0 , -1\r\n\t\t\tlX = Math.floor(pAlienPos.x) + deltaX;\r\n\t\t\tlY = Math.floor(pAlienPos.y) + deltaY;\r\n\t\t\t\t\t\t\r\n\t\t\tif (lX < 0 || lX >= PROPAGATION_COLS || lY < 0 || lY >= PROPAGATION_ROWS) continue;\r\n\r\n\t\t\tstaminaCost = propagationGrid[lX][lY];\r\n\r\n\t\t\t//on check les cases adjacentes\r\n\t\t\tlVector3 =\t\r\n\t\t\t{\r\n\t\t\t\tx:lX,\r\n\t\t\t\ty:lY,\r\n\t\t\t\tz:pStamina-staminaCost\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\tif (staminaCost == -1) continue;\r\n\t\t\tif (lVector3.z < 0) continue;\r\n\t\t\tif (isInVectorArray(lVector3, propagationPath)) continue;\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tpropagationPath.push(lVector3);\r\n\t\t\t\tcalculatePropagation(new Point(lVector3.x, lVector3.y), lVector3.z, false);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Nettoie le tableau de Vector3\r\n\t */\r\n\tprivate function cleanVector3Array():Void\r\n\t{\r\n\t\tvar lVector:Vector3;\r\n\t\tvar lLength:Int = propagationPath.length;\r\n\t\tfor (i in 0...lLength) \r\n\t\t{\r\n\t\t\tlVector = propagationPath[lLength - 1 - i];\r\n\t\t\tif (lVector.x % 2 == 1 || lVector.y % 2 == 1) propagationPath.remove(lVector);\r\n\t\t}\r\n\t\t\r\n\t\tfor (vector in propagationPath)\r\n\t\t{\r\n\t\t\tvector.x = Math.floor(vector.x/ 2);\r\n\t\t\tvector.y  = Math.floor(vector.y / 2);\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Vrifie si un Vector3 se trouve dans le tableau de Vector3\r\n\t * @param\tpVector3\r\n\t * @param\tpVector3Array\r\n\t * @return\r\n\t */\r\n\tprivate function isInVectorArray(pVector3:Vector3, pVector3Array:Array<Vector3>):Bool\r\n\t{\r\n\t\tvar result:Bool = false;\r\n\t\tif (pVector3Array.length == 0) return false;\r\n\t\t\r\n\t\tvar lVector:Vector3;\r\n\t\tvar lLength:Int = pVector3Array.length;\r\n\t\tfor (i in 0...lLength) \r\n\t\t{\r\n\t\t\tlVector = pVector3Array[lLength - 1 - i];\r\n\t\t\tif (lVector.x == pVector3.x && lVector.y == pVector3.y)\r\n\t\t\t{\r\n\t\t\t\tif (lVector.z < pVector3.z) pVector3Array.remove(lVector);\r\n\t\t\t\telse return true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function getPropagationPath(pAlienType:String, pAlienPos:Point, pStamina:Int):Array<Vector3>\r\n\t{\r\n\t\tgeneratePropagationGrid(pAlienType);\r\n\t\tcalculatePropagation(new Point(pAlienPos.x*2,pAlienPos.y*2), pStamina);\r\n\t\tcleanVector3Array();\r\n\t\treturn propagationPath;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function checkForRessource(pTarget:Point):Bool\r\n\t{\r\n\t\tvar jsonList:Array<Dynamic> = jsonGrid[Math.round(pTarget.x)][Math.round(pTarget.y)];\r\n\t\t\r\n\t\tif (jsonList != null)\r\n\t\t{\r\n\t\t\tfor (object in 0...jsonList.length) \r\n\t\t\t{\r\n\t\t\t\tif (jsonList[object].type.substring(0, 4) == ElementType.ITEM)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\r\n\t\r\n\t/**\r\n\t * Vrifie le contenu d'une cellule pour savoir si la cellule target contient un mur\r\n\t * @param\tpAlienPos\r\n\t * @param\tpTarget\r\n\t * @return\r\n\t */\r\n\tpublic function checkWallinNextPos(pAlienPos:Point, pTarget:Point):Bool\r\n\t{\r\n\t\tvar DeltaX:Int;\r\n\t\tvar DeltaY:Int;\r\n\t\tvar alienList:Array<Dynamic> = jsonGrid[Math.round(pAlienPos.x)][Math.round(pAlienPos.y)];\r\n\t\tvar targetList:Array<Dynamic> = getInstance().jsonGrid[Math.round(pTarget.x)][Math.round(pTarget.y)];\r\n\t\tvar direction:String=null;\r\n\t\tDeltaX = Math.floor(pTarget.x - pAlienPos.x);\r\n\t\tDeltaY = Math.floor(pTarget.y - pAlienPos.y);\r\n\t\t\r\n\t\tif (DeltaX != 0) direction = DeltaX == 1 ? \"Right\": \"Left\";\r\n\t\tif (DeltaY !=  0) direction = DeltaY == 1 ? \"Bot\": \"Top\";\r\n\t\t\r\n\t\t\r\n\t\tfor (i in 0...alienList.length) \r\n\t\t{\r\n\t\t\tif (alienList[i].type == \"Wall\"+direction) return true;\t\r\n\t\t}\r\n\t\t\r\n\t\tif (DeltaX !=  0) direction = DeltaX == -1 ? \"Right\": \"Left\";\r\n\t\tif (DeltaY !=  0) direction = DeltaY == -1 ? \"Bot\": \"Top\";\r\n\t\t\r\n\t\tif (targetList != null)\r\n\t\t{\r\n\t\t\tfor (j in 0...targetList.length) \r\n\t\t\t{\r\n\t\t\t\tif (targetList[j].type == \"Wall\"+direction) return true;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne la position global de la souris par rapport  pContainer\r\n\t * @param\tpContainer\r\n\t * @return\r\n\t */\r\n\tpublic function getGlobalMouseCoords(pContainer:Container):Point\r\n\t{\r\n\t\treturn Controller.getInstance().getPosFrom(pContainer);\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne les coordonnes globales selon le modle de la grille\r\n\t * @param\tpPos\r\n\t * @return\r\n\t */\r\n\tpublic function getGlobalGridCoords(pPos:Point):Point\r\n\t{\r\n\t\treturn new Point(pPos.x * CELL_WIDTH, pPos.y * CELL_HEIGHT);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Retourne les coordonnes selon le modle grille ex:(2,5)\r\n\t * @param\tpGlobalPosition\r\n\t * @return\r\n\t */\r\n\tpublic function getGridCoords(pGlobalPosition:Point):Point\r\n\t{\r\n\t\treturn new Point\r\n\t\t\t(\r\n\t\t\t\tMath.round(pGlobalPosition.x / CELL_WIDTH),\r\n\t\t\t\tMath.round(pGlobalPosition.y / CELL_HEIGHT)\r\n\t\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.DataBaseAction.TempoBuildingInfo;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SFTilesManager \r\n{\r\n\tpublic var tileList:Array<Tile> = new Array<Tile>();  \r\n\tpublic var skillTilesList:Array<Tile> = new Array<Tile>();  \r\n\t\r\n\tprivate static inline var CLUE_CLASSNAME:String = ElementType.CLUE;\r\n\tpublic static inline var LAVA_CLASSNAME:String = ElementType.LAVA;\r\n\tpublic static inline var HARDBRICK_CLASSNAME:String = ElementType.HARDBRICK;\r\n\tpublic static inline var ITEM_CLASSNAME:String = ElementType.ITEM;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TilesManager\r\n\t */\r\n\tprivate static var instance: SFTilesManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SFTilesManager {\r\n\t\tif (instance == null) instance = new SFTilesManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Enlve une Tile (graphiquement) de l'cran\r\n\t * @param\tpType\r\n\t */\r\n\tpublic function removeInTileList(pJsonObject:Dynamic):Void\r\n\t{\r\n\t\tvar gridMousePos:Point = SFGridManager.getInstance().gridMousePos;\r\n\t\tfor (i in 0...tileList.length) \r\n\t\t{\r\n\t\t\t\r\n\t\t\tif (tileList[i].positionInGrid.x == gridMousePos.x &&\r\n\t\t\ttileList[i].positionInGrid.y == gridMousePos.y && \r\n\t\t\ttileList[i].type == pJsonObject.type)\r\n\t\t\t{\r\n\t\t\t\tif (pJsonObject.type.substring(0, 4) == ElementType.ITEM )\r\n\t\t\t\t{\r\n\t\t\t\t\tSFGameManager.getInstance().ressourcesContainer.removeChild(tileList[i]);\r\n\t\t\t\t}\r\n\t\t\t\tif (pJsonObject.type.substring(0, 4) == CLUE_CLASSNAME ||  pJsonObject.type.substring(0, 9) == ElementType.HARDBRICK)\r\n\t\t\t\t{\r\n\t\t\t\t\tSFGameManager.getInstance().blocsContainer.removeChild(tileList[i]);\r\n\t\t\t\t}\r\n\t\t\t\tif (pJsonObject.type.substring(0, 4) != \"Wall\")\r\n\t\t\t\t{\r\n\t\t\t\t\tpJsonObject.type = \"destroyed\";\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\t\r\n\t\t}\r\n\t}\t\r\n\t\r\n\t\r\n\tpublic function addSpecialTile(pTileType:String, pTarget:Point):Void\r\n\t{\r\n\t\tvar lTile:Tile = null;\r\n\t\tif (pTileType == \"dig\")\r\n\t\t{\r\n\t\t\tlTile = cast(PoolManager.getFromPool(ElementType.CLUE_EMPTY_GREEN),Tile);\r\n\t\t}\r\n\t\telse if (pTileType == \"move\")\r\n\t\t{\r\n\t\t\tlTile = cast(PoolManager.getFromPool(ElementType.CLUE_EMPTY_BLUE),Tile);\r\n\t\t}\r\n\t\telse if (pTileType == \"skill\")\r\n\t\t{\r\n\t\t\tlTile = cast(PoolManager.getFromPool(ElementType.CLUE_EMPTY_ORANGE),Tile);\r\n\t\t}\r\n\t\telse return;\r\n\t\tSFGameManager.getInstance().skillContainer.addChild(lTile);\r\n\t\tlTile.position = pTarget;\r\n\t\tlTile.start();\r\n\t}\r\n\t\r\n\tpublic function removeSpecialTile():Void\r\n\t{\r\n\t\tvar length:Int = SFGameManager.getInstance().skillContainer.children.length;\r\n\t\tvar child:PoolObject;\r\n\t\tfor (i in 0...length) \r\n\t\t{\r\n\t\t\tchild = cast(SFGameManager.getInstance().skillContainer.children[length-1-i],PoolObject);\r\n\t\t\tchild.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Vrifie si la Tile pTarget est dans la range d'action de l'alien slectionn\r\n\t * @param\tpTarget\r\n\t * @return\r\n\t */\r\n\tpublic function isTileInRange(pTarget:Point):Bool\r\n\t{\r\n\t\tvar lAlien:SpecialFeatureAliens = SFAliensManager.getInstance().selectedAlien;\r\n\t\tvar lAlienPos:Point = SFGridManager.getInstance().getGridCoords(lAlien.position);\r\n\t\tvar distance:Int;\r\n\r\n\t\tdistance =Math.floor(Math.abs(lAlienPos.x - pTarget.x) + Math.abs(lAlienPos.y - pTarget.y));\r\n\t\treturn distance <= lAlien.powerRange;\r\n\t\t\r\n\t}\r\n\r\n\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.ui;\r\n\r\nimport com.isartdigital.utils.events.EventType;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.ui.UIPositionable;\r\nimport com.isartdigital.utils.ui.smart.UIBuilder;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * Base de tous les conteneurs d'interface\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass UIComponent extends GameObject\r\n{\r\n\r\n\tprivate var positionables:Array<UIPositionable> = [];\r\n\t\r\n\tpublic var isOpened:Bool;\r\n\t\r\n\tprivate var modalZone:Sprite;\r\n\t\r\n\tprivate var componentName:String;\r\n\t\r\n\tpublic var modalImage(default, set):String=\"assets/alpha_bg.png\";\r\n\t\r\n\tprivate function set_modalImage(pImage:String):String {\r\n\t\tmodalImage = pImage;\r\n\r\n\t\tif (modalZone != null) {\r\n\t\t\tmodalZone.texture = Texture.fromImage(modalImage);\r\n\t\t}\r\n\t\treturn modalImage;\r\n\t}\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper();\r\n\t\tif (pID == null) {\r\n\t\t\tcomponentName = Type.getClassName(Type.getClass(this));\r\n\t\t\tcomponentName = componentName.substring(componentName.lastIndexOf(\".\") + 1);\r\n\t\t} else componentName = pID;\r\n\r\n\t}\r\n\t\r\n\t/**\r\n\t * permet de construire l'UIComponent  partir de l'UIBuilder\r\n\t */\r\n\tpublic function build (pFrame:Int=0) : Void {\r\n\t\tvar lItems:Array<UIPositionable> = UIBuilder.build(componentName,pFrame);\r\n\t\t\r\n\t\tfor (lItem in lItems) {\r\n\t\t\taddChild(lItem.item);\r\n\t\t\tif (lItem.align != \"\") positionables.push(lItem);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function open (): Void {\r\n\t\tif (isOpened) return;\r\n\t\tisOpened = true;\r\n\t\tset_modal(modal);\r\n\t\tGameStage.getInstance().on(EventType.RESIZE, onResize);\r\n\t\tonResize();\r\n\t}\r\n\t\r\n\tpublic var modal (default, set):Bool=true;\r\n\t\r\n\tprivate function set_modal (pModal:Bool):Bool {\r\n\t\tmodal = pModal;\r\n\t\t\r\n\t\tif (modal) {\r\n\t\t\tif (modalZone == null) {\r\n\t\t\t\tmodalZone = new Sprite(Texture.fromImage(Config.url(modalImage)));\r\n\t\t\t\tmodalZone.interactive = true;\r\n\t\t\t\tmodalZone.on(MouseEventType.CLICK, stopPropagation);\r\n\t\t\t\tmodalZone.on(TouchEventType.TAP, stopPropagation);\r\n\t\t\t\tpositionables.unshift({ item:modalZone, align:UIPosition.FIT_SCREEN, offsetX:0, offsetY:0});\r\n\t\t\t}\r\n\t\t\tif (parent != null) parent.addChildAt(modalZone, parent.getChildIndex(this));\r\n\t\t} else {\t\r\n\t\t\tif (modalZone != null) {\r\n\t\t\t\tif (modalZone.parent != null) modalZone.parent.removeChild(modalZone);\r\n\t\t\t\tmodalZone.off(MouseEventType.CLICK, stopPropagation);\r\n\t\t\t\tmodalZone.off(TouchEventType.TAP, stopPropagation);\r\n\t\t\t\tmodalZone = null;\r\n\t\t\t\tif (positionables[0].item == modalZone) positionables.shift();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn modal;\r\n\t}\r\n\t\r\n\tprivate function stopPropagation (pEvent:EventTarget): Void {}\r\n\t\r\n\tpublic function close ():Void {\r\n\t\tif (!isOpened) return;\r\n\t\tisOpened = false;\r\n\t\tmodal = false;\r\n\t\tdestroy();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dclenche le positionnement des objets\r\n\t * @param pEvent\r\n\t */\r\n\tprivate function onResize (pEvent:EventTarget = null): Void {\r\n\t\tfor (lObj in positionables) {\r\n\t\t\tif (lObj.update) {\r\n\t\t\t\tif (lObj.align==UIPosition.TOP || lObj.align==UIPosition.TOP_LEFT || lObj.align==UIPosition.TOP_RIGHT) {\r\n\t\t\t\t\tlObj.offsetY = parent.y + lObj.item.y;\r\n\t\t\t\t} else if (lObj.align==UIPosition.BOTTOM || lObj.align==UIPosition.BOTTOM_LEFT || lObj.align==UIPosition.BOTTOM_RIGHT) {\t\r\n\t\t\t\t\tlObj.offsetY = GameStage.getInstance().safeZone.height - parent.y - lObj.item.y;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (lObj.align==UIPosition.LEFT || lObj.align==UIPosition.TOP_LEFT || lObj.align==UIPosition.BOTTOM_LEFT) {\r\n\t\t\t\t\tlObj.offsetX = parent.x + lObj.item.x;\r\n\t\t\t\t} else if (lObj.align==UIPosition.RIGHT || lObj.align==UIPosition.TOP_RIGHT || lObj.align==UIPosition.BOTTOM_RIGHT) {\t\r\n\t\t\t\t\tlObj.offsetX = GameStage.getInstance().safeZone.width - parent.x - lObj.item.x;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlObj.update = false;\r\n\t\t\t}\r\n\t\t\tUIPosition.setPosition(lObj.item, lObj.align, lObj.offsetX, lObj.offsetY);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * nettoie l'instance\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tclose();\r\n\t\tGameStage.getInstance().off(EventType.RESIZE, onResize);\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui;\r\n\r\n\r\n/**\r\n * Classe de base des Ecrans\r\n * Tous les crans d'interface hritent de cette classe\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Screen extends UIComponent \r\n{\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodalImage = \"assets/black_bg.png\";\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.ui.Screen;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass SmartScreen extends Screen\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tbuild();\r\n\t\tbuttonMode = true;\r\n\t\tinteractive = true;\r\n\t\tdefaultCursor = \"url(assets/Curseur.png), auto\";\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.screens;\r\n\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartScreen;\r\n\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass SmartScreenRegister extends SmartScreen\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tname = componentName;\r\n\t\tftueRegister();\r\n\t}\r\n\t\r\n\tpublic function ftueRegister():Void \r\n\t{\r\n\t\tfor (i in 0...children.length) \r\n\t\t{\r\n\t\t\tif (Std.is(children[i], SmartButton)) FTUEManager.register(children[i]);\r\n\t\t\telse if(Std.is(children[i], SmartComponent)) FTUEManager.register(children[i]);\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\t\r\n\t\t//SwitchItem.destroyAll();\r\n\t}\r\n}","package com.isartdigital.ruby.game.specialFeature.managers;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.AlienType;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFAliensEventManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFAliensManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFEventsManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFTilesManager;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SpecialFeatureSwitchSkill;\r\nimport com.isartdigital.ruby.ui.popin.TutoSpecialFeature;\r\n\r\nimport com.isartdigital.ruby.ui.popin.Confirm;\r\nimport com.isartdigital.ruby.ui.popin.DynamicPopin;\r\nimport com.isartdigital.ruby.ui.popin.Menu;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.ruby.ui.screens.SmartScreenRegister;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.Screen;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartScreen;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport haxe.Constraints.Function;\r\nimport haxe.Json;\r\nimport js.Browser;\r\nimport js.Lib;\r\nimport js.html.Event;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.renderers.Detector;\r\nimport pixi.core.renderers.Detector.RenderingOptions;\r\n\r\n\r\ntypedef AlienHudInfo = {\r\n\tvar skillBtn:SmartComponent;\r\n\tvar moveBtn:SmartComponent;\r\n\tvar staminaBar:UISprite;\r\n\tvar xenoName:TextSprite;\r\n}\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SpecialFeatureScreen extends SmartScreenRegister\r\n{\r\n\t\r\n\tprivate static inline var BTN_CLOSE:String = \"btn_Close\";\r\n\t\r\n\tprivate static inline var HC_CONTAINER:String = \"HCContainer\";\t\r\n\tprivate static inline var SC_CONTAINER:String = \"SCContainer\";\r\n\tprivate static inline var MN_CONTAINER:String = \"MNContainer\";\r\n\tprivate static inline var SCHEMAS_CONTAINER:String = \"ArchivesContainer\";\r\n\t\tprivate static inline var TXT_REWARDS:String = \"txt_Reward\";\r\n\t\r\n\tprivate static inline var GENES_CONTAINER:String = \"GeneContainer\";\r\n\t\tprivate static inline var GENES_1:String = \"Gene #0\";\r\n\t\tprivate static inline var GENES_2:String = \"Gene #1\";\r\n\t\tprivate static inline var GENES_3:String = \"Gene #2\";\r\n\t\tprivate static inline var GENES_4:String = \"Gene #3\";\r\n\t\tprivate static inline var GENES_5:String = \"Gene #4\";\r\n\r\n\t\r\n\tprivate static inline var ALIENS_CONTAINER:String = \"ItemContainer\";\r\n\t\tprivate static inline var ALIEN_SUFFIXE:String = \"item #\";\r\n\t\t\tprivate static inline var SKILL_BTN:String = \"SwitchSkill\";\r\n\t\t\t\tprivate static inline var NORMAL:String = \"Normal\";\r\n\t\t\t\tprivate static inline var SELECTED:String = \"Selected\";\r\n\t\t\tprivate static inline var MOVE_BTN:String = \"SwitchMove\";\r\n\t\t\tprivate static inline var STAMINA_BAR:String = \"XenoBarCharging\";\r\n\t\t\tprivate static inline var XENO_NAME:String = \"txt_XenoName\";\t\r\n\t\t\tprivate static inline var BACKGROUND_XENO_BAR:String = \"SpecialFeature_spriteXenoBarBG\";\r\n\t\r\n\tprivate static inline var TILES_CONTAINER:String = \"CaseContainer\";\t\r\n\tprivate static inline var BACKGROUND_SF:String = \"SpecialFeature_spriteBackgroundLevel\";\r\n\tprivate static inline var BACKGROUND_TILE_CONTAINER:String = \"SpecialFeature_spriteBackgroundLevel\";\r\n\t\r\n\tprivate static inline var BTN_INFO:String = \"SpecialFeature_btn_Info\";\r\n\t\r\n\tprivate var alienHudInfoList:Array<AlienHudInfo> = [];\r\n\tprivate static inline var MAX_SF_ALIENS_NUMBER:Int = 3;\r\n\tprivate var alienSpawnersInCurrentMap:Int;\r\n\t\r\n\tpublic var hcContainer:SmartComponent;\r\n\tprivate var scContainer:SmartComponent;\r\n\tprivate var mnContainer:SmartComponent;\r\n\tprivate var schemasContainer:SmartComponent;\r\n\r\n\t\r\n\tprivate var genesContainer:SmartComponent;\r\n\t\tprivate var geneContainer1:SmartComponent;\r\n\t\tprivate var geneContainer2:SmartComponent;\r\n\t\tprivate var geneContainer3:SmartComponent;\r\n\t\tprivate var geneContainer4:SmartComponent;\r\n\t\tprivate var geneContainer5:SmartComponent;\r\n\r\n\t\r\n\tprivate var aliensContainer:SmartComponent;\r\n\tprivate var staminaBarMaxWidth:Float;\r\n\tprivate var staminaBarWidth:Float;\t\r\n\t\r\n\tpublic var tilesContainer:SmartComponent;\r\n\r\n\tprivate var backgroundSF:SmartComponent;\r\n\tprivate var backgroundTileContainer:SmartComponent;\r\n\tprivate var backgroundXenoBar:SmartComponent;\r\n\r\n\tpublic var btnInfo:SmartButton;\r\n\t\r\n\tpublic var btnClose:SmartButton;\r\n\t\r\n\tprivate var btnSkill:SmartComponent;\r\n\t\tprivate var normal:SmartComponent;\r\n\t\tprivate var selected:SmartComponent;\r\n\t\r\n\tprivate var btnMove:SmartComponent;\r\n\t\r\n\t//rewards\r\n\tprivate var rewardHardCurrency:Int;\r\n\tprivate var rewardSoftCurrency:Int;\r\n\tprivate var rewardMN:Int;\r\n\tprivate var rewardSchema:Int;\r\n\tprivate var rewardGene1:Int;\r\n\tprivate var rewardGene2:Int;\r\n\tprivate var rewardGene3:Int;\r\n\tprivate var rewardGene4:Int;\r\n\tprivate var rewardGene5:Int;\r\n\r\n\t\r\n\tprivate var alienCurrentStamina:Int;\r\n\tprivate var alienOldStamina:Int;\r\n\t\r\n\tprivate var alienHudList:Array<AlienHudInfo> =[];\r\n\tprivate var alienSuffixe:SmartComponent;\r\n\r\n\tprivate var activatedAlienList:Array<SpecialFeatureAliens>;\r\n\r\n\tpublic var closeFlag:Bool = false;\r\n\t\r\n\tpublic var playerSchema : Int = 0;\r\n\t/**\r\n\t * instance unique de la classe SpecialFeaturePoppin\r\n\t */\r\n\tprivate static var instance: SpecialFeatureScreen;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SpecialFeatureScreen {\r\n\t\tif (instance == null) instance = new SpecialFeatureScreen();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\t\r\n\t\tsuper(pID);\r\n\t\tmodalImage = \"assets/sft.png\";\r\n\r\n\t}\r\n\t\r\n\tpublic function initContainers():Void\r\n\t{\r\n\t\taliensContainer = cast(getChildByName(ALIENS_CONTAINER), SmartComponent);\r\n\t\ttilesContainer = cast(getChildByName(TILES_CONTAINER), SmartComponent);\r\n\t\thcContainer = cast(getChildByName(HC_CONTAINER), SmartComponent);\r\n\t\tscContainer = cast(getChildByName(SC_CONTAINER), SmartComponent);\r\n\t\tmnContainer = cast(getChildByName(MN_CONTAINER), SmartComponent);\r\n\t\tschemasContainer = cast(getChildByName(SCHEMAS_CONTAINER), SmartComponent);\r\n\t\tgenesContainer = cast(getChildByName(GENES_CONTAINER), SmartComponent);\r\n\t\t\r\n\t\tgeneContainer1 = cast(genesContainer.getChildByName(GENES_1), SmartComponent);\r\n\t\tgeneContainer2 = cast(genesContainer.getChildByName(GENES_2), SmartComponent);\r\n\t\tgeneContainer3 = cast(genesContainer.getChildByName(GENES_3), SmartComponent);\r\n\t\tgeneContainer4 = cast(genesContainer.getChildByName(GENES_4), SmartComponent);\r\n\t\tgeneContainer5 = cast(genesContainer.getChildByName(GENES_5), SmartComponent);\r\n\t\tfor (j in 0...MAX_SF_ALIENS_NUMBER) \r\n\t\t{\r\n\t\t\talienSuffixe = cast(aliensContainer.getChildByName(ALIEN_SUFFIXE+j), SmartComponent);\r\n\t\t\talienSuffixe.visible = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise le hud Aliens\r\n\t */\r\n\tpublic function initHud():Void\r\n\t{\t\r\n\t\tactivatedAlienList = SFAliensManager.getInstance().activatedAlienList;\r\n\t\tinitAlienHud();\r\n\t\tupdateRessourceHud();\r\n\t\tupdateAlienHud();\r\n\t\t\t\r\n\t\talienSelection(0, SFEventsManager.MODE_MOVE)();\r\n\t\t\r\n\t\tbtnInfo = cast(getChildByName(BTN_INFO), SmartButton);\r\n\t\tbtnInfo.on(MouseEventType.CLICK, onInfo);\r\n\t\tbtnInfo.on(TouchEventType.TAP, onInfo);\t\t\r\n\t\t\r\n\t\tbtnClose = cast(getChildByName(BTN_CLOSE), SmartButton);\r\n\t\tbtnClose.on(MouseEventType.CLICK, onClose);\r\n\t\tbtnClose.on(TouchEventType.TAP, onClose);\r\n\r\n\t}\r\n\t\r\n\t\r\n\tprivate function onInfo():Void\r\n\t{\r\n\t\tUIManager.getInstance().openPopin(TutoSpecialFeature.getInstance());\r\n\t}\r\n\t\r\n\t/**\r\n\t * Callback de slection d'alien et initialisation du son mode\r\n\t * @param\tpAlienIndex\r\n\t * @param\tpMode\r\n\t */\r\n\tpublic  function alienSelection(pAlienIndex:Int, pMode:String):Void->Void\r\n\t{\r\n\t\treturn function(){ \r\n\t\t\tSFEventsManager.getInstance().selectAlienOnHud(pAlienIndex, pMode);\r\n\t\t};\r\n\t}\r\n\t\r\n\tpublic function updateRessourceHud():Void\r\n\t{\r\n\t\tcast(hcContainer.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().hardCurrency);\r\n\t\tcast(scContainer.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().softCurrency);\r\n\t\tcast(mnContainer.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().ressource);\r\n\t\tcast(schemasContainer.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(playerSchema);\r\n\t\t\r\n\t\tcast(geneContainer1.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().gene1);\r\n\t\tcast(geneContainer2.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().gene2);\r\n\t\tcast(geneContainer3.getChildByName(TXT_REWARDS), TextSprite).text\t= Std.string(Player.getInstance().gene3);\r\n\t\tcast(geneContainer4.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().gene4);\r\n\t\tcast(geneContainer5.getChildByName(TXT_REWARDS), TextSprite).text = Std.string(Player.getInstance().gene5);\r\n\t}\r\n\t\r\n\tpublic function updateAlienHud():Void\r\n\t{\r\n\t\tvar index:Int = 0;\r\n\t\tfor (alien in activatedAlienList) \r\n\t\t{\r\n\t\t\tstaminaBarWidth = alien.stamina * staminaBarMaxWidth / alien.maxStamina;\r\n\r\n\t\t\tif (staminaBarWidth >= staminaBarMaxWidth) staminaBarWidth = staminaBarMaxWidth;\r\n\t\t\tif (staminaBarWidth <= 0) staminaBarWidth = 0;\r\n\r\n\t\t\talienHudList[index].staminaBar.width = staminaBarWidth;\r\n\t\t\tindex++;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initAlienHud():Void\r\n\t{\r\n\t\tvar alienHud:AlienHudInfo;\r\n\t\tvar index:Int = 0;\r\n\t\t\r\n\t\tfor (alien in activatedAlienList) \r\n\t\t{\r\n\t\t\talienSuffixe = cast(aliensContainer.getChildByName(ALIEN_SUFFIXE+index), SmartComponent);\r\n\t\t\talienSuffixe.visible = true;\r\n\t\t\t\r\n\t\t\talienHud = {\r\n\t\t\t\tskillBtn: cast(alienSuffixe.getChildByName(SKILL_BTN), SmartComponent),\r\n\t\t\t\tmoveBtn: cast(alienSuffixe.getChildByName(MOVE_BTN), SmartComponent),\r\n\t\t\t\tstaminaBar: cast(alienSuffixe.getChildByName(STAMINA_BAR), UISprite),\r\n\t\t\t\txenoName: cast(alienSuffixe.getChildByName(XENO_NAME), TextSprite)\r\n\t\t\t}\r\n\t\t\talienHud.xenoName.text = alien.alienType;\r\n\t\t\t\r\n\t\t\tcast(alienSuffixe.getChildByName(SKILL_BTN), SpecialFeatureSwitchSkill).init();\r\n\t\t\tcast(alienSuffixe.getChildByName(SKILL_BTN), SpecialFeatureSwitchSkill).initAlien(alien);\r\n\t\t\t\r\n\t\t\tstaminaBarMaxWidth = alienHud.staminaBar.width;\r\n\t\t\r\n\t\t\tstaminaBarWidth = alien.stamina * staminaBarMaxWidth / alien.maxStamina;\r\n\r\n\t\t\talienHud.staminaBar.width = staminaBarWidth;\r\n\r\n\t\t\talienHud.moveBtn.interactive = true;\r\n\t\t\talienHud.skillBtn.interactive = true;\r\n\t\t\t\r\n\t\t\talienHud.moveBtn.on(MouseEventType.CLICK, alienSelection(index,\"Move\"));\r\n\t\t\talienHud.moveBtn.on(TouchEventType.TAP, alienSelection(index, \"Move\"));\r\n\t\t\t\r\n\t\t\talienHud.skillBtn.on(MouseEventType.CLICK, alienSelection(index,\"Skill\"));\r\n\t\t\talienHud.skillBtn.on(TouchEventType.TAP, alienSelection(index, \"Skill\"));\r\n\t\t\t\r\n\t\t\talienHudList.push(alienHud);\r\n\t\t\tindex++;\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\t\r\n\r\n\r\n\t/**\r\n\t * Donne des ressources au player et update le hud\r\n\t * @param\tpRewardType\r\n\t */\r\n\tpublic function getRessourceHudPosition(pRewardType:String):Point\r\n\t{\r\n\t\tif (pRewardType == ElementType.ITEM_GENEONE) return genesContainer.toGlobal(geneContainer1.position);\r\n\t\tif (pRewardType == ElementType.ITEM_GENETWO) return  genesContainer.toGlobal(geneContainer2.position);\r\n\t\tif (pRewardType == ElementType.ITEM_GENETHREE) return  genesContainer.toGlobal(geneContainer3.position);\r\n\t\tif (pRewardType == ElementType.ITEM_GENEFOUR) return  genesContainer.toGlobal(geneContainer4.position);\r\n\t\tif (pRewardType == ElementType.ITEM_GENEFIVE) return  genesContainer.toGlobal(geneContainer5.position);\r\n\t\t\r\n\t\tif (pRewardType == ElementType.ITEM_DARKMATTER) return toGlobal(mnContainer.position);\r\n\t\tif (pRewardType == ElementType.ITEM_BLUEPRINT) return toGlobal(schemasContainer.position);\r\n\t\tif (pRewardType == ElementType.ITEM_HC) return toGlobal(hcContainer.position);\r\n\t\tif (pRewardType == ElementType.ITEM_SC) return toGlobal(scContainer.position);\r\n\r\n\t\telse return toGlobal(btnClose.position);\r\n\t}\r\n\t/**\r\n\t * fermeture du hud\r\n\t */\r\n\tpublic function onClose():Void\r\n\t{\r\n\t\t//if (closeFlag) SFGameManager.getInstance().openEndMissionPoppin();\r\n\t\t\r\n\t\tremoveAllListeners();\r\n\t\tGameManager.getInstance().setModeNormal();\r\n\t\tSFGameManager.getInstance().destroy();\r\n\t\tSFAliensManager.getInstance().destroy();\r\n\t\tSFEventsManager.getInstance().destroy();\r\n\t\tSFAliensEventManager.getInstance().destroy();\r\n\t\tSFGameManager.getInstance().destroy();\r\n\t\tSFTilesManager.getInstance().destroy();\r\n\t\tSoundManager.getSound(\"soundMusicSpecialFeature\").stop();\r\n\t\tUIManager.getInstance().closeScreens();\r\n\t\tUIManager.getInstance().openHud();\r\n\t\tHud.getInstance().update();\r\n\t\tSmartPopinRegister.event.emit(\"onClose\");\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t\r\n\t\t//suppression de l'couteur de clic\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles;\r\n\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport haxe.Json;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Tile extends PoolObject\r\n{\r\n\tpublic var positionInGrid:Point;\r\n\tpublic var type:String;\r\n\tpublic var index:Int;\r\n\t\r\n\t\t\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function getRandomNumber(pMaxValue:Int):Int\r\n\t{\r\n\t\treturn Math.floor(Math.random() * pMaxValue);\r\n\t}\r\n\t\r\n\toverride public function dispose():Void \r\n\t{\r\n\t\tsuper.dispose();\r\n\t}\r\n\t\r\n\r\n\t\r\n\t\r\n\t\r\n\t\r\n\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass AlienSpawn extends Tile\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Clue extends Tile\r\n{\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tif (pAsset != ElementType.CLUE_EMPTY_ORANGE && pAsset != ElementType.CLUE_EMPTY_GREEN && pAsset != ElementType.CLUE_EMPTY_BLUE)\r\n\t\t{\r\n\t\t\tpAsset = pAsset + getRandomNumber(3);\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\n\r\n\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass HardBrick extends Tile\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tassetName = pAsset + getRandomNumber(3);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\n\r\n\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Lava extends Tile\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tassetName = pAsset + getRandomNumber(3);\r\n\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass SpecialFeatureItem extends Tile\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.specialFeature.tiles.classes;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.Tile;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Walls extends Tile\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.loader;\r\nimport com.isartdigital.utils.events.LoadEventType;\r\nimport com.isartdigital.utils.sounds.SoundDef;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Json;\r\nimport howler.Howl;\r\nimport howler.Howler;\r\nimport js.html.XMLSerializer;\r\nimport pixi.flump.Parser;\r\nimport pixi.loaders.Loader;\r\nimport pixi.loaders.Resource;\r\nimport pixi.loaders.ResourceLoader;\r\nimport webfont.WebFontLoader;\r\n\r\n/**\r\n * Classe de chargement\r\n * Cette classe permet de grer des chargements par lot aussi bien de fichiers textes que de ressources graphiques ou du son\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass GameLoader extends Loader\r\n{\r\n\r\n\t/**\r\n\t * liste des fichiers sons  charger\r\n\t */\r\n\tprivate var soundsList:Array<String>;\r\n\t\r\n\tprivate var soundsSpecs:Map<String,HowlOptions>;\r\n\t\r\n\tpublic static var ressourceName:String;\r\n\t\r\n\t/**\r\n\t * liste des fichiers chargs\r\n\t */\r\n\tprivate static var txtLoaded:Map<String,Dynamic> = new Map<String,Dynamic>();\r\n\t\r\n\tprivate static var xmlLoaded:Map<String,Dynamic> = new Map<String,Dynamic>();\r\n\t/**\r\n\t* retourne le contenu charg pour le chemin de fichier pass en paramtre\r\n\t* @param\tpFile chemin du fichier\r\n\t* @return\tressource (JSon ou Xml)\r\n\t*/\r\n\tpublic static function getContent (pFile:String):Dynamic {\r\n\t\t//trace(\"TXT LOADED\"+txtLoaded);\r\n\t\treturn txtLoaded[Config.txtsPath+pFile];\r\n\t}\r\n\r\n\t/**\r\n\t* retourne le contenu charg pour le chemin de fichier pass en paramtre\r\n\t* @param\tpFile chemin du fichier\r\n\t* @return\tfichier xml\r\n\t*/\r\n\tpublic static function getContentXml (pFile:String):String {\r\n\t\treturn xmlLoaded[Config.langPath + pFile];\r\n\t}\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tsoundsList = [];\r\n\t\tsoundsSpecs = new Map();\r\n\t\tsuper();\r\n\t\tonce(LoadEventType.COMPLETE, onComplete);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t* ajoute un fichier de type texte  la liste de chargement (JSon ou Xml)\r\n\t* @param\tpUrl chaine de caractres spcifiant le chemin vers le fichier\r\n\t*/\r\n\tpublic function addTxtFile (pUrl:String):Void {\r\n\t\tvar lUrl:String = Config.txtsPath + pUrl;\r\n\t\tadd(Config.url(lUrl));\r\n\t}\t\r\n\t\r\n\t/**\r\n\t* ajoute un fichier d'assets  la liste de chargement\r\n\t* @param\tpUrl chaine de caractre spcifiant le nom du fichier\r\n\t*/\r\n\tpublic function addAssetFile (pUrl:String):Void {\t\r\n\t\tvar lUrl:String = Config.assetsPath + pUrl;\r\n\t\tadd(Config.url(lUrl));\t\t\r\n\t}\r\n\r\n\t/**\r\n\t* ajoute une liste de sons  la liste de chargement\r\n\t* @param\tpUrl chaine de caractre spcifiant le nom du fichier\r\n\t*/\r\n\tpublic function addSoundFile (pUrl:String):Void {\t\r\n\t\tvar lUrl:String = Config.soundsPath + pUrl;\r\n\t\tsoundsList.push(lUrl);\r\n\t\tadd(Config.url(lUrl));\r\n\t}\t\r\n\t\r\n\t/**\r\n\t* ajoute un fichier css de polices de caractre\r\n\t* @param\tpUrl chaine de caractre spcifiant le nom du fichier\r\n\t*/\r\n\tpublic function addFontFile (pUrl:String):Void {\r\n\t\tif (DeviceCapabilities.isCanvasPlus) return;\r\n\t\tvar lUrl:String = Config.fontsPath + pUrl;\r\n\t\tadd(Config.url(lUrl));\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t* ajoute un fichier de type texte  la liste de chargement (actuellement seuls les  sont supports)\r\n\t* @param\tpUrl chaine de caractres spcifiant le chemin vers le fichier\r\n\t*/\r\n\tpublic function addXMLFile (pUrl:String):Void {\r\n\t\tvar lUrl:String = Config.langPath + pUrl;\r\n\t\tadd(Config.url(lUrl));\r\n\t}\r\n\t\r\n\tprivate function parseData (pResource:Resource, pNext:Void->Void): Void {\r\n\t\t//trace (pResource.url + \" loaded\");\r\n\t\tressourceName = pResource.url + \" loaded\";\r\n\t\t\r\n\t\tvar lUrl:String = pResource.url.split(\"?\")[0];\r\n\t\t\r\n\t\tif (lUrl.indexOf(\".css\") > 0) {\r\n\t\t\t\r\n\t\t\tvar lData:Array<String> = pResource.data.split(\";\");\r\n\t\t\tvar lFamilies:Array<String> = [];\r\n\t\t\tvar lReg:EReg = ~/font-family:\\s?(.*)/; \r\n\t\t\t\r\n\t\t\tfor (i in 0...lData.length) {\r\n\t\t\t\tif (lReg.match(lData[i])) lFamilies.push(lReg.matched(1));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar lWebFontConfig = {\r\n\t\t\t\tcustom: {\r\n\t\t\t\t\tfamilies: lFamilies,\r\n\t\t\t\t\turls: [Config.fontsPath+\"fonts.css\"],\r\n\t\t\t\t},\r\n\r\n\t\t\t\tactive: pNext\r\n\t\t\t};\r\n\t\t   \r\n\t\t\tWebFontLoader.load(lWebFontConfig);\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (pResource.isJson) {\r\n\t\t\t\r\n\t\t\ttxtLoaded[lUrl] = pResource.data;\r\n\t\t\t\r\n\t\t\tif(lUrl.substr(-12,12)==\"library.json\" && Reflect.hasField(pResource.data,\"md5\") && Reflect.hasField(pResource.data,\"movies\") && Reflect.hasField(pResource.data,\"textureGroups\") && Reflect.hasField(pResource.data,\"frameRate\")) {\r\n\t\t\t\tParser.parse(1,Config.cache)(pResource, pNext);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if (soundsList.length>0) { \r\n\t\t\t\r\n\t\t\t\tvar lData:SoundDef;\r\n\t\t\t\t\r\n\t\t\t\tfor (i in 0...soundsList.length) {\r\n\t\t\t\t\tif (lUrl == soundsList[i]) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsoundsList.splice(i, 1);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlData = pResource.data;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (DeviceCapabilities.isCocoonJS) {\r\n\t\t\t\t\t\t\tif (lData.extensions.indexOf(\"ogg\") == -1) throw \"CocoonJs needs ogg sounds. No sound will be played in the application.\";\r\n\t\t\t\t\t\t\telse lData.extensions = [\"ogg\"];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tfor (j in 0...lData.extensions.length) {\r\n\t\t\t\t\t\t\tif (Howler.codecs(lData.extensions[j])) {\r\n\t\t\t\t\t\t\t\taddSounds(lData.fxs,false,lData.extensions,lData.extensions[i]);\r\n\t\t\t\t\t\t\t\taddSounds(lData.musics,true,lData.extensions,lData.extensions[i]);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else if (pResource.isXml) txtLoaded[lUrl] = Xml.parse(new XMLSerializer().serializeToString(pResource.data));\r\n\t\telse xmlLoaded[lUrl] = pResource.data;\r\n\t\t\r\n\t\tpNext();\r\n\t}\r\n\t\r\n\tprivate function manageCache (pResource:Resource, pNext:Void->Void): Void {\r\n\t\tif  (pResource.name != pResource.url) pResource.url = Config.url(pResource.url);\r\n\t\tpNext();\r\n\t}\r\n\t\r\n\tprivate function addSounds (pList:Dynamic, pLoop:Bool, pExtensions:Array<String>, pCodec:String): Void {\t\r\n\t\tvar lUrl:String;\r\n\t\tfor (lID in Reflect.fields(pList)) {\r\n\t\t\tlUrl = Config.url(Config.soundsPath + lID + \".\" + pCodec);\r\n\t\t\tsoundsSpecs.set(lID, {src:[lUrl],volume:Reflect.field(pList, lID) / 100, loop:pLoop} );\r\n\t\t\tadd(lUrl);\r\n\t\t}\r\n\t}\r\n\r\n\toverride public function load (?cb:Void->Void):ResourceLoader {\r\n\t\tbefore(manageCache);\r\n\t\tafter(parseData);\r\n\t\treturn super.load();\r\n\t}\r\n\t\r\n\tprivate function onComplete ():Void {\r\n\t\tfor (lID in soundsSpecs.keys()) {\r\n\t\t\tSoundManager.addSound(lID, new Howl (soundsSpecs[lID]));\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n}","package com.isartdigital.utils ;\r\nimport haxe.Json;\r\nimport js.Browser;\r\nimport js.html.Storage;\r\n\r\n/**\r\n * Classe utilitaire contenant les donnes de configuration du jeu\r\n * @author Mathieu ANTHOINE\r\n * @version 0.2.0\r\n */\r\nclass Config \r\n{\r\n\t\r\n\t/**\r\n\t * nom du jeu\r\n\t */\r\n\tpublic static var gameName (get,never):String;\r\n\t\r\n\t/**\r\n\t * version de l'application\r\n\t */\r\n\tpublic static var version (get,never):String;\r\n\t\r\n\t/**\r\n\t * langue courante\r\n\t */\r\n\tpublic static var language (get,never): String;\r\n\t\r\n\t/**\r\n\t * langues disponibles\r\n\t */\r\n\tpublic static var languages (get,never): Array<String>;\r\n\t\r\n\t/**\r\n\t * dfini si le jeu est en mode \"debug\" ou pas (si prvu dans le code du jeu)\r\n\t */\r\n\tpublic static var debug (get, never): Bool;\r\n\t\r\n\t/**\r\n\t * dfini si il faut afficher les fps ou non\r\n\t */\r\n\tpublic static var fps (get,never): Bool;\r\n\r\n\t/**\r\n\t * dfini si il faut afficher le qrcode ou non\r\n\t */\r\n\tpublic static var qrcode (get, never): Bool;\t\r\n\t\r\n\t/** \r\n\t * chemin du dossier de langues\r\n\t */\r\n\tpublic static var langPath (get, never): String;\r\n\t\r\n\t/** \r\n\t * chemin du dossier des fichiers textes\r\n\t */\r\n\tpublic static var txtsPath (get, never): String;\r\n\t\r\n\t/** \r\n\t * chemin du dossier d'assets graphiques\r\n\t */\r\n\tpublic static var assetsPath (get, never): String;\r\n\t\r\n\t/** \r\n\t * chemin du dossier de sons\r\n\t */\r\n\tpublic static var soundsPath (get, never): String;\r\n\r\n\t/** \r\n\t * chemin du dossier des polices de caractres\r\n\t */\r\n\tpublic static var fontsPath (get, never): String;\t\r\n\t\r\n\t/*\r\n\t * utiliser le cache du navigateur ou non\r\n\t */\r\n\tpublic static var cache(default, null):Bool = true;\r\n\t\r\n\t/**\r\n\t * conteneur des donnes de configuration\r\n\t */\r\n\tpublic static var data (get, never):Dynamic;\r\n\tprivate static var _data:Dynamic={};\r\n\t\r\n\tpublic static function init(pConfig:Json): Void {\t\t\r\n\t\tfor (i in Reflect.fields(pConfig)) Reflect.setField(_data, i, Reflect.field(pConfig, i));\t\r\n\t\t\r\n\t\tif (_data.version == null || _data.version==\"\") _data.version = \"0.0.0\";\r\n\t\tif (_data.gameName == null) _data.gameName = \"\";\r\n\t\t\r\n\t\tvar lStorage:Storage = Browser.getLocalStorage();\r\n\t\t\r\n\t\tvar lVersion:String = lStorage.getItem(gameName)==null ? null : Json.parse(lStorage.getItem(gameName)).version;\r\n\t\tif (lVersion != null) cache = version == lVersion;\r\n\t\tlStorage.setItem(gameName, Json.stringify({version:version}));\r\n\t\t\r\n\t\tif (_data.languages == \"\" || _data.languages == []) throw \"Pas de langues dans la liste des langues supportes\";\r\n\t\tif (_data.language == null || _data.language == \"\") _data.language = Browser.window.navigator.language.substr(0, 2);\r\n\t\tif (_data.languages.indexOf(_data.language) ==-1) _data.language = _data.languages[0];\r\n\t\t\t\t\r\n\t\tif (_data.debug == null || _data.debug==\"\") _data.debug = false;\r\n\t\tif (_data.fps == null || _data.fps==\"\") _data.fps = false;\r\n\t\tif (_data.qrcode == null || _data.qrcode==\"\") _data.qrcode = false;\r\n\r\n\t\tif (_data.langPath == null) _data.langPath = \"\";\r\n\t\tif (_data.txtsPath == null) _data.txtsPath = \"\";\r\n\t\tif (_data.assetsPath == null) _data.assetsPath = \"\";\r\n\t\tif (_data.fontsPath == null) _data.fontsPath = \"\";\r\n\t\tif (_data.soundsPath == null) _data.soundsPath = \"\";\r\n\t\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Retourne l'url complte (chemin+version)\r\n\t * @return url complte\r\n\t */\r\n\tpublic static function url (pPath:String):String {\r\n\t\treturn pPath + \"?\" + version;\r\n\t}\r\n\t\r\n\tprivate static function get_data ():Dynamic {\r\n\t\treturn _data;\r\n\t}\r\n\r\n\tprivate static function get_gameName ():String {\r\n\t\treturn _data.gameName;\r\n\t}\t\r\n\t\r\n\tprivate static function get_version ():String {\r\n\t\treturn _data.version;\r\n\t}\r\n\t\r\n\tprivate static function get_language ():String {\r\n\t\treturn data.language;\r\n\t}\r\n\t\r\n\tprivate static function get_languages ():Array<String> {\r\n\t\treturn data.languages;\r\n\t}\r\n\t\r\n\tprivate static function get_debug ():Bool {\r\n\t\treturn data.debug;\r\n\t}\r\n\t\r\n\tprivate static function get_fps ():Bool {\r\n\t\treturn data.fps;\r\n\t}\r\n\t\r\n\tprivate static function get_qrcode ():Bool {\r\n\t\treturn data.qrcode;\r\n\t}\r\n\t\r\n\tprivate static function get_langPath ():String {\r\n\t\treturn _data.langPath;\r\n\t}\r\n\r\n\tprivate static function get_txtsPath ():String {\r\n\t\treturn _data.txtsPath;\r\n\t}\t\r\n\t\r\n\tprivate static function get_assetsPath ():String {\r\n\t\treturn _data.assetsPath;\r\n\t}\r\n\t\r\n\tprivate static function get_fontsPath ():String {\r\n\t\treturn _data.fontsPath;\r\n\t}\r\n\t\r\n\tprivate static function get_soundsPath ():String {\r\n\t\treturn _data.soundsPath;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.sprites.elements;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule1;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule2;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule3;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant1;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant2;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant3;\r\nimport com.isartdigital.ruby.game.world.Layer;\r\nimport com.isartdigital.ruby.utils.ParticleManager;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.popin.Destruction;\r\nimport com.isartdigital.utils.Debug;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\r\nimport com.isartdigital.utils.game.iso.IZSortable;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport haxe.Json;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\n\r\nimport js.Lib;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins / Julien Fournier\r\n */\r\n\r\n \t/**\r\n\t * month: 0 to 11 // day: 1 to 31 // hour: 0 to 23 // min: 0 to 59 // sec: 0 to 59\r\n\t */\r\n\ttypedef BuildingTime = {\r\n\t\tvar seconds:Int;\r\n\t\tvar minutes:Int;\r\n\t\tvar hours:Int;\r\n\t\tvar days:Int;\r\n\t}\r\n\t\r\n\t\r\nclass GameElement extends PoolObject implements IZSortable\r\n{\t\r\n\tpublic static var JSON_CONFIG:Dynamic = GameLoader.getContent(\"caracBuilding.json\");\r\n\tpublic var colMin:Int;\r\n\tpublic var colMax:Int;\r\n\t\r\n\tpublic var currentState :String;\r\n\t\r\n\tpublic var rowMin:Int;\r\n\tpublic var rowMax:Int;\r\n\t\r\n\tpublic var behind:Array<IZSortable>;\r\n\tpublic var inFront:Array<IZSortable>;\r\n\t\r\n\tpublic var localWidth:Int;\r\n\tpublic var localHeight:Int;\r\n\t\r\n\tpublic var margin:Int = 0;\r\n\t\r\n\tpublic var className:String;\r\n\t\r\n\tpublic var timeToBuild:BuildingTime;\r\n\tpublic var timeToUpgrade:BuildingTime;\r\n\tpublic var dateEndBuilding:Date;\r\n\tpublic var dateStartBuilding:Date;\r\n\r\n\tpublic var level:Int = 1;\r\n\tpublic var maxLevel:Int = 1;\r\n\t\r\n\tprivate var hoverFilter:ColorMatrixFilter = new ColorMatrixFilter();\r\n\tprivate var redFilter:ColorMatrixFilter = new ColorMatrixFilter();\r\n\tprivate var greyFilter:ColorMatrixFilter = new ColorMatrixFilter();\r\n\t\r\n\tpublic var SPAWNING_STATE(default, never):String = \"Spawning\";\r\n\tpublic var CONSTRUCTING_STATE(default, never):String = \"Constructing\";\r\n\tpublic var WAITING_STATE(default, never):String = \"Wait\";\r\n\tpublic var COLLECTING_STATE(default,never):String = \"Recolting\";\r\n\tpublic var UPGRADING_STATE(default,never):String = \"Upgrading\";\r\n\t\r\n\tpublic var currentRegionCoor:Point;\r\n\t\r\n\tpublic var globalPosition:Point;\r\n\tpublic var contextualOpened:Bool = false;\r\n\t\r\n\t\r\n\t\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tclassName = Type.getClassName(Type.getClass(this)).split(\".\").pop();\r\n\t\tname = className;\r\n\t\tinteractive = true;\r\n\t\thoverFilter.matrix = [1.3,0,0,0,0,0,1.3,0,0,0,0,0,1.3,0,0,0,0,0,1,0];\r\n\t\tgreyFilter.matrix = [0.309,0.609,0.082,0,0,0.309,0.609,0.082,0,0,0.309,0.609,0.082,0,0,0,0,0,1,0];\r\n\t\tredFilter.matrix = [1,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];\r\n\t}\r\n\t\r\n\tpublic function changeAsset(pState:String, ?pAutoPlay:Bool = true):Void {\r\n\t\t\r\n\t\tif (pState == UPGRADING_STATE) pState = CONSTRUCTING_STATE;\r\n\t\telse if (pState == \"WaitValidation\") pState = WAITING_STATE;\r\n\t\tif (maxLevel == 1 || Std.is(this, AlienTrainingCenter) || Std.is(this, BuildingCosmeticCapsule1) \r\n\t\t|| Std.is(this, BuildingCosmeticCapsule2) || Std.is(this, BuildingCosmeticCapsule3) || Std.is(this, BuildingCosmeticPlant1) \r\n\t\t|| Std.is(this, BuildingCosmeticCapsule3) || Std.is(this, BuildingCosmeticPlant2) || Std.is(this, BuildingCosmeticCapsule3) || Std.is(this, BuildingCosmeticPlant3)) setState(pState, true, pAutoPlay);\r\n\t\telse setState(pState+\"_Lvl\" + level, true, pAutoPlay);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void {\r\n\t\t//Lib.debug();\r\n\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\t\tinitColAndRow();\r\n\t\t\r\n\t\tdateEndBuilding = pElem.dateEndBuilding;\r\n\t\tdateStartBuilding = pElem.dateStartBuilding;\r\n\t\tcurrentRegionCoor = new Point(pElem.regionX, pElem.regionY);\r\n\t}\r\n\t\r\n\tprivate function initColAndRow():Void\r\n\t{\r\n\t\tcolMin = elem.x;\r\n\t\trowMin = elem.y;\r\n\t\t\r\n\t\tcolMax = colMin + localWidth - 1;\r\n\t\trowMax = rowMin + localHeight - 1;\r\n\t}\r\n\t\r\n\tpublic function changePosition(pX:Int, pY:Int):Void \r\n\t{\r\n\t\tcolMin = pX;\r\n\t\trowMin = pY;\r\n\t}\r\n\t\r\n\t\r\n\tprivate function setTimeToBuild(pSec:Int, pMin:Int, pHour:Int, pDay:Int):Void\r\n\t{\r\n\t\ttimeToBuild = \r\n\t\t{\t\t\r\n\t\t\tseconds:pSec,\r\n\t\t\tminutes:pMin,\r\n\t\t\thours:pHour,\r\n\t\t\tdays:pDay\t\r\n\t\t};\r\n\t}\r\n\t\r\n\tpublic function setModeDestroy():Void {\r\n\t\t\r\n\t\tvar lParticle2:Container = ParticleManager.getInstance().createParticle(\"destroy\", [\"smoke4\",\"sparks3\"], 5000);\r\n\t\tlParticle2.position = this.position.clone();\r\n\t\t\r\n\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"dig\", [\"bloc1\",\"bloc2\",\"bloc3\",\"bloc4\",\"smoke4\"], 5000);\r\n\t\tlParticle.position = this.position.clone();\r\n\t\t\r\n\t\tGameStage.getInstance().getGameContainer().addChild(lParticle);\r\n\t\tGameStage.getInstance().getGameContainer().addChild(lParticle2);\t\r\n\t\t\r\n\t\tDataBaseAction.getInstance().destroyBuilding(elem.instanceID);\r\n\t\tSoundManager.getSound(\"soundPlayerDestroyBuilding\").play();\r\n\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].remove(this);\r\n\t\tdispose(); //  bouger  la fin de l'anim destroy\r\n\t\tPoolObject.elementList.remove(instanceID);\r\n\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\tdoAction = doActionDestroy;\r\n\t}\r\n\t\r\n\tpublic function hasSameCoordonatesAs(pBuilding:GameElement):Bool\r\n\t{\r\n\t\t// if same region and same colmin/rowmin return true\r\n\t\tif (currentRegionCoor.x == pBuilding.currentRegionCoor.x && currentRegionCoor.y == pBuilding.currentRegionCoor.y && colMin == pBuilding.colMin && rowMin == pBuilding.rowMin) return true;\r\n\t\telse return false;\r\n\t}\r\n\t\r\n\t\r\n\t//Filtre\r\n\tpublic function applyHoverFilter():Void \r\n\t{\t\r\n\t\tif (filters == null) {\r\n\t\t\tif (!contextualOpened) {\r\n\t\t\t\r\n\t\t\t\tSoundManager.getSound(\"soundPlayerClic\").play();\r\n\t\t\t\tfilters = [hoverFilter];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function removeHoverFilter():Void \r\n\t{\t\r\n\t\tif (filters != null) filters = null;\r\n\t}\r\n\t\r\n\tpublic function applyGreyFilter():Void \r\n\t{\t\r\n\t\tif (filters == null) filters = [greyFilter];\r\n\t}\r\n\t\r\n\tpublic function removeGreyFilter():Void \r\n\t{\t\r\n\t\tif (filters != null) filters = null;\r\n\t}\r\n\tpublic function applyRedFilter():Void \r\n\t{\t\r\n\t\tif (filters == null) filters = [redFilter];\r\n\t}\r\n\t\r\n\tpublic function removeRedFilter():Void \r\n\t{\t\r\n\t\tif (filters != null) filters = null;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function doActionDestroy():Void {\r\n\t\t\r\n\t}\r\n\r\n\t\r\n\t\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements;\r\n\r\n\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Quart;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.player.XpToLevel;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.BuildingEnergyProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanHeadQuarter;\r\nimport com.isartdigital.ruby.juicy.bullesxp.BullesManager;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.DynamicPopin;\r\nimport com.isartdigital.ruby.ui.popin.TimeBased;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.save.BuildingTypes.BuildingType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.save.ElementSave.EvolveState;\r\nimport com.isartdigital.utils.save.ElementSave.State;\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport eventemitter3.EventEmitter;\r\nimport haxe.Timer;\r\nimport haxe.rtti.CType.Typedef;\r\nimport js.Browser;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.text.Text;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins / fournier Julien / Zegoudia Guillaume / Bourdon Adrien / Jordan Dachicourt\r\n */\r\n\r\n//enum State {}\r\n//enum EvolveState {}\r\n\r\n\r\nclass Building extends GameElement\r\n{\r\n\tpublic var buildingName:String;\r\n\r\n\tpublic var buildingType(default, null):BuildingType;\r\n\t\r\n\t\r\n\tpublic var timeForNextState:Float; //faire getter setter\r\n\tpublic var elapsedTime:Float;\r\n\tpublic var description:String;\r\n\r\n\tpublic var constructTime:String = \"ConstructTime\";\r\n\tpublic var upgradeTime:String = \"UpgradingTimeLevel\";\r\n\tpublic var collectTime:String = \"CollectingTimeLevel\";\r\n\tpublic static inline var WAIT_VALIDATION:String = \"WaitValidation\";\r\n\t\r\n\tpublic var buffType(default, null):String;\r\n\tpublic var buffCoef(default, null):Float;\r\n\t\r\n\tpublic var costSC:Int;\r\n\tpublic var costHC:Int;\r\n\tpublic var costMN:Int;\r\n\tpublic var energyCost(default, null):Int;\r\n\t\r\n\tpublic var costUpgradeSC:Int;\r\n\tpublic var costUpgradeMN:Int;\r\n\tpublic var costUpgradeEnergy:Int;\r\n\tprivate var energyAdded:Int;\r\n\t\r\n\t//private var sablier:UIMovie;\r\n\t\r\n\tpublic var canReceiveAliens:Bool = false;\r\n\tpublic var canReceiveDrillers:Bool = false;\r\n\r\n\tpublic var stateTest:String;\r\n\r\n\tprivate var allowedFilter:ColorMatrixFilter = new ColorMatrixFilter();\r\n\t\r\n\tpublic static var HQinstance:UrbanHeadQuarter;\r\n\t\r\n\tpublic var timerContainer:UISprite;\r\n\tprivate var percentageContainer:SmartText;\r\n\t\r\n\tprivate var hardToSkipTimer:Int = 3;\r\n\t\r\n\tprivate var sellingCost:Int;\r\n\t\r\n\tpublic var timeConstruction:String;\r\n\t\r\n\tpublic static var event:EventEmitter = new EventEmitter();\r\n\t\r\n\r\n\tpublic function new(?pAsset:String=null)\r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tmargin = 1;\r\n\t\tbuildingType = DataManager.getInstance().listBuildingTypes.get(className);\r\n\t\tenergyCost = buildingType.energyCost;\r\n\t\tcostSC = buildingType.softCurrencyCost;\r\n\t\tcostHC = cast(buildingType.hardCurrencyCost);\r\n\t\tcostMN = buildingType.ressourcesCost;\r\n\t\tallowedFilter.matrix = [1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0];\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\toverride public function init(?pElem:Element=null):Void\r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\t//name = pElem.type;\r\n\t\t\r\n\t\tif (pElem.levelUpGrade != null) level = pElem.levelUpGrade;\r\n\t\tcurrentState = pElem.mode;\r\n\t\t\r\n\t\tif (pElem.dateStartBuilding != null) dateStartBuilding = pElem.dateStartBuilding;\r\n\t\t\r\n\t\tglobalPosition = new Point(elem.globalX, elem.globalY);\r\n\t\t\r\n\t\tif (level != maxLevel && !Std.is(this, AlienTrainingCenter))\r\n\t\t{\r\n\t\t\tsetUpgradeCost();\r\n\t\t}\r\n\t\t\r\n\t\tchangeState();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic static function updateBuildingsCarac():Void \r\n\t{\r\n\t\tfor (paddock in AlienPaddock.alienPaddockList) cast(paddock.instance, AlienPaddock).getBuildingOnAera();\r\n\t}\r\n\r\n\toverride public function start():Void\r\n\t{\r\n\t\tboxType = BoxType.SIMPLE;\r\n\t\tfactory = new FlumpMovieAnimFactory();\r\n\t\t\r\n\t\tif (elem == null) currentState = SPAWNING_STATE;\r\n\t\telse\r\n\t\t{\r\n\t\t\tswitch (elem.mode)\r\n\t\t\t{\r\n\t\t\t\tcase \"Constructing\":\r\n\t\t\t\t\tsetModeConstruct();\r\n\t\t\t\tcase \"Recolting\":\r\n\t\t\t\t\tsetModeCollect();\r\n\t\t\t\tcase \"Wait\":\r\n\t\t\t\t\tsetModeNormal();\r\n\t\t\t\tcase \"Upgrading\":\r\n\t\t\t\t\tsetModeConstruct(true);\r\n\t\t\t\tcase \"WaitValidation\":\r\n\t\t\t\t\tsetModeValidationConstruct();\r\n\t\t\t\t\r\n\t\t\t}\t\t\r\n\t\t}\r\n\t\tchangeAsset(currentState);\r\n    }\r\n\t\r\n\tprivate function changeState():Void\r\n\t{\r\n\t\t\r\n\t\tif (elem.mode == CONSTRUCTING_STATE) currentState = CONSTRUCTING_STATE;\r\n\t\tif (elem.mode == COLLECTING_STATE) currentState = COLLECTING_STATE;\r\n\t\tif (elem.mode == WAITING_STATE) currentState = WAITING_STATE;\r\n\t\tif (elem.mode == UPGRADING_STATE) currentState = UPGRADING_STATE;\r\n\t\tif (elem.mode == WAIT_VALIDATION) currentState = WAITING_STATE;\r\n\t}\r\n\r\n\t// Machine  tat : \r\n\tpublic function setModeConstruct(?isUpgrading:Bool = false):Void\r\n\t{\t\t\t\r\n\t\tif (dateEndBuilding == null || isUpgrading)\r\n\t\t{\r\n\t\t\tisUpgrading ? newTimeToUpgrade() : newTimeToBuild();\r\n\t\t\tTimeManager.getInstance().init(this);\r\n\t\t\telem.dateStartBuilding = Date.now(); \r\n\t\t}\r\n\t\t\r\n\t\tisUpgrading ? currentState = UPGRADING_STATE : currentState = CONSTRUCTING_STATE;\r\n\t\tchangeAsset(currentState);\r\n\t\t\r\n\t\tdoAction = doActionConstruct;\r\n\t\telem.dateEndBuilding = dateEndBuilding;\r\n\t\telem.mode = currentState;\r\n\t\tif (isUpgrading) DataBaseAction.getInstance().releaseBuildingMode(elem.instanceID, elem.mode);\r\n\t\treleaseElementList();\r\n\r\n\t\t//timerContainer = new SmartText(GameStage.getInstance().getInfoBulleContainer(), 100, 100, 40, \"Arial Black\", \"white\", \"left\", false, \"blue\", 0.9, 30, 0, 0, 20, 20);\r\n\t\ttimerContainer = new UISprite(\"Building_WaitingTime\");\r\n\t\tGameStage.getInstance().getInfoBulleContainer().addChild(timerContainer);\r\n\t\tvar lPoint:Point = new Point(0, 0);\r\n\t\tlPoint.x = elem.regionX * Region.WIDTH + elem.x;\r\n\t\tlPoint.y = elem.regionY * Region.HEIGHT + elem.y;\r\n\t\ttimerContainer.position = IsoManager.modelToIsoView(lPoint);\r\n\t\ttimerContainer.position.y -= 100;\r\n\t\ttimerContainer.interactive = true;\r\n\t\ttimerContainer.buttonMode = true;\r\n\t\taddBtnSkipCDTimer();\r\n\t\ttimerContainer.name = \"timerContainer\" + name;\r\n\t\tFTUEManager.register(timerContainer);\r\n\t\tvar bump:TweenMax = new TweenMax(\r\n\t\t\ttimerContainer.scale,\r\n\t\t\t0.5,\r\n\t\t\t{\r\n\t\t\t\trepeatDelay:0.3,\r\n\t\t\t\tx:0.9,\r\n\t\t\t\ty:0.9,\r\n\t\t\t\trepeat:-1,\r\n\t\t\t\tease:Quart.easeIn,\r\n\t\t\t\tyoyo:true\r\n\t\t\t}\r\n\t\t\t\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate function doActionConstruct():Void\r\n\t{    \r\n\t\tif(smartTime != null) smartTime.refreshText(TimeManager.getInstance().getTimeToFinishBuildingStringFormat(dateEndBuilding));\r\n\t\tif (TimeManager.getInstance().getTimeInSecondsToFinishBuilding(dateEndBuilding) >= 0)\r\n\t\t{\t\r\n\t\t\t//timerContainer.destroyTimer();\r\n\t\t\t//timerContainer = null;\r\n\t\t\tif (currentState == UPGRADING_STATE) upgrade();\r\n\t\t\tif (timerContainer != null) \r\n\t\t\t{\r\n\t\t\t\ttimerContainer.off(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\t\t\ttimerContainer.on(MouseEventType.MOUSE_OVER, onDisplayTime);\r\n\t\t\t\ttimerContainer.on(MouseEventType.MOUSE_OUT, offDisplayTime);\r\n\t\t\t\tGameStage.getInstance().getInfoBulleContainer().removeChild(timerContainer);\r\n\t\t\t}\r\n\t\t\tsetModeValidationConstruct();\r\n\r\n\t\t\t//dateEndBuilding = null;\r\n\t\t\t//elem.dateEndBuilding = dateEndBuilding;\r\n\t\t\t//releaseElementList();\t\t\r\n\t\t}\r\n\t\t\r\n\t\telse  timeConstruction = TimeManager.getInstance().getTimeToFinishBuildingStringFormat(elem.dateEndBuilding);\r\n\t}\r\n\t\r\n\tprivate function setModeValidationConstruct():Void\r\n\t{\r\n\t\tstateTest = DEFAULT_STATE;\r\n\t\tcurrentState = WAITING_STATE;\r\n\t\tchangeAsset(WAITING_STATE);\r\n\t\tfilters = null;\r\n\t\telem.mode = WAIT_VALIDATION;\r\n\t\treleaseElementList();\r\n\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\tDataBaseAction.getInstance().releaseBuildingMode(elem.instanceID, elem.mode);\r\n\t\tif (!BullesManager.getInstance().isBuildingHasBulles(instanceID)) BullesManager.getInstance().initBulles(100, this);\r\n\t\tSoundManager.getSound(\"soundPlayerFinishCreateBuilding\").play();\r\n\t\tdoAction = doActionValidationConstruct;\r\n\t}\r\n\r\n\tprivate function doActionValidationConstruct():Void\r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\toverride private function setModeNormal():Void\r\n\t{\r\n\t\tstateTest = DEFAULT_STATE;\r\n\t\tcurrentState = WAITING_STATE;\r\n\t\tchangeAsset(currentState);\r\n\t\tfilters = null;\r\n\t\telem.mode = currentState;\r\n\t\treleaseElementList();\r\n\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\tDataBaseAction.getInstance().releaseBuildingMode(elem.instanceID, elem.mode);\r\n\t\tsuper.setModeNormal();\r\n\t\t/*var graph:Graphics = new Graphics();\r\n\t\tgraph.beginFill();\r\n\t\tgraph.drawRect(x - 100, y - 200, width, height);\r\n\t\tgraph.endFill();\r\n\t\taddChild(graph);\r\n\t\tgraph.alpha = 0.3;*/\r\n\t}\r\n\r\n\toverride private function doActionNormal():Void\r\n\t{\r\n\t\tsuper.doActionNormal();\r\n\t}\r\n\t\r\n\tprivate function setModeCollect():Void {\r\n\t\t\r\n\t\t\r\n\t\tcurrentState = COLLECTING_STATE;\r\n\t\tchangeAsset(currentState);\r\n\t\telem.mode = currentState;\r\n\t\treleaseElementList();\r\n\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\tDataBaseAction.getInstance().releaseBuildingMode(elem.instanceID, elem.mode);\r\n\t\t\r\n\t\tdoAction = doActionCollecting;\r\n\t}\r\n\t\r\n\tprivate function doActionCollecting():Void {\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tpublic function setModeMove():Void\r\n\t{\r\n\r\n\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].remove(this);\r\n\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].container.removeChild(this);\r\n\t\tSpawner.getInstance().moveBuilding(this);\r\n\t}\r\n\t\r\n\t// Methodes : \r\n\t//\r\n\tpublic function onBulleExplose():Void\r\n\t{\r\n\t    Timer.delay(onTime, 1500);\r\n\t\t//var lXp:Int = FTUEManager.isFTUEon()? XpToLevel.xpToNextLevel[Player.getInstance().level]:20;\r\n\t\t//Player.getInstance().addExp(lXp);\r\n\t\tsetModeNormal();\r\n\t}\r\n\t\r\n\tprivate function onTime():Void\r\n\t{\r\n\t\tvar lXp:Int = FTUEManager.isFTUEon()? Math.round(XpToLevel.xpToNextLevel[Player.getInstance().level] / Player.getInstance().level):20;\r\n\t\tif (Player.getInstance().level == 2) lXp = 20; \r\n\t\tPlayer.getInstance().addExp(lXp);\r\n\t\tevent.emit(\"onBulle\");\r\n\t}\r\n\t\r\n\t//Upgrade :\r\n\t\r\n\tpublic function startUpgrading():Void {\r\n\t\r\n\t\tif (level < maxLevel) {\r\n\t\t\tpayForUpgrade();\r\n\t\t\tsetModeConstruct(true);\r\n\t\t\tSoundManager.getSound(\"soundBuildingUpgrade\").play();\r\n\t\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function upgrade():Void\r\n\t{\r\n\t\tif (level < maxLevel)\r\n\t\t{\r\n\t\t\tenergyCost = costUpgradeEnergy;\r\n\t\t\telem.levelUpGrade = ++level;\r\n\t\t\tchangeAsset(currentState);\r\n\t\t\treleaseElementList();\r\n\t\t\tDataManager.getInstance().save(PoolObject.elementList);\r\n\t\t\tDataBaseAction.getInstance().changeBuildingLevel(elem.instanceID, level);\r\n\t\t\tif (level != maxLevel) setUpgradeCost();\r\n\t\t\tchangeBehavior();\r\n\t\t\tPlayer.getInstance().addExp(35);\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function changeBehavior():Void {\r\n\t\r\n\t\tswitch (level) {\r\n\t\t\r\n\t\t\tcase 2:\r\n\t\t\t\tchangeBehaviorLevel2();\r\n\t\t\tcase 3:\r\n\t\t\t\tchangeBehaviorLevel3();\r\n\t\t\tcase 4:\r\n\t\t\t\tchangeBehaviorLevel4();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function changeBehaviorLevel2():Void {\r\n\t\r\n\t\t\r\n\t}\r\n\tprivate function changeBehaviorLevel3():Void {\r\n\t\r\n\t\t\r\n\t}\r\n\tprivate function changeBehaviorLevel4():Void {\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function canAffordUpgrade():Bool {\r\n\t\t\r\n\t\tenergyAdded = (costUpgradeEnergy - energyCost);\r\n\t\t\r\n\t\tif (GameManager.getInstance().godMode) return true;\r\n\t\r\n\t\tvar lHasEnoughSC:Bool = Player.getInstance().hasEnoughQuantity(costUpgradeSC, Player.getInstance().softCurrency);\r\n\t\tvar lHasEnoughMN:Bool = Player.getInstance().hasEnoughQuantity(costUpgradeMN, Player.getInstance().ressource);\r\n\t\tvar lHasEnoughNRJ:Bool = Player.getInstance().hasEnoughEnergy(energyAdded);\r\n\t\t\r\n\t\tif (lHasEnoughSC && lHasEnoughMN && lHasEnoughNRJ) return true;\r\n\t\telse {\r\n\t\t\r\n\t\t\tif (!lHasEnoughMN) Hud.getInstance().noMaterialAnimation();\r\n\t \t\tif (!lHasEnoughSC) Hud.getInstance().noSCAnimation();\r\n\t \t\tif (!lHasEnoughNRJ) Hud.getInstance().noEnergyAnimation();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tprivate function setUpgradeCost():Void {\r\n\t\r\n\t\t\r\n\t\tvar JSON_CONFIG:Dynamic = GameElement.JSON_CONFIG;\r\n\t\tvar lTimeToUpgrade : String = upgradeTime+Std.string(level + 1);\r\n\t\tcostUpgradeSC = Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).costSC;\r\n\t\tcostUpgradeMN = Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).costMN;\r\n\t\tcostUpgradeEnergy = Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).costEnergy;\r\n\t}\r\n\t\r\n\tprivate function payForUpgrade():Void {\r\n\t\r\n\t\tif (!GameManager.getInstance().godMode) {\r\n\t\t\tPlayer.getInstance().changePlayerValue(-costUpgradeSC, Player.TYPE_SOFTCURRENCY, false);\r\n\t\t\tPlayer.getInstance().changePlayerValue( -costUpgradeMN, Player.TYPE_RESSOURCE, false);\r\n\t\t\tPlayer.getInstance().increaseEnergyConsumed(energyAdded);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t//Timer && button :\r\n\tpublic function newTimeToBuild():Void\r\n\t{\r\n\t\tvar JSON_CONFIG:Dynamic = GameElement.JSON_CONFIG;\r\n\t\ttimeToBuild =\r\n\t\t{\r\n\t\t\tseconds:Reflect.field(Reflect.field(JSON_CONFIG, className), constructTime).seconds,\r\n\t\t\tminutes:Reflect.field(Reflect.field(JSON_CONFIG, className), constructTime).minutes,\r\n\t\t\thours:Reflect.field(Reflect.field(JSON_CONFIG, className), constructTime).hours,\r\n\t\t\tdays:Reflect.field(Reflect.field(JSON_CONFIG, className), constructTime).days\r\n\t\t};\r\n\t}\r\n\t\r\n\tpublic function newTimeToUpgrade():Void\r\n\t{\r\n\t\tvar JSON_CONFIG:Dynamic = GameElement.JSON_CONFIG;\r\n\t\t\r\n\t\tvar lTimeToUpgrade : String = upgradeTime+Std.string(level + 1);\r\n\t\t\r\n\t\ttimeToBuild =\r\n\t\t{\r\n\t\t\tseconds:Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).seconds,\r\n\t\t\tminutes:Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).minutes,\r\n\t\t\thours:Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).hours,\r\n\t\t\tdays:Reflect.field(Reflect.field(JSON_CONFIG, className), lTimeToUpgrade).days\r\n\t\t};\r\n\t}\r\n\t\r\n\tprivate function addBtnSkipCDTimer():Void\r\n\t{\r\n\t\ttimerContainer.on(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\ttimerContainer.on(MouseEventType.MOUSE_OVER, onDisplayTime);\r\n\t\ttimerContainer.on(MouseEventType.MOUSE_OUT, offDisplayTime);\r\n\t}\r\n\t\r\n\tprivate var smartTime:SmartText;\r\n\tprivate function onDisplayTime():Void\r\n\t{\r\n\t\tsmartTime = new SmartText(GameStage.getInstance().getInfoBulleContainer(), 100, 100, 40, \"Arial Black\", \"white\", \"left\", false, \"blue\", 0, 30, 0, 0, 20, 20);\r\n\t\tsmartTime.refreshText(TimeManager.getInstance().getTimeToFinishBuildingStringFormat(dateEndBuilding));\r\n\t\ttimerContainer.addChild(smartTime);\r\n\t\tsmartTime.position.x -= 100;\r\n\t\tsmartTime.position.y -= 150;\r\n\t}\r\n\t\r\n\tprivate function offDisplayTime():Void\r\n\t{\r\n\t\tif (smartTime != null) timerContainer.removeChild(smartTime);\r\n\t\tsmartTime = null;\r\n\t}\r\n\r\n\t/**\r\n\t * ouvre la popin de confirmation et l'initialise\r\n\t */\r\n\tprivate function onSkipCdTimer():Void\r\n\t{\r\n\t\t\r\n\t\tUIManager.getInstance().openPopin(TimeBased.getInstance());\r\n\t\t//if (!FTUEManager.isFTUEon()) DynamicPopin.getInstance().init(\"Acclerer le temps en dpensant \" + hardToSkipTimer + \" cristaux ?\", cdTimerSkiped);\r\n\t\t//else DynamicPopin.getInstance().init(\"Gratuit pour cette fois\", cdTimerSkiped);\r\n\t\tTimeBased.getInstance().setText(this);\r\n\t}\r\n\t\r\n\t/**\r\n\t * skip le cooldown et retire la hardCurrency si le joueur en a assez\r\n\t */\r\n\tpublic function cdTimerSkiped():Void \r\n\t{\r\n\t\tif (Player.getInstance().hasEnoughQuantity(hardToSkipTimer, Player.getInstance().hardCurrency) || Spawner.getInstance().godMode)\r\n\t\t{\r\n\t\t\tif (timerContainer != null) {\r\n\t\t\t\ttimerContainer.off(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\t\t\ttimerContainer.off(MouseEventType.MOUSE_OVER, onDisplayTime);\r\n\t\t\t\ttimerContainer.off(MouseEventType.MOUSE_OUT, offDisplayTime);\r\n\t\t\t}\r\n\t\t\tdateEndBuilding = Date.now();\r\n\t\t\tif (FTUEManager.currentStep >= FTUEManager.steps.length) Player.getInstance().changePlayerValue( -hardToSkipTimer, Player.TYPE_HARDCURRENCY);\r\n\t\t\tGameStage.getInstance().getInfoBulleContainer().removeChild(timerContainer);\r\n\t\t\t//timerContainer.destroyTimer();\r\n\t\t\t//timerContainer = null;\r\n\t\t\tif (currentState == UPGRADING_STATE) upgrade();\r\n\t\t\tsetModeValidationConstruct();\r\n\t\t\t//dateEndBuilding = null;\r\n\t\t\telem.dateEndBuilding = dateEndBuilding;\r\n\t\t\treleaseElementList();\r\n\t\t}\r\n\t\telse Hud.getInstance().noHCAnimation();\r\n\t}\r\n\r\n\t//Position & Move\r\n\toverride public function changePosition(pX:Int, pY:Int)\r\n\t{\r\n\t\tsuper.changePosition(pX, pY);\r\n\t\tcolMax = colMin + localWidth - 1;\r\n\t\trowMax = rowMin + localHeight - 1;\r\n\t}\r\n\r\n\t\r\n\r\n\tpublic function saveNewPosition(pX:Int, pY:Int, ?pRegionX:Int=null, ?pRegionY:Int=null):Void\r\n\t{\r\n\t\tvar lRegion:Region = Spawner.getInstance().currentRegion;\r\n\t\telem.x = cast(pX);\r\n\t\telem.y = cast(pY);\r\n\t\tposition = IsoManager.modelToIsoView(new Point(pX, pY));\r\n\t\tvar lGlobalPoint = new Point(0, 0);\r\n\t\tlGlobalPoint.x = lRegion.x * Region.WIDTH + pX;\r\n\t\tlGlobalPoint.y = lRegion.y * Region.HEIGHT + pY;\r\n\t\tlGlobalPoint = IsoManager.modelToIsoView(lGlobalPoint);\r\n\t\telem.globalX = lGlobalPoint.x;\r\n\t\telem.globalY = lGlobalPoint.y;\r\n\t\tinitColAndRow();\r\n\t\tglobalPosition = new Point(elem.globalX, elem.globalY);\r\n\t\telem.regionX = (pRegionX == null ? lRegion.x : pRegionX);\r\n\t\telem.regionY = (pRegionY == null ? lRegion.y : pRegionY);\r\n\t\tcurrentRegionCoor = new Point(elem.regionX, elem.regionY);\r\n\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].add(this);\r\n\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].container.addChild(this);\r\n\r\n\t\tDataBaseAction.getInstance().releaseBuildingPosition(elem.instanceID, elem.regionX, elem.regionY, elem.x, elem.y);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t//Energy\r\n\t/**\r\n\t * lors de l'ajout d'un batiment ajoute l'energie qu'il consomme au player\r\n\t */\r\n\tpublic function addEnergyToPlayer():Void\r\n\t{\r\n\t\tPlayer.getInstance().increaseEnergyConsumed(energyCost);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\toverride public function setModeDestroy():Void \r\n\t{\r\n\t\tsuper.setModeDestroy();\r\n\t\tPlayer.getInstance().changePlayerValue(sellingCost, Player.TYPE_SOFTCURRENCY, false);\r\n\t\tPlayer.getInstance().increaseEnergyConsumed( -energyCost);\r\n\t\tBuilding.updateBuildingsCarac();\r\n\t}\r\n\t\r\n\t//Filtre\r\n\tpublic function applyAllowedFilter():Void \r\n\t{\t\r\n\t\tif (filters == null) filters = [allowedFilter];\r\n\t}\r\n\t\r\n\tpublic function removeAllowedFilter():Void \r\n\t{\t\r\n\t\tif (filters != null) filters = null;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\toverride public function dispose():Void \r\n\t{\r\n\t\tif (BullesManager.getInstance().isBuildingHasBulles(instanceID)) BullesManager.getInstance().destroyGroupOfBulles(instanceID, true);\r\n\t\tif (timerContainer != null) \r\n\t\t{\r\n\t\t\ttimerContainer.off(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\t\ttimerContainer.off(MouseEventType.MOUSE_OVER, onDisplayTime);\r\n\t\t\ttimerContainer.off(MouseEventType.MOUSE_OUT, offDisplayTime);\r\n\t\t\tGameStage.getInstance().getInfoBulleContainer().removeChild(timerContainer);\r\n\t\t\ttimerContainer = null;\r\n\t\t}\r\n\t\tsuper.dispose();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass AlienCryoCenter extends Building\r\n{\r\n\tpublic var xenosStorage:Array<AlienElement> = [];\r\n\t\r\n\tprivate var storageLength:UInt = 15; // a modif aprs le playtest\r\n\tprivate var lengthSizeFactor:UInt = 2;\r\n\tpublic function new(?pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"CryoCenter\";\r\n\t\tdescription = \"Stocke les xenos implaables.\";\r\n\t\tlocalWidth = 3;\r\n\t\tlocalHeight = 3;\r\n\t\tmaxLevel = 4;\r\n\t\tcanReceiveAliens = false;\r\n\t\tsellingCost = 4375;\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element = null):Void \r\n\t{\r\n\t\t\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\t\tfor (alien in Alien.alienElementList)\r\n\t\t{\r\n\t\t\tif (alien.idBuilding == elem.instanceID)\r\n\t\t\t{\r\n\t\t\t\txenosStorage.push(alien);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienEsthetique;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\n\r\ntypedef AlienCarac =\r\n{\r\n\tvar alien:Alien;\r\n\tvar dateStartCreation:Date;\r\n\tvar dateEndCreation:Date;\r\n}\r\nclass AlienIncubator extends Building\r\n{\r\n\r\n\t//public var currentAlienCreating(default, set):Alien;\r\n\r\n\tpublic var alienOneCreating:Bool;\r\n\tpublic var alienTwoCreating:Bool;\r\n\r\n\tpublic var alienSlot1:AlienElement;\r\n\tpublic var alienSlot2:AlienElement;\r\n\r\n\tprivate var alienSlot1Time:Date;\r\n\tprivate var alienSlot2Time:Date;\r\n\r\n\tpublic function new(pAsset:String=null)\r\n\t{\r\n\t\tsuper(pAsset);\r\n\r\n\t\tbuildingName = \"Incubator\";\r\n\t\tdescription = \"Permet de crer un Xnos.\";\r\n\t\tlocalWidth = 6;\r\n\t\tlocalHeight = 3;\r\n\t\tmaxLevel = 2;\r\n\t\tcanReceiveAliens = true;\r\n\t\tsellingCost = 3125;\r\n\t}\r\n\r\n\toverride public function init(?pElem:Element=null):Void\r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t}\r\n\r\n\toverride public function start():Void\r\n\t{\r\n\t\tsuper.start();\r\n\t\tif ((alienSlot1 != null && alienSlot1.mode == \"Constructing\") || (alienSlot2 != null && alienSlot2.mode == \"Constructing\")) doAction = doActionCollecting;\r\n\t}\r\n\r\n\toverride function setModeCollect():Void\r\n\t{\r\n\t\tsuper.setModeCollect();\r\n\t}\r\n\r\n\toverride function doActionCollecting():Void\r\n\t{\r\n\t\t//super.doActionCollecting();\r\n\t\tif (alienSlot1 == null && alienSlot2 == null)\r\n\t\t{\r\n\t\t\tsetModeNormal();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (alienSlot1 != null && alienSlot1Time == null && alienSlot1.endTime != null) alienSlot1Time = Date.fromString(alienSlot1.endTime);\r\n\t\tif (alienSlot2 != null && alienSlot2Time == null && alienSlot2.endTime != null) alienSlot2Time = Date.fromString(alienSlot2.endTime);\r\n\r\n\t\tif (alienSlot1 != null && alienSlot1Time != null)\r\n\t\t{\r\n\t\t\tif (TimeManager.getInstance().getTimeInSecondsToFinishBuilding(alienSlot1Time) >= 0)\r\n\t\t\t{\r\n\t\t\t\tAlien.alienElementList[Alien.alienElementList.indexOf(alienSlot1)].mode = \"Waiting\";\r\n\t\t\t\talienSlot1.mode = \"Waiting\";\r\n\t\t\t\tDataBaseAction.getInstance().releaseAlienMode(alienSlot1.idAlien, alienSlot1.mode);\r\n\t\t\t\talienSlot1 = null;\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tif (alienSlot2 != null && alienSlot2Time != null)\r\n\t\t{\r\n\t\t\tif (TimeManager.getInstance().getTimeInSecondsToFinishBuilding(alienSlot2Time) >= 0)\r\n\t\t\t{\r\n\t\t\t\tAlien.alienElementList[Alien.alienElementList.indexOf(alienSlot2)].mode = \"Waiting\";\r\n\t\t\t\talienSlot2 = null;\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic function addAlien(pAlien:Dynamic, pSlotAlien:Int, pCategory:String ):Void\r\n\t{\r\n\t\t\r\n\t\t\r\n\t\tvar lAlien:Dynamic = Reflect.getProperty(this, \"alienSlot\" + pSlotAlien);\r\n\r\n\t\tvar alienID:String = pAlien.name+Date.now().getTime();\r\n\r\n\t\tvar lAlienElem:AlienElement =\r\n\t\t{\r\n\t\t\tidAlien:alienID,\r\n\t\t\tidBuilding:this.elem.instanceID,\r\n\t\t\tmode:\"Constructing\",\r\n\t\t\tname:pAlien.name,\r\n\t\t\ttype:pAlien.type,\r\n\t\t\tnomPropre:\"\",\r\n\t\t\tstamina:Std.int(pAlien.stamina),\r\n\t\t\t//level:Std.int(pAlien.level),\r\n\t\t\tlevel:1,\r\n\t\t\tstartTime:null,\r\n\t\t\tendTime:null,\r\n\t\t\tcarac:Alien.getAlienType(\"name\", DataManager.getInstance().getAlienArray(pAlien.type)),\r\n\t\t\tidPlayer:Player.getInstance().id\r\n\t\t}\r\n\t\tAlien.alienElementList.push(lAlienElem);\r\n\t\tDataBaseAction.getInstance().addAlien(alienID, this.elem.instanceID, pAlien.type, pAlien.name, \"\", pAlien.stamina, pAlien.time);\r\n\t\tReflect.setProperty(this, \"alienSlot\" + pSlotAlien, lAlienElem); /************ !!!!!a push egalement dans le codex!!!!! *****************/\r\n\t\tdoAction = doActionCollecting;\r\n\t\t//TO DO : ajouter alien dans les slots, demarrer le mode creation, ajouter les aliens dans les slots au chargement.\r\n\t}\r\n\r\n\tprivate function setTime(pAlienSlot:AlienElement, pAlienSlotTime:Date):Void\r\n\t{\r\n\t\tpAlienSlotTime = Date.fromString(pAlienSlot.endTime);\r\n\t\t\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBufferType;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingAutoOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.BuildingEnergyProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanPowerStation;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.ruby.utils.ColorFilterManager;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager;\r\nimport com.greensock.TweenLite;\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Back;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager.RessourceType;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager.RessourcesEffectParams;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienPaddockable;\r\nimport com.isartdigital.ruby.game.sprites.ressources.Bubble;\r\nimport com.isartdigital.ruby.game.sprites.ressources.RessourceSoftCurrency;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.DynamicPopin;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.ruby.utils.SmartShaker;\r\nimport com.isartdigital.ruby.utils.SmartShaker.ShakerParams;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport eventemitter3.EventEmitter;\r\nimport haxe.Timer;import com.isartdigital.utils.ui.smart.SmartComponent;import pixi.core.graphics.Graphics;\r\nimport js.Browser;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.textures.Texture;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass AlienPaddock extends Building\r\n{\r\n\t\r\n\tpublic static var alienPaddockList:Array<Element> = new Array<Element>();\r\n\tprivate var alienProds:Array<AlienProducer>;\r\n\tprivate var alienBuffers:Array<AlienBuffer>;\r\n\tpublic var totalAliens:Array<AlienElement>;\r\n\tpublic var prodContainer:SmartText;\r\n\tprivate var hardToSkip:Int = 3;\r\n\tprivate var isFilled:Bool;\r\n\tprivate var currentRessources:Float = 0;\r\n\tprivate var maxRessources:Float = 0;\r\n\tprivate var buildingBuffedList:Array<Building> = new Array<Building>();\r\n\tprivate var buffAera:Graphics;\r\n\tprivate var buffAeraSize:Int = 3;\r\n\tpublic var room:Int;\r\n\tpublic static var event:EventEmitter = new EventEmitter();\r\n\t\r\n\t\r\n\tpublic function new(pAsset:String=null)\r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Paddock\";\r\n\t\tdescription = \"Permet de placer des Xnos pour qu'ils produisent de l'or.\";\r\n\t\talienProds = new Array<AlienProducer>();\r\n\t\talienBuffers = new Array<AlienBuffer>();\r\n\t\ttotalAliens = new Array<AlienElement>();\r\n\t\tcanReceiveAliens = true;\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function addAlien(pAlienElem:AlienElement):Void {\r\n\t\t\r\n\t\tfor (alien in totalAliens) if (pAlienElem == alien) {\r\n\t\t\tMapInteractor.getInstance().stopAlienMode();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tif (totalAliens.length >= room) {\r\n\t\t\tMapInteractor.getInstance().stopAlienMode();\r\n\t\t\tBrowser.alert(\"Plus de place dans l'enclos\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpAlienElem.idBuilding = elem.instanceID;\r\n\t\t\tDataBaseAction.getInstance().changeAlienIdBuilding(pAlienElem.idAlien, pAlienElem.idBuilding);\r\n\t\t\tMapInteractor.getInstance().stopAlienMode();\r\n\t\t\t//SoundManager.getSound(\"soundPlayerPutXenos\").play();\r\n\t\t\tdisplayAliens();\r\n\t\t}\r\n\t\t\r\n\t\tevent.emit(\"onAddAlien\");\r\n\t}\r\n\t\r\n\tpublic function removeAlien(pAlienElem:AlienElement):Void {\r\n\t\r\n\t\tpAlienElem.idBuilding = \"no Building\";\r\n\t\tDataBaseAction.getInstance().changeAlienIdBuilding(pAlienElem.idAlien, pAlienElem.idBuilding);\r\n\t\ttotalAliens.splice(totalAliens.indexOf(pAlienElem), 1);\r\n\t\tif (pAlienElem.type == \"AlienBuffer\") removeBuffer(pAlienElem);\r\n\t\telse if (pAlienElem.type == \"AlienProducer\") removeProducer(pAlienElem);\r\n\t\tSoundManager.getSound(\"soundPlayerRetakeXenos\").play();\r\n\t\tdisplayAliens();\r\n\t}\r\n\t\r\n\tprivate function removeBuffer(pAlienElem:AlienElement):Void {\r\n\t\r\n\t\tvar lLength:Int = alienBuffers.length;\r\n\t\tfor (i in 0...lLength) {\r\n\t\t\r\n\t\t\tif (alienBuffers[i].aElem == pAlienElem) {\r\n\t\t\t\tGameStage.getInstance().getAlienContainer().removeChild(alienBuffers[i]);\r\n\t\t\t\talienBuffers.splice(alienBuffers.indexOf(alienBuffers[i]), 1);\r\n\t\t\t\tSoundManager.getSound(\"soundPlayerSelectXenosBomber\").play();\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function removeProducer(pAlienElem:AlienElement):Void {\r\n\t\r\n\t\tvar lLength:Int = alienProds.length;\r\n\t\tfor (i in 0...lLength) {\r\n\t\t\r\n\t\t\tif (alienProds[i].aElem == pAlienElem) {\r\n\t\t\t\tGameStage.getInstance().getAlienContainer().removeChild(alienProds[i]);\r\n\t\t\t\talienProds.splice(alienProds.indexOf(alienProds[i]), 1);\r\n\t\t\t\tSoundManager.getSound(\"soundPlayerSelectXenosForeur\").play();\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//initialisation\r\n\toverride public function init(?pElem:Element=null):Void\r\n\t{\r\n\t\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\t\tif (alienPaddockList.indexOf(this.elem) == -1) alienPaddockList.push(this.elem);\r\n\t\t\r\n\t\tdisplayAliens();\r\n\t}\r\n\t\r\n\tprivate function displayAliens():Void {\r\n\t\r\n\t\tfor (i in 0...Alien.alienElementList.length) {\r\n\t\t\r\n\t\t\tvar lAlienElem: AlienElement = Alien.alienElementList[i];\r\n\t\t\tif (lAlienElem.idBuilding == instanceID) createAlien(lAlienElem);\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tprivate function createAlien(pAlienElem:AlienElement):Void {\r\n\t\t\r\n\t\t\r\n\t\ttotalAliens.push(pAlienElem);\r\n\t\t\r\n\t\tvar lIndex:Int = totalAliens.indexOf(pAlienElem);\r\n\t\t\r\n\t\t\r\n\t\t// DRYIFIER\r\n\t\tif (pAlienElem.type == \"AlienBuffer\") {\r\n\t\t\tvar lAlien:AlienBuffer = new AlienBuffer();\r\n\t\t\tlAlien.setElem(pAlienElem);\r\n\t\t\tGameStage.getInstance().getAlienContainer().addChild(lAlien);\r\n\t\t\tlAlien.start();\r\n\t\t\tlAlien.ownPaddock = this;\r\n\t\t\tlAlien.position = setPosition(lIndex);\r\n\t\t\tvar isoPos:Point = IsoManager.isoViewToModel(setPosition(lIndex));\r\n\t\t\tlAlien.setPosition(isoPos);\r\n\t\t\talienBuffers.push(lAlien);\r\n\t\t\tSoundManager.getSound(\"soundPlayerChooseXenosForeur\").play();\r\n\t\t}\r\n\t\tif (pAlienElem.type == \"AlienProducer\") {\r\n\t\t\tvar lAlien:AlienProducer = new AlienProducer();\r\n\t\t\tlAlien.setElem(pAlienElem);\r\n\t\t\tGameStage.getInstance().getAlienContainer().addChild(lAlien);\r\n\t\t\tlAlien.start();\r\n\t\t\tlAlien.ownPaddock = this;\r\n\t\t\tlAlien.position = setPosition(lIndex);\r\n\t\t\tvar isoPos:Point = IsoManager.isoViewToModel(setPosition(lIndex));\r\n\t\t\tlAlien.setPosition(isoPos);\r\n\t\t\talienProds.push(lAlien);\r\n\t\t\tcheckForContainer();\r\n\t\t\t\r\n\t\t}\r\n\t\tSoundManager.getSound(\"soundPlayerChooseXenosBomber\").play();\r\n\t}\r\n\t\r\n\tprivate function setPosition(pIndex:Int):Point {\r\n\t\r\n\t\treturn new Point(elem.globalX, elem.globalY);\r\n\t}\r\n\r\n\t//machine  tat\r\n\toverride private function setModeNormal():Void\r\n\t{\r\n\t\tcheckForContainer();\r\n\t\tsuper.setModeNormal();\r\n\r\n\t}\r\n\t\r\n\t\r\n\tprivate function checkForContainer():Void {\r\n\t\r\n\t\t\r\n\t\tif (alienProds.length > 0) \r\n\t\t{\t\t\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\toverride private function doActionNormal():Void\r\n\t{\r\n\t\tsuper.doActionNormal();\r\n\t\tvar lTotalRessources:Float = 0;\r\n\t\tvar lTotalMaxProd:Float = 0;\r\n\t\t\r\n\t\tfor (alien in alienProds)\r\n\t\t{\r\n\t\t\talien.doAction();\r\n\t\t\tlTotalRessources += alien.ressources;\r\n\t\t\tlTotalMaxProd += alien.maxProduction;\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif (lTotalMaxProd != maxRessources || lTotalRessources != currentRessources) {\r\n\t\t\tcurrentRessources = lTotalRessources;\r\n\t\t\tmaxRessources = lTotalMaxProd;\r\n\t\t}\r\n\t\tif (alienProds.length > 0 && areTheyAllFilled()) {\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function areTheyAllFilled():Bool {\r\n\t\tfor (alien in alienProds) {\r\n\t\t\tif (!alien.isFilled) return false;\r\n\t\t}\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic function setModeCollectable():Void\r\n\t{\r\n\t\tchangebuttonToCollect();\r\n\t\tisFilled = true;\r\n\t\tdoAction = doActionCollectable;\r\n\t\t\r\n\t}\r\n\r\n\tprivate function doActionCollectable()\r\n\t{\r\n\t\tfor (alien in alienProds) alien.doAction();\r\n\t}\r\n\r\n\t//methodes\r\n\r\n\t/**\r\n\t * ajoute un ecouteur de clic sur prodContainer\r\n\t */\r\n\tprivate function changebuttonToCollect():Void\r\n\t{\r\n\t\ttrace(\"harvest\");\r\n\t}\r\n\r\n\t/**\r\n\t * met un ecouteur sur les ressources\r\n\t */\r\n\tprivate function addBtnSkipCooldown():Void\r\n\t{\r\n\t\tprodContainer.on(MouseEventType.CLICK, onSkipCooldown);\r\n\t}\r\n\r\n\t/**\r\n\t * ouvre la popin de confirmation et l'initialise\r\n\t */\r\n\tprivate function onSkipCooldown():Void\r\n\t{\r\n\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\tDynamicPopin.getInstance().init(\"skip cooldown with \"+ hardToSkip + \" hard currency ?\", cooldownSkiped);\r\n\t}\r\n\t\r\n\t/**\r\n\t * skip le cooldown et retire la hardCurrency si le joueur en a assez\r\n\t */\r\n\tprivate function cooldownSkiped():Void \r\n\t{\r\n\t\t\r\n\t\tisFilled = true;\r\n\t\tif (Player.getInstance().hasEnoughQuantity(hardToSkip, Player.getInstance().hardCurrency))\r\n\t\t{\r\n\t\t\tfor (alien in alienProds) alien.isFilled = true;\r\n\t\t\tPlayer.getInstance().changePlayerValue( -hardToSkip, Player.TYPE_HARDCURRENCY);\r\n\t\t\t\r\n\t\t\tcooldownSkipedAnimation();\r\n\t\t}\r\n\t\telse\t\r\n\t\t\tHud.getInstance().noHCAnimation();\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * callback du clic sur le prodContainer\r\n\t */\r\n\tpublic function onCollect():Void\r\n\t{\r\n\t\tisFilled = false;\t\t\r\n\t\tcollect();\r\n\t\tsetModeNormal();\r\n\t}\r\n\t\r\n\tprivate function collect() {\r\n\t\t\t\t\r\n\t\tvar lAllRessources:Float = 0;\r\n\t\tSoundManager.getSound(\"soundPlayerHarvest\").play();\r\n\t\tressourceCollectAnimation();\r\n\t\t\r\n\t\tfor (alien in alienProds){\r\n\t\t\tlAllRessources += alien.ressources;\r\n\t\t\talien.isFilled = false;\r\n\t\t}\r\n\t\t\r\n\t\tPlayer.getInstance().changePlayerValue(lAllRessources, Player.TYPE_SOFTCURRENCY);\r\n\t}\r\n\t\r\n\tprivate function cooldownSkipedAnimation() {\r\n\t\tvar ressourceHCgoToBuilding : RessourcesEffectParams = \r\n\t\t\t{\r\n\t\t\t\toriginalPosition: GameStage.getInstance().getHudContainer().toLocal(Hud.getInstance().hcAddButton.parent.toGlobal(Hud.getInstance().hcAddButton.position.clone())),\r\n\t\t\t\tdestinationPosition : GameStage.getInstance().getHudContainer().toLocal(parent.toGlobal(position.clone())),\r\n\t\t\t\twhereToAddchild: GameStage.getInstance().getHudContainer(),\r\n\t\t\t\tnumObjectsToInstanciate: hardToSkip,\r\n\t\t\t\tduration:1,\r\n\t\t\t\tsecondsBtwnaddchilds:1,\r\n\t\t\t\tspeed:0.2,\r\n\t\t\t\tanimationType:\"dispersionToCurve\",\r\n\t\t\t\tressource: RessourceType.HardCurrency,\r\n\t\t\t}\r\n\r\n\t\t\tRessourcesEffectManager.getInstance().SetEffect(ressourceHCgoToBuilding);\r\n\t}\r\n\t\r\n\tprivate function ressourceCollectAnimation() {\r\n\t\tvar ressourceSCgoToHud : RessourcesEffectParams = \r\n\t\t\t{\r\n\t\t\t\toriginalPosition: GameStage.getInstance().getHudContainer().toLocal(parent.toGlobal(position.clone())),\r\n\t\t\t\tdestinationPosition : GameStage.getInstance().getHudContainer().toLocal(Hud.getInstance().scAddButton.parent.toGlobal(Hud.getInstance().scAddButton.position.clone())),\r\n\t\t\t\twhereToAddchild: GameStage.getInstance().getHudContainer(),\r\n\t\t\t\tnumObjectsToInstanciate: 20,\r\n\t\t\t\tduration:1,\r\n\t\t\t\tsecondsBtwnaddchilds:1,\r\n\t\t\t\tspeed:0.2,\r\n\t\t\t\tanimationType:\"dispersionToCurve\",\r\n\t\t\t\tressource: RessourceType.SoftCurrency,\r\n\t\t\t}\r\n\r\n\t\tRessourcesEffectManager.getInstance().SetEffect(ressourceSCgoToHud);\r\n\t}\r\n\r\n\t/**\r\n\t * Ajoute un alien au batiment\r\n\t * @param\tpType : nom de class de l'alien\r\n\t */\r\n\tprivate function addProducer(pType:String) :Void\r\n\t{\r\n\t\tvar lAlien:AlienProducer = new AlienProducer();\r\n\t\talienProds.push(lAlien);\r\n\t}\r\n\t\r\n\tprivate function addBuffer(pName:String):Void \r\n\t{\r\n\t\tvar lBuffer:AlienBuffer = new AlienBuffer(pName);\r\n\t\tlBuffer.initBuff();\r\n\t\talienBuffers.push(lBuffer);\r\n\t\tif (buffAeraSize != null) buffAeraSize = 3;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * recupre les building dans la zone de buff\r\n\t * @param\tpBuffAera : zone de buff\r\n\t */\r\n\tpublic function getBuildingOnAera(?pIsFirstLoad:Bool = false):Void {\r\n\t\tvar listBuildingCanBeBuff:Array<Building> = new Array<Building>();\r\n\t\tvar lRegion:Region = World.getInstance().getRegion(elem.regionX, elem.regionY);\r\n\t\tlRegion.layers[1].getCell(elem.x, elem.y);\r\n\t\tvar xMin:Int = colMin - buffAeraSize;\r\n\t\tvar xMax:Int = colMax + buffAeraSize;\r\n\t\tvar yMin:Int = rowMin - buffAeraSize;\r\n\t\tvar yMax:Int = rowMax + buffAeraSize;\r\n\t\tfor (x in xMin...xMax+1\t)\r\n\t\t{\r\n\t\t\tfor ( y in yMin...yMax+1)\r\n\t\t\t{\r\n\t\t\t\tif (lRegion.layers[1].getCell(x, y) != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar lBuilding:Building = cast(lRegion.layers[1].getCell(x, y), Building);\r\n\t\t\t\t\tif (Std.is(lBuilding, AlienPaddock)) continue;\r\n\t\t\t\t\tif (listBuildingCanBeBuff.indexOf(lBuilding) == -1 && isBuildingCanBeBuff(lBuilding)) listBuildingCanBeBuff.push(lBuilding);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (buildingBuffedList != listBuildingCanBeBuff && !pIsFirstLoad) updateBuildingBuffedList(listBuildingCanBeBuff);\r\n\t\telse if(pIsFirstLoad) buildingBuffedList = listBuildingCanBeBuff;\r\n\t}\r\n\t\r\n\t/**\r\n\t * met  jour la liste de building buff en fonction de la liste de building a buff\r\n\t * @param\tpArray\r\n\t */\r\n\tprivate function updateBuildingBuffedList(pArray:Array<Building>):Void\r\n\t{\r\n\t\tvar lBuilding:Building;\r\n\t\tvar lBuildingToDebuff:Array<Building> = new Array<Building>();\r\n\t\tvar lBuildingToBuff:Array<Building> = new Array<Building>();\r\n\t\t\r\n\t\tvar i:Int = buildingBuffedList.length -1;\r\n\t\twhile (i >= 0) \r\n\t\t{\r\n\t\t\tlBuilding = buildingBuffedList[i];\r\n\t\t\tif (pArray.indexOf(lBuilding) == -1) \r\n\t\t\t{\r\n\t\t\t\tlBuildingToDebuff.push(lBuilding);\r\n\t\t\t\tbuildingBuffedList.remove(lBuilding);\r\n\t\t\t}\r\n\t\t\ti--;\r\n\t\t}\r\n\t\tfor (i in 0...pArray.length)\r\n\t\t{\r\n\t\t\tlBuilding = pArray[i];\r\n\t\t\tif (buildingBuffedList.indexOf(lBuilding) == -1) \r\n\t\t\t{\r\n\t\t\t\tlBuildingToBuff.push(lBuilding);\r\n\t\t\t\tbuildingBuffedList.push(lBuilding);\r\n\t\t\t}\r\n\t\t}\r\n\t\tAddOrRemoveBuff(lBuildingToDebuff, false);\r\n\t\tAddOrRemoveBuff(lBuildingToBuff, true);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Modifie le comportement des building a buff ou debuff\r\n\t * @param\tpArray : liste de building a buff\r\n\t * @param\tisAdd : true pour ajouter un buff, false pour le retirer\r\n\t */\r\n\tprivate function AddOrRemoveBuff(pArray:Array<Building>, ?isAdd:Bool = true):Void\r\n\t{\r\n\t\tfor (alien in alienBuffers)\r\n\t\t{\r\n\t\t\tif (alien.buffType == \"energy\") \r\n\t\t\t{\r\n\t\t\t\tfor (building in pArray) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (Std.is(building, BuildingEnergyProducer))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcast(building, BuildingEnergyProducer).Buff(alien.buffCoef, isAdd);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (alien.buffType == \"darkMater\")\r\n\t\t\t{\r\n\t\t\t\tfor (building in pArray) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (Std.is(building, DrillingAutoOutPost) || Std.is(building, DrillingCenter))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcast(building, BuildingEnergyProducer).Buff(alien.buffCoef, isAdd);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse if (alien.buffType == \"gene\")\r\n\t\t\t{\r\n\t\t\t\tfor (building in pArray) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (Std.is(building, DrillingAutoOutPost) || Std.is(building, DrillingCenter)) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcast(building, BuildingEnergyProducer).Buff(alien.buffCoef, isAdd);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * verifie si pBuilding peut recevoir un buff\r\n\t * @param\tpBuilding : Building\r\n\t * @return true si il peut\r\n\t */\r\n\tprivate function isBuildingCanBeBuff(pBuilding:Building):Bool\r\n\t{\r\n\t\tif (Std.is(pBuilding, BuildingEnergyProducer)|| Std.is(pBuilding, DrillingCenter) || Std.is(pBuilding, DrillingAutoOutPost)) return true;\r\n\t\telse return false;\r\n\t}\r\n\r\n\toverride public function applyHoverFilter():Void \r\n\t{\r\n\t\tsuper.applyHoverFilter();\r\n\t\tif (alienBuffers.length > 0 && buffAera == null) showBuffAera();\r\n\t}\r\n\t\r\n\toverride public function removeHoverFilter():Void \r\n\t{\r\n\t\tsuper.removeHoverFilter();\r\n\t\tif (buffAera != null) \r\n\t\t{\r\n\t\t\tbuffAera.clear();\r\n\t\t\tGameStage.getInstance().getGameContainer().removeChild(buffAera);\r\n\t\t\tbuffAera = null;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * cre graphiquement la zone de buff\r\n\t */\r\n\tprivate function initBuffAeraGraph():Void \r\n\t{\r\n\t\tbuffAera = new Graphics();\r\n\t\tbuffAera.alpha = 0.2;\t\r\n\t\tbuffAera.clear();\r\n\t\tbuffAera.beginFill(0xccff99);\r\n\t\t\r\n\t\tvar lStart:Point = IsoManager.isoViewToModel(position);\r\n\t\tvar lIsoTop:Point = IsoManager.modelToIsoView(new Point(lStart.x - buffAeraSize, lStart.y - buffAeraSize));\r\n\t\tvar lIsoRight:Point = IsoManager.modelToIsoView(new Point(lStart.x + localWidth  + buffAeraSize, lStart.y - buffAeraSize));\r\n\t\tvar lIsoBottom:Point = IsoManager.modelToIsoView(new Point(lStart.x + localWidth + buffAeraSize, lStart.y + localHeight + buffAeraSize));\r\n\t\tvar lIsoLeft:Point = IsoManager.modelToIsoView(new Point(lStart.x - buffAeraSize, lStart.y + localHeight + buffAeraSize));\r\n\t\tbuffAera.drawPolygon\r\n\t\t([\r\n\t\t\tlIsoTop.x, lIsoTop.y,\r\n\t\t\tlIsoRight.x, lIsoRight.y,\r\n\t\t\tlIsoBottom.x, lIsoBottom.y,\r\n\t\t\tlIsoLeft.x, lIsoLeft.y\r\n        ]);\t\r\n\t\t\r\n\t\tbuffAera.endFill();\t\t\r\n\t}\r\n\tprivate function showBuffAera():Void \r\n\t{\r\n\t\tif (buffAera == null) initBuffAeraGraph();\r\n\t\tif (buffAera != null) GameStage.getInstance().getGameContainer().addChild(buffAera);\r\n\t}\r\n\t\r\n\toverride public function dispose():Void \r\n\t{\r\n\t\tif (prodContainer != null) \r\n\t\t{\r\n           if (isFilled) prodContainer.off(MouseEventType.CLICK, onCollect);\r\n\t\t   else prodContainer.off(MouseEventType.CLICK, onSkipCooldown);\r\n\t\t   prodContainer.destroyTimer();\r\n\t\t}\r\n\t\t\r\n\t\tfor (alien in alienProds) {\r\n\t\t\r\n\t\t\talien.dispose();\r\n\t\t}\r\n\t\t\r\n\t\tfor (alien in alienBuffers) {\r\n\t\t\r\n\t\t\talien.dispose();\r\n\t\t}\r\n\t\tsuper.dispose();\r\n\t}\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass AlienResearchCenter extends Building\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\t\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Reseerch Center\";\r\n\t\tdescription = \"Permet d'effectuer des recherches scientifiques pour dcouvrir des schmas de nouvelles races xenos.\";\r\n\t\tlocalWidth = 4;\r\n\t\tlocalHeight = 3;\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(0, 0, 1, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\r\n\t\t/*\r\n\r\n\t\tInsrez ces lignes utile au timerMAnager Quand le joueur pose un batiment\r\n\t\tTimeManager.getInstance().init(this);\r\n\t\tendOfBuildTime = TimeManager.getInstance().getEndOfBuildDate();\r\n\t\t*/\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.popin.upgradeCenter.UpgradeCenter;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass AlienTrainingCenter extends Building\r\n{\r\n\r\n\tpublic var slot1Bought:Bool;\r\n\tpublic var slot2Bought:Bool;\r\n\t\r\n\tpublic var aliens:Array<AlienElement>;\r\n\tpublic var alien:AlienElement;\r\n\t\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Training Center\";\r\n\t\tdescription = \"Permet de faire evoluer les xnos.\";\r\n\t\tlocalWidth = 3;\r\n\t\tlocalHeight = 3;\r\n\t\tsellingCost = 6250;\r\n\t\tcanReceiveAliens = true;\r\n\t\tmaxLevel = 3;\r\n\t\taliens = [];\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(0, 0, 1, 0);\r\n\t}\r\n\t\r\n\toverride public function upgrade():Void \r\n\t{\r\n\t\tsuper.upgrade();\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\r\n\t\tif (level == 2) slot1Bought = true;\r\n\t\tif (level == 3) slot2Bought = true;\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function addAlien(pAlienElem:AlienElement):Void {\r\n\t\t\r\n\t\t\r\n\t\tpAlienElem.idBuilding = elem.instanceID;\r\n\t\talien = pAlienElem;\r\n\t\tDataBaseAction.getInstance().changeAlienIdBuilding(pAlienElem.idAlien, pAlienElem.idBuilding);\r\n\t\tMapInteractor.getInstance().stopAlienMode();\r\n\t\tSoundManager.getSound(\"soundPlayerPutXenos\").play();\r\n\t\tUpgradeCenter.getInstance().initializationCurrentBuildingTrainingCenter(this);\r\n\t\tUpgradeCenter.getInstance().setAlien();\r\n\t\tUIManager.getInstance().openPopin(UpgradeCenter.getInstance());\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass AlienPaddockBig extends AlienPaddock\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tlocalWidth = 3;\r\n\t\tlocalHeight = 2;\r\n\t\tsuper(pAsset);\r\n\t\troom = 6;\r\n\t\tsellingCost = 3750;\r\n\t\tdescription = \"Placez-y jusqu' 6 xenos produisant de l'or\";\r\n\t}\r\n\t\r\n\toverride function setPosition(pIndex:Int):Point \r\n\t{\r\n\t\tvar lPos:Point;\r\n\t\t\r\n\t\tswitch(pIndex) {\r\n\t\t\r\n\t\t\tcase 0:\r\n\t\t\t\treturn new Point(elem.globalX, elem.globalY);\r\n\t\t\tcase 1:\r\n\t\t\t\treturn new Point(elem.globalX+100, elem.globalY+50);\r\n\t\t\tcase 2:\r\n\t\t\t\treturn new Point(elem.globalX+200, elem.globalY+100);\r\n\t\t\tcase 3:\r\n\t\t\t\treturn new Point(elem.globalX-100, elem.globalY+50);\r\n\t\t\tcase 4:\r\n\t\t\t\treturn new Point(elem.globalX, elem.globalY+100);\r\n\t\t\tcase 5:\r\n\t\t\t\treturn new Point(elem.globalX+100, elem.globalY+150);\r\n\t\t}\r\n\t\t\r\n\t\treturn new Point(0, 0);\r\n\t}\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass AlienPaddockMedium extends AlienPaddock\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\t\r\n\t\tlocalWidth = 2;\r\n\t\tlocalHeight = 2;\r\n\t\tsuper(pAsset);\r\n\t\troom = 4;\r\n\t\tdescription = \"Placez-y jusqu' 4 xenos produisant de l'or\";\r\n\t\tsellingCost = 2500;\r\n\t}\r\n\t\r\n\toverride function setPosition(pIndex:Int):Point \r\n\t{\r\n\t\tvar lPos:Point;\r\n\t\t\r\n\t\tswitch(pIndex) {\r\n\t\t\r\n\t\t\tcase 0:\r\n\t\t\t\treturn new Point(elem.globalX, elem.globalY);\r\n\t\t\tcase 1:\r\n\t\t\t\treturn new Point(elem.globalX+100, elem.globalY+50);\r\n\t\t\tcase 2:\r\n\t\t\t\treturn new Point(elem.globalX-100, elem.globalY+50);\r\n\t\t\tcase 3:\r\n\t\t\t\treturn new Point(elem.globalX, elem.globalY+100);\r\n\t\t}\r\n\t\t\r\n\t\treturn new Point(0, 0);\r\n\t}\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass AlienPaddockSmall extends AlienPaddock\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tlocalWidth = 3;\r\n\t\tlocalHeight = 1;\r\n\t\tsuper(pAsset);\r\n\t\tdescription = \"Placez-y jusqu' 3 xenos produisant de l'or\";\r\n\t\troom = 3;\r\n\t\tsellingCost = 2000;\r\n\t}\r\n\t\r\n\t\r\n\toverride function setPosition(pIndex:Int):Point \r\n\t{\r\n\t\tvar lPos:Point;\r\n\t\t\r\n\t\tswitch(pIndex) {\r\n\t\t\r\n\t\t\tcase 0:\r\n\t\t\t\treturn new Point(elem.globalX, elem.globalY);\r\n\t\t\tcase 1:\r\n\t\t\t\treturn new Point(elem.globalX+100, elem.globalY+50);\r\n\t\t\tcase 2:\r\n\t\t\t\treturn new Point(elem.globalX+200, elem.globalY+100);\r\n\t\t}\r\n\t\t\r\n\t\treturn new Point(0, 0);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass AlienPaddockTiny extends AlienPaddock\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tlocalWidth = 1;\r\n\t\tlocalHeight = 1;\r\n\t\tdescription = \"Placez-y jusqu' 1 xenos produisant de l'or\";\r\n\t\tsuper(pAsset);\r\n\t\troom = 1;\r\n\t\tsellingCost = 1000;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.aliens;\r\nimport com.isartdigital.utils.save.AlienTypes.AlienEsthetiqueTypes;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass AlienEsthetique extends Alien\r\n{\r\n\r\n\tpublic static var esthetiqueTypes:Array<AlienEsthetiqueTypes> = new Array<AlienEsthetiqueTypes>();\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n    public static function loadTypes(pTypes:Dynamic):Void \r\n\t{\r\n\t\testhetiqueTypes = pTypes;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\r\nimport com.isartdigital.utils.game.iso.IZSortable;\r\nimport pixi.core.math.Point;\r\nimport pixi.flump.Movie;\r\nimport sys.db.Types.STimeStamp;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass AlienPaddockable extends Alien implements IZSortable\r\n{\r\n\tpublic var aElem : AlienElement;\r\n\t\r\n\tpublic var colMin:Int;\r\n\t\r\n\tpublic var colMax:Int;\r\n\t\r\n\tpublic var rowMin:Int;\r\n\t\r\n\tpublic var rowMax:Int;\r\n\t\r\n\tpublic var behind:Array<IZSortable>;\r\n\t\r\n\tpublic var inFront:Array<IZSortable>;\r\n\t\r\n\tpublic var ownPaddock:AlienPaddock;\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setPosition(pPos:Point):Void {\r\n\t\r\n\t\tcolMin = colMax = cast(pPos.x);\r\n\t\trowMin = rowMax = cast(pPos.y);\r\n\t}\r\n\t\r\n\tpublic function setPaddock(pPaddock:AlienPaddock):Void {\r\n\t\r\n\t\townPaddock = pPaddock;\r\n\t\ton(MouseEventType.CLICK, onClickk);\r\n\t}\r\n\t\r\n\tprivate function onClickk():Void {\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\tpublic function setElem(pElem:AlienElement):Void {\r\n\t\r\n\t\taElem = pElem;\r\n\t\tassetName = aElem.name;\r\n\t\tlevel = aElem.level;\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tboxType = BoxType.NONE;\r\n\t\tfactory = new FlumpMovieAnimFactory();\r\n\t\t\r\n\t\tchangeAsset(\"Harvest\");\r\n\r\n\t}\r\n\t\r\n\tpublic function changeAsset(pState:String):Void {\r\n\t\r\n\t\tsetState(pState+\"_Lvl\" + level);\r\n\t}\r\n\t//gestion des etats graphiques\r\n\t\r\n\t\r\n\tprivate function loopanim():Void {\r\n\t\r\n\t\tif (cast(anim, Movie).currentFrame >= cast(anim, Movie).totalFrames -2) changeAsset(\"Harvest\");\r\n\t}\r\n}\r\n\r\n","package com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienPaddockable;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.AlienTypes.AlienBuffersType;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass AlienBuffer extends AlienPaddockable\r\n{\r\n\tpublic static var buffTypes:Array<AlienBufferType>;\r\n\tprivate var carac:AlienBufferType;\r\n\tpublic var buffType(default, null):String;\r\n\tpublic var buffCoef(default, null):Float;\r\n\t\r\n\tpublic static var bufferTypes:Array<AlienBuffersType> = new Array<AlienBuffersType>();\r\n\t\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tname = pAsset;\r\n\t\tbuffTypes = GameLoader.getContent(\"../balance/alienBalance.json\").buffers;\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tpublic static function loadTypes(pTypes:Dynamic):Void \r\n\t{\r\n\t\tbufferTypes = pTypes;\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tsetModeBuff();\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * initalise les type et le coef de buff de cet alien\r\n\t */\r\n\tpublic function initBuff():Void\r\n\t{\r\n\t\tfor (alienType in buffTypes)\r\n\t\t{\r\n\t\t\tif (alienType.name == name) carac = alienType;\r\n\t\t}\r\n\t\tif (carac == null) return;\r\n\t\tbuffType = carac.buffType;\r\n\t\tbuffCoef = Reflect.getProperty(carac, \"coef\" + level); \r\n\t}\r\n\t\r\n\tprivate function setModeBuff():Void {\r\n\t\tdoAction = doActionBuff;\r\n\t}\r\n\t\r\n\tprivate function doActionBuff():Void {\r\n\t\tloopanim();\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable;\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Quart;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienPaddockable;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager.RessourcesEffectParams;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.save.AlienTypes.AlienProducerType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass AlienProducer extends AlienPaddockable\r\n{\r\n\t//valeurs de production de ressources \r\n\tpublic var maxProduction(default, null):Int = 10000;\r\n\tpublic var productionSpeedCoef(default, null):Int = 1;\r\n\tpublic var productionPerCycle(default, null):Int = 1000;\r\n\tpublic var cycleTimeInMin(default, null):Int = 1;\r\n\tpublic var ressources(default, null):Int = 0;\r\n\t\r\n\t//variables de temps\r\n\tprivate var startTime:Date;\r\n\tprivate var endTime:Date;\r\n\t\r\n\t//list des types\r\n\tpublic static var prodTypes:Array<AlienProducerType> = new Array<AlienProducerType>();\r\n\t\r\n\t//l'alien est-il a son max de ressource recolt\r\n\tpublic var isFilled:Bool = false;\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\t\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tif (aElem.startTime != null && aElem.endTime != null)\r\n\t\t{\r\n\t\t\tstartTime = Date.fromString(aElem.startTime);\r\n\t\t\tendTime = Date.fromString(aElem.endTime);\r\n\t\t}\r\n\t\tif (FTUEManager.isFTUEon()) \r\n\t\t{\r\n\t\t\tressources = maxProduction;\r\n\t\t\tsetModeFilled();\r\n\t\t}\r\n\t\telse if (endTime != null)\r\n\t\t{\r\n\t\t\tif (Date.now().getTime() >= endTime.getTime()) \r\n\t\t\t{\r\n\t\t\t\tressources = maxProduction;\r\n\t\t\t\tsetModeFilled();\r\n\t\t\t}\r\n\t\t\telse setModeProduction();\r\n\t\t}\t\r\n\t\telse setModeProduction();\r\n\t}\r\n\tpublic static function loadTypes(pTypes:Dynamic):Void \r\n\t{\r\n\t\tprodTypes = pTypes;\r\n\t}\r\n\t\r\n\t\t//machine  tat\r\n\tpublic\t function setModeProduction():Void\r\n\t{\r\n\t\tif (ressources == 0) \r\n\t\t{\r\n\t\t\tcalculateEndProductionTime();\r\n\t\t}\r\n\t\tdoAction = doActionProduction;\r\n\t}\r\n\t\r\n\tprivate function doActionProduction():Void\r\n\t{\r\n\t\tloopanim();\r\n\t\tressources = Math.round((TimeManager.getInstance().getPercentage(startTime, endTime) * maxProduction) / 100);\r\n\t\tif (TimeManager.getInstance().getTimeInSecondsToFinishBuilding(endTime) >= 0 || isFilled) setModeFilled();\r\n\t\t\r\n\t}\r\n\t\r\n\tvar gold:UISprite;\r\n\tpublic function setModeFilled():Void \r\n\t{\r\n\t\tisFilled = true;\r\n\t\tressources = maxProduction;\r\n\t\tdoAction = doActionFilled;\r\n\t\tgold = new UISprite(\"Building_Harvest\");\r\n\t\taddChild(gold);\r\n\t\tgold.position.y -= 70;\r\n\t\tvar bump:TweenMax = new TweenMax(\r\n\t\t\tgold.scale,\r\n\t\t\t0.5,\r\n\t\t\t{\r\n\t\t\t\trepeatDelay:0.3,\r\n\t\t\t\tx:0.95,\r\n\t\t\t\ty:0.95,\r\n\t\t\t\trepeat:-1,\r\n\t\t\t\tease:Quart.easeIn,\r\n\t\t\t\tyoyo:true\r\n\t\t\t}\r\n\t\t\t\r\n\t\t);\r\n\t\ton(MouseEventType.CLICK, onHarve);\r\n\t\ton(TouchEventType.TAP, onHarve);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function doActionFilled():Void \r\n\t{\r\n\t\tloopanim();\r\n\t\tif (!isFilled) {\r\n\t\t\tressources = 0;\r\n\t\t\tsetModeProduction();\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t//methodes\r\n\t\r\n\t/**\r\n\t * calcule le temps de production de ressource d'un alien en fonction de :\r\n\t * maxProduction : maximum de ressources qu'il peut avoir\r\n\t * cyleTimeInMin & productionPerCycle : le temps d'un cycle et la quantit de ressource produite pour un cycle\r\n\t * productionSpeedCoef : un facteur d'acclration \r\n\t */\r\n\tprivate function calculateEndProductionTime():Void\r\n\t{\r\n\t\tstartTime = Date.now();\r\n\t\tvar lStartTimeStamps:Float = startTime.getTime();\r\n\t\t\r\n\t\tvar time:Float = Math.fround((maxProduction / productionPerCycle) * (cycleTimeInMin * productionSpeedCoef) * 60000);\r\n\t\t\r\n\t\tvar lEndtimeStamps:Float = lStartTimeStamps + time;\t\t\r\n\t\t\r\n\t\tendTime = Date.fromTime(lEndtimeStamps);\r\n\t\taElem.startTime = startTime.toString();\r\n\t\taElem.endTime = endTime.toString();\r\n\t}\t\r\n\t\r\n\tprivate function onHarve():Void\r\n\t{\r\n\t\toff(MouseEventType.CLICK, onHarve);\r\n\t\toff(TouchEventType.TAP, onHarve);\r\n\t\tremoveChild(gold);\r\n\t\tSoundManager.getSound(\"soundPlayerHarvest\").play();\r\n\t\tressourceCollectAnimation();\r\n\t\tPlayer.getInstance().changePlayerValue(ressources, Player.TYPE_SOFTCURRENCY);\r\n\t\tressources = 0;\r\n\t\tisFilled = false;\r\n\t\tsetModeProduction();\r\n\t}\r\n\t\r\n\tprivate function ressourceCollectAnimation() {\r\n\t\tvar ressourceSCgoToHud : RessourcesEffectParams = \r\n\t\t\t{\r\n\t\t\t\toriginalPosition: GameStage.getInstance().getHudContainer().toLocal(parent.toGlobal(position.clone())),\r\n\t\t\t\tdestinationPosition : GameStage.getInstance().getHudContainer().toLocal(Hud.getInstance().scAddButton.parent.toGlobal(Hud.getInstance().scAddButton.position.clone())),\r\n\t\t\t\twhereToAddchild: GameStage.getInstance().getHudContainer(),\r\n\t\t\t\tnumObjectsToInstanciate: 20,\r\n\t\t\t\tduration:1,\r\n\t\t\t\tsecondsBtwnaddchilds:1,\r\n\t\t\t\tspeed:0.2,\r\n\t\t\t\tanimationType:\"dispersionToCurve\",\r\n\t\t\t\tressource: RessourceType.SoftCurrency,\r\n\t\t\t}\r\n\r\n\t\tRessourcesEffectManager.getInstance().SetEffect(ressourceSCgoToHud);\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tif (gold != null) removeChild(gold);\r\n\t\toff(MouseEventType.CLICK, onHarve);\r\n\t\toff(TouchEventType.TAP, onHarve);\r\n\t\tsuper.destroy();\r\n\t}\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass CosmeticBuilding extends Building\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\t//pAsset= \"CosmeticFluoAlga\";\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Decorative\";\r\n\t\t//setTimeToBuild(1, 0, 0, 0);\r\n\t\tmargin = 0;\r\n\t\tlocalWidth = 1;\r\n\t\tlocalHeight = 1;\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null) \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\t\t\r\n\t\tcolMin = pElem.x;\r\n\t\trowMin = pElem.y;\r\n\t\telem.mode = WAITING_STATE;\r\n\t\tsellingCost = Std.int(elem.softCurrency / 4);\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t}\r\n\toverride public function changeAsset(pState:String, ?pAutoPlay:Bool = true):Void \r\n\t{\r\n\t\t//super.changeAsset(pState, pAutoPlay);\r\n\t\tsetState(\"\", true, pAutoPlay);\r\n\t}\r\n\t\r\n\t/*override public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\t//setModeNormal();\r\n\t}*/\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\nimport flump.library.Label;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticCapsule1 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_CAPSULE1);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticCapsule2 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_CAPSULE2);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticCapsule3 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_CAPSULE3);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticPlant1 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_PLANT1);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticPlant2 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_PLANT2);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass BuildingCosmeticPlant3 extends CosmeticBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tdescription = Localization.getLabel(LocalizationByType.COSMETIC_PLANT3);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.destructible;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.popin.DynamicPopin;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.save.DestructableType;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport js.Lib;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass Destructible extends GameElement\r\n{\r\n\r\n\tpublic static var arrayConfigDestructible(default, null):Array<String> = [];\r\n\tpublic static var totalConfig(default, null) = 5;\r\n\tprivate var timerContainer:SmartText;\r\n\tprivate var percentageContainer:SmartText;\r\n\r\n\tpublic var timeToDestroy:Date;\r\n\r\n\tpublic var destructableType(default, null):DestructableType;\r\n\r\n\tpublic function new(pAsset:String=null)\r\n\t{\r\n\t\tsuper(pAsset);\r\n\t}\r\n\r\n\toverride public function init(?pElem:Element=null):Void\r\n\t{\r\n\t\tvar lDestructible:DestructableType = DataManager.getInstance().listDestructableTypes.get(pElem.assetName);\r\n\t\tlocalWidth = lDestructible.width;\r\n\t\tlocalHeight = lDestructible.height;\r\n\t\tsuper.init(pElem);\r\n\t\tassetName = elem.assetName;\r\n\t\tdestructableType = DataManager.getInstance().listDestructableTypes.get(assetName);\r\n\t\tvar timeString:String = DataManager.getInstance().listDestructableTypes.get(assetName).destructionTime;\r\n\t\tvar arrayTime:Array<String> = timeString.split(\":\");\r\n\t}\r\n\r\n\toverride public function start():Void\r\n\t{\r\n\t\tsuper.start(); changeState();\r\n\t}\r\n\r\n\tprivate function changeState():Void\r\n\t{\r\n\t\tif (elem.mode == \"Destruction\") setModeDestruction();\r\n\t}\r\n\r\n\tprivate function convertTimeStamp(pHour:Int, pMin:Int, pSec:Int):Float\r\n\t{\r\n\t\tvar lMin:Float = pMin;\r\n\t\tvar lHour:Float = pHour;\r\n\r\n\t\tlMin *= 60;\r\n\t\tlHour *= 3600;\r\n\r\n\t\treturn DateTools.seconds(pSec + lMin + lHour);\r\n\t}\r\n\r\n\tpublic function setModeDestruction():Void\r\n\t{\r\n\r\n\t\tdoAction = doActionDestruction;\r\n\t\treleaseElementList();\r\n\r\n\t\ttimerContainer = new SmartText(GameStage.getInstance().getInfoBulleContainer(), 100, 100, 40, \"Arial Black\", \"white\", \"left\", false, \"blue\", 0.9, 30, 0, 0, 20, 20);\r\n\t\tGameStage.getInstance().getInfoBulleContainer().addChild(timerContainer);\r\n\t\taddChild(timerContainer);\r\n\t\ttimerContainer.interactive = true;\r\n\t\ttimerContainer.buttonMode = true;\r\n\t\taddBtnSkipCDTimer();\r\n\r\n\t}\r\n\r\n\tpublic function destructionDB():Void\r\n\t{\r\n\t\tvar dataTime:String = DataManager.getInstance().listDestructableTypes.get(assetName).destructionTime;\r\n\t\tvar arrayTime:Array<String> = dataTime.split(\":\");\r\n\t\telem.dateStartBuilding = Date.now();\r\n\t\tdateStartBuilding = elem.dateStartBuilding;\r\n\t\telem.dateEndBuilding = DateTools.delta(dateStartBuilding, convertTimeStamp(Std.parseInt(arrayTime[0]), Std.parseInt(arrayTime[1]), Std.parseInt(arrayTime[2])));\r\n\t\tdateEndBuilding = elem.dateEndBuilding;\r\n\t\telem.mode = \"Destruction\";\r\n\t\tDataBaseAction.getInstance().releaseDestructibleMode(elem.assetName, elem.instanceID, elem.mode);\r\n\t\tsetModeDestruction();\r\n\t}\r\n\r\n\tprivate function doActionDestruction():Void\r\n\t{\r\n\t\tif (TimeManager.getInstance().getTimeInSecondsToFinishBuilding(dateEndBuilding) >= 0)\r\n\t\t{\r\n\t\t\tcreateArtefact();\r\n\t\t\ttimerContainer.destroyTimer();\r\n\t\t\tDataBaseAction.getInstance().destroyDestructible(elem.instanceID);\r\n\t\t\tWorld.getInstance().getRegion(cast(currentRegionCoor.x, Int), cast(currentRegionCoor.y, Int)).layers[1].remove(this);\r\n\t\t\tdispose(); //  bouger  la fin de l'anim destroy\r\n\t\t\tPoolObject.elementList.remove(instanceID);\r\n\t\t}\r\n\r\n\t\telse{\r\n\t\t\ttimerContainer.refreshText(TimeManager.getInstance().getTimeToFinishBuildingStringFormat(elem.dateEndBuilding));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function addBtnSkipCDTimer():Void\r\n\t{\r\n\t\ttimerContainer.on(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\ttimerContainer.on(TouchEventType.TAP, onSkipCdTimer);\r\n\t}\r\n\r\n\t/**\r\n\t * ouvre la popin de confirmation et l'initialise\r\n\t */\r\n\tprivate function onSkipCdTimer():Void\r\n\t{\r\n\t\tvar cost:Int = DataManager.getInstance().listDestructableTypes.get(assetName).skipHCCost;\r\n\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\tif (!FTUEManager.isFTUEon()) DynamicPopin.getInstance().init(\"skip cooldown with \" + cost + \" hard currency ?\", cdTimerSkiped);\r\n\t\telse DynamicPopin.getInstance().init(\"FTUE gratuit\", cdTimerSkiped);\r\n\t}\r\n\r\n\tprivate function cdTimerSkiped():Void\r\n\t{\r\n\t\tvar cost:Int = DataManager.getInstance().listDestructableTypes.get(assetName).skipHCCost;\r\n\t\tif (Player.getInstance().hasEnoughQuantity(cost, Player.getInstance().hardCurrency) || Spawner.getInstance().godMode)\r\n\t\t{\r\n\t\t\ttimerContainer.off(MouseEventType.CLICK, onSkipCdTimer);\r\n\t\t\tdateEndBuilding = Date.now();\r\n\t\t\tif (!FTUEManager.isFTUEon()) Player.getInstance().changePlayerValue(-cost, Player.TYPE_HARDCURRENCY);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function createArtefact():Void\r\n\t{\r\n\t\tvar random:Int = Math.round(Math.random() +1);\r\n\r\n\t\tvar elemToSpawn:String = \"DestructiblePebbles\" + random;\r\n\t\tvar lDestructible:Destructible = new Destructible(elemToSpawn);\r\n\t\tvar lElement:Element =\r\n\t\t{\r\n\t\t\tinstanceID:elemToSpawn + Date.now().getTime(),\r\n\t\t\ttype:elemToSpawn,\r\n\t\t\twidth:DataManager.getInstance().listDestructableTypes.get(elemToSpawn).width,\r\n\t\t\theight:DataManager.getInstance().listDestructableTypes.get(elemToSpawn).height,\r\n\t\t\tx:elem.x,\r\n\t\t\ty:elem.y,\r\n\t\t\tglobalX:elem.globalX,\r\n\t\t\tglobalY:elem.globalY,\r\n\t\t\tregionX:elem.regionX,\r\n\t\t\tregionY:elem.regionY,\r\n\t\t\tlayer:0,\r\n\t\t\tassetName: elemToSpawn,\r\n\t\t\tmode:\"Waiting\"\r\n\t\t\t//dateEndBuilding:Date.now(),\r\n\t\t\t//dateStartBuilding:Date.now(),\r\n\t\t\t//softCurrency:DataManager.getInstance().listDestructableTypes.get(destructible.type).softCurrencyCost\r\n\t\t}\r\n\t\tlDestructible.init(lElement);\r\n\t\tlDestructible.start();\r\n\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).layers[0].add(lDestructible);\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).layers[0].container.addChild(lDestructible);\r\n\r\n\t\tlDestructible.position = IsoManager.modelToIsoView(new Point(lElement.x, lElement.y));\r\n\r\n\t\tPoolObject.elementList.set(lElement.instanceID, lElement);\r\n\t\tDataBaseAction.getInstance().addDestructible(lElement.assetName, lElement.instanceID, lElement.regionX, lElement.regionY, lElement.x, lElement.y, lElement.layer);\r\n\t}\r\n\r\n\tpublic static function createDestructibles(pRegion:Region):Void\r\n\t{\r\n\r\n\t\tvar random:Int = Math.round(Math.random() * (arrayConfigDestructible.length-1));\r\n\t\tvar currentConfig:Dynamic = GameLoader.getContent(arrayConfigDestructible[random]);\r\n\r\n\t\tfor (instance in Reflect.fields(currentConfig))\r\n\t\t{\r\n\t\t\tvar destructible:Dynamic = Reflect.field(currentConfig, instance);\r\n\r\n\t\t\tvar lDestructible:Destructible = new Destructible(destructible.type);\r\n\r\n\t\t\tvar lElement:Element =\r\n\t\t\t{\r\n\t\t\t\tinstanceID:destructible.type + Std.string(Date.now().getTime()),\r\n\t\t\t\ttype:destructible.type,\r\n\t\t\t\twidth:DataManager.getInstance().listDestructableTypes.get(destructible.type).width,\r\n\t\t\t\theight:DataManager.getInstance().listDestructableTypes.get(destructible.type).height,\r\n\t\t\t\tx:Std.parseInt(destructible.x),\r\n\t\t\t\ty:Std.parseInt(destructible.y),\r\n\t\t\t\tglobalX:Std.parseInt(destructible.globalX),\r\n\t\t\t\tglobalY:Std.parseInt(destructible.globalY),\r\n\t\t\t\tregionX:pRegion.x,\r\n\t\t\t\tregionY:pRegion.y,\r\n\t\t\t\tlayer:1,\r\n\t\t\t\tassetName: destructible.type,\r\n\t\t\t\tmode:\"Waiting\",\r\n\t\t\t\t//dateEndBuilding:Date.now(),\r\n\t\t\t\tdateStartBuilding:Date.now(),\r\n\t\t\t\tsoftCurrency:DataManager.getInstance().listDestructableTypes.get(destructible.type).softCurrencyCost\r\n\t\t\t}\r\n\t\t\tlDestructible.init(lElement);\r\n\t\t\tlDestructible.start();\r\n\r\n\t\t\tpRegion.layers[1].add(lDestructible);\r\n\t\t\tpRegion.layers[1].container.addChild(lDestructible);\r\n\r\n\t\t\tlDestructible.position = IsoManager.modelToIsoView(new Point(lElement.x, lElement.y));\r\n\r\n\t\t\tPoolObject.elementList.set(lElement.instanceID, lElement);\r\n\t\t\tDataBaseAction.getInstance().addDestructible(lElement.assetName, lElement.instanceID, lElement.regionX, lElement.regionY, lElement.x, lElement.y, lElement.layer);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static function createFirstDestructible(pAsset:String, pX:Int, pY:Int):Void\r\n\t{\r\n\t\tvar lDestructible:Destructible = new Destructible(pAsset);\r\n\t\t\r\n\t\tvar lType:DestructableType = DataManager.getInstance().listDestructableTypes.get(pAsset);\r\n\t\t\r\n\r\n\t\tvar lElement:Element =\r\n\t\t{\r\n\t\t\tinstanceID:pAsset + Std.string(Date.now().getTime()),\r\n\t\t\ttype:pAsset,\r\n\t\t\twidth:DataManager.getInstance().listDestructableTypes.get(pAsset).width,\r\n\t\t\theight:DataManager.getInstance().listDestructableTypes.get(pAsset).height,\r\n\t\t\tx:pX,\r\n\t\t\ty:pY,\r\n\t\t\tglobalX:0,\r\n\t\t\tglobalY:0,\r\n\t\t\tregionX:pX,\r\n\t\t\tregionY:pY,\r\n\t\t\tlayer:1,\r\n\t\t\tassetName: pAsset,\r\n\t\t\tmode:\"Waiting\",\r\n\t\t\t//dateEndBuilding:Date.now(),\r\n\t\t\tdateStartBuilding:Date.now(),\r\n\t\t\tsoftCurrency:DataManager.getInstance().listDestructableTypes.get(pAsset).softCurrencyCost\r\n\t\t}\r\n\t\tlDestructible.init(lElement);\r\n\t\tlDestructible.start();\r\n\r\n\t\tWorld.getInstance().getRegion(0,0).layers[1].add(lDestructible);\r\n\t\tWorld.getInstance().getRegion(0,0).layers[1].container.addChild(lDestructible);\r\n\r\n\t\tlDestructible.position = IsoManager.modelToIsoView(new Point(lElement.x, lElement.y));\r\n\r\n\t\tPoolObject.elementList.set(lElement.instanceID, lElement);\r\n\t\tDataBaseAction.getInstance().addDestructible(lElement.assetName, lElement.instanceID, lElement.regionX, lElement.regionY, lElement.x, lElement.y, lElement.layer);\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.sprites.elements.drillingbuilding;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass DrillingBuilding extends Building\r\n{\r\n\r\n\t//nombre de drillingBuilding\r\n\tpublic static var drillingBuildingCount(default, null):Int;\r\n\tpublic static var drillingBuildingList(default, null):Array<Element> = new Array<Element>();\r\n\t\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\t\t\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\t\r\n\t\tif (drillingBuildingList.indexOf(this.elem) == -1) drillingBuildingList.push(this.elem);\r\n\t\tdrillingBuildingCount = drillingBuildingList.length;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.drillingbuilding;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass DrillingAutoOutPost extends DrillingBuilding\r\n{\r\n\r\n\tprivate static inline var MN_PROD:Int = 25; \r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\t\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tbuildingName = \"AutoDrill Outpost\";\r\n\t\tdescription = \"Lance les missions de forage automatiques : elle produisent de la MATIRE NOIRE en petite quantit.\";\r\n\t\tlocalWidth = 2;\r\n\t\tlocalHeight = 2;\r\n\t\tsellingCost = 1875;\r\n\t\t\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(0, 0, 1, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\r\n\t}\r\n\t\r\n\tpublic function production():Void\r\n\t{\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.drillingbuilding;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass DrillingCenter extends DrillingBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Drilling Center\";\r\n\t\tdescription = \"Permet de lancer des missions de forage dans la rgion.\";\r\n\t\tlocalWidth = 6;\r\n\t\tlocalHeight = 4;\r\n\t\tmaxLevel = 4;\r\n\t\tsellingCost = 3750;\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(0, 0, 1, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\tFTUEManager.register(this);\r\n\t\ton(MouseEventType.CLICK, onClickFtue);\r\n\t\ton(TouchEventType.TAP, onClickFtue);\r\n\t}\r\n\t\r\n\t\r\n\tprivate function onClickFtue():Void\r\n\t{\r\n\t\toff(MouseEventType.CLICK, onClickFtue);\r\n\t\toff(TouchEventType.TAP, onClickFtue);\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.drillingbuilding;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass DrillingOutPost extends DrillingBuilding\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Drill Outpost\";\r\n\t\tdescription = \"Dcouvre de nouvelles missions de forage.\";\r\n\t\tlocalWidth = 4;\r\n\t\tlocalHeight = 2;\r\n\t\tmaxLevel = 2;\r\n\t\tsellingCost = 1375;\r\n\t\t\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(0, 0, 1, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\n\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass BuildingEnergyProducer extends Building\r\n{\r\n\tprivate var energyProduced:Int;\r\n\t\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function increasePlayerMaxEnergy(?pEnergy:Int):Void\r\n\t{\r\n\t\tvar lEnergy:Int = pEnergy == null? energyProduced: pEnergy;\r\n\t\tPlayer.getInstance().increaseMaxEnergy(lEnergy);\r\n\t}\r\n\t\r\n\tpublic function Buff(pCoef:Float, ?isAdded:Bool = true):Void\r\n\t{\r\n\t\tvar lEnergy:Int = Math.round(energyProduced * pCoef - energyProduced);\r\n\t\tvar lSign:Int = isAdded? 1: -1;\r\n\t\tincreasePlayerMaxEnergy(lEnergy * lSign);\r\n\t}\r\n\t\r\n\toverride public function setModeDestroy():Void \r\n\t{\r\n\t\tsuper.setModeDestroy();\r\n\t\tincreasePlayerMaxEnergy(-energyProduced);\r\n\t}\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.LocalizationByType;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass UrbanAntenna extends BuildingEnergyProducer\r\n{\r\n\tprivate static inline var ENERGY_PROD:Int = 5;\r\n\t\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Antenna\";\r\n\t\tdescription = Localization.getLabel(LocalizationByType.DESC_ANTENNA);\r\n\t\tlocalWidth = 1;\r\n\t\tlocalHeight = 1;\r\n\t\tmaxLevel = 2;\r\n\t\t\r\n\t\tsellingCost = 875;\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(1, 0, 0, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).antennasInRegion.push(this);\r\n\t\tenergyProduced = level == 1 ? ENERGY_PROD : ENERGY_PROD*2;\r\n\r\n\t}\r\n\t\r\n\toverride function changeBehaviorLevel2():Void \r\n\t{\r\n\t\tPlayer.getInstance().increaseMaxEnergy(5);\r\n\t}\r\n\t\r\n\toverride public function setModeDestroy():Void \r\n\t{\r\n\t\tsuper.setModeDestroy();\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.splice(World.getInstance().getRegion(elem.regionX, elem.regionY).antennasInRegion.indexOf(this),1);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass UrbanCommunication extends Building\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Communication\";\r\n\t\tdescription = \"Permet de contacter vos amis, d'aller visiter leur plante ou d'changer avec eux.\";\r\n\t\tlocalWidth = 3;\r\n\t\tlocalHeight = 1;\r\n\t\tsellingCost = 4000;\r\n\t\t\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(1, 0, 0, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport pixi.flump.Movie;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass UrbanHeadQuarter extends Building\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Head Quarter\";\r\n\t\tdescription = \"Donne les informations sur votre plante. Les volutions des autres batiments dpendent du niveau de celui-ci.\";\r\n\t\tlocalWidth = 6;\r\n\t\tlocalHeight = 6;\r\n\t\tmaxLevel = 4;\r\n\t\tlevel = 1;\r\n\t\tBuilding.HQinstance = this;\r\n\t\tsellingCost = 0;\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(1, 0, 0, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tif (World.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.length == 0) changeAsset(CONSTRUCTING_STATE);\r\n\t}\r\n\t\r\n\tpublic function turnOn():Void {\r\n\t\r\n\t\tchangeAsset(WAITING_STATE);\r\n\t\tSoundManager.getSound(\"soundPlayerStartCreateBuilding\").play();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass UrbanPowerStation extends BuildingEnergyProducer\r\n{\r\n\tprivate static inline var ENERGY_PROD:Int = 50;\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Power Station\";\r\n\t\tdescription = \"Augmente beaucoup l'nergie et permet de poser des antennes.\";\r\n\t\tlocalWidth = 4;\r\n\t\tlocalHeight = 2;\r\n\t\tenergyProduced = ENERGY_PROD;\r\n\t\tmaxLevel = 2;\r\n\t\tsellingCost = 2500;\r\n\t\t\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(5, 0, 0, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t\t\r\n\t\t\r\n\t}\t\r\n\t\r\n\toverride function setModeNormal():Void \r\n\t{\r\n\t\t\r\n\t\tsuper.setModeNormal();\r\n\t\tcheckRegion();\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\toverride function setModeValidationConstruct():Void \r\n\t{\r\n\t\tsuper.setModeValidationConstruct();\r\n\t\tSoundManager.getSound(\"soundPlayerHaveEnergy\").play();\r\n\t}\r\n\t\r\n\tpublic function checkRegion():Void {\r\n\t\r\n\t\tif (World.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.length == 0) {\r\n\t\t\r\n\t\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.push(this);\r\n\t\t\tBuilding.HQinstance.turnOn();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (station in World.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion) {\r\n\t\t\r\n\t\t\tif (station.elem.instanceID == elem.instanceID) return;\r\n\t\t\t\r\n\t\t}\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.push(this);\r\n\t}\r\n\t\r\n\t\r\n\toverride public function saveNewPosition(pX:Int, pY:Int, ?pRegionX:Int = null, ?pRegionY:Int = null):Void \r\n\t{\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.splice(World.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.indexOf(this),1);\r\n\t\tsuper.saveNewPosition(pX, pY, pRegionX, pRegionY);\r\n\t\tcheckRegion();\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\toverride function changeBehaviorLevel2():Void \r\n\t{\r\n\t\tif (level <= maxLevel) {\r\n\t\t\tfor (antenna in World.getInstance().getRegion(elem.regionX, elem.regionY).antennasInRegion) \r\n\t\t\t\tantenna.upgrade();\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride public function setModeDestroy():Void \r\n\t{\r\n\t\tsuper.setModeDestroy();\r\n\t\tWorld.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.splice(World.getInstance().getRegion(elem.regionX, elem.regionY).powerStationsInRegion.indexOf(this),1);\r\n\t}\r\n}","package com.isartdigital.ruby.game.sprites.elements.urbanbuilding;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass UrbanTranslation extends Building\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tbuildingName = \"Translation Center\";\r\n\t\tdescription = \"Permet de traduire les anciens textes xenos.\";\r\n\t\tlocalWidth = 2;\r\n\t\tlocalHeight = 2;\r\n\t\tsellingCost = 4875;\r\n\t\t//setTimeToBuild : secondes/minutes/heures/jours\r\n\t\t//setTimeToBuild(1, 0, 0, 0);\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element=null):Void \r\n\t{\r\n\t\tsuper.init(pElem);\r\n\t}\r\n}","package com.isartdigital.ruby.utils;\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager;\r\nimport pixi.core.display.Container;\r\n\r\nimport com.isartdigital.ruby.utils.RessourcesEffectManager.RessourceType;\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.utils.BezierCurve;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport pixi.core.math.Point;\r\n\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass RessourceEffect extends PoolObject\r\n{\r\n\r\n\tprivate var counter:Int;\r\n\t\r\n\tprivate var nextAction:Void->Void;\r\n\t\r\n\tprivate static inline var COUNTER_BUBBLE:Int = 100;\r\n\tprivate static inline var COUNTER_CURVE:Int = 30;\r\n\tprivate static inline var COUNTER_EXPLOSION:Int = 100;\r\n\tprivate static inline var COUNTER_DISPERSION:Int = 40;\r\n\t\r\n\tprivate static inline var BUBBLEMODE_APLITUDE_X:Float = 0.75;\r\n\tprivate static inline var BUBBLEMODE_SPEED_Y:Int = 2;\r\n\t\r\n\tprivate var numLittleBubbleToSpawn:Int = 10;\r\n\t\r\n\tprivate static inline var RADIUS_EXPLOSION:Int = 150;\r\n\t\r\n\r\n\tprivate var ressourceType:RessourceType;\r\n\t\r\n\tprivate var finalDestination:Point;\r\n\tprivate var directionDispersion:Point;\r\n\tprivate var originPoint:Point;\r\n\tprivate var bezierA:Point;\r\n\tprivate var bezierB:Point;\r\n\r\n\tprivate var soundFlag:Bool = true;\r\n\tprivate var listRessources:Array<RessourceEffect> = new Array<RessourceEffect>();\r\n\tprivate var dispertionCounter:Int;\r\n\tpublic var starsParticle:Container;\r\n\tprivate var container:Container;\r\n\t\r\n\t//private var lParticle:Container = ParticleManager.getInstance().createParticle(\"ressources\", [\"smoke02\", \"sparks1\", \"sparks2\"], 5000);\r\n\r\n\r\n\t\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t}\r\n\r\n\tpublic function initStarsParticle(pX:Float,pY:Float):Void\r\n\t{\r\n\t\tif (GameManager.currentMode == GameManager.MODE_SPECIAL_FEATURE) return;\r\n\t\tvar counter:Int = 0;\r\n\t\tvar counterMax:Int = 60;\r\n\t\tfor (i in 0...counterMax) \r\n\t\t{\r\n\t\t\tcounter++;\r\n\t\t\tif (counter >= counterMax)\r\n\t\t\t{\r\n\t\t\t\tstarsParticle = ParticleManager.getInstance().createParticle(\"trail\", [\"stars1\"], 500);\r\n\t\t\t\tstarsParticle.x = pX;\r\n\t\t\t\tstarsParticle.y = pY;\r\n\t\t\t\taddChild(starsParticle);\r\n\t\t\t\tcounter = 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}\t\r\n\t/**\r\n\t * SETMODES\r\n\t */\r\n\t/**\r\n\t * Initialise l'effet avec le type de ressource  afficher, la position de dpart, la destination, et l'animation  jouer\r\n\t * @param\tpAnimationType\r\n\t * @param\tpDestination\r\n\t * @param\tpRessourceType\r\n\t * @param\tpDirectionDispersion\r\n\t */\r\n\tpublic function setModeInit(pAnimationType:String, pDestination:Point,  pRessourceType:RessourceType,?pDirectionDispersion:Point,?pWhereToAddchildParticles:Container):Void\r\n\t{\r\n\t\tcounter = 0;\r\n\t\tfinalDestination = pDestination;\r\n\t\tressourceType = pRessourceType;\r\n\t\tvar myRessource:PoolObject;\r\n\t\tcontainer = pWhereToAddchildParticles;\r\n\t\t\r\n\t\tif (ressourceType == RessourceType.SoftCurrency)\r\n\t\t{\r\n\t\t\tmyRessource = PoolManager.getFromPool(\"RessourceSoftCurrency\");\r\n\t\t\taddChild(myRessource);\r\n\t\t\tmyRessource.start();\r\n\t\t}\r\n\t\telse if (ressourceType == RessourceType.HardCurrency)\r\n\t\t{\r\n\t\t\tmyRessource = PoolManager.getFromPool(\"RessourceHardCurrency\");\r\n\t\t\taddChild(myRessource);\r\n\t\t\tmyRessource.start();\r\n\t\t}\r\n\t\telse{\r\n\t\t\tmyRessource = PoolManager.getFromPool(Std.string(pRessourceType));\r\n\t\t\taddChild(myRessource);\r\n\t\t\tmyRessource.start();\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tstart();\r\n\t\t\r\n\t\tif (pAnimationType == \"bubble\") setModeBubble();\r\n\t\tif (pAnimationType == \"curve\") setModeCurve();\r\n\t\tif (pAnimationType == \"dispersionToCurve\" && pDirectionDispersion != null) setModeDispersionToCurve(pDirectionDispersion);\r\n\t\tif (pAnimationType == \"dispersionToExplosion\" && pDirectionDispersion != null) setModeDispersionToExplosion(pDirectionDispersion);\r\n\t\t\r\n\r\n\r\n\t\t\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * Mode bubble\r\n\t */\r\n\tpublic function setModeBubble():Void\r\n\t{\r\n\t\tdoAction = doActionBubble;\r\n\t\tcounter = COUNTER_BUBBLE;\r\n\t\tif(!SoundManager.getSound(\"bubbleUp\").playing()) SoundManager.getSound(\"bubbleUp\").play();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Mode Courbe\r\n\t */\r\n\tpublic function setModeCurve():Void\r\n\t{\r\n\t\tcounter = COUNTER_CURVE;\r\n\t\toriginPoint = position.clone();\r\n\t\t\r\n\t\tvar direction:Int = originPoint.x < finalDestination.x ? 1: -1; \r\n\t\tbezierA = new Point(originPoint.x + direction* COUNTER_CURVE*3, originPoint.y+COUNTER_CURVE*3);\r\n\t\tbezierB = new Point(finalDestination.x, finalDestination.y + COUNTER_CURVE);\r\n\t\tdoAction = doActionCurve;\r\n\t\tif(!SoundManager.getSound(\"bubbleCurve\").playing()) SoundManager.getSound(\"bubbleCurve\").play();\r\n\t}\r\n\t\r\n\t/**\r\n\t * mode Explosion\r\n\t */\r\n\tpublic function setModeExplosion():Void\r\n\t{\r\n\t\tdoAction = doActionExplosion;\r\n\t\tcounter = COUNTER_EXPLOSION;\r\n\t\tif(!SoundManager.getSound(\"bubbleExplosion\").playing()) SoundManager.getSound(\"bubbleExplosion\").play();\r\n\t\t\r\n\t\tvar lParent = parent;\r\n\t\tvar lElement:RessourceEffect;\r\n\t\tvar radius:Float = 7;\r\n\t\t\r\n\t\tfor (i in 0...numLittleBubbleToSpawn) \r\n\t\t{\r\n\t\t\tlElement = cast(PoolManager.getFromPool(\"Bubble\"),RessourceEffect);\r\n\t\t\tlElement.x = x+radius * Math.cos(2 * Math.PI * i / numLittleBubbleToSpawn);\r\n\t\t\tlElement.y = y+radius * Math.sin(2 * Math.PI * i / numLittleBubbleToSpawn);\r\n\t\t\tlElement.scale.x /= 3;\r\n\t\t\tlElement.scale.y /= 3;\r\n\t\t\t\r\n\t\t\tlElement.init(null);\r\n\t\t\taddChild(lElement);\r\n\t\t\tlElement.dispertionCounter = 15 * i;\r\n\t\t\t\r\n\t\t\tlElement.setModeInit(\"null\", finalDestination,ressourceType);\r\n\t\t\tlElement.originPoint = new Point(position.x,position.y);\r\n\t\t\tlistRessources.push(lElement);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tparent.removeChild(this);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Mode dispersion puis Courbe\r\n\t * @param\tpDirectionDispertion\r\n\t */\r\n\tpublic function setModeDispersionToCurve(pDirectionDispertion:Point):Void\r\n\t{\r\n\t\tcounter = COUNTER_DISPERSION;\r\n\t\tdoAction = doActionDispertion;\r\n\t\tif(!SoundManager.getSound(\"bubbleExplosion\").playing()) SoundManager.getSound(\"bubbleExplosion\").play();\r\n\r\n\t\tdirectionDispersion = pDirectionDispertion.clone();\r\n\t\tnextAction = setModeCurve;\r\n\t}\r\n\t\r\n\t/**\r\n\t * mode dispersion puis Explosion\r\n\t * @param\tpDirectionDispertion\r\n\t */\r\n\tpublic function setModeDispersionToExplosion(pDirectionDispertion:Point):Void\r\n\t{\r\n\t\tcounter = COUNTER_DISPERSION;\r\n\t\tdoAction = doActionDispertion;\r\n\t\tif(!SoundManager.getSound(\"bubbleExplosion\").playing()) SoundManager.getSound(\"bubbleExplosion\").play();\r\n\r\n\t\tdirectionDispersion = pDirectionDispertion.clone();\r\n\t\tnextAction = setModeExplosion;\r\n\t\t\r\n\t}\t\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * DOACTION\r\n\t */\r\n\t\r\n\tpublic function doActionBubble():Void\r\n\t{\r\n\t\tvar base:Float = 1;\r\n\t\tvar amplitude:Float = 0.15;\r\n\t\t\r\n\t\tif(counter-- >0)\r\n\t\t{\r\n\t\t\tscale.x = base+amplitude * Math.cos(2 * Math.PI * 2 * counter/COUNTER_BUBBLE);\r\n\t\t\tscale.y = base+amplitude * Math.sin(2 * Math.PI * 2 * counter / COUNTER_BUBBLE);\r\n\t\t\ty -= BUBBLEMODE_SPEED_Y;\r\n\t\t\tx += BUBBLEMODE_APLITUDE_X * Math.cos(2 * Math.PI * 3 * counter / COUNTER_BUBBLE);\r\n\t\t\tinitStarsParticle(x, y);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tscale.x = 1;\r\n\t\t\tscale.y = 1;\r\n\t\t\tsetModeExplosion();\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function doActionCurve():Void\r\n\t{\r\n\t\tif(counter-- >0)\r\n\t\t{\r\n\t\t\tvar lPoint:Point = BezierCurve.calculCurve(originPoint, bezierA, bezierB, finalDestination, (1 - counter / COUNTER_CURVE),true);\r\n\t\t\tx = lPoint.x;\r\n\t\t\ty = lPoint.y;\r\n\t\t\tinitStarsParticle(x, y);\r\n\t\t\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif(!SoundManager.getSound(\"gold\").playing()) SoundManager.getSound(\"gold\").play();\r\n\t\t\tRessourcesEffectManager.getInstance().OnEffectEnd();\r\n\t\t\r\n\t\t\t\r\n\t\t\tdispose();\r\n\t\t\t\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function doActionExplosion():Void\r\n\t{\r\n\t\tvar listRessourceLenght = listRessources.length;\r\n\t\tvar lElement:RessourceEffect;\r\n\t\tvar i:Int;\r\n\t\tif(counter-- > COUNTER_EXPLOSION/3)\r\n\t\t{\r\n\t\t\tfor (i in 0...listRessourceLenght) \r\n\t\t\t{\r\n\t\t\t\tlElement = listRessources[i];\r\n\t\t\t\tlElement.x = lElement.originPoint.x + Math.sin(Math.PI * 2 * counter / COUNTER_EXPLOSION)*RADIUS_EXPLOSION * Math.cos(Math.PI*2 * counter/COUNTER_EXPLOSION*2+2*Math.PI*i/listRessourceLenght);\r\n\t\t\t\tlElement.y = lElement.originPoint.y + Math.sin(Math.PI * 2 * counter / COUNTER_EXPLOSION)*RADIUS_EXPLOSION * Math.sin(Math.PI*2 * counter/COUNTER_EXPLOSION*2+2*Math.PI*i/listRessourceLenght);\r\n\t\t\t\r\n\t\t\t\tinitStarsParticle(lElement.x, lElement.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\t\r\n\t\t\tcounter--;\r\n\t\t\tfor (j in 0...listRessourceLenght) \r\n\t\t\t{\r\n\t\t\t\ti = listRessourceLenght - 1 - j;\r\n\t\t\t\tlElement = listRessources[i];\r\n\t\t\t\tlElement.x = lElement.originPoint.x + RADIUS_EXPLOSION * Math.cos(Math.PI*2 * counter/COUNTER_EXPLOSION*2+2*Math.PI*i/listRessourceLenght);\r\n\t\t\t\tlElement.y = lElement.originPoint.y + RADIUS_EXPLOSION * Math.sin(Math.PI*2 * counter/COUNTER_EXPLOSION*2+2*Math.PI*i/listRessourceLenght);\r\n\t\t\t\tlElement.dispertionCounter--;\r\n\t\t\t\tif (lElement.dispertionCounter <= 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tlElement.setModeCurve();\r\n\t\t\t\t\tlistRessources.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (listRessourceLenght == 0)\r\n\t\t\t{\r\n\t\t\t\tdispose();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function doActionDispertion():Void\r\n\t{\r\n\t\tif(counter-- >0)\r\n\t\t{\t\t\t\t\r\n\t\t\tx += directionDispersion.x * (counter/COUNTER_DISPERSION);\r\n\t\t\ty += directionDispersion.y * (counter / COUNTER_DISPERSION);\r\n\t\t\tinitStarsParticle(x, y);\r\n\t\t\t\r\n\t\t}\r\n\t\telse{\r\n\t\t\t\r\n\t\t\tnextAction();\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.ressources;\r\nimport com.isartdigital.ruby.utils.RessourceEffect;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass Bubble extends RessourceEffect\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.ressources;\r\n\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass RessourceHardCurrency extends PoolObject\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.ressources;\r\n\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass RessourceSoftCurrency extends PoolObject\r\n{\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.world;\r\n\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass Background extends GameElement\r\n{\r\n\t\r\n\t\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tboxType = BoxType.SELF;\r\n\t}\r\n\t\r\n\r\n}","package com.isartdigital.ruby.game.world;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.save.ElementSave;\r\nimport pixi.core.display.Container;\r\nimport pixi.interaction.EventEmitter;\r\n\r\n/**\r\n * les layers ont une grille et definisse les niveaux en Z d'une region\r\n * @author Adrien Bourdon\r\n */\r\n\r\nclass Layer\r\n{\r\n\r\n\t//grille du layer\r\n\tpublic var grid:Array<Array<GameElement>>;\r\n\tpublic var width(default, null):Int;\r\n\tpublic var height(default, null):Int;\r\n\tpublic var region:Region;\r\n\tpublic var container:RegionContainer;\r\n\t//private var arrayToSave:Array<GameElement>;\r\n\r\n\t\r\n\t//couteur\r\n\tprivate var onSpawnerMove:EventEmitter;\r\n\r\n\tpublic function new(pWidth:Int, pHeight:Int)\r\n\t{\r\n\t\twidth = pWidth;\r\n\t\theight = pHeight;\r\n\t\t\r\n\t}\r\n\r\n\tpublic function init() {\r\n\t\tinitGrid();\r\n\t}\r\n\r\n\t\r\n\tprivate function initGrid()\r\n\t{\r\n\t\tgrid = new Array<Array<GameElement>>();\r\n\t\tvar lArray:Array<GameElement>;\r\n\t\tfor (i in 0...width)\r\n\t\t{\r\n\t\t\tlArray = new Array<GameElement>();\r\n\t\t\tfor (j in 0...height)\r\n\t\t\t{\r\n\t\t\t\tlArray[j] = null;\r\n\t\t\t}\r\n\t\t\tgrid[i] = lArray;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ajoute un GameElement a la grille si c'est possible\r\n\t * @param\tpElem : GameElement\r\n\t */\r\n\tpublic function add(pElem:GameElement):Void\r\n\t{\r\n\t\tif (pElem == null) return;\r\n\t\tif (!canAdd(pElem)) return;\r\n\t\t\r\n\t\tfor (i in pElem.rowMin...(pElem.rowMax + 1))\r\n\t\t{\r\n\t\t\tfor (j in pElem.colMin...(pElem.colMax + 1))\r\n\t\t\t{\r\n\t\t\t\tsetCell(i, j, pElem);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * retire un GameElement de la grille\r\n\t * @param\tpElem : GameElement\r\n\t */\r\n\tpublic function remove(pElem:GameElement):Void\r\n\t{\r\n\t\tif (pElem == null) return;\r\n\r\n\t\tfor (i in pElem.rowMin...(pElem.rowMax + 1))\r\n\t\t{\r\n\t\t\tfor (j in pElem.colMin...(pElem.colMax + 1))\r\n\t\t\t{\r\n\t\t\t\tsetCell(i, j, null);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * verifie si le GameElement rentre dans la grille de la region\r\n\t * @param\tpElem : GameElement\r\n\t * @return true s'il rentre\r\n\t */\r\n\tpublic function isIn(pElem:GameElement):Bool\r\n\t{\r\n\t\tif (pElem == null) return false;\r\n\t\treturn (((pElem.colMin >= 0) && (pElem.rowMin >= 0)) && ((pElem.colMax <= width-1) && (pElem.rowMax <= height-1)));\r\n\t}\r\n\r\n\t/**\r\n\t * verifie si on peut poser le GameElement dans la grille\r\n\t * @param\tpElem : GameElement\r\n\t * @return true si on peut\r\n\t */\r\n\tpublic function canAdd(pElem:GameElement):Bool\r\n\t{\r\n\t\tif (pElem == null) return false;\r\n\t\tif (!isIn(pElem)) return false;\r\n\t\t\r\n\t\tfor (i in (pElem.rowMin - pElem.margin) ... (pElem.rowMax + 1 + pElem.margin))\r\n\t\t{\r\n\t\t\tfor (j in (pElem.colMin - pElem.margin) ...(pElem.colMax + 1 + pElem.margin))\r\n\t\t\t{\r\n\t\t\t\tif (getCell(i, j) != null) return false;\r\n\t\t\t\telse if (i == Region.WIDTH || j == Region.HEIGHT) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * recupre le GameElment contenu dans une cellule de la grille\r\n\t * @param\tpX : premier index de la grille\r\n\t * @param\tpY : deuxieme index de la grille\r\n\t * @return GameElement ou null\r\n\t */\r\n\tpublic function getCell(pX:Int, pY:Int):GameElement\r\n\t{\r\n\t\t\r\n\t\tif (grid[pX] == null) return null;\r\n\t\tif (grid[pX][pY] == null) return null;\r\n\t\treturn grid[pX][pY];\r\n\t}\r\n\r\n\t/**\r\n\t * ajoute un gameElement a une cellule de la grille\r\n\t * @param\tpX : premier index de la grille\r\n\t * @param\tpY : deuxieme index de la grille\r\n\t * @param\tpElem : GameElement\r\n\t */\r\n\tprivate function setCell(pX:Int, pY:Int, pElem:GameElement):Void\r\n\t{\r\n\t\tgrid[pX][pY] = pElem;\r\n\t}\r\n\r\n\t/**\r\n\t * recupere les doones dans la grilles\r\n\t * @return arrayToSave un array contenant tout les elements prsent dans la grille\r\n\t */\r\n\tpublic function getData():Array<ElementSave>\r\n\t{\r\n\t\tif (grid.length <= 0) return null;\r\n\t\tvar arrayToSave:Array<ElementSave> = [];\r\n\r\n\t\tvar toSave:ElementSave;\r\n\t\tfor (i in 0...grid.length)\r\n\t\t{\r\n\t\t\tfor (j in 0...grid[i].length)\r\n\t\t\t{\r\n\r\n\t\t\t\tvar inGrid:GameElement = grid[i][j];\r\n\r\n\t\t\t\tif (inGrid != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (Std.is(inGrid, Building))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar lBuilding:Building = cast(inGrid, Building);\r\n\t\t\t\t\t\ttoSave =\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype : lBuilding.className,\r\n\t\t\t\t\t\t\tx : lBuilding.colMin,\r\n\t\t\t\t\t\t\ty : lBuilding.rowMin,\r\n\r\n\t\t\t\t\t\t\tmode : lBuilding.currentState,\r\n\t\t\t\t\t\t\tevolveState : lBuilding.level,\r\n\t\t\t\t\t\t\ttimeForNextState : lBuilding.timeForNextState,\r\n\t\t\t\t\t\t\telapsedTime : lBuilding.elapsedTime,\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\twidth : lBuilding.width,\r\n\t\t\t\t\t\t\theight : lBuilding.height,\r\n\t\t\t\t\t\t\tworldX : lBuilding.toGlobal(lBuilding.position).x,\r\n\t\t\t\t\t\t\tworldY : lBuilding.toGlobal(lBuilding.position).y\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttoSave =\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype : inGrid.className,\r\n\t\t\t\t\t\t\tx : inGrid.colMin,\r\n\t\t\t\t\t\t\ty : inGrid.rowMin,\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\twidth : inGrid.width,\r\n\t\t\t\t\t\t\theight : inGrid.height,\r\n\t\t\t\t\t\t\tworldX : inGrid.toGlobal(inGrid.position).x,\r\n\t\t\t\t\t\t\tworldY : inGrid.toGlobal(inGrid.position).y\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarrayToSave.push(toSave);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn arrayToSave;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.world;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienIncubator;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.destructible.Destructible;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingBuilding;\r\nimport com.isartdigital.ruby.juicy.bullesxp.Bulle;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.Deplacement;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.ruby.ui.popin.TimeBased;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.ruby.ui.popin.DynamicPopin;\r\nimport com.isartdigital.ruby.ui.popin.XenosPanel;\r\nimport com.isartdigital.ruby.ui.popin.contextual.BuildingContextualMenu;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.ruby.ui.popin.codex.Codex;\r\nimport com.isartdigital.ruby.ui.popin.shop.Shop;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.ruby.utils.Focus;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport js.Browser;\r\nimport js.Lib;\r\nimport pixi.core.math.Point;\r\n\r\n\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass MapInteractor\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe MapInteractor\r\n\t */\r\n\tprivate static var instance: MapInteractor;\r\n\r\n\tprivate var isClicked:Bool = false;\r\n\tprivate var isCameraLocked:Bool = false;\r\n\r\n\tpublic var doAction:Void->Void;\r\n\t\r\n\tprivate var openMenuHasBeenRequested:Bool = false;\r\n\r\n\tprivate var lastBuildingHovered: Building;\r\n\tprivate var movingAlienMode = false;\r\n\t\r\n\tprivate var gameElemWhichWantsToOpenMenu:GameElement;\r\n\t\r\n\tpublic var modalPopinOpened:Bool = false;\r\n\t\r\n\tpublic var alienSelected:AlienElement;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): MapInteractor\r\n\t{\r\n\t\tif (instance == null) instance = new MapInteractor();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\t\tdoAction = doActionNormal;\r\n\t}\r\n\r\n\tprivate function doActionNormal():Void\r\n\t{\r\n\t\t\r\n\t\tcheckBuildingHover();\r\n\r\n\t\tif (!Controller.isTap && isClicked) isClicked = false;\r\n\r\n\t\tif (Controller.getInstance().getMouseRegion() != null)\r\n\t\t{\r\n\t\t\tif (Controller.isTap && Controller.getInstance().getMouseRegion().isActive && !isClicked && Spawner.getInstance().toSpawn == null)\r\n\t\t\t{\r\n\r\n\t\t\t\tisClicked = true;\r\n\r\n\t\t\t\tif (gameElemUnderMouse() != null) openInfoPanel();\r\n\t\t\t\telse closeInfoPanel();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\r\n\tprivate function doActionSpawner():Void\r\n\t{\r\n\r\n\t\tSpawner.getInstance().doAction();\r\n\t}\r\n\r\n\tprivate function gameElemUnderMouse():GameElement\r\n\t{\r\n\t\tvar currRegion:Region = Controller.getInstance().getMouseRegion();\r\n\t\tif (currRegion == null) return null;\r\n\r\n\t\tvar lPoint:Point = Controller.getInstance().getPosFrom(Controller.getInstance().getMouseRegion().layers[1].container);\r\n\t\tlPoint = IsoManager.localToModel(lPoint);\r\n\r\n\t\t\r\n\t\tvar lDataGameElem:GameElement = Controller.getInstance().getMouseRegion().layers[1].getCell(cast(lPoint.y, Int), cast(lPoint.x, Int));\r\n\r\n\t\tif (lDataGameElem == null) return null;\r\n\t\t\r\n\r\n\r\n\t\tvar lGraphicGameElem:GameElement = getGraphicBuildingWithDataBuilding(lDataGameElem);\r\n\r\n\r\n\t\treturn lGraphicGameElem;\r\n\t}\r\n\r\n\tprivate function getGraphicBuildingWithDataBuilding(pDataBuilding:GameElement):GameElement\r\n\t{\r\n\r\n\t\tfor (i in 0...PoolObject.activeObjectList.length)\r\n\t\t{\r\n\t\t\tif (!Std.is(PoolObject.activeObjectList[i], Bulle))\r\n\t\t\t{\r\n\t\t\t\tvar lGraphicBuilding = cast(PoolObject.activeObjectList[i], GameElement);\r\n\r\n\r\n\t\t\t\tif (lGraphicBuilding.hasSameCoordonatesAs(pDataBuilding))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn lGraphicBuilding;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t\r\n\tprivate function openXenoPanel():Void \r\n\t{\r\n\t\tUIManager.getInstance().openPopin(XenosPanel.getInstance());\r\n\t}\r\n\t\r\n\r\n\r\n\tpublic function closeInfoPanel():Void\r\n\t{\r\n\t\t\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\t\r\n\t}\r\n\r\n\tprivate function openInfoPanel():Void\r\n\t{\r\n\r\n\r\n\t\tif (!Std.is(gameElemUnderMouse(), Destructible))\r\n\t\t{\r\n\t\t\tvar lBuilding:Building = cast(gameElemUnderMouse(), Building);\r\n\t\t\t\r\n\t\t\tif (lBuilding.currentState != lBuilding.CONSTRUCTING_STATE && lBuilding.currentState != lBuilding.UPGRADING_STATE) {\r\n\t\t\t\t\r\n\t\t\t\tif (!movingAlienMode) {\r\n\t\t\t\t\topenContextual();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (lBuilding.canReceiveAliens) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tUIManager.getInstance().closeAllPopins();\r\n\t\t\t\t\t\tif (Std.is(lBuilding, AlienIncubator)) stopAlienMode();\r\n\t\t\t\t\t\tfor (paddock in AlienPaddock.alienPaddockList) {\r\n\t\t\t\t\t\t\tif (paddock.instanceID == alienSelected.idBuilding) cast(paddock.instance, AlienPaddock).removeAlien(alienSelected);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (Std.is(lBuilding, AlienPaddock)) cast(lBuilding, AlienPaddock).addAlien(alienSelected);\r\n\t\t\t\t\t\tif (Std.is(lBuilding, AlienTrainingCenter)) cast(lBuilding, AlienTrainingCenter).addAlien(alienSelected);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\telse openTimeBased(lBuilding);\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\telse if (!movingAlienMode)\r\n\t\t{\r\n\t\t\tDynamicPopin.getInstance().init(\"destroy item for \" + gameElemUnderMouse().elem.softCurrency + \" coins ?\", cast(gameElemUnderMouse(), Destructible).destructionDB);\r\n\t\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\t}\r\n\r\n\t\t//if (Std.is(gameElemUnderMouse(), DrillingCenter)) UIManager.getInstance().openPopin(CentreForage.getInstance());\r\n\r\n\t}\r\n\t\r\n\tpublic function openInfoPaddock(pPaddock:AlienPaddock):Void {\r\n\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function openTimeBased(lBuilding:Building):Void {\r\n\t\r\n\t\tUIManager.getInstance().openPopin(TimeBased.getInstance());\r\n\t\tTimeBased.getInstance().setText(lBuilding);\r\n\t}\r\n\r\n\tprivate function openContextual() {\r\n\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif (!cast(gameElemUnderMouse(), Building).contextualOpened) {\r\n\t\t\t\tUIManager.getInstance().closeAllPopins();\r\n\t\t\t\tcast(gameElemUnderMouse(), Building).contextualOpened = true;\r\n\t\t\t\tUIManager.getInstance().openPopin(BuildingContextualMenu.getInstance());\r\n\t\t\t\tBuildingContextualMenu.getInstance().target = cast(gameElemUnderMouse(), Building);\r\n\t\t\t\tBuildingContextualMenu.getInstance().init();\r\n\t\t\t\tBuildingContextualMenu.getInstance().update();\r\n\t\t\t\tif (Std.is(gameElemUnderMouse(), AlienPaddock)) openXenoPanel();\r\n\t\t\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\telse UIManager.getInstance().closeAllPopins();\r\n\t}\r\n\t\t\t\r\n\tpublic function highLightAlienBuildings():Void {\r\n\t\t\r\n\t\tmovingAlienMode = true;\r\n\t\tHud.getInstance().maskButtons();\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tUIManager.getInstance().openPopin(Deplacement.getInstance());\r\n\t\tfor (i in 0...PoolObject.activeObjectList.length)\r\n\t\t{\r\n\t\t\tif (Std.is(PoolObject.activeObjectList[i], Building)) {\r\n\t\t\t\tvar lBuilding = cast(PoolObject.activeObjectList[i], Building);\r\n\t\t\t\tif (!lBuilding.canReceiveAliens) lBuilding.applyGreyFilter();\r\n\t\t\t}\r\n\t\t\telse if (Std.is(PoolObject.activeObjectList[i], Destructible)) {\r\n\t\t\t\t\r\n\t\t\t\tvar lDestructible = cast(PoolObject.activeObjectList[i], Destructible);\r\n\t\t\t\tlDestructible.applyGreyFilter();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tfor (lMap in World.getInstance().worldMap) \r\n\t\t\t{\r\n\t\t\t\tfor (lRegion in lMap) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (lRegion.isActive) lRegion.background.applyGreyFilter();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\r\n\t\r\n\tpublic function stopAlienMode():Void {\r\n\t\r\n\t\tHud.getInstance().unmaskButtons();\r\n\t\tmovingAlienMode = false;\r\n\t\tXenosPanel.getInstance().alienSelected = null;\r\n\t\tfor (i in 0...PoolObject.activeObjectList.length)\r\n\t\t{\r\n\t\t\tif (Std.is(PoolObject.activeObjectList[i], Building)) {\r\n\t\t\t\tvar lBuilding = cast(PoolObject.activeObjectList[i], Building);\r\n\t\t\t\tif (!lBuilding.canReceiveAliens) lBuilding.removeGreyFilter();\r\n\t\t\t}\r\n\t\t\telse if (Std.is(PoolObject.activeObjectList[i], Destructible)) {\r\n\t\t\t\t\r\n\t\t\t\tvar lDestructible = cast(PoolObject.activeObjectList[i], Destructible);\r\n\t\t\t\tlDestructible.removeGreyFilter();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tfor (lMap in World.getInstance().worldMap) \r\n\t\t\t{\r\n\t\t\t\tfor (lRegion in lMap) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (lRegion.isActive) lRegion.background.removeGreyFilter();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n\tprivate function checkBuildingHover():Void\r\n\t{\r\n\r\n\t\tif (!movingAlienMode) {\r\n\t\t\tif (!modalPopinOpened)\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\t\tif (gameElemUnderMouse() != null && !Std.is(gameElemUnderMouse(), Destructible) && gameElemUnderMouse().currentState != gameElemUnderMouse().UPGRADING_STATE && gameElemUnderMouse().currentState != gameElemUnderMouse().CONSTRUCTING_STATE  )\r\n\t\t\t\t{\r\n\t\t\t\tlastBuildingHovered = cast(gameElemUnderMouse(), Building);\r\n\t\t\t\tlastBuildingHovered.applyHoverFilter();\r\n\t\t\t\t}\r\n\r\n\t\t\t\telse if (lastBuildingHovered != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tlastBuildingHovered.removeHoverFilter();\r\n\t\t\t\t\tlastBuildingHovered = null;\r\n\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\telse {\r\n\t\t\t\r\n\t\t\tif (gameElemUnderMouse() != null && !Std.is(gameElemUnderMouse(), Destructible))\r\n\t\t\t{\r\n\t\t\t\tlastBuildingHovered = cast(gameElemUnderMouse(), Building);\r\n\t\t\t\tif(lastBuildingHovered.canReceiveAliens) lastBuildingHovered.applyAllowedFilter();\r\n\t\t\t}\r\n\r\n\t\t\telse if (lastBuildingHovered != null)\r\n\t\t\t{\r\n\t\t\t\r\n\t\t\t\tif(lastBuildingHovered.canReceiveAliens) lastBuildingHovered.removeAllowedFilter();\r\n\t\t\t\tlastBuildingHovered = null;\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tpublic function activateSpawner():Void\r\n\t{\r\n\t\tif (Spawner.getInstance().toSpawn != null) doAction = doActionSpawner;\r\n\t\telse Browser.alert(\"SPAWNER ACTIVATED WHILE TOSPAWN DOESN'T EXIST\");\r\n\t}\r\n\r\n\tpublic function deactivateSpawner():Void\r\n\t{\r\n\r\n\t\tif (Spawner.getInstance().toSpawn == null) doAction = doActionNormal;\r\n\t\telse Browser.alert(\"SPAWNER DEACTIVATED WHILE TOSPAWN EXISTS\");\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.world;\r\nimport com.isartdigital.ruby.game.sprites.elements.destructible.Destructible;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanPowerStation;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.popin.buyRegion.BuyRegion;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.ElementSave;\r\nimport com.isartdigital.utils.save.LayerSave;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\n\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass Region\r\n{\r\n\t//position et dimension\r\n\tpublic var position:Point;\r\n\tpublic static inline var WIDTH:Int =26;\r\n\tpublic static inline var HEIGHT:Int = 26;\r\n\tpublic var x:Int;\r\n\tpublic var y:Int;\r\n\r\n\t//public static var regionContainerArray:Array<RegionContainer> = [];\r\n\r\n\t//filtre\r\n\tprivate var smoke:ColorMatrixFilter;\r\n\r\n\t//container et background\r\n\tpublic var regionContainer:RegionContainer;\r\n\tpublic var background:Background;\r\n\tpublic var warFog:Background;\r\n\r\n\t//liste des layer\r\n\tpublic var layers:Array<Layer>;\r\n\tprivate var numberLayer:UInt;\r\n\r\n\t//la rgion est elle dbloqu\r\n\tpublic var isActive(default, null):Bool = false;\r\n\tpublic var unlockPopin:BuyRegion;\r\n\tpublic var powerStationsInRegion:Array<UrbanPowerStation>;\r\n\tpublic var antennasInRegion:Array<UrbanAntenna>;\r\n\r\n\tpublic function new(pX:Int, pY:Int)\r\n\t{\r\n\t\tnumberLayer = 2;\r\n\t\tx = pX;\r\n\t\ty = pY;\r\n\t\tbackground = new Background();\r\n\t\twarFog = new Background(\"WarFog\");\r\n\t\tbackground.start();\t\r\n\t\twarFog.start();\t\r\n\t\tlayers = new Array<Layer>();\r\n\t\tpowerStationsInRegion = new Array<UrbanPowerStation>();\r\n\t\tantennasInRegion = new Array<UrbanAntenna>();\r\n\t\tregionContainer = new RegionContainer(x, y);\r\n\t\tregionContainer.addChild(warFog);\r\n\t\tregionContainer.addChild(background);\r\n\t\t\r\n\t\tregionContainer.name = Std.string(x) + \" \" +Std.string(y);\r\n\t\tbackground.localHeight = HEIGHT;\r\n\t\tbackground.localWidth = WIDTH;\r\n\t\tbackground.currentRegionCoor = new Point(x, y);\r\n\t\tbackground.visible = false;\r\n\t\t\r\n\r\n\t}\r\n\t\r\n\t/**\r\n\t * rend une rgion active, pour pouvoir poser des batiments dessus\r\n\t */\r\n\tpublic function setActive()\r\n\t{\r\n\t\tif (isActive)return;\r\n\t\tisActive = true;\r\n\t\t\r\n\t\tregionContainer.removeChild(warFog);\r\n\t\twarFog.destroy();\r\n\t\tbackground.visible = true;\r\n\t\t//background.alpha = .5;\r\n\t}\r\n\r\n\t/**\r\n\t * cre un container de region en fonction de la taille des region\r\n\t * et de la taille d'une tile\r\n\t */\r\n\t/*private function createRegionContainer(pLayer:Layer):Void\r\n\t{\r\n\t\tpLayer.container = new RegionContainer(x, y);\r\n\t\tpLayer.container.position = setPosition(x, y);\r\n\t\tGameStage.getInstance().getGameContainer().addChild(pLayer.container);\r\n\t\tpLayer.container.name = Std.string(x) + \" \" +Std.string(y);\r\n\r\n\t}*/\r\n\r\n\tprivate function createLayerContainer(pLayer:Layer):Void\r\n\t{\r\n\t\t//var lLayerContainer:LayerContainer = new LayerContainer();\r\n\t\tpLayer.container = new RegionContainer(x,y);\r\n\t\t//pLayer.container.addChild(pLayer.container);\r\n\t\tpLayer.container.name = \"region\" + x + \"\" + y;\r\n\t\tregionContainer.addChild(pLayer.container);\r\n\t\t//pLayer.container.position = setPosition(x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * modeleToIso pour les regions\r\n\t * @param\tpX : position x en modele de la region\r\n\t * @param\tpY : position y en modele de la region\r\n\t * @return position de la region en coordonnes global\r\n\t */\r\n\tprivate function setPosition(pX:Float, pY:Float) : Point\r\n\t{\r\n\t\tvar lHalfWidth:Float = (WIDTH * GameManager.TILE_WIDTH / 2);\r\n\t\tvar lHalfHeight:Float = (HEIGHT * GameManager.TILE_HEIGHT / 2);\r\n\t\tvar lX:Float = (pX - pY) * lHalfWidth;\r\n\t\tvar lY:Float = (pX + pY) * lHalfHeight;\r\n\t\tvar lPoint = new Point(lX, lY);\r\n\t\treturn lPoint;\r\n\t}\r\n\t\r\n\t\r\n\r\n\t/**\r\n\t * initialise un layer d'index pIndexLayer\r\n\t * @param\tpIndexLayer\r\n\t */\r\n\t/*public function initLayer(pIndexLayer:Int):Void\r\n\t{\r\n\t\tvar lCurrentLayer:Layer;\r\n\t\tlCurrentLayer = new Layer(WIDTH, HEIGHT);\r\n\t\tlayers[pIndexLayer] = lCurrentLayer;\r\n\t\tlCurrentLayer.init();\r\n\t\tcreateRegionContainer(lCurrentLayer);\r\n\t\tif (pIndexLayer == 0)\r\n\t\t{\r\n\t\t\tlCurrentLayer.container.addChild(background);\r\n\t\t}\r\n\t}*/\r\n\r\n\t/**\r\n\t * initialise tout les layers contenu dans la rgion\r\n\t */\r\n\tpublic function newInitLayer():Void\r\n\t{\r\n\t\tfor (i in 0...numberLayer)\r\n\t\t{\r\n\t\t\tvar lCurrentLayer:Layer;\r\n\t\t\tlCurrentLayer = new Layer(WIDTH, HEIGHT);\r\n\t\t\tlayers[i] = lCurrentLayer;\r\n\t\t\tlCurrentLayer.init();\r\n\t\t\tcreateLayerContainer(lCurrentLayer);\r\n\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\tGameStage.getInstance().getGameContainer().addChild(regionContainer);\r\n\t\tregionContainer.position = setPosition(x, y);\r\n\t\t\r\n\t\tif (!isActive)\r\n\t\t{\r\n\t\t\t\r\n\t\t\tunlockPopin = new BuyRegion();\r\n\r\n\t\t\tUIManager.getInstance().openRegionPopin(unlockPopin);\r\n\t\t\tunlockPopin.target = background;\r\n\t\t\tunlockPopin.setOwnRegion(this);\r\n\t\t}\r\n\t\t\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * dbloque la region\r\n\t */\r\n\tpublic function unlock():Void\r\n\t{\r\n\t\t\r\n\t\tWorld.getInstance().unlockRegion(x, y);\r\n\t\tfor (popin in UIManager.getInstance().regionPopins) cast(popin, BuyRegion).displayCost();\r\n\t\tDataBaseAction.getInstance().unlockRegion(x, y);\r\n\r\n\t\tDestructible.createDestructibles(this);\r\n\t\tsortAllContainer();\r\n\t}\r\n\r\n\tpublic function getData():Array<LayerSave>\r\n\t{\r\n\t\tif (layers.length <= 0) return null;\r\n\r\n\t\tvar arrayToSave:Array<LayerSave> = [];\r\n\r\n\t\tfor (i in 0...layers.length)\r\n\t\t{\r\n\t\t\tvar lIndex:Int = i;\r\n\t\t\tvar lLayerArray:Array<ElementSave> = layers[i].getData();\r\n\t\t\tvar lLayerToSave:LayerSave;\r\n\r\n\t\t\tlLayerToSave =\r\n\t\t\t{\r\n\t\t\t\tindex : i,\r\n\t\t\t\tgrid : lLayerArray\r\n\t\t\t};\r\n\r\n\t\t\tarrayToSave.push(lLayerToSave);\r\n\t\t}\r\n\r\n\t\treturn arrayToSave;\r\n\r\n\t}\r\n\r\n\t\r\n\tpublic static function sortContainers():Void\r\n\t{\r\n\t\tGameStage.getInstance().getGameContainer().children = IsoManager.sortTiles(GameStage.getInstance().getGameContainer().children);\r\n\t}\r\n\r\n\t/**\r\n\t * trie tout les elements contenu dans le GameContainer, puis les elements a l'interieur des enfants du GameContainer\r\n\t */\r\n\tpublic static function sortAllContainer():Void\r\n\t{\r\n\t\tvar lArray:Array<DisplayObject> = [];\r\n\t\tvar lLength:Int = GameStage.getInstance().getGameContainer().children.length;\r\n\t\tfor (i in 0 ... lLength)\r\n\t\t{\r\n\t\t\tvar lTemp:DisplayObject = GameStage.getInstance().getGameContainer().children[i];\r\n\t\t\t\r\n\t\t\tif (lTemp.name != UnlockButtonContainer.getInstance().name)\r\n\t\t\t{\r\n\t\t\t\tlArray.push(lTemp);\r\n\t\t\t}\r\n\t\t}\r\n\t\tGameStage.getInstance().getGameContainer().children = IsoManager.sortTiles(lArray);\r\n\t\t\r\n\t\tGameStage.getInstance().getGameContainer().addChild(UnlockButtonContainer.getInstance().getUnlockContainer());\r\n\t\t//UnlockButtonContainer.getInstance().positionning();\r\n\t\t\r\n\t\t//GameStage.getInstance().getGameContainer().addChild(\r\n\r\n\t\tfor (firstKey in World.getInstance().worldMap.keys())\r\n\t\t{\r\n\t\t\tfor (secondKey in World.getInstance().worldMap.get(firstKey).keys())\r\n\t\t\t{\r\n\t\t\t\tfor (i in 0...World.getInstance().worldMap.get(firstKey).get(secondKey).layers.length)\r\n\t\t\t\t{\r\n\t\t\t\t\tWorld.getInstance().worldMap.get(firstKey).get(secondKey).layers[i].container.children = IsoManager.sortTiles(World.getInstance().worldMap.get(firstKey).get(secondKey).layers[i].container.children);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.world;\r\n\r\nimport com.isartdigital.utils.game.iso.IZSortable;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass RegionContainer extends Container implements IZSortable\r\n{\r\n\t\r\n\r\n\tpublic var colMin:Int;\r\n\tpublic var colMax:Int;\r\n\t\r\n\tpublic var rowMin:Int;\r\n\tpublic var rowMax:Int;\r\n\t\r\n\tpublic var behind:Array<IZSortable>;\r\n\t\r\n\tpublic var inFront:Array<IZSortable>;\r\n\r\n\tpublic function new(pX:Int, pY:Int) \r\n\t{\r\n\t\tsuper();\r\n\t\t//colMax = colMin = pX;\r\n\t\t//rowMax = rowMin = pY;\r\n\t\tcolMin = pX * Region.WIDTH;\r\n\t\tcolMax = pX + Region.WIDTH +(colMin -1);\r\n\t\t\r\n\t\trowMin =  pY * Region.HEIGHT;\r\n\t\trowMax =  pY + Region.HEIGHT + (rowMin -1);\r\n\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.game.world;\r\n\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.sprites.Sprite;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass UnlockButtonContainer extends Container \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe UnlockButtonContainer\r\n\t */\r\n\tprivate static var instance: UnlockButtonContainer;\r\n\tpublic static var  arrayButton:Array<Sprite> = [];\r\n\t\r\n\tprivate var unlockContainer:Container;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): UnlockButtonContainer {\r\n\t\tif (instance == null) instance = new UnlockButtonContainer();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tunlockContainer = new Container();\r\n\t\tname = \"unlockContainer\";\r\n\t\t//GameStage.getInstance().getGameContainer().addChild(unlockContainer);\r\n\t\tunlockContainer.name = \"unlockContainer\";\r\n\t\tunlockContainer.interactive = false;\r\n\t\tunlockContainer.buttonMode = false;\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function getUnlockContainer():Container\r\n\t{\r\n\t\treturn unlockContainer;\r\n\t}\r\n\t\r\n\tpublic function positionning():Void\r\n\t{\r\n\t\tposition = GameStage.getInstance().getGameContainer().position;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.game.world;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.popin.buyRegion.BuyRegion;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.RegionSave;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * Gestion du monde : manage des rgions et rcupration de leurs donnes\r\n * @author Adrien Bourdon\r\n */\r\nclass World\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe World\r\n\r\n\t */\r\n\tprivate static var instance: World;\r\n\tpublic var worldMap:Map<Int, Map<Int, Region>>;\r\n\tprivate var minX:Int;\r\n\tprivate var minY:Int;\r\n\t\r\n\tpublic var numberOfRegionUnlocked:Int = 0;\r\n\tprivate static inline var FIRST_REGION_UNLOCK_COST = 30000;\r\n\tprivate static inline var UNLOCK_MULTIPLIER = 3;\r\n\tpublic var unlockRegionCost:Int = FIRST_REGION_UNLOCK_COST;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): World\r\n\t{\r\n\t\tif (instance == null) instance = new World();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tpublic function new()\r\n\t{\r\n\t\tworldMap = new Map<Int, Map<Int, Region>>();\r\n\t\tunlockRegion(0, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * unlock une region et crer les regions alentour si elle n'existe pas\r\n\t * @param\tpX : index X de la region\r\n\t * @param\tpY : index Y de la region\r\n\t */\r\n\tpublic function unlockRegion(pX:Int, pY:Int)\r\n\t{\r\n\t\tif (getRegion(pX, pY) == null)\r\n\t\t{\r\n\t\t\taddRegion(pX, pY);\r\n\t\t\tgetRegion(pX, pY).setActive();\r\n\t\t\tinitContainers(pX, pY);\r\n\t\t}\r\n\t\telse getRegion(pX, pY).setActive();\r\n\t\tif (getRegion(pX + 1, pY) == null) { addRegion(pX + 1, pY) ;  initContainers(pX+1, pY);  }\r\n\t\tif (getRegion(pX, pY + 1) == null) { addRegion(pX, pY +1) ;  initContainers(pX, pY+1);  }\r\n\t\tif (getRegion(pX - 1, pY) == null) { addRegion(pX - 1, pY);  initContainers(pX-1, pY);  }\r\n\t\tif (getRegion(pX, pY - 1) == null) { addRegion(pX , pY -1);  initContainers(pX, pY - 1);  }\r\n\t\t\r\n\t\tif (getRegion(pX - 1, pY - 1) == null) { addRegion(pX - 1, pY - 1);  initContainers(pX - 1,  pY - 1);  }\r\n\t\tif (getRegion(pX + 1, pY + 1) == null) { addRegion(pX + 1, pY + 1);  initContainers(pX + 1, pY + 1);  }\r\n\t\tif (getRegion(pX + 1, pY - 1) == null) { addRegion(pX + 1, pY - 1);  initContainers(pX + 1, pY - 1);  }\r\n\t\tif (getRegion(pX - 1, pY + 1) == null) { addRegion(pX - 1, pY + 1);  initContainers(pX - 1, pY + 1);  }\r\n\t\t\r\n\t\t//if (UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name) != null)\r\n\t\t//{\r\n\t\t\t//UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name).off(MouseEventType.CLICK, UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name).click);\r\n\t\t\t//UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name).off(TouchEventType.TAP, UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name).click);\r\n\t\t\t////getRegion(pX, pY).regionContainer.removeChild(getRegion(pX, pY).regionContainer.getChildByName(\"buttonUnlock\"));\r\n\t\t\t//UnlockButtonContainer.getInstance().getUnlockContainer().removeChild(UnlockButtonContainer.getInstance().getUnlockContainer().getChildByName(\"buttonUnlock\"+getRegion(pX, pY).regionContainer.name));\r\n\t\t//}\r\n\t\t\r\n\t\t\r\n\t\tif(getRegion(pX,pY).unlockPopin != null) UIManager.getInstance().closeRegionPopin(getRegion(pX,pY).unlockPopin);\r\n\t\t\r\n\t\tnumberOfRegionUnlocked++;\r\n\t\tcalculateUnlockingRegionCost();\r\n\t\t\r\n\r\n\t\t//A Rajouter\r\n\t\t//Region.sortContainers();\r\n\t}\r\n\r\n\t/**\r\n\t * initialise les containers de la region\r\n\t * @param\tpX coordonne x de la region\r\n\t * @param\tpY coordonne y de la region\r\n\t */\r\n\tpublic function initContainers(pX:Int, pY:Int):Void\r\n\t{\r\n\t\tgetRegion(pX, pY).newInitLayer();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function calculateUnlockingRegionCost():Void {\r\n\t\r\n\t\tif (numberOfRegionUnlocked == 1) return;\r\n\t\tvar lCost:Int = FIRST_REGION_UNLOCK_COST;\r\n\t\tfor (i in 1...numberOfRegionUnlocked) {\r\n\t\t\r\n\t\t lCost = lCost * UNLOCK_MULTIPLIER;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tunlockRegionCost = lCost;\r\n\t}\r\n\r\n\t/**\r\n\t * Ajoute une region au world et modifier les index minimum si besoin\r\n\t * @param\tpPos : position de la region\r\n\t */\r\n\tpublic function addRegion(pX:Int, pY:Int)\r\n\t{\r\n\t\tif (getRegion(pX, pY) != null) return;\r\n\t\tvar map :Map<Int, Region>;\r\n\t\tvar region:Region;\r\n\t\tif (!worldMap.exists(pX))\r\n\t\t{\r\n\t\t\tmap = new Map<Int, Region>();\r\n\t\t}\r\n\t\telse map = worldMap.get(pX);\r\n\r\n\t\tif (!map.exists(pY))\r\n\t\t{\r\n\t\t\tregion = new Region(pX, pY);\r\n\t\t\tmap.set(pY, region);\r\n\t\t}\r\n\t\tworldMap.set(pX, map);\r\n\t}\r\n\r\n\t/**\r\n\t * Recupre une region du world\r\n\t * @param\tpPos : position de la region\r\n\t */\r\n\tpublic function getRegion(pX:Int, pY:Int):Region\r\n\t{\r\n\t\tif (worldMap.get(pX) == null) return null;\r\n\t\tif (worldMap.get(pX).get(pY) == null) return null;\r\n\t\treturn worldMap.get(pX).get(pY);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\t/*private function getData():Void\r\n\t{\r\n\t\tvar lWorldArray:Array<RegionSave>  = [];\r\n\t\tfor (keyX in worldMap.keys())\r\n\t\t{\r\n\t\t\tfor (keyX in worldMap.keys())\r\n\t\t\t{\r\n\t\t\t\tfor (keyY in worldMap.get(keyX).keys())\r\n\t\t\t\t{\r\n\t\t\t\t\tvar lRegion:RegionSave =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tposX : keyX,\r\n\t\t\t\t\t\tposY : keyY,\r\n\t\t\t\t\t\twidth : worldMap[keyX][keyY].width,\r\n\t\t\t\t\t\theight : worldMap[keyX][keyY].height,\r\n\t\t\t\t\t\tlayerSave : worldMap[keyX][keyY].getData()\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlWorldArray.push(lRegion);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}*/\r\n\r\n\t//J'ai mis cette fonctio en commentaire, si vous voulez tester si a fonctionne\r\n\tpublic function getData():Array<RegionSave>\r\n\t{\r\n\t\tvar lWorldArray:Array<RegionSave>  = [];\r\n\t\tfor (keyX in worldMap.keys())\r\n\t\t{\r\n\t\t\tfor (keyY in worldMap.get(keyX).keys())\r\n\t\t\t{\r\n\t\t\t\tvar lRegion:RegionSave =\r\n\t\t\t\t{\r\n\t\t\t\t\tposX : keyX,\r\n\t\t\t\t\tposY : keyY,\r\n\t\t\t\t\twidth : Region.WIDTH,\r\n\t\t\t\t\theight : Region.HEIGHT,\r\n\t\t\t\t\tlayerSave : worldMap[keyX][keyY].getData(),\r\n\t\t\t\t\tisActive : worldMap[keyX][keyY].isActive\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlWorldArray.push(lRegion);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn lWorldArray;\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.juicy.bullesxp;\r\n\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport pixi.flump.Movie;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass Bulle extends PoolObject\r\n{\r\n\tprivate var counter:Int;\r\n\tpublic var idBuilding:String;\r\n\tprivate var isFirstBulle:Bool = true;\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tinteractive = true;\r\n\t\tscale.x = 3;\r\n\t\tscale.y = 3;\r\n\t}\r\n\t\r\n\toverride function setModeNormal():Void \r\n\t{\r\n\t\tsetState(DEFAULT_STATE);\r\n\t\tscale.x = Math.random() * 1 +3;\r\n\t\tscale.y = Math.random() * 2 +2;\r\n\t\tthis.on(MouseEventType.CLICK, setModeExplosion);\r\n\t\tthis.on(TouchEventType.TAP, setModeExplosion);\r\n\t\tsuper.setModeNormal();\r\n\t}\r\n\t\r\n\toverride function doActionNormal():Void \r\n\t{\r\n\t\tif (cast(anim, Movie).currentFrame >= cast(anim, Movie).totalFrames -2) setState(DEFAULT_STATE);\r\n\t\tsuper.doActionNormal();\r\n\t}\r\n\t\r\n\tpublic function setModePrepareToExplose(?pIsFirst = true):Void\r\n\t{\r\n\t\tcounter = 0;\r\n\t\tif (!pIsFirst) isFirstBulle = false;\r\n\t\tdoAction = doActionPrepareToExplose;\r\n\t}\r\n\t\r\n\tprivate function doActionPrepareToExplose():Void\r\n\t{\r\n\t\tcounter++;\r\n\t\tif (counter >= 75) \r\n\t\t{\r\n\t\t\tsetModeExplosion();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function setModeExplosion():Void\r\n\t{\r\n\t\tsetState(\"Explosion\");\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\r\n\t\tdoAction = doActionExplosion;\r\n\t}\r\n\t\r\n\tprivate function doActionExplosion():Void\r\n\t{\r\n\t\tif (cast(anim, Movie).currentFrame >= cast(anim, Movie).totalFrames -1) \r\n\t\t{\r\n\t\t\tif(isFirstBulle) BullesManager.getInstance().destroyGroupOfBulles(idBuilding);\r\n\t\t\tdestroy();\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tthis.off(MouseEventType.CLICK, setModeExplosion);\r\n\t\tthis.off(TouchEventType.TAP, setModeExplosion);\r\n\t\tsuper.destroy();\r\n\t}\r\n}","package com.isartdigital.ruby.juicy.bullesxp;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass BullesManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe BullesManager\r\n\t */\r\n\tprivate static var instance: BullesManager;\r\n\t\r\n\tprivate var listBulle:Map<String, Array<Bulle>> = new Map<String, Array<Bulle>>();\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): BullesManager {\r\n\t\tif (instance == null) instance = new BullesManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initBulles(pXp:Int, pParent:Building):Void\r\n\t{\r\n\t\tvar lNumberBulles:Int = 2 + Math.round(Math.random() * 2 * (pParent.localWidth / 2));\r\n\t\tvar lBulle:Bulle;\r\n\t\tvar lBulleArray:Array<Bulle> = new Array<Bulle>();\r\n\t\tfor (i in 2...(lNumberBulles + 1))\r\n\t\t{\r\n\t\t\tlBulle = new Bulle();\r\n\t\t\tGameStage.getInstance().getInfoBulleContainer().addChild(lBulle);\r\n\t\t\tlBulle.position = getRandomPosition(IsoManager.getGlobalPositionOfBuilding(pParent));\r\n\t\t\tlBulle.init();\r\n\t\t\tlBulle.start();\r\n\t\t\tlBulle.idBuilding = pParent.instanceID;\r\n\t\t\tlBulleArray.push(lBulle);\r\n\t\t}\r\n\t\tlistBulle.set(pParent.instanceID, lBulleArray);\r\n\r\n\t}\r\n\t\r\n\r\n\t\r\n\tpublic function getRandomPosition(pPoint:Point):Point\r\n\t{\r\n\t\tvar sign:Int = Math.random() <= 0.5? 1 : -1;\r\n\t\tpPoint.x += sign * Math.random() * 200;\r\n\t\tpPoint.y += sign * Math.random() * 100;\r\n\t\treturn pPoint;\r\n\t}\r\n\t\r\n\tpublic function destroyGroupOfBulles(pIdBuilding:String, ?pFastDestroy:Bool = false):Void\r\n\t{\r\n\t\tvar lArray:Array<Bulle> = listBulle.get(pIdBuilding);\r\n\t\tif (lArray == null) return;\r\n\t\tfor (i in 0...lArray.length)\r\n\t\t{\r\n\t\t\tif (lArray[i] != null)\r\n\t\t\t{\r\n\t\t\t\tif (!pFastDestroy) lArray[i].setModePrepareToExplose(false);\r\n\t\t\t\telse lArray[i].destroy();\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\tlArray = null;\r\n\t\tlistBulle.remove(pIdBuilding);\r\n\t\t\r\n\t\tif (!pFastDestroy)cast(PoolObject.elementList.get(pIdBuilding).instance, Building).onBulleExplose();\r\n\t}\r\n\t\r\n\tpublic function isBuildingHasBulles(pBuildingID:String):Bool\r\n\t{\r\n\t\tif (listBulle == null || pBuildingID == null) return false;\r\n\t\tif(listBulle.exists(pBuildingID)) return true;\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass UIMovie extends StateGraphic\r\n{\r\n\r\n\tpublic function new(pAssetName:String) \r\n\t{\r\n\t\tsuper();\r\n\t\tassetName = pAssetName;\r\n\t\tfactory = new FlumpMovieAnimFactory();\r\n\t\tsetState(DEFAULT_STATE,true);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.preloadgame;\r\n\r\nimport com.isartdigital.utils.events.EventType;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\nimport pixi.flump.Movie;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Helix extends UIMovie\r\n\r\n{\r\n\r\n\tprivate var animation:Movie;\r\n\t\r\n\tprivate var isStopped:Bool = false;\r\n\t\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\tanimation = cast(anim, Movie);\r\n\t\tstart();\r\n\t}\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tMain.getInstance().on(EventType.GAME_LOOP, gameLoop);\r\n\t}\r\n\t\r\n\tpublic function isFinished():Bool {\r\n\t\r\n\t\t\r\n\t\tif (animation.currentFrame >= animation.totalFrames-1) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse return false;\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function update (pProgress:Float): Void {\r\n\t\tvar lProgession:UInt = Math.round((200 * pProgress / 100));\r\n\t\t\r\n\t\tif (lProgession <= animation.currentFrame) {\r\n\t\t\tanimation.stop();\r\n\t\t\tisStopped = true;\r\n\t\t}\r\n\t\t\r\n\t\tif (isStopped && lProgession > animation.currentFrame) {\r\n\t\t\tanimation.play();\r\n\t\t\tisStopped = false;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function gameLoop(pEvent:EventTarget):Void {\r\n\t\r\n\t\tif (isFinished()) {\r\n\t\t\tanimation.stop();\r\n\t\t\tMain.getInstance().isAnimLoadingDone = true;\r\n\t\t\tMain.getInstance().verifyLaunch();\r\n\t\t\tMain.getInstance().off(EventType.GAME_LOOP, gameLoop);\r\n\t\t}\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.preloadgame;\r\n\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartScreen;\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass LoadingBar extends SmartScreen \r\n{\r\n\tprivate var container:SmartComponent;\r\n\tprivate var helix:Helix;\r\n\tprivate var helixEmpty:UIMovie;\r\n\t/**\r\n\t * instance unique de la classe LoadingBar\r\n\t */\r\n\tprivate static var instance: LoadingBar;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): LoadingBar {\r\n\t\tif (instance == null) instance = new LoadingBar();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(?pAsset:String) \r\n\t{\r\n\t\tsuper(pAsset);\r\n\t\t\r\n\t\tcontainer = cast(getChildByName(\"loader_container\"), SmartComponent);\r\n\t\thelix = cast(container.getChildByName(\"helix_turn\"), Helix);\r\n\t\thelixEmpty = cast(container.getChildByName(\"helix_turn_empty\"), UIMovie);\r\n\t\thelixEmpty.visible = false;\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * mise  jour de la barre de chargement\r\n\t * @param\tpProgress\r\n\t */\r\n\tpublic function update (pProgress:Float): Void {\r\n\t\thelix.update(pProgress);\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.preloadgame;\r\n\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport pixi.flump.Movie;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass PreloadBulle extends PoolObject\r\n{\r\n\r\n    public static var list:Array<PreloadBulle> = new Array<PreloadBulle>();\r\n\tpublic static var score:Int = 0;\r\n\r\n\tpublic function new(?pAsset:String) \r\n\t{\r\n\t\talpha = 0.1;\r\n\t\tassetName = \"Bulle\";\r\n\t\tsuper(assetName);\r\n\t\tinteractive = true;\r\n\t\tscale.x = 3;\r\n\t\tscale.y = 3;\r\n\t}\r\n\t\r\n\toverride public function init(?pElem:Element = null):Void \r\n\t{\r\n\t\tlist.push(this);\r\n\t\tsuper.init(pElem);\r\n\t}\r\n\t\r\n\toverride function setModeNormal():Void \r\n\t{\r\n\t\ton(MouseEventType.CLICK, setModeExplosion);\r\n\t\ton(TouchEventType.TAP, setModeExplosion);\r\n\t\tscale.x = Math.random() * 2 + 2;\r\n\t\tscale.y = Math.random() * 2 + 2;\t\r\n\t\tsuper.setModeNormal();\r\n\t\tsetState(DEFAULT_STATE);\r\n\t}\r\n\r\n\toverride function doActionNormal():Void \r\n\t{\r\n\t\tPreloadMiniGame.scoreText.refreshText(Std.string(PreloadBulle.score));\r\n\t\tif (cast(anim, Movie).currentFrame >= cast(anim, Movie).totalFrames -2) setState(DEFAULT_STATE);\r\n\t\tsuper.doActionNormal();\r\n\t}\r\n\t\r\n\tprivate function setModeExplosion():Void\r\n\t{\r\n\t\tsetState(\"Explosion\");\r\n\t\tdoAction = doActionExplosion;\r\n\t\tscore++;\r\n\t\tPreloadMiniGame.scoreText.refreshText(Std.string(PreloadBulle.score));\r\n\t}\r\n\t\r\n\tprivate function doActionExplosion():Void\r\n\t{\r\n\t\t//if (isAnimEnd) {\r\n\t\tif (cast(anim, Movie).currentFrame >= cast(anim, Movie).totalFrames -1) destroy();\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tlist.remove(this);\r\n\t\toff(MouseEventType.CLICK, setModeExplosion);\r\n\t\toff(TouchEventType.TAP, setModeExplosion);\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.preloadgame;\r\nimport com.isartdigital.ruby.juicy.bullesxp.Bulle;\r\nimport com.isartdigital.utils.events.EventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass PreloadMiniGame \r\n{\r\n\t\r\n\tprivate var counter:Int = 0;\r\n\t\r\n\r\n\t/**\r\n\t * instance unique de la classe PreloadMiniGame\r\n\t */\r\n\tprivate static var instance: PreloadMiniGame;\r\n\tpublic static var scoreText:SmartText;\r\n\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): PreloadMiniGame {\r\n\t\tif (instance == null) instance = new PreloadMiniGame();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function start():Void \r\n\t{\r\n\t\tcounter = 30;\r\n\t\tscoreText = new SmartText(GameStage.getInstance(), 300, 300, 100, \"Arial Black\", \"white\", \"center\", true, \"blue\", 0, 100);\r\n\t\tGameStage.getInstance().addChild(scoreText);\r\n\t\tscoreText.position = new Point(0 , 50);\r\n\t\t\r\n\t\tMain.getInstance().on(EventType.GAME_LOOP, gameLoop);\r\n\t}\r\n\t\r\n\tpublic function gameLoop (pEvent:EventTarget): Void\r\n\t{\r\n\t\tcounter++;\r\n\t\tif (counter >= 30)\r\n\t\t{\r\n\t\t\tvar lBulle:PreloadBulle = new PreloadBulle();\r\n\t\t\tGameStage.getInstance().addChild(lBulle);\r\n\t\t\tlBulle.position = getRandomPosition();\r\n\t\t\tlBulle.init();\r\n\t\t\tlBulle.start();\r\n\t\t\tcounter = 0;\r\n\t\t\tif (PreloadBulle.list.length >= 20) \r\n\t\t\t{\r\n\t\t\t\tPreloadBulle.list[0].destroy();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (i in 0...PoolObject.activeObjectList.length){\r\n\t\t\tif (PoolObject.activeObjectList[i] == null) continue;\t\r\n\t\t\tPoolObject.activeObjectList[i].doAction();\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function getRandomPosition():Point\r\n\t{\r\n\t\tvar lPoint:Point = new Point(0, 0);\r\n\t\tlPoint.x = Math.random() * 1500;\r\n\t\tlPoint.y = Math.random() * 1500;\r\n\t\treturn lPoint;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tMain.getInstance().off(EventType.GAME_LOOP, gameLoop);\r\n\t\tif (scoreText != null) scoreText.destroyTimer();\r\n\t\tif (scoreText != null) scoreText.destroy();\r\n\t\tvar i = PreloadBulle.list.length;\r\n\t\twhile (PreloadBulle.list.length > 0) \r\n\t\t{\r\n\t\t\ti--;\r\n\t\t\tPreloadBulle.list[i].destroy();\r\n\t\t}\r\n\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui;\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.ruby.game.controller.MouseController;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.ftue.FocusManager;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport dat.controllers.Controller;\r\nimport dat.gui.GUI;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport js.Browser;\r\n\r\n\t\r\n/**\r\n * Classe permettant de manipuler des parametres du projet au runtime\r\n * Si la proprit Config.debug et  false ou que la proprit Config.data.cheat est  false, aucun code n'est execut.\r\n * Il n'est pas ncessaire de retirer ou commenter le code du CheatPanel dans la version \"release\" du jeu\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass CheatPanel \r\n{\r\n\t\r\n\t\t\r\n\tprivate var startFTUEButton:Controller;\r\n\tprivate var bgFTUEButton:Controller;\r\n\tprivate var resetFTUEButton:Controller;\r\n\tprivate var godModeBtn:Controller;\r\n\t\r\n\tprivate var startFTUE:Bool=false;\r\n\tprivate var _FTUE:Bool = false;\r\n\tprivate var _resetFTUE:Bool = false;\r\n\tprivate var _killFTUE:Bool = false;\r\n\tprivate var _godMode:Bool = GameManager.getInstance().godMode;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe CheatPanel\r\n\t */\r\n\tprivate static var instance: CheatPanel;\r\n\t\r\n\t/**\r\n\t * instance de dat.GUI compose par le CheatPanel\r\n\t */\r\n\tprivate var gui:GUI;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): CheatPanel {\r\n\t\tif (instance == null) instance = new CheatPanel();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\tinit();\r\n\t}\r\n\r\n\t\r\n\tprivate function init():Void {\r\n\t\tif (Config.debug && Config.data.cheat && !DeviceCapabilities.isCanvasPlus) gui = new GUI();\r\n\t}\r\n\t\r\n\t// exemple de mthode configurant le panneau de cheat suivant le contexte\r\n\tpublic function ingame (): Void {\r\n\t\t// ATTENTION: toujours intgrer cette ligne dans chacune de vos mthodes pour ignorer le reste du code si le CheatPanel doit tre dsactiv\r\n\t\tif (gui == null) return;\r\n\t\t//startFTUEButton = gui.add(this, \"startFTUE\");\r\n\t\t//startFTUEButton.onChange(cbFTUE);\r\n\t\t\r\n\t\tbgFTUEButton = gui.add(this, \"_killFTUE\");\r\n\t\tbgFTUEButton.onChange(killFTUE);\t\r\n\t\t\r\n\t\tresetFTUEButton = gui.add(this, \"_resetFTUE\");\r\n\t\tresetFTUEButton.onChange(resetFTUE);\r\n\t\t\r\n\t\tgodModeBtn = gui.add(this, \"_godMode\");\r\n\t\tgodModeBtn.onChange(godMode);\r\n\t\t\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * vide le CheatPanel\r\n\t */\r\n\tpublic function clear ():Void {\r\n\t\tif (gui == null) return;\r\n\t\tgui.destroy();\r\n\t\tinit();\r\n\t}\r\n\t\r\n\tprivate function godMode(pValue:Bool): Void {\r\n\t\tGameManager.getInstance().godMode =  Spawner.getInstance().godMode =  pValue;\r\n\t}\r\n\t\r\n\tprivate function cbFTUE (pValue:Bool): Void {\r\n\t\t//FTUEManager.currentStep = 0;\r\n\t\tif (pValue) FTUEManager.nextStep();\r\n\t\tstartFTUE = false;\r\n\t}\r\n\t\r\n\tprivate function cbBgFTUE (pValue:Bool): Void {\r\n\t\tFocusManager.getInstance().modalImage = pValue ? \"assets/ftue2_bg.png\" : \"assets/ftue_bg.png\";\r\n\t}\t\r\n\t\r\n\tprivate function resetFTUE(pValue:Bool)\r\n\t{\r\n\t\tif (pValue) {\r\n\t\t\tDataBaseAction.getInstance().changeFtueStep(Player.getInstance().id, 0);\r\n\t\t\t_resetFTUE = false;\r\n\t\t\tBrowser.window.location.reload();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function killFTUE(pValue:Bool)\r\n\t{\r\n\t\tif (pValue) {\r\n\t\t\tDataBaseAction.getInstance().changeFtueStep(Player.getInstance().id, 100);\r\n\t\t\t_killFTUE = false;\r\n\t\t\tBrowser.window.location.reload();\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui;\n\nimport com.isartdigital.ruby.preloadgame.LoadingBar;\nimport com.isartdigital.utils.Config;\nimport com.isartdigital.utils.loader.GameLoader;\nimport com.isartdigital.utils.ui.Screen;\nimport pixi.core.sprites.Sprite;\nimport pixi.core.text.Text;\nimport pixi.core.textures.Texture;\n\n/**\n * Preloader Graphique principal\n * @author Mathieu ANTHOINE\n */\nclass GraphicLoader extends Screen \n{\n\t\n\t/**\n\t * instance unique de la classe GraphicLoader\n\t */\n\tprivate static var instance: GraphicLoader;\n\n\t//private var loaderBar:LoadingBar = LoadingBar.getInstance();\n\tprivate var pourcentage:Text;\n\tprivate var title:Text;\n\tprivate var ressourceText:Text;\n\tprivate static inline var MARGIN_TOP: Float = 500;\n\t\n\n\n\tpublic function new() \n\t{\n\t\tsuper();\n\t\t//var lBg:Sprite = new Sprite(Texture.fromImage(Config.url(Config.assetsPath+\"preload_bg.png\")));\n\t\t//lBg.anchor.set(0.5, 0.5);\n\t\t//addChild(lBg);\n\t\t//\n\t\t//loaderBar = new Sprite (Texture.fromImage(Config.url(Config.assetsPath+\"preload.png\")));\n\t\t//loaderBar.anchor.y = 0.5;\n\t\t//loaderBar.x = -loaderBar.width / 2;\n\t\t//addChild(loaderBar);\n\t\t//loaderBar.scale.x = 0;\n\t\t//\n\t\t//pourcentage  = new Text(\" \", { font : '50px Arial black', fill : 0xFFFFFF, align : 'center' } );\n\t\t//pourcentage.anchor.set(0.5, 0.5);\n\t\t//pourcentage.y = MARGIN_TOP/2-150;\n\t\t//addChild(pourcentage);\n\t\t//\n\t\t//ressourceText  = new Text(\" \", { font : '50px Arial black', fill : 0xFFFFFF, align : 'center' } );\n\t\t//ressourceText.anchor.set(0.5, 0.5);\n\t\t//ressourceText.y = MARGIN_TOP/2.5;\n\t\t//addChild(ressourceText);\n\t\t\t\t\n\t\t//addChild(loaderBar);\n\t\t//loaderBar.start();\n\t\t//loaderBar.scale.x = 1.5;\n\t\t//loaderBar.scale.y = 1.5;\n\t\t\n\t}\n\t\n\t/**\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\n\t * @return instance unique\n\t */\n\tpublic static function getInstance (): GraphicLoader {\n\t\tif (instance == null) instance = new GraphicLoader();\n\t\treturn instance;\n\t}\n\t\n\t\n\t\n\t/**\n\t * dtruit l'instance unique et met sa rfrence interne  null\n\t */\n\toverride public function destroy (): Void {\n\t\tinstance = null;\n\t\tsuper.destroy();\n\t}\n\n}","package com.isartdigital.ruby.ui;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.utils.system.Localization;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass LocalizationByType\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe LocalizationByType\r\n\t */\r\n\tprivate static var instance: LocalizationByType;\r\n\r\n\tpublic static var ANTENNA:String = \t\t\t\t\t\t\"LABEL_BUILDING_ANTENNA\";\r\n\tpublic static var COMMUNICATION:String = \t\t\t\t\"LABEL_BUILDING_COMMUNICATION\";\r\n\tpublic static var HQ:String = \t\t\t\t\t\t\t\"LABEL_BUILDING_HQ\";\r\n\tpublic static var POWERSTATION:String = \t\t\t\t\"LABEL_BUILDING_POWERSTATION\";\r\n\tpublic static var TRANSLATION:String = \t\t\t\t\t\"LABEL_BUILDING_TRANSLATIONCENTER\";\r\n\tpublic static var DRILLING_AUTO_OUTPOST:String = \t\t\"LABEL_BUILDING_DRILLINGAUTO\";\r\n\tpublic static var DRILLING_CENTER:String = \t\t\t\t\"LABEL_BUILDING_DRILLINGCENTER\";\r\n\tpublic static var DRILLING_OUTPOST:String = \t\t\t\"LABEL_BUILDING_DRILLINGOUTPOST\";\r\n\tpublic static var COSMETIC_CAPSULE1:String = \t\t\t\"LABEL_BUILDING_CAPSULE1\";\r\n\tpublic static var COSMETIC_CAPSULE2:String = \t\t\t\"LABEL_BUILDING_CAPSULE2\";\r\n\tpublic static var COSMETIC_CAPSULE3:String = \t\t\t\"LABEL_BUILDING_CAPSULE3\";\r\n\tpublic static var COSMETIC_PLANT1:String = \t\t\t\t\"LABEL_BUILDING_PLANT1\";\r\n\tpublic static var COSMETIC_PLANT2:String = \t\t\t\t\"LABEL_BUILDING_PLANT2\";\r\n\tpublic static var COSMETIC_PLANT3:String = \t\t\t\t\"LABEL_BUILDING_PLANT3\";\r\n\tpublic static var INCUBATOR:String = \t\t\t\t\t\"LABEL_BUILDING_INCUBATOR\";\r\n\tpublic static var PADDOCK_TINY:String = \t\t\t\t\"LABEL_BUILDING_PADDOCKTINY\";\r\n\tpublic static var PADDOCK_SMALL:String = \t\t\t\t\"LABEL_BUILDING_PADDOCKSMALL\";\r\n\tpublic static var PADDOCK_MEDIUM:String = \t\t\t\t\"LABEL_BUILDING_PADDOCKMEDIUM\";\r\n\tpublic static var PADDOCK_BIG:String = \t\t\t\t\t\"LABEL_BUILDING_PADDOCKBIG\";\r\n\tpublic static var RESEARCH_CENTER:String = \t\t\t\t\"LABEL_BUILDING_RESEARCH\";\r\n\tpublic static var TRAINING_CENTER:String = \t\t\t\t\"LABEL_BUILDING_TRAININGCENTER\";\r\n\tpublic static var CRYO_CENTER:String = \t\t\t\t\t\"LABEL_BUILDING_CRYOCENTER\";\r\n\r\n\tpublic static var DESC_ANTENNA:String = \t\t\t\t\"LABEL_DESC_ANTENNA\";\r\n\tpublic static var DESC_COMMUNICATION:String = \t\t\t\"LABEL_DESC_COMMUNICATION\";\r\n\tpublic static var DESC_HQ:String = \t\t\t\t\t\t\"LABEL_DESC_HQ\";\r\n\tpublic static var DESC_POWERSTATION:String = \t\t\t\"LABEL_DESC_POWERSTATION\";\r\n\tpublic static var DESC_TRANSLATION:String = \t\t\t\"LABEL_DESC_TRANSLATIONCENTER\";\r\n\tpublic static var DESC_DRILLING_AUTO_OUTPOST:String = \t\"LABEL_DESC_DRILLINGAUTO\";\r\n\tpublic static var DESC_DRILLING_CENTER:String = \t\t\"LABEL_DESC_DRILLINGCENTER\";\r\n\tpublic static var DESC_DRILLING_OUTPOST:String = \t\t\"LABEL_DESC_DRILLINGOUTPOST\";\r\n\tpublic static var DESC_COSMETIC_FLUOALGA:String = \t\t\"LABEL_DESC_COSMETIC\";\r\n\tpublic static var DESC_COSMETIC_FLUOALGA2:String = \t\t\"LABEL_DESC_COSMETIC\";\r\n\tpublic static var DESC_INCUBATOR:String = \t\t\t\t\"LABEL_DESC_INCUBATOR\";\r\n\tpublic static var DESC_PADDOCK_TINY:String = \t\t\t\"LABEL_DESC_PADDOCKTINY\";\r\n\tpublic static var DESC_PADDOCK_SMALL:String = \t\t\t\"LABEL_DESC_PADDOCKSMALL\";\r\n\tpublic static var DESC_PADDOCK_MEDIUM:String = \t\t\t\"LABEL_DESC_PADDOCKMEDIUM\";\r\n\tpublic static var DESC_PADDOCK_BIG:String = \t\t\t\"LABEL_DESC_PADDOCKBIG\";\r\n\tpublic static var DESC_RESEARCH_CENTER:String = \t\t\"LABEL_DESC_RESEARCH\";\r\n\tpublic static var DESC_TRAINING_CENTER:String = \t\t\"LABEL_DESC_TRAININGCENTER\";\r\n\tpublic static var DESC_CRYO_CENTER:String = \t\t\t\"LABEL_DESC_CRYOCENTER\";\r\n\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): LocalizationByType\r\n\t{\r\n\t\tif (instance == null) instance = new LocalizationByType();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\r\n\t}\r\n\r\n\tpublic function translateFromType(pType:String):String\r\n\t{\r\n\t\tvar lType:String = getLabelFromType(pType);\r\n\t\treturn Localization.getLabel(lType);\r\n\t}\r\n\r\n\tprivate function getLabelFromType(pType:String):String\r\n\t{\r\n\t\tif (pType == ElementType.ANTENNA) return ANTENNA;\r\n\t\telse if (pType == ElementType.COMMUNICATION) return COMMUNICATION;\r\n\t\telse if (pType == ElementType.HQ) return HQ;\r\n\t\telse if (pType == ElementType.POWERSTATION) return POWERSTATION;\r\n\t\telse if (pType == ElementType.TRANSLATION) return TRANSLATION;\r\n\t\telse if (pType == ElementType.DRILLING_AUTO_OUTPOST) return DRILLING_AUTO_OUTPOST;\r\n\t\telse if (pType == ElementType.DRILLING_CENTER) return DRILLING_CENTER;\r\n\t\telse if (pType == ElementType.DRILLING_OUTPOST) return DRILLING_OUTPOST;\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE1) return COSMETIC_CAPSULE1;\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE2) return COSMETIC_CAPSULE2;\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE3) return COSMETIC_CAPSULE3;\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT1) return COSMETIC_PLANT1;\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT2) return COSMETIC_PLANT2;\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT3) return COSMETIC_PLANT3;\r\n\t\telse if (pType == ElementType.INCUBATOR) return INCUBATOR;\r\n\t\telse if (pType == ElementType.PADDOCK_TINY) return PADDOCK_TINY;\r\n\t\telse if (pType == ElementType.PADDOCK_SMALL) return PADDOCK_SMALL;\r\n\t\telse if (pType == ElementType.PADDOCK_MEDIUM) return PADDOCK_MEDIUM;\r\n\t\telse if (pType == ElementType.PADDOCK_BIG) return PADDOCK_BIG;\r\n\t\telse if (pType == ElementType.RESEARCH_CENTER) return RESEARCH_CENTER;\r\n\t\telse if (pType == ElementType.TRAINING_CENTER) return TRAINING_CENTER;\r\n\t\telse if (pType == ElementType.CRYO_CENTER) return CRYO_CENTER;\r\n\t\telse return pType;\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchItem;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport js.Lib;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass Slider extends DisplayObject\r\n{\r\n\t\r\n\tprivate var g:Graphics;\r\n\t\r\n\tprivate var hasEnoughItemToSlide:Bool;\r\n\tprivate var isOver:Bool;\r\n\tprivate var isDown:Bool;\r\n\t\r\n\tprivate var oldX:Float;\r\n\tprivate var deltaX:Float;\r\n\tprivate var beginXSlider:Float;\r\n\tprivate var lastItemX:Float;\r\n\tprivate var firstItemX:Float;\r\n\tprivate var endXSlider:Float;\r\n\t\r\n\tprivate var mainContainer:SmartComponent;\r\n\tpublic var itemContainer(default, null):SmartComponent;\r\n\t\r\n\tprivate var isListeningItem:Bool;\r\n\tprivate var theMask:Graphics;\r\n\tprivate var isParamsUpdate:Bool = false;\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tg = new Graphics();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialisele slider, les containeurs et les couteurs\r\n\t */\r\n\tpublic function init(pSlider:SmartComponent, pItemContainer:SmartComponent) {\r\n\t\t\r\n\t\tinitContainer(pSlider, pItemContainer);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function initMask() {\r\n\t\tif(theMask == null)\r\n\t\t\ttheMask = new Graphics();\r\n\t\t\r\n\t\ttheMask.beginFill(0xffffff);\r\n\t\ttheMask.drawRect(0-(mainContainer.width-150)/2, itemContainer.y-mainContainer.height/2, mainContainer.width-150, mainContainer.height);\r\n\t\ttheMask.endFill();\r\n\t\tmainContainer.addChildAt(theMask, 0);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initContainer(pSlider:SmartComponent, pItemContainer:SmartComponent) {\r\n\t\tmainContainer = pSlider;\r\n\t\tmainContainer.interactive = true;\r\n\t\t\r\n\t\titemContainer = pItemContainer;\r\n\t\titemContainer.interactive = true;\r\n\t\t\r\n\t\tmainContainer.on(MouseEventType.MOUSE_MOVE, onSlide);\r\n\t\tmainContainer.on(MouseEventType.MOUSE_DOWN, function() {\r\n\t\t\tisDown = true;\r\n\t\t\toldX = Controller.getInstance().getPosFrom(mainContainer).x;\r\n\t\t});\r\n\t\tmainContainer.on(MouseEventType.MOUSE_UP, function() {\r\n\t\t\tisDown = false;\t\t\t\r\n\t\t\tcheckSliderPosition();\r\n\t\t\tlistenItems();\r\n\t\t});\r\n\t\tmainContainer.on(MouseEventType.MOUSE_OVER, function() {\r\n\t\t\tisOver = true;\r\n\t\t});\r\n\t\tmainContainer.on(MouseEventType.MOUSE_OUT, function() {\r\n\t\t\tisDown = false;\r\n\t\t\tisOver = false;\r\n\t\t\tlistenItems();\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\tif (!isParamsUpdate) updateParams();\r\n\t\t\r\n\t\t\r\n\t\titemContainer.mask = theMask;\r\n\t}\r\n\t\r\n\tpublic function setItemContainer(pItemContainer:SmartComponent) {\r\n\t\t\r\n\t}\r\n\tpublic function update() {\r\n\t\tsetItemPositionToBeginPosition();\r\n\t\tupdateFirstAndLastXItemData();\r\n\t\tcheckIfHasEnoughItemToSlide();\r\n\t\tlistenItems();\r\n\t}\r\n\t/**\r\n\t * met  jour les parametres slider permetant de definir les cran d'arret\r\n\t */\r\n\tprivate function updateParams() {\r\n\t\tbeginXSlider = itemContainer.x;\r\n\t\tendXSlider =  mainContainer.width/2 - 200;\r\n\t\tif (theMask == null) initMask();\r\n\t\tisParamsUpdate = true;\r\n\t}\r\n\t\r\n\tprivate function updateFirstAndLastXItemData() {\r\n\t\tif (itemContainer.children.length <= 0) return;\r\n\t\tlastItemX = itemContainer.x + itemContainer.getChildAt(itemContainer.children.length - 1).x;\r\n\t\tfirstItemX = itemContainer.x;\r\n\t}\r\n\t\r\n\tprivate function setItemPositionToBeginPosition() {\r\n\t\titemContainer.x = beginXSlider;\r\n\t}\r\n\t\r\n\tprivate function checkIfHasEnoughItemToSlide() {\r\n\t\thasEnoughItemToSlide = lastItemX > endXSlider;\r\n\t}\r\n\t/**\r\n\t * callback d'event ce qui est exectu au mouvement de la souris\r\n\t * @param\tpEvent\r\n\t */\r\n\tprivate function onSlide(pEvent:EventTarget) {\r\n\t\t\r\n\t\tif (isDown) {\r\n\t\t\tmoveTheSlider();\r\n\t\t\t//draw();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gere le mouvement du slider\r\n\t */\r\n\tprivate function moveTheSlider() {\r\n\t\tif (hasEnoughItemToSlide) {\t\t\r\n\t\t\t\r\n\t\t\tvar currentX:Float = Controller.getInstance().getPosFrom(mainContainer).x;\r\n\t\t\tupdateFirstAndLastXItemData();\r\n\t\t\tdeltaX = currentX - oldX;\r\n\t\t\t\r\n\t\t\tif (Math.abs(deltaX) > 5) offItems();\r\n\t\t\t\r\n\t\t\tvar newX:Float = itemContainer.x + deltaX;\r\n\t\t\t\r\n\t\t\tif(newX <= beginXSlider && lastItemX >= endXSlider)\r\n\t\t\t\titemContainer.x  = newX;\r\n\t\t\t\t\r\n\t\t\toldX = currentX;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function listenItems() {\r\n\t\tif (!isListeningItem) {\t\r\n\t\t\tfor (item in itemContainer.children) {\r\n\t\t\t\tcast(item, Item).onListen();\t\r\n\t\t\t}\r\n\t\t\tisListeningItem = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function offItems() {\r\n\t\tif (isListeningItem) {\r\n\t\t\tfor (item in itemContainer.children)\r\n\t\t\t\tcast(item, Item).onOff();\r\n\t\t\t\t\r\n\t\t\tisListeningItem = false;\r\n\t\t}\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Reposition le slider si la position n'est pas dans le clamp\r\n\t */\r\n\tprivate function checkSliderPosition() {\r\n\t\tif (hasEnoughItemToSlide) {\r\n\t\t\tif (itemContainer.x > beginXSlider) {\t\r\n\t\t\t\titemContainer.x = beginXSlider;\r\n\t\t\t}\r\n\t\t\telse if (lastItemX < endXSlider)\r\n\t\t\t\titemContainer.x += endXSlider - lastItemX + 5;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function draw() {\r\n\t\tg.clear();\r\n\t\t\t\r\n\t\t//ROUGE LE DEPART SLIDER\r\n\t\tg.beginFill(0xff0000);\r\n\t\tg.drawCircle(beginXSlider, 0, 10);\r\n\t\tg.endFill();\r\n\t\t\r\n\t\t//ROSE LE PREMIER ITEM\r\n\t\tg.beginFill(0xff00ff);\r\n\t\tg.drawCircle(firstItemX, 0, 10);\r\n\t\tg.endFill();\r\n\t\t\r\n\t\t//VERT LA FIN DU SLIDER\r\n\t\tg.beginFill(0x00ff00);\r\n\t\tg.drawCircle(endXSlider, 0, 10);\r\n\t\tg.endFill();\r\n\t\t\r\n\t\t//BLEU LE DERNIER ITEM\r\n\t\tg.beginFill(0x0000ff);\r\n\t\tg.drawCircle(lastItemX, 0, 10);\r\n\t\tg.endFill();\r\n\t\t\r\n\t\tmainContainer.addChild(g);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui;\n\n\nimport com.isartdigital.ruby.ui.ftue.FocusManager;\nimport com.isartdigital.ruby.ui.hud.Hud;\nimport com.isartdigital.utils.game.GameStage;\nimport com.isartdigital.utils.sounds.SoundManager;\nimport com.isartdigital.utils.ui.Popin;\nimport com.isartdigital.utils.ui.Screen;\nimport pixi.core.display.Container;\n\n/**\n * Manager (Singleton) en charge de grer les crans d'interface\n * @author Mathieu ANTHOINE\n */\nclass UIManager \n{\n\t\n\t/**\n\t * instance unique de la classe UIManager\n\t */\n\tprivate static var instance: UIManager;\n\t\n\t\n\t/**\n\t * tableau des popins ouverts\n\t */\n\tprivate var popins:Array<Popin>;\n\tpublic var regionPopins:Array<Popin>;\n\n\tpublic function new() \n\t{\n\t\tpopins = [];\n\t\tregionPopins = [];\n\t}\n\t\n\t/**\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\n\t * @return instance unique\n\t */\n\tpublic static function getInstance (): UIManager {\n\t\tif (instance == null) instance = new UIManager();\n\t\treturn instance;\n\t}\n\t\n\t/**\n\t * Ajoute un cran dans le conteneur de Screens en s'assurant qu'il n'y en a pas d'autres\n\t * @param\tpScreen Screen  ouvrir\n\t */\n\tpublic function openScreen (pScreen: Screen): Void {\n\t\tcloseScreens();\n\t\tGameStage.getInstance().getScreensContainer().addChild(pScreen);\n\t\tpScreen.open();\n\t}\n\t\n\t/**\n\t * Supprime les crans dans le conteneur de Screens\n\t */\n\tpublic function closeScreens (): Void {\n\t\tvar lContainer:Container = GameStage.getInstance().getScreensContainer();\n\t\twhile (lContainer.children.length > 0) {\n\t\t\tvar lCurrent:Screen = cast(lContainer.getChildAt(lContainer.children.length - 1), Screen);\n\t\t\tlCurrent.interactive = false;\n\t\t\tlContainer.removeChild(lCurrent);\n\t\t\tlCurrent.close();\n\t\t}\n\t}\n\t\n\t/**\n\t * Ajoute un popin dans le conteneur de Popin\n\t * @param\tpPopin Popin  ouvrir\n\t */\n\tpublic function openPopin (pPopin: Popin): Void {\n\t\tpopins.push(pPopin);\n\t\tGameStage.getInstance().getPopinsContainer().addChild(pPopin);\n\t\tpPopin.open();\n\t\tSoundManager.getSound(\"in\").play();\n\n\t}\n\t\n\tpublic function openRegionPopin (pPopin: Popin): Void {\n\t\tregionPopins.push(pPopin);\n\t\tpPopin.open();\n\n\t}\n\t\n\tpublic function closeRegionPopin (pPopin: Popin): Void {\n\t\tif(pPopin == null)\n\t\t\tregionPopins.remove(pPopin);\n\t\t\t\n\t\tpPopin.close();\n\t\t\n\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\n\n\t}\n\t\n\tpublic function closePopin (pPopin: Popin): Void {\n\t\t\n\t\tif(pPopin == null)\n\t\t\tpopins.remove(pPopin);\n\t\t\t\n\t\tGameStage.getInstance().getPopinsContainer().removeChild(pPopin);\n\t\tpPopin.close();\n\t\t\n\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\n\n\t}\n\t/**\n\t * Supprime le popin dans le conteneur de Screens\n\t */\n\tpublic function closeCurrentPopin (): Void {\n\t\tif (popins.length == 0) return;\n\t\tvar lCurrent:Popin = popins.pop();\n\t\tlCurrent.interactive = false;\n\t\tGameStage.getInstance().getPopinsContainer().removeChild(lCurrent);\n\t\tlCurrent.close();\n\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\n\n\t\t\n\t}\n\t\n\tpublic function  closeAllPopins():Void {\n\t\t\n\t\tif (popins.length == 0) return;\n\t\tvar lindex:Int;\n\t\tfor (i in 0...popins.length) {\n\t\t\tvar lCurrent:Popin = popins.pop();\n\t\t\tclosePopin(lCurrent);\n\t\t}\n\t}\n\n\t\n\t/**\n\t * Ajoute le hud dans le conteneur de Hud\n\t */\n\tpublic function openHud (): Void {\n\t\tGameStage.getInstance().getHudContainer().addChild(Hud.getInstance());\n\t\tHud.getInstance().open();\n\n\t}\n\t\n\t/**\n\t * Retire le hud du conteneur de Hud\n\t */\n\tpublic function closeHud (): Void {\n\t\tGameStage.getInstance().getHudContainer().removeChild(Hud.getInstance());\n\t\tHud.getInstance().close();\n\n\t}\n\t\n\t/**\n\t * Ajoute le hud dans le conteneur de Hud\n\t */\n\tpublic function openFTUE (): Void {\n\t\tGameStage.getInstance().getFtueContainer().addChild(FocusManager.getInstance());\n\t\tFocusManager.getInstance().open();\n\t}\n\t\n\t/**\n\t * Retire le hud du conteneur de Hud\n\t */\n\tpublic function closeFTUE (): Void {\n\t\tGameStage.getInstance().getFtueContainer().removeChild(FocusManager.getInstance());\n\t\tFocusManager.getInstance().close();\n\t}\n\t\n\t/**\n\t * met l'interface en mode jeu\n\t */\n\t public function startGame (): Void {\n\t\tcloseScreens();\n\t\topenHud();\n\t}\n\t\n\t/**\n\t * dtruit l'instance unique et met sa rfrence interne  null\n\t */\n\tpublic function destroy (): Void {\n\t\tinstance = null;\n\t}\n\n}","package com.isartdigital.ruby.ui.ftue;\r\n\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass Arrow extends FlumpStateGraphic\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(\"FTUE_arrow\");\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tsetState(DEFAULT_STATE,true);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.ftue;\r\n\r\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass BouleHighlight extends FlumpStateGraphic\r\n{\r\n\r\n\tpublic function new(pAsset:String=null) \r\n\t{\r\n\t\tsuper(\"Boule_Highlight\");\r\n\t\t\r\n\t}\r\n\toverride public function start():Void \r\n\t{\r\n\t\tsuper.start();\r\n\t\tsetState(DEFAULT_STATE,true);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.ftue;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.IsartPoints;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport eventemitter3.EventEmitter;\r\nimport haxe.Constraints.Function;\r\nimport haxe.Json;\r\nimport js.Browser;\r\nimport js.Lib;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\r\n/**\r\n * Gestion des changement d'etape de la ftue\r\n * @author Adrien Bourdon\r\n */ \r\n\tclass FTUEManager\r\n{\r\n\t\r\n\tpublic static var steps(default, null):Array<FTUEStep>;\r\n\tpublic static var numberSteps(default, null):Int;\r\n\t//TODO: rcuprer l'tape courante sur le serveur\r\n\tpublic static var currentStep(default, default):UInt = 0;\r\n\tprivate static var isRunning:Bool;\r\n\t\r\n\tprivate function new() {}\r\n\t\r\n\tpublic static function init (pFTUE: Dynamic): Void {\r\n\t\tsteps = pFTUE.steps;\r\n\t\tnumberSteps = steps.length;\r\n\t}\r\n\t\r\n\tpublic static function isFTUEon():Bool \r\n\t{\r\n\t\treturn (currentStep < numberSteps-1) && isRunning;\r\n\t}\r\n\t\r\n\tpublic static function register (pTarget:DisplayObject): Void {\r\n\t\tif (currentStep>=steps.length || pTarget.parent == null) return;\r\n\t\tfor (i in 0...steps.length) {\r\n\t\t\tif (pTarget.name == steps[i].name && pTarget.parent.name == steps[i].parentName) {\r\n\t\t\t\tsteps[i].item = pTarget;\r\n\t\t\t}\r\n\t\t\tif (pTarget.name == steps[i].arrowTarget) \r\n\t\t\t{\r\n\t\t\t\tsteps[i].itemTarget = pTarget;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function nextStep(pTarget:DisplayObject = null): Void {\r\n\t\tisRunning = true;\r\n\t\tif (!isFTUEon()) return;\r\n\t\tif (steps[currentStep].text != \"\") setText();\r\n\t\tFocusManager.getInstance().setCurrentStep(steps[currentStep]);\r\n\r\n\t\t\tif (steps[currentStep].isAction) \r\n\t\t\t{\r\n\t\t\t\tif (Std.is(steps[currentStep].item, SmartButton)) cast(steps[currentStep].item, SmartButton).on(MouseEventType.CLICK, endOfStep);\r\n\t\t\t\telse if (Std.is(steps[currentStep].item, SmartComponent)) cast(steps[currentStep].item, SmartComponent).on(MouseEventType.CLICK, endOfStep);\t\t\t\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tif (steps[currentStep].parentName == \"infoBulleContainer\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(steps[currentStep].item.interactive) steps[currentStep].item.on(MouseEventType.CLICK, endOfStep);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tUIManager.getInstance().openFTUE();\t\r\n\r\n\t\tif (steps[currentStep].event != \"\")\r\n\t\t{\r\n\t\t\tif (steps[currentStep].event == \"onBulle\") Building.event.on(steps[currentStep].event, readyToNextStep);\r\n\t\t\telse if (steps[currentStep].event == \"onAddAlien\") AlienPaddock.event.on(steps[currentStep].event, readyToNextStep);\r\n\t\t\telse SmartPopinRegister.event.on(steps[currentStep].event, readyToNextStep);\r\n\t\t}\r\n\t\t\r\n\t\tif (steps[currentStep].gift != \"\") addGift(steps[currentStep].gift);\r\n\t\tif (steps[currentStep].ftueStop) isRunning = false;\r\n\t\tif (pTarget != null || steps[currentStep].name == \"\") return;\r\n\t\tFocusManager.getInstance().setFocus(steps[currentStep].item, steps[currentStep].arrowRot);\r\n\t}\r\n\t\r\n\tprivate static function endOfStep ():Void {\t\r\n\t\tif (Std.is(steps[currentStep].item, SmartButton) && steps[currentStep].isAction) {\r\n\t\t\tcast(steps[currentStep].item, SmartButton).off(MouseEventType.CLICK, endOfStep);\r\n\t\t\tsteps[currentStep].item = null;\r\n\t\t}\r\n\t\telse if (Std.is(steps[currentStep].item, SmartComponent) && steps[currentStep].isAction) {\r\n\t\t\tcast(steps[currentStep].item, SmartComponent).off(MouseEventType.CLICK, endOfStep);\r\n\t\t\tsteps[currentStep].item = null;\r\n\t\r\n\t\t}\r\n\t\tUIManager.getInstance().closeFTUE();\r\n\t\t\r\n\t\tif (steps[currentStep].checkpoint) DataBaseAction.getInstance().changeFtueStep(Player.getInstance().id, currentStep);\r\n\t\t//TODO: ne pas oublier de donner la possibilit de rinitialiser la valeur dans le cheatPanel\r\n\t\t\r\n\t\tif (currentStep == steps.length - 1) UIManager.getInstance().closeCurrentPopin();\r\n\t\tcurrentStep++;\r\n\t\tif (FTUEPopin.getInstance() != null) UIManager.getInstance().closePopin(FTUEPopin.getInstance());\r\n\t\tif (!steps[currentStep - 1].ftueStop && isFTUEon()) nextStep();\r\n\t}\r\n\t\r\n\t/**\r\n\t * call back des event de la ftue\r\n\t * @param\tpEvent\r\n\t */\r\n\tprivate static function readyToNextStep (pEvent:EventTarget):Void\r\n\t{\r\n\t\tif (FTUEPopin.getInstance() != null) UIManager.getInstance().closePopin(FTUEPopin.getInstance());\r\n\t\tif (steps[currentStep].event == \"onBulle\") Building.event.off(steps[currentStep].event, readyToNextStep);\r\n\t\telse if (steps[currentStep].event == \"onAddAlien\") AlienPaddock.event.off(steps[currentStep].event, readyToNextStep);\r\n\t\telse SmartPopinRegister.event.off(steps[currentStep].event, readyToNextStep);\r\n\t\tendOfStep();\r\n\t}\r\n\t\r\n\t/**\r\n\t * ouvre une popin de text explicatif\r\n\t */\r\n\tprivate static function setText():Void \r\n\t{\r\n\t\tif (steps[currentStep].text == \"LABEL_FTUE_ISART_POINT_DISCLAIMER\") \r\n\t\t{\r\n\t\t\tUIManager.getInstance().openPopin(IsartPoints.getInstance());\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tUIManager.getInstance().openPopin(FTUEPopin.getInstance());\r\n\t\t\t//FTUEPopin.getInstance().\r\n\t\t\t//GameStage.getInstance().getInfoBulleContainer.addChild(FTUEPopin.getInstance());\r\n\t\t\t\r\n\t\t\tvar lCallBack:Function = steps[currentStep].isAction || steps[currentStep].event != \"\" ? null : nextText;\r\n\t\t\tvar lEmot:Int = 0;\r\n\t\t\tif (steps[currentStep].emotion != null)\r\n\t\t\t{\r\n\t\t\t\tif (steps[currentStep].emotion == \"joy\") lEmot = 1;\r\n\t\t\t\telse if (steps[currentStep].emotion == \"neutral\") lEmot = 0;\r\n\t\t\t\telse if (steps[currentStep].emotion == \"exclamation\") lEmot = 3;\t\r\n\t\t\t\telse if (steps[currentStep].emotion == \"surprised\") lEmot = 2;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tFTUEPopin.getInstance().init(steps[currentStep].text, lCallBack, steps[currentStep].textPos, lEmot);\t\r\n\t\t\tif (steps[currentStep].parentName != \"FTUEpopin\") \r\n\t\t\t{\r\n\t\t\t\t//FTUEPopin.getInstance().position = steps[currentStep].item.position;\r\n\t\t\t}\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static function addGift(pGift:String):Void\r\n\t{\r\n\t\tif (pGift == \"AlienForreur\") \r\n\t\t{\r\n\t\t\tvar alienID:String = \"Basic1\"+Date.now().getTime();\r\n\t\t\tvar lAlien:AlienElement =\r\n\t\t\t{\r\n\t\t\t\tidAlien:alienID,\r\n\t\t\t\tidBuilding:\"\",\r\n\t\t\t\tmode:\"\",\r\n\t\t\t\tname:\"Basic1\",\r\n\t\t\t\ttype:\"AlienForeur\",\r\n\t\t\t\tnomPropre:\"Bob\",\r\n\t\t\t\tstamina:6,\r\n\t\t\t\tlevel:1,\r\n\t\t\t\tstartTime:Std.string(Date.now()),\r\n\t\t\t\tendTime:Std.string(Date.now()),\r\n\t\t\t\tcarac:Alien.getAlienType(\"Basic1\", DataManager.getInstance().getAlienArray(\"AlienForeur\")),\r\n\t\t\t\tidPlayer:Player.getInstance().id\r\n\t\t\t}\r\n\t\t\tAlien.alienElementList.push(lAlien);\r\n\t\t\tDataBaseAction.getInstance().addAlien(lAlien.idAlien, lAlien.idBuilding, lAlien.type, lAlien.name, lAlien.nomPropre, lAlien.stamina, lAlien.endTime);\r\n\t\t}\r\n\t\tif (pGift == \"AlienProducer\") \r\n\t\t{\r\n\t\t\tvar alienID:String = \"Producer1\"+Date.now().getTime();\r\n\t\t\tvar lAlien:AlienElement =\r\n\t\t\t{\r\n\t\t\t\tidAlien:alienID,\r\n\t\t\t\tidBuilding:\"\",\r\n\t\t\t\tmode:\"\",\r\n\t\t\t\tname:\"Producer1\",\r\n\t\t\t\ttype:\"AlienProducer\",\r\n\t\t\t\tnomPropre:\"Mik\",\r\n\t\t\t\tstamina:6,\r\n\t\t\t\tlevel:1,\r\n\t\t\t\tstartTime:\"00:00:00\",\r\n\t\t\t\tendTime:\"00:00:00\",\r\n\t\t\t\tcarac:Alien.getAlienType(\"Producer1\", DataManager.getInstance().getAlienArray(\"AlienProducer\")),\r\n\t\t\t\tidPlayer:Player.getInstance().id\r\n\t\t\t}\r\n\t\t\tAlien.alienElementList.push(lAlien);\r\n\t\t\tDataBaseAction.getInstance().addAlien(lAlien.idAlien, lAlien.idBuilding, lAlien.type, lAlien.name, lAlien.nomPropre, lAlien.stamina, lAlien.endTime);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * call back du bouton next des popin de texte explicatif\r\n\t */\r\n\tprivate static function nextText():Void\r\n\t{\r\n\t\tendOfStep();\r\n\t}\r\n}","package com.isartdigital.utils.ui;\r\n\r\n/**\r\n * Classe de base des PopIn\r\n * Toutes les popin d'interface hritent de cette classe\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Popin extends UIComponent\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.ui.Popin;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass SmartPopin extends Popin\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tbuttonMode = true;\r\n\t\tinteractive = true;\r\n\t\tdefaultCursor = \"url(assets/Curseur.png), auto\";\r\n\t\tbuild();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport eventemitter3.EventEmitter;\r\nimport js.Lib;\r\n\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\n\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass SmartPopinRegister extends SmartPopin\r\n{\r\n\tpublic static var event:EventEmitter = new EventEmitter();\r\n\tprivate static inline var ON_OPEN:String = \"onOpen\";\r\n\tprivate static inline var ON_YES:String = \"onYes\";\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tname = componentName;\r\n\t\t//event = new EventEmitter();\r\n\t\tftueRegister();\r\n\t}\r\n\t\r\n\toverride public function open():Void \r\n\t{\r\n\t\tsuper.open();\r\n\t\tevent.emit(ON_OPEN);\r\n\t}\r\n\t\r\n\tpublic function ftueRegister():Void \r\n\t{\r\n\t\tif (children.length <= 0) return;\r\n\t\tfor (i in 0...children.length) \r\n\t\t{\r\n\t\t\tif (Std.is(children[i], SmartButton)) FTUEManager.register(children[i]);\r\n\t\t\telse if (Std.is(children[i], SmartComponent)) FTUEManager.register(children[i]);\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\tif (Std.is(children[i], SmartComponent)) \r\n\t\t\t\t{\r\n\t\t\t\t\tvar component:SmartComponent = cast(children[i], SmartComponent);\r\n\t\t\t\t\tif (component.children.length <= 0) return;\r\n\t\t\t\t\tfor (j in 0...component.children.length) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (Std.is(component.children[j], SmartButton)) FTUEManager.register(component.children[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\t\r\n\t\t//SwitchItem.destroyAll();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.ftue;\r\n\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Quart;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.system.Localization;\r\nimport com.isartdigital.utils.ui.UIPositionable;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\nimport flump.IFlumpMovie;\r\nimport haxe.Constraints.Function;\r\nimport js.html.svg.PointList;\r\nimport pixi.core.math.Point;\r\nimport pixi.extras.MovieClip;\r\nimport pixi.flump.Sprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass FTUEPopin extends SmartPopinRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe FTUEPopin\r\n\t */\r\n\tprivate static var instance: FTUEPopin;\r\n\tprivate static inline var TEXT:String = \"txt_FTUEInstructions\";\r\n\tprivate static inline var NEXT_BTN:String = \"btn_Close\";\r\n\tprivate static inline var FTUE_CONTAINER:String = \"FTUE_popinContainer\";\r\n\tprivate var ftuePos:Point;\r\n\t\r\n\tprivate var nextButton:SmartButton;\r\n\tprivate var noButton:SmartButton;\r\n\t\r\n\tprivate var text:TextSprite;\r\n\tprivate var ftueContainer:SmartComponent;\r\n\t\r\n\tprivate var validationFunction:Function;\r\n\tprivate var mascotte:UIMovie;\r\n\tprivate var margin:Int = 100;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): FTUEPopin {\r\n\t\tif (instance == null) instance = new FTUEPopin();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(\"FTUE\");\r\n\t\tcomponentName = \"FTUEpopin\";\r\n\t\tname = \"FTUEpopin\";\r\n\t\tftueContainer = cast(getChildByName(FTUE_CONTAINER), SmartComponent);\r\n\t\tnextButton = cast(ftueContainer.getChildByName(NEXT_BTN), SmartButton);\r\n\t\tmascotte = cast(ftueContainer.getChildByName(\"FTUE_spriteMascot\"), UIMovie);\r\n\t\tinteractive = true;\r\n\t\tscale = new Point(0.7, 0.7);\r\n\t\tftueRegister();\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise la popin de confirmation \r\n\t * @param\tpQuestion : question  confirmer\r\n\t * @param\tpFunction : fonction  executer si confirmation\r\n\t */\r\n\tpublic function init(pText:String, pFunction:Function, ?pPos:String, ?pState:Int = 0):Void \r\n\t{\r\n\t\ttext = cast(ftueContainer.getChildByName(TEXT), TextSprite);\r\n\t\tchangeText(pText);\r\n\t\t\r\n\t\tmascotte.setBehavior(false, false, pState);\r\n\t\tif (pFunction != null) \r\n\t\t{\r\n\t\t\tvalidationFunction = pFunction;\r\n\t\t\tnextButton.on(MouseEventType.CLICK, onNext);\r\n\t\t\tnextButton.on(TouchEventType.TAP, onNext);\r\n\t\t\ton(MouseEventType.CLICK, onNext);\r\n\t\t\ton(TouchEventType.TAP, onNext);\r\n\t\t\t\r\n\t\t\tvar bump:TweenMax = new TweenMax(\r\n\t\t\t\tnextButton.scale,\r\n\t\t\t\t0.5,\r\n\t\t\t\t{\r\n\t\t\t\t\trepeatDelay:0.5,\r\n\t\t\t\t\tx:0.2,\r\n\t\t\t\t\ty:0.2,\r\n\t\t\t\t\trepeat:-1,\r\n\t\t\t\t\tease:Quart.easeIn,\r\n\t\t\t\t\tyoyo:true\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t);\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tvalidationFunction = null;\r\n\t\t\tnextButton.visible = false;\r\n\t\t}\r\n\t\t\r\n\t\tif (pPos != null) \r\n\t\t{\r\n\t\t\tsetUIPosition(pPos);\r\n\t\t}\r\n\t\tFTUEManager.register(nextButton);\r\n\t}\r\n\t//font: 50 + \"px \" + \"Arial\", \r\n\tpublic function changeText(pText):Void \r\n\t{\r\n\t\ttext.text = Localization.getLabel(pText);\r\n\t\ttext.textField.anchor.y = 0; \r\n\t\t/*text.textField.style = { \r\n\t\t\t\t\t\t\t\tfill:0xFFFFFF, \r\n\t\t\t\t\t\t\t\tfont: 50 + \"px \" + \"Alegreya Sans\",\r\n\t\t\t\t\t\t\t\t//align: \"left\",\r\n\t\t\t\t\t\t\t\twordWrap: true,\r\n\t\t\t\t\t\t\t\twordWrapWidth:text.textField.width,\r\n\t\t};*/\r\n\t}\r\n\t\r\n\tprivate function setUIPosition(pPos:String):Void\r\n\t{\r\n\r\n\t\tvar lPositionnables:Array<UIPositionable> = untyped positionables;\r\n\t\tfor (i in 0...lPositionnables.length)\r\n\t\t{\r\n\t\t\tif (lPositionnables[i].item.name == FTUE_CONTAINER)\r\n\t\t\t{\r\n\t\t\t\tlPositionnables[i].align = pPos;\r\n\t\t\t\tlPositionnables[i].offsetX = 800;\r\n\t\t\t\tlPositionnables[i].offsetY = 700;\r\n\t\t\t}\r\n\t\t\tif (i == 0) lPositionnables[i].item.alpha = 0;\r\n\t\t}\r\n\t\tonResize();\r\n\t}\r\n\r\n\tprivate function onNext()\r\n\t{\r\n\t\t//SmartPopinRegister.event.emit(\"onNext\");\r\n\t\tif (validationFunction != null) validationFunction();\r\n\t\tnextButton.off(MouseEventType.CLICK, onNext);\r\n\t\tnextButton.off(TouchEventType.TAP, onNext);\r\n\t\toff(MouseEventType.CLICK, onNext);\r\n\t\toff(TouchEventType.TAP, onNext);\r\n\t}\r\n\t\r\n\toverride function onResize(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\t//GameStage.getInstance().getPopinsContainer\r\n\t\tsuper.onResize(pEvent);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tnextButton.off(MouseEventType.CLICK, onNext);\r\n\t\tnextButton.off(TouchEventType.TAP, onNext);\r\n\t\toff(MouseEventType.CLICK, onNext);\r\n\t\toff(TouchEventType.TAP, onNext);\r\n\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.ftue;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.ui.ftue.Arrow;\r\nimport com.isartdigital.ruby.ui.popin.RewardNotifications;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.ui.Screen;\r\nimport com.isartdigital.utils.ui.UIComponent;\r\nimport com.isartdigital.utils.ui.UIPositionable;\r\nimport pixi.core.Pixi;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\t\r\n/**\r\n * Classe Exemple destine  grer l'accs/verrouillage des lements du jeu pour la FTUE\r\n * Permet de pointer facilement un lement de jeu et desactiver le comportement des autres\r\n * @author Mathieu Anthoine\r\n */\r\nclass FocusManager extends Screen \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe FTUE\r\n\t */\r\n\tprivate static var instance: FocusManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): FocusManager {\r\n\t\tif (instance == null) instance = new FocusManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\tprivate var arrow:Arrow;\r\n\tprivate var boule:BouleHighlight;\r\n\tprivate var arrowRotation:Float;\r\n\tprivate var target:DisplayObject;\r\n\tprivate var shadow:Container;\r\n\tprivate var currentStep:FTUEStep;\r\n\tprivate var lastStep:FTUEStep;\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodalImage = \"assets/ftue_bg.png\";\r\n\t\t\r\n\t\tshadow = new Container();\r\n\t\tshadow.name = \"shadow\";\r\n\t}\r\n\t\r\n\tpublic function setCurrentStep(pStep:FTUEStep):Void {\r\n\t\tif (pStep == null) return;\r\n\t\tif (currentStep != null) lastStep = currentStep;\r\n\t\tcurrentStep = pStep;\t\r\n\t}\r\n\r\n\t/**\r\n\t * Dfinit l'objet graphique  pointer\r\n\t * @param\tpTarget objet cibl\r\n\t * @param\tpRotation rotation de la flche qui pointe sur l'objet exprim en degrs\r\n\t */\r\n\tpublic function setFocus (pTarget:DisplayObject, ?pRotation:Float = 0): Void {\r\n\t\tif (!FTUEManager.isFTUEon()) return;\r\n\t\tif (target != null && target.parent == this) swap(shadow, target);\r\n\t\ttarget = pTarget;\r\n\t\tswap(target, shadow);\r\n\t\tarrowRotation = pRotation; \r\n\t\tonResize();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Ferme le screen FTUE et replace les objets graphique comme il convient\r\n\t */\r\n\toverride public function close():Void \r\n\t{\r\n\t\tif (target != null && target.parent == this) swap(shadow, target);\r\n\t\tsuper.close();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Echange l'objets graphique point avec un objet graphique \"shadow\"\r\n\t * Dans le cas ou l'objet point est  sa place d'origine, il le met dans le Screen FTUE et place un repre (shadow)  sa place dans le conteneur d'origine\r\n\t * Dans le cas ou l'objet point est dans le Screen FTUE, il le remet  sa place d'origine\r\n\t * @param\tpTarget objet dans le conteneur d'origine de l'objet cibl\r\n\t * @param\tpFTUE objet dans le Screen FTUE\r\n\t */\r\n\tprivate function swap (pTarget:DisplayObject, pFTUE: DisplayObject): Void {\r\n\t\tif (pTarget == null || pFTUE == null) return;\r\n\t\tif( pTarget.parent == null ) return;\r\n\t\tvar lParent:Container = pTarget.parent;\r\n\t\tif (pTarget.name == \"shadow\" && lastStep != null)\r\n\t\t{\r\n\t\t\taddChildOnContainer(pTarget, pFTUE);\r\n\t\t\tif (Reflect.getProperty(pFTUE, \"focusInFTUE\") != null) \r\n\t\t\t{\r\n\t\t\t\tif(Reflect.getProperty(pFTUE, \"focusInFTUE\")) Reflect.setProperty(pFTUE, \"focusInFTUE\", false);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tlParent.addChildAt(pFTUE,lParent.getChildIndex(pTarget));\r\n\t\t\tpFTUE.position = pTarget.position;\r\n\t\t\tif (BuildingMenu.getInstance().isOpened) \r\n\t\t\t{\r\n\t\t\t\tvar lNextStepName:String = FTUEManager.steps[FTUEManager.currentStep + 1].name;\t\r\n\t\t\t\tif (DataManager.getInstance().listBuildingTypes[lNextStepName] != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tBuildingMenu.getInstance().panel.setInfo(DataManager.getInstance().listBuildingTypes[lNextStepName]);\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse if (FTUEManager.steps[FTUEManager.currentStep].text == \"LABEL_FTUE_NOT_ENOUGH_MONEY\")\r\n\t\t\t\t{\r\n\t\t\t\t\tBuildingMenu.getInstance().panel.setInfo(DataManager.getInstance().listBuildingTypes[\"AlienPaddockTiny\"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\taddChildAt(pTarget, 0);\r\n\t\tif (Reflect.getProperty(pTarget, \"focusInFTUE\") != null) \r\n\t\t{\r\n\t\t\tif(!Reflect.getProperty(pTarget, \"focusInFTUE\")) Reflect.setProperty(pTarget, \"focusInFTUE\", true);\r\n\t\t}\r\n\t\t\r\n\t\tif (Std.is (lParent, UIComponent)) {\r\n\t\t\tvar lPositionnables:Array<UIPositionable> = untyped lParent.positionables;\r\n\t\t\tfor (i in 0...lPositionnables.length) {\r\n\t\t\t\tif (lPositionnables[i].item == pTarget) {\r\n\t\t\t\t\tlPositionnables[i].item = cast(pFTUE,Container);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function addChildOnContainer(pObject:DisplayObject, pTarget:DisplayObject ):Void\r\n\t{\r\n\t\tif (pObject == null ) return;\r\n\t\tvar lGrandParent:Container;\r\n\t\tif (lastStep.arGrandParentName != \"\") {\r\n\t\t\tvar lArGparent:Container = pObject.parent.parent.parent;\r\n\t\t\tlGrandParent = pObject.parent.parent;\r\n\t\t\tcast(cast(lArGparent.getChildByName(lGrandParent.name), Container).getChildByName(pObject.parent.name), Container).addChildAt(pTarget,pObject.parent.getChildIndex(pTarget));\t\t\t\r\n\t\t}\r\n\t\telse if (currentStep.grandParentName != \"\") \r\n\t\t{\r\n\t\t\tlGrandParent = pObject.parent.parent;\r\n\t\t\tcast(lGrandParent.getChildByName(pObject.parent.name), Container).addChildAt(pTarget,pObject.parent.getChildIndex(pObject));\r\n\t\t}\r\n\t\telse pObject.parent.addChildAt(pTarget,pObject.parent.getChildIndex(pObject));\t\t\r\n\t}\r\n\t\r\n\tvar lTest:Int  = 500;\r\n\toverride function onResize(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tif (target == null) return;\r\n\t\ttarget.position = toLocal(shadow.position, shadow.parent);\r\n\t\tvar lStep:FTUEStep = FTUEManager.steps[FTUEManager.currentStep];\r\n\t\t\r\n\t\tif (arrowRotation != 999) \r\n\t\t{\t\r\n\t\t\tif (lStep.arrowTarget != \"\")\r\n\t\t\t{\r\n\t\t\t\tif (boule == null) \r\n\t\t\t\t{ \r\n\t\t\t\t\tboule = new BouleHighlight();\r\n\t\t\t\t\taddChild(boule);\r\n\t\t\t\t\tboule.start();\r\n\t\t\t\t}\r\n\t\t\t\tvar lPoint:Point = toLocal(lStep.itemTarget.position, lStep.itemTarget.parent);\r\n\t\t\t\tboule.position = lPoint;\r\n\t\t\t\tboule.rotation = lStep.arrowRot * Pixi.DEG_TO_RAD;\r\n\t\t\t\tif (lStep.arrowRecule != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tboule.position.x = boule.position.x + lStep.arrowRecule * Math.cos(boule.rotation);\r\n\t\t\t\t\tboule.position.y = boule.position.y - lStep.arrowRecule * Math.sin(boule.rotation);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse \r\n\t\t\t{\r\n\t\t\t\tif (arrow == null) \r\n\t\t\t\t{ \r\n\t\t\t\t\tarrow = new Arrow();\r\n\t\t\t\t\taddChild(arrow);\r\n\t\t\t\t\tarrow.start();\r\n\t\t\t\t}\r\n\t\t\t\tarrow.rotation = arrowRotation * Pixi.DEG_TO_RAD;\r\n\t\t\t\tarrow.position = toLocal(shadow.position, shadow.parent);\r\n\t\t\t}\r\n\t\t\tif (lStep.arrowRecule != null && lStep.arrowTarget == \"\")\r\n\t\t\t{\r\n\t\t\t\tarrow.position.x = arrow.position.x + lStep.arrowRecule * Math.cos(arrow.rotation);\r\n\t\t\t\tarrow.position.y = arrow.position.y - lStep.arrowRecule * Math.sin(arrow.rotation);\r\n\t\t\t}\r\n\t\t\t//arrow.position = target.position;\t\r\n\t\t}\r\n\t\tsuper.onResize(pEvent);\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.hud;\n\nimport com.isartdigital.ruby.game.Spawner;\nimport com.isartdigital.ruby.game.player.Player;\nimport com.isartdigital.ruby.game.sprites.FlumpStateGraphic;\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\nimport com.isartdigital.ruby.game.world.MapInteractor;\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\nimport com.isartdigital.ruby.ui.popin.ConfirmationPose;\nimport com.isartdigital.ruby.ui.popin.DailyReward;\nimport com.isartdigital.ruby.ui.popin.Friendlist;\nimport com.isartdigital.ruby.ui.popin.Settings;\nimport com.isartdigital.ruby.ui.popin.XenosPanel;\nimport com.isartdigital.ruby.ui.popin.contextual.YesNoPose;\nimport com.isartdigital.ruby.ui.popin.contextual.BuildingContextualMenu;\nimport com.isartdigital.ruby.ui.popin.enclos.Enclos;\nimport com.isartdigital.ruby.ui.popin.TimeBased;\nimport com.isartdigital.ruby.ui.popin.XenoPage;\nimport com.isartdigital.ruby.ui.popin.shop.Shop;\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\nimport com.isartdigital.ruby.ui.popin.codex.Codex;\nimport com.isartdigital.ruby.ui.screens.PubImage;\nimport com.isartdigital.ruby.ui.screens.PubVideo;\nimport com.isartdigital.ruby.ui.screens.SmartScreenRegister;\nimport com.isartdigital.utils.Config;\nimport com.isartdigital.ruby.utils.ColorFilterManager;\nimport com.isartdigital.ruby.utils.ColorFilterManager.ColorFilterParams;\nimport com.isartdigital.ruby.utils.SmartShaker;\nimport com.isartdigital.ruby.utils.SmartShaker.ShakerParams;\nimport com.isartdigital.utils.events.MouseEventType;\nimport com.isartdigital.utils.events.TouchEventType;\nimport com.isartdigital.utils.game.factory.FlumpMovieAnimFactory;\nimport com.isartdigital.utils.sounds.SoundManager;\nimport com.isartdigital.utils.system.DeviceCapabilities;\nimport com.isartdigital.utils.ui.UIPosition;\nimport com.isartdigital.utils.ui.smart.SmartButton;\nimport com.isartdigital.utils.ui.smart.SmartComponent;\nimport com.isartdigital.utils.ui.smart.SmartPopin;\nimport com.isartdigital.utils.ui.smart.SmartScreen;\nimport com.isartdigital.utils.ui.smart.TextSprite;\nimport com.isartdigital.utils.ui.smart.UIMovie;\nimport flump.IFlumpMovie;\nimport js.Lib;\nimport js.html.MouseEvent;\nimport pixi.core.display.Container;\nimport pixi.core.display.DisplayObject;\nimport pixi.core.math.Point;\nimport pixi.core.sprites.Sprite;\nimport pixi.core.text.Text;\nimport pixi.core.textures.Texture;\nimport pixi.filters.color.ColorMatrixFilter;\nimport pixi.flump.Movie;\n\n/**\n * Classe en charge de grer les informations du Hud\n * @author Michael Wilkins\n */\nclass Hud extends SmartScreenRegister\n{\n\n\tprivate static inline var SHOP_BTN:String = \"btn_Shop\";\n\tprivate static inline var BUILD_BTN:String = \"btn_Build\";\n\tprivate static inline var OPTIONS_BTN:String = \"btn_Options\";\n\tprivate static inline var CODEX_BTN:String = \"btn_Codex\";\n\tprivate static inline var HC_ADD_BTN:String = \"btn_PlusHC\";\n\tprivate static inline var SC_ADD_BTN:String = \"btn_PlusSC\";\n\n\tpublic static inline var SC_BAR:String = \"HUD_clipSoftCurrencie\";\n\tpublic static inline var HC_BAR:String = \"HUD_clipHardCurrencie\";\n\tpublic static inline var MATERIAL_BAR:String = \"HUD_clipMatiere\";\n\n\tprivate static inline var PLAYER_INFO_CONTAINER:String = \"HUD_clipPlayerInfos\";\n\tprivate static inline var PLAYER_LVL_TEXTFIELD:String = \"txt_PlayerLevel\";\n\tprivate static inline var TEXTFIELD_SC:String = \"txt_hardCurrencyDisplay\";\n\tprivate static inline var TEXTFIELD_HC:String = \"txt_softCurrencieDisplay\";\n\tprivate static inline var TEXTFIELD_MAT:String = \"txt_matiereDisplay\";\n\n\tprivate static inline var XP_Container:String = \"HUD_spriteCurrentXP\";\n\tprivate static inline var XP_BAR:String = \"HUD_spriteCurrentXP_fill\";\n\t\n\tprivate static inline var ENERGY_BAR:String = \"HUD_clipEnergyBar\";\n\tprivate static inline var TEXTFIELD_ENERGY:String = \"txt_energyDisplay\";\n\n\tprivate var redFilter:ColorMatrixFilter = new ColorMatrixFilter();\n\tprivate var whiteFilter:ColorMatrixFilter = new ColorMatrixFilter();\n\tprivate var filterFlag:String;\n\tpublic var componentToApplyFilterTo:SmartComponent;\n\tprivate var colorAmount:Float = 0;\n\n\tprivate var shopButton:SmartButton;\n\tprivate var buildButton:SmartButton;\n\tprivate var optionsButton:SmartButton;\n\tprivate var codexButton:SmartButton;\n\tpublic var hcAddButton:SmartButton;\n\tpublic var scAddButton:SmartButton;\n\t\n\tpublic var scBar:SmartComponent;\n\tpublic var hcBar:SmartComponent;\n\tpublic var materialBar:SmartComponent;\n\tpublic var energyBar:SmartComponent;\n\t\n\tprivate var frame:UInt = 0;\n\t/**\n\t * instance unique de la classe Hud\n\t */\n\tprivate static var instance: Hud;\n\n\tprivate var hudTopLeft:Sprite;\n\tprivate var hudBottomLeft:Container;\n\n\t/**\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\n\t * @return instance unique\n\t */\n\tpublic static function getInstance (): Hud\n\t{\n\t\tif (instance == null) instance = new Hud();\n\t\treturn instance;\n\t}\n\n\tpublic function new(pID:String = null)\n\t{\n\t\tsuper(pID);\n\t\tmodal = false;\n\t//\tupdate();\n\n\t\tshopButton = cast(getChildByName(SHOP_BTN),SmartButton);\n\t\tbuildButton = cast(getChildByName(BUILD_BTN),SmartButton);\n\t\toptionsButton = cast(getChildByName(OPTIONS_BTN),SmartButton);\n\t\tcodexButton = cast(getChildByName(CODEX_BTN),SmartButton);\n\t\thcAddButton = cast(getChildByName(HC_ADD_BTN),SmartButton);\n\t\tscAddButton = cast(getChildByName(SC_ADD_BTN), SmartButton);\n\t\tscBar = cast(getChildByName(SC_BAR), SmartComponent);\n\t\thcBar = cast(getChildByName(HC_BAR), SmartComponent);\n\t\tmaterialBar = cast(getChildByName(MATERIAL_BAR), SmartComponent);\n\t\tenergyBar = cast(getChildByName(ENERGY_BAR), SmartComponent);\n\t\t\n\t\t//playerInfoContainer = cast(getChildByName(PLAYER_INFO_CONTAINER), SmartComponent);\n\t\t//xpBar = cast(xpContainer.getChildByName(XP_BAR), FlumpMovieAnimFactory);\n\n\t\tshopButton.on(MouseEventType.CLICK, shopAction);\n\t\tbuildButton.on(MouseEventType.CLICK, buildAction);\n\t\toptionsButton.on(MouseEventType.CLICK, optionsAction);\n\t\tcodexButton.on(MouseEventType.CLICK, codexAction);\n\t\thcAddButton.on(MouseEventType.CLICK, hcAddAction);\n\t\tscAddButton.on(MouseEventType.CLICK, scAddAction);\n\n\t\tshopButton.on(TouchEventType.TAP, shopAction);\n\t\tbuildButton.on(TouchEventType.TAP, buildAction);\n\t\toptionsButton.on(TouchEventType.TAP, optionsAction);\n\t\tcodexButton.on(TouchEventType.TAP, codexAction);\n\t\thcAddButton.on(TouchEventType.TAP, hcAddAction);\n\t\tscAddButton.on(TouchEventType.TAP, scAddAction);\n\n\t\t\n\t}\n\n\tpublic function update():Void\n\t{\n\n\t\tvar lComponent:SmartComponent;\n\t\tvar lTextField:TextSprite;\n\t\tvar lAnim:UIMovie;\n\n\t\t\n\t\tlTextField = cast(scBar.getChildByName(TEXTFIELD_SC), TextSprite);\n\t\tlTextField.text = Std.string(Player.getInstance().softCurrency);\n\n\t\t\n\t\tlTextField = cast(hcBar.getChildByName(TEXTFIELD_HC), TextSprite);\n\t\tlTextField.text = Std.string(Player.getInstance().hardCurrency);\n\n\t\t\n\t\tlTextField = cast(materialBar.getChildByName(TEXTFIELD_MAT), TextSprite);\n\t\tlTextField.text = Std.string(Player.getInstance().ressource);\n\t\t\n\t\tlTextField = cast(energyBar.getChildByName(TEXTFIELD_ENERGY), TextSprite);\n\t\tlTextField.text = Std.string(Player.getInstance().currentEnergy) + \" / \" + Std.string(Player.getInstance().maxEnergy);\n\t\t\n\n\t\t\n\n\t\tlComponent = cast(getChildByName(PLAYER_INFO_CONTAINER), SmartComponent);\n\t\tlTextField = cast(lComponent.getChildByName(PLAYER_LVL_TEXTFIELD), TextSprite);\n\t\tlTextField.text = Std.string(Player.getInstance().level );\n\t\t\n\t\tlAnim = cast(lComponent.getChildByName(XP_Container), UIMovie);\n\t\t//var lxpAnim:Movie =  cast(lAnim.anim, Movie);\n\t\t// cast(lAnim, Movie);\n\t\t//lxpAnim.stop();\n\t\t\n\t\t//lxpAnim.gotoAndStop(frame);\n\t\t//\n\t\tvar lFrame:UInt = Math.round((30 * Player.getInstance().calculateLevelAdvance()) / 100);\n\t\tlAnim.setBehavior(false, false, lFrame);\n\t\t//lxpAnim.play();\n\t\t//if (lxpAnim.currentFrame == lFrame) lxpAnim.stop();\n\t\t//\n\t\t//frame = lFrame;\n\t\tFTUEManager.register(energyBar);\n\t}\n\t\n\t\n\t\n\n\tpublic function doAction():Void\n\t{\n\n\n\t\t\t\n\t}\n\n\tpublic function maskButtons():Void {\n\t\n\t\tbuildButton.visible = false;\n\t\tshopButton.visible = false;\n\t\tscAddButton.interactive = false;\n\t\thcAddButton.interactive = false;\n\t\tcodexButton.visible = false;\n\t}\n\t\n\tpublic function unmaskButtons():Void {\n\t\n\t\tbuildButton.visible = true;\n\t\tshopButton.visible = true;\n\t\tscAddButton.interactive = true;\n\t\thcAddButton.interactive = true;\n\t\tcodexButton.visible = true;\n\t}\n\n\tprivate function buildAction()\n\t{\n\t\tSoundManager.getSound(\"soundPlayerInputBuildButton\").play();\n\t\tif (BuildingMenu.getInstance().isOpened)\n\t\t{\n\t\t\tUIManager.getInstance().closeCurrentPopin();\n\t\t}\n\t\telse {\n\t\t\tSpawner.getInstance().cancel();\n\t\t\tUIManager.getInstance().closeAllPopins();\n\t\t\tUIManager.getInstance().openPopin(BuildingMenu.getInstance());\n\t\t}\n\t}\n\n\tprivate function shopAction()\n\t{\n\t\tSoundManager.getSound(\"soundPlayerInputShopButton\").play();\n\t\tif (Shop.getInstance().isOpened)\n\t\t{\n\t\t\tUIManager.getInstance().closeCurrentPopin();\n\t\t}\n\n\t\telse\n\t\t{\n\t\t\tSpawner.getInstance().cancel();\n\t\t\tUIManager.getInstance().closeAllPopins();\n\t\t\tUIManager.getInstance().openPopin(Shop.getInstance());\n\n\t\t}\n\t}\n\n\tprivate function optionsAction()\n\t{\n\t\t\n\t\tSpawner.getInstance().cancel();\n\t\tUIManager.getInstance().closeAllPopins();\n\t\tUIManager.getInstance().closeHud();\n\t\tUIManager.getInstance().openScreen(Settings.getInstance());\n\t}\n\n\tprivate function codexAction()\n\t{\n\t\tSoundManager.getSound(\"soundPlayerInputCodexButton\").play();\n\t\tSpawner.getInstance().cancel();\n\t\tUIManager.getInstance().closeAllPopins();\n\t\tUIManager.getInstance().openPopin(Codex.getInstance());\n\t\t\n\t}\n\n\tprivate function hcAddAction()\n\t{\n\t\tSoundManager.getSound(\"soundPlayerInputShopButton\").play();\n\t\tSpawner.getInstance().cancel();\n\t\tUIManager.getInstance().closeAllPopins();\n\t\tUIManager.getInstance().openPopin(Shop.getInstance());\n\t\tShop.getInstance().currentIndex = 4;\n\t\tShop.getInstance().updateItems();\n\t\t\n\t}\n\n\tprivate function scAddAction()\n\t{\n\t\tSoundManager.getSound(\"soundPlayerInputShopButton\").play();\n\t\tSpawner.getInstance().cancel();\n\t\tUIManager.getInstance().closeAllPopins();\n\t\tUIManager.getInstance().openPopin(Shop.getInstance());\n\t\tShop.getInstance().currentIndex = 1;\n\t\tShop.getInstance().updateItems();\n\t}\n\t\n\tpublic function noHCAnimation() {\n\t\tHud.getInstance().noEnoughAnimation(hcAddButton);\n\t\tHud.getInstance().noEnoughAnimation(hcBar);\n\t}\n\t\n\tpublic function noSCAnimation() {\n\t\tHud.getInstance().noEnoughAnimation(scAddButton);\n\t\tHud.getInstance().noEnoughAnimation(scBar);\n\t}\n\t\n\tpublic function noMaterialAnimation() {\n\t\tHud.getInstance().noEnoughAnimation(materialBar);\n\t}\n\t\n\tpublic function noEnergyAnimation() {\n\t\tHud.getInstance().noEnoughAnimation(energyBar);\n\t}\n\t\n\tprivate function noEnoughAnimation(pComponent:SmartComponent) {\n\t\tvar redParams:ColorFilterParams = \n\t\t{\n\t\t\tcolorAmount:1,\n\t\t\tcolorToApply: \"red\",\n\t\t\tduration :1\n\t\t}\n\n\t\tvar shakeParams : ShakerParams = \n\t\t{\n\t\t\toriginalPosition: pComponent.position.clone(),\n\t\t\tsmoothness:5,\n\t\t\tamplitude:10,\n\t\t\tduration:40,\n\t\t\txQuantity: 1.5,\n\t\t\tyQuantity: 0.5,\n\t\t\tfadeOut: 0.95,\n\t\t\trandomShake: true,\n\t\t\tsound:\"no\"\n\t\t}\n\t\t\n\t\tColorFilterManager.getInstance().applyFilter(pComponent, redParams);\n\t\tSmartShaker.getInstance().SetShaker(pComponent, shakeParams);\n\t}\n\n\t/**\n\t * dtruit l'instance unique et met sa rfrence interne  null\n\t */\n\toverride public function destroy (): Void\n\t{\n\t\tshopButton.off(MouseEventType.CLICK, shopAction);\n\t\tbuildButton.off(MouseEventType.CLICK, buildAction);\n\t\toptionsButton.off(MouseEventType.CLICK, optionsAction);\n\t\tcodexButton.off(MouseEventType.CLICK, codexAction);\n\t\thcAddButton.off(MouseEventType.CLICK, hcAddAction);\n\t\tscAddButton.off(MouseEventType.CLICK, scAddAction);\n\n\t\tshopButton.off(TouchEventType.TAP, shopAction);\n\t\tbuildButton.off(TouchEventType.TAP, buildAction);\n\t\toptionsButton.off(TouchEventType.TAP, optionsAction);\n\t\tcodexButton.off(TouchEventType.TAP, codexAction);\n\t\thcAddButton.off(TouchEventType.TAP, hcAddAction);\n\t\tscAddButton.off(TouchEventType.TAP, scAddAction);\n\n\t\tinstance = null;\n\t\tsuper.destroy();\n\t}\n\n}","package com.isartdigital.ruby.ui.popin;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass MenuClosable extends SmartPopinRegister\r\n{\r\n\r\n\tprivate var close_btn:SmartButton;\r\n\tprivate static inline var CLOSE_BTN:String = \"btn_Close\";\r\n\tpublic function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\r\n\t}\r\n\r\n\tprivate function init():Void\r\n\t{\r\n\t\t\r\n\t\tclose_btn = cast(getChildByName(CLOSE_BTN), SmartButton);\r\n\t\tclose_btn.on(MouseEventType.CLICK, onClose);\r\n\t\tclose_btn.on(TouchEventType.TAP, onClose);\r\n\t}\r\n\t\r\n\tprivate function onClose():Void {\r\n\t\tUIManager.getInstance().closePopin(this);\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Quart;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass Menu extends MenuClosable\r\n{\r\n\tpublic var TAB_CONTAINER(default, never):String = \"TabContainer\";\r\n\tpublic var ITEM_CONTAINER(default, never):String = \"ItemContainer\";\r\n\tpublic var BTN_TAB(default, never):String = \"tab\";\r\n\tpublic var ITEM(default, never):String = \"item\";\r\n\r\n\t\r\n\r\n\t\r\n\t/** \r\n\t * les onglet \r\n\t * **/\r\n\tprivate var tabButtons:Array<SwitchGroupItem>;\r\n\tprivate var tabContainer:SmartComponent;\r\n\tprivate var offsetTab:Point;\r\n\tprivate var offsetItem:Point;\r\n\tprivate var firstItemPosition:Point;\r\n\t/**\r\n\t * Index correspondant  l'onglet actif\r\n\t */\r\n\tpublic var currentIndex:Int = 0;\r\n\t\r\n\tpublic var itemContainer(default, null):SmartComponent;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t}\r\n\t\r\n\toverride public function open():Void \r\n\t{\r\n\t\tsuper.open();\r\n\t\t\r\n\t\tinit();\r\n\t\t\r\n\t\tscale.x = 0;\r\n\t\tscale.y = 0;\r\n\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\tscale,\r\n\t\t\t0.3, \r\n\t\t\t\t{ x : 1, \r\n\t\t\t\t  y: 1,\r\n\t\t\t\t  ease:Quart.easeIn \r\n\t\t\t\t  \r\n\t\t\t\t}\r\n\t\t);\r\n\t}\r\n\t\r\n\t\r\n\tpublic function update():Void {\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function initOffsetBetweenItems() {\r\n\t\t\r\n\t\tfirstItemPosition = itemContainer.getChildByName(ITEM + \" #0\").position;\r\n\t\tvar lNextItem:DisplayObject = itemContainer.getChildByName(ITEM + \" #1\");\r\n\t\tif (lNextItem != null) {\r\n\t\t\toffsetItem = new Point( lNextItem.x - firstItemPosition.x, lNextItem.y - firstItemPosition.y);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t/**\r\n\t * initialise les onglet\r\n\t */\r\n\tprivate function initTab(pTabClass:Class<Dynamic>) {\r\n\t\ttabButtons = new Array<SwitchGroupItem>();\r\n\t\ttabContainer = cast(getChildByName(TAB_CONTAINER), SmartComponent);\r\n\t\tFTUEManager.register(tabContainer);\r\n\t\r\n\t\toffsetTab = new Point(tabContainer.children[0].x - tabContainer.children[1].x, tabContainer.children[0].y - tabContainer.children[1].y);\r\n\t\t\r\n\t\tif (tabContainer == null || tabContainer.children.length == 0) { trace(\"tabContainer doesn't exist or doesn't have any children\"); return; }\r\n\t\t\r\n\t\tvar lTabLength:Int = tabContainer.children.length;\r\n\t\tvar lTabFirstItemPosition:Point =  tabContainer.getChildByName(ITEM+\" #0\").position;\r\n\t\t\r\n\t\tdestroyAllChildInContainer(tabContainer);\r\n\t\t\r\n\t\tfor (i in 0 ... lTabLength) {\r\n\t\t\ttabButtons.push(Type.createInstance( pTabClass, [] ));\r\n\t\t\ttabButtons[i].x = lTabFirstItemPosition.x + i * offsetTab.x;\r\n\t\t\ttabButtons[i].y = lTabFirstItemPosition.y + i * offsetTab.y;\r\n\t\t\ttabButtons[i].name = \"tabButton\" + i;\r\n\t\t\ttabContainer.addChild(tabButtons[i]);\r\n\t\t\ttabButtons[i].id = i;\r\n\r\n\t\t\ttabButtons[i].init();\r\n\t\t\tFTUEManager.register(tabButtons[i]);\r\n\t\t\t\r\n\t\t\tif (i == currentIndex) {\r\n\t\t\t\t\r\n\t\t\t\ttabButtons[i].setActive();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * stock les item du popin dans un tableau de reference\r\n\t */\r\n\tprivate function initItems() {\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * callBack appel lors du click sur un onglet\r\n\t * et initialise set proprit du popin en fonction\r\n\t * @param\tpTarget le bouton cliqu\r\n\t */\r\n\tprivate function onTabSelected(pId:Int):Void{\r\n\t\tSoundManager.getSound(\"click1\").play();\r\n\t\tcurrentIndex = pId;\r\n\t}\r\n\t\r\n\tprivate function onItemSelected(pTarget:EventTarget):Void {\r\n\t\tSoundManager.getSound(\"click1\").play();\r\n\t}\r\n\t\r\n\tprivate function getIdFromEvent(pTarget:EventTarget):Int{\r\n\t\tvar lName = pTarget.target.name;\r\n\t\tvar lIdButtonChar:String = lName.charAt(lName.length - 1);\r\n\t\treturn Std.parseInt(lIdButtonChar);\r\n\t}\r\n\t\r\n\tprivate function destroyAllChildInContainer(pContainer:SmartComponent) {\r\n\t\tif (pContainer == null) return;\r\n\t\tvar lChild:DisplayObject;\r\n\t\twhile (pContainer.children.length > 0) {\r\n\t\t\tlChild = pContainer.getChildAt(0);\r\n\t\t\tif (lChild == null) return;\r\n\t\t\tpContainer.removeChild(lChild);\r\n\t\t\tlChild.destroy();\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\r\n}","package com.isartdigital.ruby.ui.hud;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingCenter;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.popin.Destruction;\r\nimport com.isartdigital.ruby.ui.popin.Menu;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureScreen;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass InfosBatiment extends Menu \r\n{\r\n\t\r\n\t\r\n\tprivate static inline var UPGRADE_BTN:String = \"btn_Upgrade\";\r\n\tprivate static inline var DESTROY_BTN:String = \"btn_Destroy\";\r\n\tprivate static inline var MOVE_BTN:String = \"btn_Moove\";\r\n\tprivate static inline var DESCRIPTION_TEXTFIELD:String = \"txt_descriptionBuilding\";\r\n\tprivate static inline var BUILDINGNAME_TEXTFIELD:String = \"InfosBatiment_ItemName\";\r\n\t\r\n\tprivate var buildingInfoContainer:SmartComponent;\r\n\t\r\n\tprivate var upgradeBtn:SmartButton;\r\n\tprivate var destroyBtn:SmartButton;\r\n\tprivate var moveBtn:SmartButton;\r\n\tprivate var description:TextSprite;\r\n\tprivate var title:TextSprite;\r\n\t\r\n\tpublic var currentBuilding:Building;\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe InfosBatiment\r\n\t */\r\n\tprivate static var instance: InfosBatiment;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): InfosBatiment {\r\n\t\tif (instance == null) instance = new InfosBatiment();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\t\r\n\t}\r\n\t\r\n\t\r\n\toverride private function init():Void {\r\n\t\t\r\n\t\tsuper.init();\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tupgradeBtn = cast(getChildByName(UPGRADE_BTN), SmartButton);\r\n\t\tupgradeBtn.on(MouseEventType.CLICK, upgradeBuilding);\r\n\t\tupgradeBtn.on(TouchEventType.TAP, upgradeBuilding);\r\n\t\t\r\n\t\tdestroyBtn = cast(getChildByName(DESTROY_BTN), SmartButton);\r\n\t\tdestroyBtn.on(MouseEventType.CLICK, destroyBuilding);\r\n\t\tdestroyBtn.on(TouchEventType.TAP, destroyBuilding);\r\n\t\t\r\n\t\tmoveBtn = cast(getChildByName(MOVE_BTN), SmartButton);\r\n\t\tmoveBtn.on(MouseEventType.CLICK, moveBuilding);\r\n\t\tmoveBtn.on(TouchEventType.TAP, moveBuilding);\r\n\t\t\r\n\t\tdescription = cast(getChildByName(DESCRIPTION_TEXTFIELD), TextSprite);\r\n\t\ttitle = cast(getChildByName(BUILDINGNAME_TEXTFIELD), TextSprite);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\toverride function update():Void \r\n\t{\r\n\t\ttitle.text = Std.string(currentBuilding.buildingName);\r\n\t\tdescription.text = currentBuilding.description;\r\n\t}\r\n\t\r\n\t\r\n\tprivate function upgradeBuilding():Void {\r\n\t\t\r\n\t\t//currentBuilding.upgrade();\r\n\t\tif (currentBuilding.buildingName == \"Incubator\")\r\n\t\t{\r\n\t\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\t\tUIManager.getInstance().openPopin(Incubator.getInstance());\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function destroyBuilding():Void {\r\n\t\t\r\n\t\tUIManager.getInstance().openPopin(Destruction.getInstance());\r\n\t}\r\n\t\r\n\tpublic function isDestroyConfirmed():Void \r\n\t{\r\n\t\tvar SoftCurrency:Int = Std.int(Reflect.field(currentBuilding.buildingType, \"SellingCost\"));\r\n\t\tPlayer.getInstance().changePlayerValue(SoftCurrency, Player.TYPE_SOFTCURRENCY);\r\n\t\tcurrentBuilding.setModeDestroy();\r\n\t}\r\n\t\r\n\tprivate function moveBuilding():Void {\r\n\t\t\r\n\t\tcurrentBuilding.setModeMove();\r\n\t\tMapInteractor.getInstance().closeInfoPanel();\r\n\t}\r\n\t\r\n\toverride function onClose():Void \r\n\t{\r\n\t\tMapInteractor.getInstance().closeInfoPanel();\r\n\t\t\r\n\t\tif (Std.is(currentBuilding, DrillingCenter))\r\n\t\t{\t\r\n\t\t\tUIManager.getInstance().closeScreens();\r\n\t\t\tUIManager.getInstance().openHud();\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t\r\n\t\t\r\n\t\tclose_btn.off(MouseEventType.CLICK, onClose);\r\n\t\tclose_btn.off(TouchEventType.TAP, onClose);\r\n\t\tupgradeBtn.off(MouseEventType.CLICK, upgradeBuilding);\r\n\t\tupgradeBtn.off(TouchEventType.TAP, upgradeBuilding);\r\n\t\tdestroyBtn.off(MouseEventType.CLICK, destroyBuilding);\r\n\t\tdestroyBtn.off(TouchEventType.TAP, destroyBuilding);\r\n\t\tmoveBtn.off(MouseEventType.CLICK, moveBuilding);\r\n\t\tmoveBtn.off(TouchEventType.TAP, moveBuilding);\r\n\t\t\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.hud;\r\n\r\nimport com.isartdigital.utils.ui.smart.UIMovie;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass XpBar extends UIMovie\r\n{\r\n\r\n\tpublic function new(pAssetName:String) \r\n\t{\r\n\t\t\r\n\t\tsuper(pAssetName);\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.ui.UIComponent;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass SmartComponent extends UIComponent\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tbuild();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items;\r\n\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass Item extends SmartComponent\r\n{\r\n\r\n\tpublic var isListening = false;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\r\n\t}\r\n\t\r\n\tpublic function init() {\r\n\t\t\r\n\t\tonListen();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function onListen():Void {\r\n\t\r\n\t\tif (!isListening) {\r\n\t\t\tinteractive = true;\r\n\t\t\ton(MouseEventType.CLICK, monClick);\r\n\t\t\ton(MouseEventType.MOUSE_DOWN, onDown);\r\n\t\t\ton(MouseEventType.MOUSE_OVER, onOver);\r\n\t\t\ton(MouseEventType.MOUSE_OUT, onOut);\r\n\t\t\t\r\n\t\t\tisListening = true;\r\n\t\t}\t\r\n\t}\r\n\t\r\n\tfunction monClick():Void {\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t}\r\n\t\r\n\tfunction onOver():Void {\r\n\t}\r\n\t\r\n\tfunction onOut():Void {\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction onDown():Void {\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function onOff():Void {\r\n\t\tif (isListening) {\r\n\t\t\tinteractive = false;\r\n\t\t\toff(MouseEventType.CLICK, monClick);\r\n\t\t\toff(TouchEventType.TOUCH_END, monClick);\r\n\t\t\r\n\t\t\toff(MouseEventType.MOUSE_OVER, onOver);\r\n\t\t\toff(MouseEventType.MOUSE_OUT, onOut);\r\n\t\t\tisListening = false;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tonOff();\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass DrillingFriendItem extends Item\r\n{\r\n\tstatic inline var XENO_LEVEL:String = \"txt_CentreForageLevel\";\r\n\tstatic inline var PLAYER_NAME:String = \"txt_CentreForageplayerName\";\r\n\tstatic inline var BTN:String = \"btn_Friend\";\r\n\t\r\n\tprivate var btn:SmartButton;\r\n\tprivate var playerName:TextSprite;\r\n\tprivate var xenoLevel:TextSprite;\r\n\t\r\n\t\r\n\t\r\n\tpublic var alien:AlienElement;\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tbtn = cast(getChildByName(BTN), SmartButton);\r\n\t\tplayerName = cast(btn.getChildByName(PLAYER_NAME), TextSprite);\r\n\t\txenoLevel = cast(btn.getChildByName(XENO_LEVEL), TextSprite);\r\n\t}\r\n\t\r\n\tpublic function setAlienElem(pAlien:AlienElement):Void {\r\n\t\r\n\t\talien = pAlien;\r\n\t\tvar btn:SmartButton = cast(getChildByName(\"btn_Friend\"), SmartButton);\r\n\t\t\r\n\t\tcast(btn.getChildByName(\"asset\"), UISprite).visible = false;\r\n\t\tvar assetsItem:UISprite = new UISprite(\"XenosThumbnail_\"+ pAlien.name+\"_Normal\");\r\n\t\tassetsItem.position = cast(btn.getChildByName(\"asset\"), UISprite).position;\r\n\t\taddChild(assetsItem);\r\n\t\t\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tprivate function update():Void {\r\n\t\r\n\t\tfor (friend in DataManager.getInstance().friendsList) if (friend.id == alien.idPlayer) {\r\n\t\t\r\n\t\t\tplayerName.text = friend.nameFb;\r\n\t\t}\r\n\t\txenoLevel.text = Std.string(alien.level);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\n\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.ui.Button;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport js.Lib;\r\n\r\n/**\r\n * C\r\n * @author Jordan Dachicourt\r\n */\r\nclass SwitchItem extends Item\r\n{\r\n\tpublic static var list:Array<SwitchItem> = new Array<SwitchItem>();\r\n\tpublic var NORMAL(default, never):String = \"Normal\";\r\n\tpublic var DISABLED(default, never):String = \"Disabled\";\r\n\t\r\n\tprivate var listStates:Array<SmartComponent>;\r\n\tprivate var btnNormal:SmartButton;\r\n\tprivate var btnDisabled:SmartComponent;\r\n\tprivate var currentState:SmartComponent;\r\n\tpublic var id:Int;\r\n\tprivate var prefix:String;\r\n\tprivate var assetName:String;\r\n\tprivate var addStateSuffix:Bool = false;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t\tlist.push(this);\r\n\t\r\n\t}\r\n\t\r\n\toverride public function init() {\r\n\t\tsuper.init();\r\n\t\tlistStates = new Array<SmartComponent>();\r\n\t\tbtnNormal = cast(getChildByName(NORMAL), SmartButton);\r\n\t\tbtnDisabled = cast(getChildByName(DISABLED), SmartComponent);\r\n\t\t\r\n\t\t/*btnNormal.on(MouseEventType.MOUSE_OVER, onOver);\r\n\t\tbtnDisabled.on(MouseEventType.MOUSE_OVER, onOver);\r\n\t\t\r\n\t\tbtnNormal.on(MouseEventType.CLICK, monClick);\r\n\t\tbtnDisabled.on(MouseEventType.CLICK, monClick);*/\r\n\t\tlistStates.push(btnNormal);\r\n\t\tlistStates.push(btnDisabled);\r\n\t\tsetAsset();\r\n\t\tsetNormal();\r\n\t}\r\n\t\r\n\tpublic function setAsset() {\r\n\t\tif (prefix == null || currentState == null || assetName == null || currentState.children == null) return;\r\n\t\tvar lAsset:UISprite;\r\n\t\tvar lSpawnAsset:UISprite;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tlSpawnAsset = cast(currentState.getChildByName(\"asset\"), UISprite);\r\n\t\tlAsset = new UISprite(prefix + assetName + (addStateSuffix?(\"_\" + currentState.name):\"\"));\r\n\t\t\r\n\t\tlAsset.name = \"mainAsset\";\r\n\t\tlAsset.position = lSpawnAsset.position.clone();\r\n\t\t\r\n\t\tif (currentState.getChildByName(lAsset.name) != null)\r\n\t\t\tcurrentState.removeChild(currentState.getChildByName(lAsset.name));\r\n\t\t\t\r\n\t\tcurrentState.addChild(lAsset);\r\n\t\t\r\n\t\tinvisibleAsset();\r\n\t}\r\n\t\r\n\t\r\n\tprivate function reset() {\r\n\t\tfor (state in listStates) {\r\n\t\t\tstate.visible = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function invisibleAsset() {\r\n\t\tfor (state in listStates) {\r\n\t\t\tif(state.getChildByName(\"asset\") != null)\r\n\t\t\t\tstate.getChildByName(\"asset\").visible = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function setNormal() {\r\n\t\treset();\r\n\t\tcurrentState = btnNormal;\r\n\t\tcurrentState.visible = true;\r\n\t}\r\n\t\r\n\tpublic function setDisabled() {\r\n\t\treset();\r\n\t\tcurrentState = btnDisabled;\r\n\t\tcurrentState.visible = true;\r\n\t}\r\n\t\r\n\tpublic static function destroyAll() {\r\n\t\tfor (elem in list)\r\n\t\t\telem.destroy();\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tsuper.destroy();\r\n\t\tlist.remove(this);\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass SwitchGroupItem extends SwitchItem\r\n{\r\n\r\n\t\r\n\tpublic var SELECTED(default, never):String = \"Selected\";\r\n\t\r\n\tprivate var btnSelected:SmartButton;\r\n\tpublic var focusInFTUE = false;\r\n\tprivate var inAGroup = true;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\t\r\n\t\tsuper.init();\r\n\t\tonListen();\r\n\t\tbtnSelected = cast(getChildByName(SELECTED), SmartButton);\r\n\t\tlistStates.push(btnSelected);\r\n\t}\r\n\t\r\n\tpublic function setActive() {\r\n\t\tif (!focusInFTUE) {\r\n\t\t\tfor (brother in parent.children) {\r\n\t\t\t\tif (brother != this)\t\t\r\n\t\t\t\t\tcast(brother, SwitchItem).setNormal();\r\n\t\t\t}\r\n\t\t}\t\r\n\t\tsetSelected();\r\n\t}\r\n\t\r\n\tpublic function setSelected() {\r\n\t\treset();\r\n\t\tcurrentState = btnSelected;\r\n\t\tcurrentState.visible = true;\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tif (currentState == btnNormal && inAGroup)\r\n\t\t\tsetActive();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass DrillingXenoItem extends SwitchGroupItem\r\n{\r\n\t\r\n\tstatic inline var CONTENT_TIMER:String = \"txt_XenoCooldownDisplay\";\r\n\tstatic inline var CONTENT_STAMINA:String = \"txt_CentreForageStaminaDisplay\";\r\n\tstatic inline var CONTENT_NAME:String = \"txt_centreForageXenoName\";\r\n\tstatic inline var CONTENT_CLASS:String = \"txt_CentreForageXenoClass\";\r\n\tstatic inline var CONTENT_AVATAR:String = \"CentreForage_spriteStaminaAvatar\";\r\n\t\r\n\tvar nameTxt:TextSprite;\r\n\tvar classTxt:TextSprite;\r\n\tvar staminaTxt:TextSprite;\r\n\t//var timerTxt:TextSprite;\r\n\tvar alien:AlienElement;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t}\r\n\tfunction updateTextChild() {\r\n\t\tnameTxt = cast(currentState.getChildByName(CONTENT_NAME), TextSprite);\r\n\t\tclassTxt = cast(currentState.getChildByName(CONTENT_CLASS), TextSprite);\r\n\t\tstaminaTxt = cast(currentState.getChildByName(CONTENT_STAMINA), TextSprite);\r\n\t\t//timerTxt = cast(currentState.getChildByName(CONTENT_TIMER), TextSprite);\r\n\t}\r\n\t\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\r\n\t\r\n\toverride public function setDisabled() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tpublic function initAlien(pAlien:AlienElement):Void\r\n\t{\r\n\t\talien = pAlien;\r\n\t\tprefix = \"XenosThumbnail_\";\r\n\t\tassetName = pAlien.name+\"_Normal\";\r\n\t\tsetNormal();\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tpublic function update() {\r\n\t\tif (alien == null) return;\r\n\t\tnameTxt.text = alien.name;\r\n\t\tclassTxt.text = alien.carac.power;\r\n\t\tstaminaTxt.text = Std.string(alien.stamina);\t\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tCentreForage.getInstance().alienSelected = alien;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.core.sprites.Sprite;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ItemAsset extends SmartComponent\r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe ItemAsset\r\n\t */\r\n\tprivate static var instance: ItemAsset;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ItemAsset {\r\n\r\n\t\tif (instance == null) instance = new ItemAsset();\r\n\t\treturn instance;\r\n\t}\r\n\t\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\tpublic function getItemAsset(pName:String):UISprite {\t\r\n\t\tvar lAsset:UISprite = cast(getChildByName(\"Shop_spriteItemAsset_SC5\"), UISprite);\r\n\t\treturn lAsset;\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\n\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuData;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuParams;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingMenuSwitchItem extends SwitchGroupItem\r\n{\r\n\r\n\tprivate static inline var NAME = \"txt_Name\";\r\n\t\r\n\tprivate static inline var ASSET_PREFIX:String = \"BuildingMenu_spriteItemAsset_\";\r\n\t\r\n\tprivate var isClicked = false;\r\n\tpublic var nameField:TextSprite;\r\n\tprivate var buildingSize:Point = new Point(3, 2);\r\n\tprivate var levelToBecomeEnable:Int;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tinteractive = true;\r\n\t\tsuper(pID);\r\n\t\ton(MouseEventType.MOUSE_UP, function() { isClicked = false; } );\r\n\t\taddStateSuffix = true;\r\n\t}\r\n\t\r\n\r\n\tpublic function setInfo(pParams:BuildingMenuParams) {\r\n\t\tnameField = cast(getChildByName(NAME), TextSprite);\r\n\t\tnameField.text = LocalizationByType.getInstance().translateFromType(pParams.name);\r\n\t\tassetName = pParams.name;\r\n\t\tname = assetName;\r\n\t\tprefix = ASSET_PREFIX;\r\n\t\tlevelToBecomeEnable = GameManager.getInstance().godMode ? 0 : pParams.levelToBecomeEnable;\r\n\t\t\r\n\t\tPlayer.getInstance().level >= levelToBecomeEnable\r\n\t\t?\tsetNormal()\r\n\t\t:\tsetDisabled();\r\n\t\tsetAsset();\r\n\t\t\r\n\t}\r\n\t\r\n\r\n\tprivate function getSpawner():Void {\r\n\t\tif (Spawner.getInstance().toSpawn != null && Spawner.getInstance().toSpawn.name == assetName) {\t\r\n\t\t\t\tSpawner.getInstance().cancel();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tSpawner.getInstance().setElementToSpawn(assetName);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function displayInfo():Void {\r\n\t\tBuildingMenu.getInstance().panel.setInfo(getDataAboutThisBuilding());\r\n\t}\r\n\t\r\n\tprivate function getDataAboutThisBuilding():Dynamic {\r\n\t\treturn DataManager.getInstance().listBuildingTypes[name];\r\n\t}\r\n\t\r\n\tprivate function unDisplayInfo():Void {\r\n\t\tBuildingMenu.getInstance().panel.reset();\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\r\n\t\tif(!isClicked && currentState != btnDisabled)\r\n\t\t\tgetSpawner();\r\n\t\t\t\r\n\t\tisClicked = true;\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tdisplayInfo();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tunDisplayInfo();\r\n\t\tsetAsset();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.ui.popin.building.BuildingMenu;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingMenuSwitchTab extends SwitchGroupItem\r\n{\r\n\tstatic inline var PREFIX:String = \"BuildingMenu_TabAsset_\";\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tprefix = PREFIX;\r\n\t\tswitch(id) {\r\n\t\t\tcase 0:\r\n\t\t\t\tassetName = \"Urbain\";\r\n\t\t\tcase 1:\r\n\t\t\t\tassetName = \"Buffeur\";\r\n\t\t\tcase 2:\r\n\t\t\t\tassetName = \"Forage\";\r\n\t\t\tcase 3:\r\n\t\t\t\tassetName = \"Esthetique\";\r\n\t\t\tdefault:\r\n\t\t\t\tassetName = \"Urbain\";\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride function monClick() \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tBuildingMenu.getInstance().currentIndex = id;\r\n\t\tBuildingMenu.getInstance().updateItems();\r\n\t}\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.ui.popin.codex.XenoCodexTypedef;\r\nimport com.isartdigital.ruby.ui.popin.XenoPage;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport js.Lib;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass CodexSwitchItem extends SwitchItem\r\n{\r\n\r\n\tstatic inline var NAME:String = \"txt_XenoName\";\r\n\tstatic inline var QUANTITY:String = \"txt_QuantityUnitDisplay\";\r\n\tstatic inline var PREFIX:String = \"XenosThumbnail_\";\r\n\r\n\tprivate var textName:TextSprite;\r\n\tprivate var textQuantity:TextSprite;\r\n\r\n\tprivate var currentAlien:XenoCodexTypedef;\r\n\r\n\tprivate var quantity:Int;\r\n\r\n\tprivate var firsTime:Bool = false;\r\n\r\n\tpublic function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\r\n\t}\r\n\r\n\toverride public function init()\r\n\t{\r\n\t\tsuper.init();\r\n\t\ttextName = cast(getChildByName(NAME), TextSprite);\r\n\t\ttextQuantity = cast(getChildByName(QUANTITY), TextSprite);\r\n\t\tprefix = PREFIX;\r\n\t\taddStateSuffix = true;\r\n\t}\r\n\r\n\tpublic function setInfo(pAlien:XenoCodexTypedef)\r\n\t{\r\n\t\tif (!firsTime)\r\n\t\t{\r\n\r\n\t\t\tcurrentAlien = pAlien;\r\n\t\t\tassetName = currentAlien.name;\r\n\t\t\ttextName.text =  (currentAlien.nomenclature != \"\" ? currentAlien.nomenclature : currentAlien.name);\r\n\t\t\tquantity = currentAlien.quantity;\r\n\t\t\ttextQuantity.text =  quantity + \"\";\r\n\t\t\tif (quantity == 0)\r\n\t\t\t\tsetDisabled();\r\n\t\t\telse\r\n\t\t\t\tsetNormal();\r\n\r\n\t\t\tsetAsset();\r\n\t\t\tfirsTime = true;\r\n\t\t}\r\n\t}\r\n\r\n\toverride function onOver():Void\r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tsetAsset();\r\n\t}\r\n\r\n\toverride function onOut():Void\r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tsetAsset();\r\n\t}\r\n\r\n\toverride function monClick():Void\r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tif (currentState.name != \"Disabled\")\r\n\t\t{\r\n\r\n\t\t\tsetAsset();\r\n\t\t\tUIManager.getInstance().openPopin(XenoPage.getInstance());\r\n\r\n\t\t\tXenoPage.getInstance().setAlienInfoToDisplay(currentAlien);\r\n\t\t}\r\n\t\t//Alien.alienList.\r\n\t}\r\n\r\n\toverride function onDown():Void\r\n\t{\r\n\t\tsuper.onDown();\r\n\t\tsetAsset();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.ui.popin.codex.Codex;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass CodexSwitchTab extends SwitchGroupItem\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tprefix = \"Codex_TabAsset_\";\r\n\t\tswitch(id) {\r\n\t\t\tcase 0:\r\n\t\t\t\tassetName = \"All\";\r\n\t\t\tcase 1:\r\n\t\t\t\tassetName = \"Buffeur\";\r\n\t\t\tcase 2:\r\n\t\t\t\tassetName = \"Esthetique\";\r\n\t\t\tcase 3:\r\n\t\t\t\tassetName = \"Foreur\";\t\r\n\t\t\tdefault:\r\n\t\t\t\tassetName = \"All\";\r\n\t\t}\r\n\t}\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\t\r\n\t\tswitch(id) {\r\n\t\t\tcase 0:\r\n\t\t\t\tCodex.getInstance().updateItems();\r\n\t\t\tcase 1:\r\n\t\t\t\tCodex.getInstance().updateItemsByTypes(\"AlienBuffer\", \"AlienProducer\");\r\n\t\t\tcase 2:\r\n\t\t\t\tCodex.getInstance().updateItemsByTypes(\"AlienEsthetique\");\r\n\t\t\tcase 3:\r\n\t\t\t\tCodex.getInstance().updateItemsByTypes(\"AlienForeur\");\r\n\t\t\tdefault:\r\n\t\t\t\tCodex.getInstance().updateItems();\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureScreen;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.ruby.ui.popin.contextual.BuildingContextualMenu;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass DrillingButtonSwitchItem extends SwitchItem\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\toverride private function monClick():Void\r\n\t{\r\n\t\t//CentreForage.getInstance().startDrillingFeature();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.Missions;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass MissionSwitchItem extends SwitchGroupItem\r\n{\r\n\t\r\n\tprivate static var NAME = \"txt_CentreForagemissionName\";\r\n\tprivate static var COULDOWN_DISPLAY = \"txt_CentreForagedrillCooldownDisplayV2\";\r\n\t\r\n\tprivate var nameText:TextSprite;\r\n\t//private var couldownDisplayText:TextSprite;\r\n\t\r\n\tprivate var missionParams:Missions;\r\n\tprivate var rewardParams:Reward;\r\n\t\r\n\t\r\n\t\r\n\r\n\tpublic function new(pID:String=null) {\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tpublic function setInfo(pParams:Missions):Void {\r\n\t\r\n\t\tmissionParams = pParams;\r\n\t\t//couldownDisplayText.visible = false;\r\n\t\tsetNormal();\r\n\t}\r\n\t\r\n\tprivate function updateInfo() {\r\n\t\tif (missionParams == null) return;\r\n\t\tnameText.text = missionParams.name;\r\n\t\t\r\n\t}\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride public function setDisabled() \r\n\t{\r\n\t\tsuper.setDisabled();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tCentreForage.getInstance().onClickMission(missionParams);\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\tfunction updateTextChild() {\r\n\t\tnameText = cast(currentState.getChildByName(NAME), TextSprite);\r\n\t\t//couldownDisplayText = cast(currentState.getChildByName(COULDOWN_DISPLAY), TextSprite);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\n\r\nimport com.isartdigital.ruby.ui.popin.shop.Shop;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ShopSwitchTab extends SwitchGroupItem\r\n{\r\n\t\r\n\tprivate static inline var ASSET_TAB_PREFIX:String = \"Shop_TabAsset_\";\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function init() {\r\n\t\tsuper.init();\r\n\t\tif (id == null) id = 0;\r\n\t\tprefix = ASSET_TAB_PREFIX;\r\n\t\t\r\n\t\tassetName =  StringTools.replace(Shop.getInstance().shopAssetTitles[id], \" \", \"_\");\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function monClick() {\r\n\t\tsuper.monClick();\r\n\t\tShop.getInstance().currentIndex = id;\r\n\t\tShop.getInstance().updateItems();\r\n\t}\r\n\t\r\n\toverride public function setNormal() {\r\n\t\tsuper.setNormal();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onOver():Void {\r\n\t\tsuper.onOver();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onOut():Void {\r\n\t\tsuper.onOut();\r\n\t\tsetAsset();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass SpecialFeatureSwitchSkill extends SwitchGroupItem\r\n{\r\n\r\n\tpublic var alien:SpecialFeatureAliens;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinAGroup = false;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function initAlien(pAlien:SpecialFeatureAliens) {\r\n\t\t/*prefix = \"XenosThumbnail_\";\r\n\t\talien = pAlien;\r\n\t\tassetName = alien.alienName;\r\n\t\taddStateSuffix = true;*/\r\n\t}\r\n\t\r\n\toverride public function setAsset() \r\n\t{\r\n\t\tif (alien == null) return;\r\n\t\t\tsuper.setAsset();\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tsetSelected();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass UpgradeCenterSwitchItem extends SwitchItem\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass XenoSlotSwitchItem extends SwitchGroupItem\r\n{\r\n\r\n\tpublic var alien:AlienElement;\r\n\tstatic inline var PREFIX:String = \"XenosThumbnail_\";\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tprefix = PREFIX;\r\n\t}\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tplaceXeno(CentreForage.getInstance().alienSelected);\t\r\n\t}\r\n\t\r\n\tprivate function placeXeno(pAlien:AlienElement) {\r\n\t\t\r\n\t\tif (pAlien != alien)\r\n\t\t\r\n\t\t\talien = pAlien;\r\n\t\t\tif (alien != null) {\r\n\t\t\tassetName = alien.name+\"_Normal\";\r\n\t\t\tCentreForage.getInstance().alienSelected = null;\r\n\t\t\tCentreForage.getInstance().checkIfMissionCanBeStarted();\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride public function setAsset() \r\n\t{\r\n\t\tif (alien == null) return;\r\n\t\ttrace(\"yolo\");\r\n\t\tsuper.setAsset();\r\n\t}\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass XenoSocialSwitchItem extends SwitchItem\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinteractive = true;\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tCentreForage.getInstance().switchXenosSocial();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.popin.XenosPanel;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass XenosPanelSwitchItem extends SwitchGroupItem\r\n{\r\n\r\n\tprivate var alien:AlienElement;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\taddStateSuffix = true;\r\n\t}\r\n\tpublic function setInfo(pAlienElem:AlienElement) \r\n\t{\r\n\t\talien = pAlienElem;\r\n\t\tinteractive = true;\r\n\t\tprefix = \"XenosThumbnail_\";\r\n\t\tassetName = alien.name;\r\n\t\tsetAsset();\r\n\t\tname = assetName;\r\n\t\tFTUEManager.register(this);\r\n\t\t//image\r\n\t\t//setNormal();\r\n\t\t\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\t//XenosPanel.getInstance().alienSelected = alien;\r\n\t\t//MapInteractor.getInstance().alienSelected = alien;\r\n\t\t//XenosPanel.getInstance().appearContextualMenuItemAt(x  - width);\t\r\n\t\t\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onDown():Void \r\n\t{\r\n\t\tsuper.onDown();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\tsuper.setSelected();\r\n\t\tsetAsset();\r\n\t\t//XenosPanel.getInstance().appearContextualMenuItemAt(position.x);\r\n\t\tXenosPanel.getInstance().alienSelected = alien;\r\n\t\tXenosPanel.getInstance().onMove();\r\n\t}\r\n\t\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tsetAsset();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.items.switchItems;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass XenosPanelSwitchTab extends SwitchGroupItem\r\n{\r\n\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tvisible = false;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.Popin;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.interaction.EventTarget;\r\nimport com.greensock.TweenLite;\r\n\t\r\n/**\r\n * Exemple de classe hritant de Popin\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Confirm extends Popin \r\n{\r\n\t\r\n\tprivate var background:Sprite;\r\n\t\r\n\tprivate var openTween:TweenLite;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Confirm\r\n\t */\r\n\tprivate static var instance: Confirm;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Confirm {\r\n\t\tif (instance == null) instance = new Confirm();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tbackground = new Sprite(Texture.fromImage(Config.url(Config.assetsPath+\"Confirm.png\")));\r\n\t\tbackground.anchor.set(0.5, 0.5);\r\n\t\taddChild(background);\r\n\t\topenTween = TweenLite.from(this, 0.5, { y : 200, alpha: 0, onComplete:openingComplete} );\r\n\t}\r\n\t\r\n\tprivate function openingComplete ():Void {\r\n\t\tinteractive = true;\r\n\t\tbuttonMode = true;\r\n\t\t\r\n\t\tonce(MouseEventType.CLICK,onClick);\r\n\t\tonce(TouchEventType.TAP,onClick);\r\n\t}\r\n\t\r\n\tprivate function onClick (pEvent:EventTarget): Void {\r\n\t\tSoundManager.getSound(\"click\").play();\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\tGameManager.getInstance().start();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.contextual;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.Background;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport js.Lib;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ContextualPopin extends SmartPopinRegister\r\n{\r\n\t\r\n\r\n\t@:isVar public var target(get, set):GameElement;\r\n\t\r\n\tfunction get_target() {\r\n\t\treturn target;\r\n\t}\r\n\r\n\tfunction set_target(pTarget) {\r\n\t\ttarget = pTarget;\r\n\t\tinitPositionCenterTarget();\r\n\t\treturn target;\r\n\t}\r\n\tprivate var positionCenterTarget:Point;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\r\n\toverride public function open():Void \r\n\t{\r\n\t\tsuper.open();\r\n\t\tGameStage.getInstance().getInfoBulleContainer().addChild(this);\r\n\t\t\r\n\t}\r\n\t\r\n\r\n\tprivate function initPositionCenterTarget(){\r\n\t\tvar lModelPos:Point = new Point(0,0);\r\n\t\tif (!Std.is(target, Background)) {\r\n\t\t\tlModelPos = IsoManager.isoViewToModel(new Point(target.globalPosition.x, target.globalPosition.y));\r\n\t\t\tlModelPos.x = lModelPos.x + (Controller.getInstance().getPosRegion().x);\r\n\t\t\tlModelPos.y = lModelPos.y + (Controller.getInstance().getPosRegion().y);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t\r\n\t\t\tlModelPos.x += (target.currentRegionCoor.x * Region.WIDTH);\r\n\t\t\tlModelPos.y += (target.currentRegionCoor.y * Region.HEIGHT);\r\n\t\t}\r\n\t\tlModelPos.x += Math.round(target.localWidth / 2);\r\n\t\tlModelPos.y += Math.round(target.localHeight / 2);\r\n\t\tpositionCenterTarget = IsoManager.modelToIsoView(lModelPos);\r\n\t\tposition = positionCenterTarget;\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tremoveAllListeners();\r\n\t\tif(parent != null) parent.removeChild(this);\r\n\t\tsuper.close();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.contextual.ContextualPopin;\r\nimport com.isartdigital.ruby.ui.specialButtons.Textbutton;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport js.Lib;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass ConfirmationPose extends ContextualPopin \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe ConfirmationPose\r\n\t */\r\n\tprivate static var instance: ConfirmationPose;\r\n\t\r\n\tprivate static inline var CANCEL_BTN:String = \"btn_ConfirmReturn\";\r\n\t\r\n\t\r\n\t//private static inline var SCMN_CNTNER:String = \"ConfirmationPose_clipSwitchButtonSC\";\r\n\tprivate static inline var SCMN_BTN_NORMAL:String = \"ConfirmationPose_ButtonSC\";\r\n\t//private static inline var SCMN_BTN_SELECTED:String = \"btn_AchatSCSelected\";\r\n\tprivate static inline var SCMN_YES_BTN:String = \"btn_YesBuySC\";\r\n\tprivate static inline var SCMN_NO_BTN:String = \"btn_NoBuySC\";\r\n\t\r\n\t//private static inline var HC_CNTNER:String = \"ConfirmationPose_clipSwitchButtonHC\";\r\n\tprivate static inline var HC_BTN_NORMAL:String = \"ConfirmationPose_ButtonHC\";\r\n\t//private static inline var HC_BTN_SELECTED:String = \"btn_AchatHCSelected\";\r\n\tprivate static inline var HC_YES_BTN:String = \"btn_YesBuyHC\";\r\n\tprivate static inline var HC_NO_BTN:String = \"btn_NoBuyHC\";\r\n\t\r\n\t\r\n\tprivate static inline var HC_TEXT_CNTNER:String = \"ConfirmationPose_clipPriceHCInfos\";\r\n\tprivate static inline var SCMN_TEXT_CNTNER:String = \"ConfirmationPose_clipPriceSCInfos\";\r\n\tprivate static inline var SC_TEXT:String = \"txt_SCPrice\";\r\n\tprivate static inline var HC_TEXT:String = \"txt_HCPrice\";\r\n\tprivate static inline var MN_TEXT:String = \"txt_MNPrice\";\r\n\t\r\n\t\r\n\tprivate var cancelButton:SmartButton;\r\n\t\r\n\tprivate var currentBuilding:GameElement;\r\n\t\r\n\tprivate var scmnButtonNormal:Textbutton;\r\n\tprivate var scmnYesButton:SmartButton;\r\n\tprivate var scmnNoButton:SmartButton;\r\n\t\r\n\tprivate var hcButtonNormal:Textbutton;\r\n\tprivate var hcYesButton:SmartButton;\r\n\tprivate var hcNoButton:SmartButton;\r\n\t\r\n\t\r\n\t//private var scmnInfoContainerNormal:SmartComponent;\r\n\t//private var hcInfoContainerNormal:SmartComponent;\r\n\t//private var scmnInfoInvisible:SmartComponent;\r\n\t//private var hcInfoInvisible:SmartComponent;\r\n\t\r\n\t//private var scTextNormal:TextSprite;\r\n\t//private var hcTextNormal:TextSprite;\r\n\t//private var mnTextNormal:TextSprite;\r\n\t\r\n\tpublic var noSC:Bool = false;\r\n\tpublic var noMN:Bool = false;\r\n\tpublic var noHC:Bool = false;\r\n\t\r\n\tpublic var scValue:String;\r\n\tpublic var mnValue:String;\r\n\tpublic var hcValue:String;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ConfirmationPose {\r\n\t\tif (instance == null) instance = new ConfirmationPose();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tpublic function init(pBuiding:GameElement):Void\r\n\t{\t\r\n\t\tcurrentBuilding = pBuiding;\r\n\t\tcancelButton = cast(getChildByName(CANCEL_BTN),SmartButton);\r\n\t\tscmnButtonNormal = cast(getChildByName(SCMN_BTN_NORMAL),Textbutton);\r\n\t\t\r\n\t\t//hcContainer = cast(getChildByName(HC_CNTNER),SmartComponent);\r\n\t\thcButtonNormal = cast(getChildByName(HC_BTN_NORMAL),Textbutton);\r\n\t\t//hcButtonSelected = cast(hcContainer.getChildByName(HC_BTN_SELECTED), SmartButton);\r\n\t\t\r\n\t\tscmnYesButton = cast(getChildByName(SCMN_YES_BTN),SmartButton);\r\n\t\tscmnNoButton = cast(getChildByName(SCMN_NO_BTN),SmartButton);\r\n\t\thcYesButton = cast(getChildByName(HC_YES_BTN),SmartButton);\r\n\t\thcNoButton = cast(getChildByName(HC_NO_BTN), SmartButton);\r\n\t\t\r\n\t\t\r\n\t\t//scmnInfoContainerNormal = cast(scmnButtonNormal.getChildByName(SCMN_TEXT_CNTNER), SmartComponent);\r\n\t\t//hcInfoInvisible = cast(scmnButtonNormal.getChildByName(HC_TEXT_CNTNER), SmartComponent);\r\n\t\t//hcInfoInvisible.visible = false;\r\n\t\t//hcInfoContainerNormal = cast(hcButtonNormal.getChildByName(HC_TEXT_CNTNER), SmartComponent);\r\n\t\t//scmnInfoInvisible = cast(hcButtonNormal.getChildByName(SCMN_TEXT_CNTNER), SmartComponent);\r\n\t\t//scmnInfoInvisible.visible = false;\r\n\t\t\r\n\t\t//scTextNormal = cast(scmnInfoContainerNormal.getChildByName(SC_TEXT), TextSprite);\r\n\t\t//mnTextNormal = cast(scmnInfoContainerNormal.getChildByName(MN_TEXT), TextSprite);\r\n\t\t//hcTextNormal = cast(hcInfoContainerNormal.getChildByName(HC_TEXT), TextSprite);\r\n\t\t\r\n\t\tscmnButtonNormal.SCMNMode();\r\n\t\thcButtonNormal.HCMode();\r\n\t\t\r\n\t\tcancelButton.on(MouseEventType.CLICK, onCancel);\r\n\t\tscmnYesButton.on(MouseEventType.CLICK, payWithSCMN);\r\n\t\tscmnNoButton.on(MouseEventType.CLICK, hideScmnConfirmButtons);\r\n\t\thcYesButton.on(MouseEventType.CLICK, payWithHC);\r\n\t\thcNoButton.on(MouseEventType.CLICK, hideHcConfirmButtons);\r\n\t\tscmnButtonNormal.on(MouseEventType.CLICK, displayScmnConfirmButtons);\r\n\t\thcButtonNormal.on(MouseEventType.CLICK, displayHcConfirmButtons);\r\n\t\t\r\n\t\t//scmnButtonNormal.on(MouseEventType.MOUSE_OVER, DisplayCost);\r\n\t\t//hcButtonNormal.on(MouseEventType.MOUSE_OVER, DisplayCost);\r\n\t\t\r\n\t\tcancelButton.on(TouchEventType.TAP, onCancel);\r\n\t\tscmnYesButton.on(TouchEventType.TAP, payWithSCMN);\r\n\t\tscmnNoButton.on(TouchEventType.TAP, hideScmnConfirmButtons);\r\n\t\thcYesButton.on(TouchEventType.TAP, payWithHC);\r\n\t\thcNoButton.on(TouchEventType.TAP, hideHcConfirmButtons);\r\n\t\tscmnButtonNormal.on(TouchEventType.TAP, displayScmnConfirmButtons);\r\n\t\thcButtonNormal.on(TouchEventType.TAP, displayHcConfirmButtons);\r\n\t\t\r\n\t\t\r\n\r\n\t\tscmnYesButton.visible = false;\r\n\t\tscmnNoButton.visible = false;\r\n\t\thcYesButton.visible = false;\r\n\t\thcNoButton.visible = false;\t\r\n\t\t\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t\t\r\n\t}\r\n\toverride public function close():Void \r\n\t{\r\n\t\thideHcConfirmButtons();\r\n\t\thideScmnConfirmButtons();\r\n\t\tsuper.close();\r\n\t}\r\n\t\r\n\tpublic function updateValues(pSC:Int, pMN:Int, pHC:Int) {\r\n\t\r\n\t\tscValue = Std.string(pSC);\r\n\t\tmnValue = Std.string(pMN);\r\n\t\thcValue = Std.string(pHC);\r\n\t\tDisplayCost();\r\n\t}\r\n\tpublic function DisplayCost():Void {\r\n\t\r\n\t\tif (scValue != null && mnValue != null && hcValue != null) {\r\n\t\t\ttrace(scValue, mnValue);\r\n\t\t\tif (Std.parseInt(scValue) > 0 && Std.parseInt(mnValue) > 0 ) scmnButtonNormal.displayTextSCMN();\r\n\t\t\telse scmnButtonNormal.visible = false;\r\n\t\t\thcButtonNormal.displayTextHC();\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function displayScmnConfirmButtons():Void {\r\n\t\r\n\t\tscmnYesButton.visible = true;\r\n\t\tscmnNoButton.visible = true;\r\n\t\thideHcConfirmButtons();\r\n\t\tcancelButton.visible = false;\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tscmnButtonNormal.on(MouseEventType.CLICK, hideScmnConfirmButtons);\r\n\t\tDisplayCost();\r\n\t}\r\n\t\r\n\t\r\n\tprivate function displayHcConfirmButtons():Void {\r\n\t\r\n\t\thcYesButton.visible = true;\r\n\t\thcNoButton.visible = true;\r\n\t\thideScmnConfirmButtons();\r\n\t\tcancelButton.visible = false;\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\thcButtonNormal.on(MouseEventType.CLICK, hideHcConfirmButtons);\r\n\t\t\r\n\t\tDisplayCost();\r\n\t}\r\n\t\r\n\tprivate function hideScmnConfirmButtons():Void {\r\n\t\r\n\t\tscmnYesButton.visible = false;\r\n\t\tscmnNoButton.visible = false;\r\n\t\tcancelButton.visible = true;\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tscmnButtonNormal.on(MouseEventType.CLICK, displayScmnConfirmButtons);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\tprivate function hideHcConfirmButtons():Void {\r\n\t\r\n\t\thcYesButton.visible = false;\r\n\t\thcNoButton.visible = false;\r\n\t\tcancelButton.visible = true;\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\thcButtonNormal.on(MouseEventType.CLICK, displayHcConfirmButtons);\r\n\t}\r\n\t\r\n\t\r\n\r\n\tprivate function onCancel()\r\n\t{\r\n\t\tresetValues();\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tSpawner.getInstance().cancel();\r\n\t}\r\n\t\r\n\tprivate function payWithSCMN():Void {\r\n\t\t\r\n\t\tif (noSC || noMN) {\r\n\t\t\r\n\t\t\tif (noSC) Hud.getInstance().noSCAnimation();\r\n\t\t\tif (noMN) Hud.getInstance().noMaterialAnimation();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tSmartPopinRegister.event.emit(\"onYes\");\r\n\t\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\r\n\t\t\tSpawner.getInstance().onClick();\r\n\t\t\tresetValues();\r\n\t\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function payWithHC():Void {\r\n\t\t\r\n\t\tif (noHC) Hud.getInstance().noHCAnimation();\r\n\t\telse {\r\n\t\t\tSmartPopinRegister.event.emit(\"onYes\");\r\n\t\t\tSoundManager.getSound(\"soundPlayerValidate\").play();\r\n\t\t\tSpawner.getInstance().isPayingWithHC = true;\r\n\t\t\tSpawner.getInstance().onClick();\r\n\t\t\tresetValues();\r\n\t\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tprivate function resetValues():Void {\r\n\t\r\n\t\tnoHC = false;\r\n\t\tnoMN = false;\r\n\t\tnoSC = false;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\t//\r\n\t\tcancelButton.off(MouseEventType.CLICK, onCancel);\r\n\t\tscmnYesButton.off(MouseEventType.CLICK, payWithSCMN);\r\n\t\tscmnNoButton.off(MouseEventType.CLICK, hideScmnConfirmButtons);\r\n\t\thcYesButton.off(MouseEventType.CLICK, payWithHC);\r\n\t\thcNoButton.off(MouseEventType.CLICK, hideHcConfirmButtons);\r\n\t\tscmnButtonNormal.off(MouseEventType.CLICK, displayScmnConfirmButtons);\r\n\t\t//scmnButtonSelected.off(MouseEventType.CLICK, hideScmnConfirmButtons);\r\n\t\thcButtonNormal.off(MouseEventType.CLICK, displayHcConfirmButtons);\r\n\t\t//hcButtonSelected.off(MouseEventType.CLICK, hideHcConfirmButtons);\r\n\t\t\r\n\t\tcancelButton.off(TouchEventType.TAP, onCancel);\r\n\t\tscmnYesButton.off(TouchEventType.TAP, payWithSCMN);\r\n\t\tscmnNoButton.off(TouchEventType.TAP, hideScmnConfirmButtons);\r\n\t\thcYesButton.off(TouchEventType.TAP, payWithHC);\r\n\t\thcNoButton.off(TouchEventType.TAP, hideHcConfirmButtons);\r\n\t\tscmnButtonNormal.off(TouchEventType.TAP, displayScmnConfirmButtons);\r\n\t\t//scmnButtonSelected.off(TouchEventType.TAP, hideScmnConfirmButtons);\r\n\t\thcButtonNormal.off(TouchEventType.TAP, displayHcConfirmButtons);\r\n\t\t//hcButtonSelected.off(TouchEventType.TAP, hideHcConfirmButtons);\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t\t//parent.removeChild(this);\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass DailyReward extends SmartPopinRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe DailyReward\r\n\t */\r\n\tprivate static var instance: DailyReward;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): DailyReward {\r\n\t\tif (instance == null) instance = new DailyReward();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Deplacement extends SmartPopinRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Deplacement\r\n\t */\r\n\tprivate static var instance: Deplacement;\r\n\t\r\n\tprivate static inline var YES_BTN:String = \"btn_Yes\";\r\n\tprivate static inline var NO_BTN:String = \"btn_No\";\r\n\t\r\n\tprivate var yesButton:SmartButton;\r\n\tprivate var noButton:SmartButton;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Deplacement {\r\n\t\tif (instance == null) instance = new Deplacement();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t\t\r\n\t\tyesButton = cast(getChildByName(YES_BTN),SmartButton);\r\n\t\tnoButton = cast(getChildByName(NO_BTN), SmartButton);\r\n\r\n\t\tyesButton.on(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.on(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.on(TouchEventType.TAP, onYes);\r\n\t\tnoButton.on(TouchEventType.TAP, onNo);\r\n\t\t\r\n\t\tyesButton.visible = false;\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function onYes()\r\n\t{\r\n\t\r\n\t}\r\n\r\n\tprivate function onNo()\r\n\t{\r\n\t\tMapInteractor.getInstance().stopAlienMode();\r\n\t\t\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tyesButton.off(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.off(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.off(TouchEventType.TAP, onYes);\r\n\t\tnoButton.off(TouchEventType.TAP, onNo);\r\n\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.hud.InfosBatiment;\r\nimport com.isartdigital.ruby.ui.popin.contextual.BuildingContextualMenu;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass Destruction extends SmartPopinRegister\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe Destruction\r\n\t */\r\n\tprivate static var instance: Destruction;\r\n\tprivate static inline var YES_BTN:String = \"btn_Yes\";\r\n\tprivate static inline var NO_BTN:String = \"btn_No\";\r\n\r\n\tprivate var yesButton:SmartButton;\r\n\tprivate var noButton:SmartButton;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Destruction\r\n\t{\r\n\t\tif (instance == null) instance = new Destruction();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\t\tyesButton = cast(getChildByName(YES_BTN),SmartButton);\r\n\t\tnoButton = cast(getChildByName(NO_BTN), SmartButton);\r\n\r\n\t\tyesButton.on(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.on(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.on(TouchEventType.TAP, onYes);\r\n\t\tnoButton.on(TouchEventType.TAP, onNo);\r\n\t}\r\n\r\n\tprivate function onYes()\r\n\t{\r\n\t\t\r\n\t\tBuildingContextualMenu.getInstance().isDestroyConfirmed();\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t\tMapInteractor.getInstance().closeInfoPanel();\r\n\t\tSoundManager.getSound(\"removeBuilding\").play();\r\n\t\tSmartPopinRegister.event.emit(\"onYes\");\r\n\t}\r\n\r\n\tprivate function onNo()\r\n\t{\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tyesButton.off(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.off(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.off(TouchEventType.TAP, onYes);\r\n\t\tnoButton.off(TouchEventType.TAP, onNo);\r\n\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport eventemitter3.EventEmitter;\r\nimport haxe.Constraints.Function;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author qPk\r\n */\r\nclass DynamicPopin extends SmartPopinRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe DynamicPopin\r\n\t */\r\n\tprivate static var instance: DynamicPopin;\r\n\t\r\n\tprivate static inline var TEXT:String = \"txt_destroyBuildingConfirm\";\r\n\tprivate static inline var YES_BTN:String = \"btn_Yes\";\r\n\tprivate static inline var NO_BTN:String = \"btn_No\";\r\n\t\r\n\tprivate var yesButton:SmartButton;\r\n\tprivate var noButton:SmartButton;\r\n\t\r\n\tprivate var validationFunction:Function;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): DynamicPopin {\r\n\t\tif (instance == null) instance = new DynamicPopin();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\t\r\n\tprivate function new(pID:String=null)\r\n\t{\r\n\t\tsuper(\"Destruction\");\r\n\t\tcomponentName = \"DynamicPopin\";\r\n\t\tyesButton = cast(getChildByName(YES_BTN),SmartButton);\r\n\t\tnoButton = cast(getChildByName(NO_BTN), SmartButton);\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise la popin de confirmation \r\n\t * @param\tpQuestion : question  confirmer\r\n\t * @param\tpFunction : fonction  executer si confirmation\r\n\t */\r\n\tpublic function init(pQuestion:String, pFunction:Function):Void \r\n\t{\r\n\t\tvar questionText:TextSprite = cast(getChildByName(TEXT), TextSprite);\r\n\t\tquestionText.y -= 80;\r\n\t\tquestionText.text = pQuestion;\r\n\t\tvalidationFunction = pFunction;\r\n\t\t\r\n\t\t\r\n\t\tyesButton.on(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.on(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.on(TouchEventType.TAP, onYes);\r\n\t\tnoButton.on(TouchEventType.TAP, onNo);\t\t\r\n\t}\r\n\r\n\tprivate function onYes()\r\n\t{\r\n\t\tif(validationFunction != null)validationFunction();\r\n\t\tUIManager.getInstance().closePopin(this);\r\n\t\tMapInteractor.getInstance().closeInfoPanel();\r\n\t}\r\n\r\n\tprivate function onNo()\r\n\t{\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tyesButton.off(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.off(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.off(TouchEventType.TAP, onYes);\r\n\t\tnoButton.off(TouchEventType.TAP, onNo);\r\n\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Friendlist extends SmartPopinRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Friendlist\r\n\t */\r\n\tprivate static var instance: Friendlist;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Friendlist {\r\n\t\tif (instance == null) instance = new Friendlist();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass IsartPoints extends MenuClosable \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe IsartPoints\r\n\t */\r\n\tprivate static var instance: IsartPoints;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): IsartPoints {\r\n\t\tif (instance == null) instance = new IsartPoints();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.Missions.Reward;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.Localization;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport js.Lib;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass RewardNotifications extends SmartPopinRegister \r\n{\r\n\t\r\n\tprivate static inline var TITLE:String = \"txt_NotificationTitle\";\r\n\tprivate static inline var CLOSE_BTN:String = \"btn_Close\";\r\n\tprivate static inline var CONTINUE_BTN:String = \"btn_Continue\";\r\n\tprivate static inline var SHARE_CLIP:String = \"RewardNotifications_clipShare\";\r\n\tprivate static inline var LOGO_CONTAINER:String = \"RewardNotification_spriteContainerPrincipal\";\r\n\tprivate static inline var REWARD_CONTAINER:String = \"RewardNotification_spriteContainerRewards\";\r\n\tprivate static inline var LOGO:String = \"RewardNotifications_spritePrincipal\";\r\n    private static inline var REWARD:String = \"RewardNotifications_clipRewardUnit\";\r\n\t\r\n\tprivate var title:TextSprite;\r\n\tprivate var btnContinue:SmartButton;\r\n\tprivate var btnClose:SmartButton;\r\n\tprivate var shareContainer:SmartComponent;\r\n\tprivate var logoContainer:SmartComponent;\r\n\tprivate var rewardContainer:SmartComponent;\r\n\t\r\n\tprivate var alienSprite1:UISprite;\r\n\tprivate var alienSprite2:UISprite;\r\n\tprivate var alienSprite3:UISprite;\r\n\t\r\n\tprivate var alienSpriteList:Array<UISprite>;\r\n\t\r\n\r\n\t\r\n\tprivate var rewardList: Array<SmartComponent>;\r\n\tprivate var rewardTextList: Array<Int>;\r\n\tprivate var rewardTypeList: Array<String>;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe RewardNotification\r\n\t */\r\n\tprivate static var instance: RewardNotifications;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): RewardNotifications {\r\n\t\tif (instance == null) instance = new RewardNotifications();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\talienSpriteList = [];\r\n\t\trewardList = [];\r\n\t\trewardTypeList = [];\r\n\t\trewardTextList = [];\r\n\t\ttitle = cast(getChildByName(TITLE), TextSprite);\r\n\t\tbtnContinue = cast(getChildByName(CONTINUE_BTN), SmartButton);\r\n\t\tbtnClose = cast(getChildByName(CLOSE_BTN), SmartButton);\r\n\t\tshareContainer = cast(getChildByName(SHARE_CLIP), SmartComponent);\r\n\t\tlogoContainer = cast(getChildByName(LOGO_CONTAINER), SmartComponent);\r\n\t\t\talienSprite1 =  cast(logoContainer.getChildByName(\"RewardNotifications_spritePrincipal #0\"), UISprite);\r\n\t\t\talienSpriteList.push(alienSprite1);\r\n\t\t\talienSprite2 =  cast(logoContainer.getChildByName(\"RewardNotifications_spritePrincipal #2\"), UISprite);\r\n\t\t\talienSpriteList.push(alienSprite2);\r\n\t\t\talienSprite3 =  cast(logoContainer.getChildByName(\"RewardNotifications_spritePrincipal #1\"), UISprite);\r\n\t\t\talienSpriteList.push(alienSprite3);\r\n\t\trewardContainer\t= cast(getChildByName(REWARD_CONTAINER), SmartComponent);\r\n\t\tfor (i in 0...6){\r\n\t\t\t\r\n\t\t\tvar lComponent:SmartComponent = cast(rewardContainer.getChildByName(\"RewardNotifications_clipRewardUnit #\" + i), SmartComponent);\r\n\t\t\trewardList.push(lComponent);\r\n\t\t}\r\n\t\t\t\r\n\t}\r\n\t\r\n\tpublic function initLevelUp(pLvl:Int):Void\r\n\t{\r\n\t\treset();\r\n\t\tshareContainer.visible = true;\r\n\t\tbtnClose.visible = false;\r\n\t\tbtnContinue.on(MouseEventType.CLICK, onClick);\r\n\t\tbtnContinue.on(MouseEventType.CLICK, onClick);\r\n\t\talienSprite1.visible = false;\r\n\t\talienSprite3.visible = false;\r\n\t\ttitle.text = Localization.getLabel(\"LABEL_LEVEL_UP\") +\" \" + pLvl;\r\n\t\tvar lReward:Reward;\r\n\t\tlReward = {\r\n\t\t\r\n\t\t\thc:0,\r\n\t\t\tsc:0,\r\n\t\t\tgene1:0,\r\n\t\t\tgene2:0,\r\n\t\t\tgene3:0,\r\n\t\t\tgene4:0,\r\n\t\t\tgene5:0,\r\n\t\t\tschema:0,\r\n\t\t\tdarkMatter:0\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif (pLvl == 2) {\r\n\t\t\r\n\t\t\tlReward = {\r\n\t\t\r\n\t\t\thc:0,\r\n\t\t\tsc:100,\r\n\t\t\tgene1:10,\r\n\t\t\tgene2:0,\r\n\t\t\tgene3:0,\r\n\t\t\tgene4:0,\r\n\t\t\tgene5:0,\r\n\t\t\tschema:0,\r\n\t\t\tdarkMatter:100\r\n\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (pLvl == 3) {\r\n\t\t\r\n\t\t\tlReward = {\r\n\t\t\r\n\t\t\thc:0,\r\n\t\t\tsc:150,\r\n\t\t\tgene1:15,\r\n\t\t\tgene2:5,\r\n\t\t\tgene3:0,\r\n\t\t\tgene4:0,\r\n\t\t\tgene5:0,\r\n\t\t\tschema:0,\r\n\t\t\tdarkMatter:100\r\n\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tinitRewardContainer(lReward);\r\n\t\tinitLogoContainer();\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t}\r\n\t\r\n\tpublic function initMissionEnd(pMissionReward:Reward, pXenoList:Array<AlienElement>) {\r\n\t\r\n\t\tLib.debug();\r\n\t\t//trace(pXenoList[0].name);\r\n\t\treset();\r\n\t\tfor (sprite in alienSpriteList) sprite.visible = false;\r\n\t\tshareContainer.visible = true;\r\n\t\tbtnClose.visible = false;\r\n\t\tbtnContinue.on(MouseEventType.CLICK, onClick);\r\n\t\tbtnContinue.on(MouseEventType.CLICK, onClick);\r\n\t\t\r\n\t\tfor (i in 0...pXenoList.length-1) {\r\n\t\t\r\n\t\t\t//trace(pXenoList[i].name);\r\n\t\t\tvar lXeno = pXenoList[i];\r\n\t\t\talienSpriteList[i].visible = true;\r\n\t\t\tsetAssetAlien(alienSpriteList[i], lXeno);\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\ttitle.text = \"Bravo !\";\r\n\t\t\r\n\t\tinitRewardContainer(pMissionReward);\r\n\t\tinitLogoContainer();\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function reset():Void {\r\n\t\r\n\t\tfor (component in rewardList) {\r\n\t\t\r\n\t\t\tcomponent.visible = true;\r\n\t\t\tcast(component.getChildByName(\"RewardNotifications_spriteReward\"), UISprite).visible = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function setAssetReward():Void {\r\n\t\r\n\t\tfor (i in 0...rewardTextList.length) {\r\n\t\t\r\n\t\t\tvar lComponent:SmartComponent = rewardList[i];\r\n\t\t\tvar lText:TextSprite = cast(lComponent.getChildByName(\"txt_itemQuantity\"), TextSprite);\r\n\t\t\tvar lWrongAsset:UISprite =  cast(lComponent.getChildByName(\"RewardNotifications_spriteReward\"), UISprite);\r\n\t\t\t\r\n\t\t\tlText.text = \"x\"+Std.string(rewardTextList[i]);\r\n\t\t\tvar lNewAsset:UISprite = new UISprite(\"RewardNotification_\" +rewardTypeList[i]);\r\n\t\t\tlNewAsset.name = \"mainAsset\";\r\n\t\t\tlNewAsset.position = lWrongAsset.position.clone();\r\n\t\t\tlComponent.addChild(lNewAsset);\r\n\t\t\tlWrongAsset.visible = false;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tfor (i in 0...rewardList.length) {\r\n\t\t\r\n\t\t\tif (i >= rewardTextList.length) rewardList[i].visible = false;\r\n\t\t}\r\n\t\t\r\n\t\twhile (rewardTextList.length > 0) rewardTextList.pop();\r\n\t\twhile (rewardTypeList.length > 0) rewardTypeList.pop();\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setAssetAlien(pAsset:UISprite, pAlien:AlienElement) {\r\n\t\t\r\n\t\tvar lAsset:UISprite;\r\n\t\t\r\n\t\t\r\n\t\tlAsset = new UISprite(\"Enclos_\" + pAlien.name + \"_lvl1\");\r\n\t\t\r\n\t\tlAsset.name = \"mainAsset\"+pAlien.name;\r\n\t\tlAsset.position = pAsset.position.clone();\r\n\t\tlAsset.position.y -= 130;\r\n\t\t//if (currentState.getChildByName(lAsset.name) != null)\r\n\t\t\t//currentState.removeChild(currentState.getChildByName(lAsset.name));\r\n\t\t\t\r\n\t\taddChild(lAsset);\r\n\t\tpAsset.visible = false;\r\n\t}\r\n\t\r\n\r\n\t\r\n\t\r\n\t\r\n\tprivate function initRewardContainer(pMissionReward:Reward):Void\r\n\t{\r\n\t\t\tif (pMissionReward.sc != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.sc);\r\n\t\t\trewardTypeList.push(\"SoftCurrency\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.hc != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.hc);\r\n\t\t\trewardTypeList.push(\"HardCurrency\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.darkMatter != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.darkMatter);\r\n\t\t\trewardTypeList.push(\"MN\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.schema != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.schema);\r\n\t\t\trewardTypeList.push(\"Parchemin\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.gene1 != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.gene1);\r\n\t\t\trewardTypeList.push(\"Rho\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.gene2 != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.gene2);\r\n\t\t\trewardTypeList.push(\"Upsilon\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.gene3 != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.gene3);\r\n\t\t\trewardTypeList.push(\"Beta\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.gene4 != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.gene4);\r\n\t\t\trewardTypeList.push(\"Iota\");\r\n\t\t}\r\n\t\t\r\n\t\tif (pMissionReward.gene5 != 0) {\r\n\t\t\trewardTextList.push(pMissionReward.gene5);\r\n\t\t\trewardTypeList.push(\"Sigma\");\r\n\t\t}\r\n\t\t\r\n\t\tsetAssetReward();\r\n\t}\r\n\t\r\n\tprivate function initLogoContainer():Void\r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function onClick():Void\r\n\t{\r\n\t\t//event.emit(\"onOpen\");\r\n\t\tUIManager.getInstance().closePopin(this);\r\n\t\tSoundManager.getSound(\"soundAtmosphere\").play();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tbtnContinue.off(MouseEventType.CLICK, onClick);\r\n\t\tbtnContinue.off(MouseEventType.CLICK, onClick);\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.services.monetization.Ads;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartScreen;\r\nimport howler.Howler;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Settings extends SmartScreen \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Settings\r\n\t */\r\n\tprivate static var instance: Settings;\r\n\tprivate var close_btn:SmartButton;\r\n\tprivate var moreGame_btn:SmartButton;\r\n\tprivate var audioOn:SmartComponent;\r\n\tprivate var audioOff:SmartComponent;\r\n\tprivate static inline var CLOSE_BTN:String = \"btn_Close\";\r\n\tprivate static inline var MOREGAME_BTN:String = \"btn_MoreGames\";\r\n\tprivate static inline var BTN_AUDIO_ON:String = \"btn_AudioOn\";\r\n\tprivate static inline var BTN_AUDIO_OFF:String = \"btn_AudioOff\";\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Settings {\r\n\t\tif (instance == null) instance = new Settings();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t\t\r\n\t\taudioOff = cast(getChildByName(BTN_AUDIO_OFF), SmartComponent);\r\n\t\taudioOn = cast(getChildByName(BTN_AUDIO_ON), SmartComponent);\r\n\t\t\r\n\t\taudioOff.interactive = true;\r\n\t\taudioOn.interactive = true;\r\n\t\t\r\n\t\taudioOff.on(MouseEventType.CLICK, onAudioOff);\r\n\t\taudioOff.on(TouchEventType.TAP, onAudioOff);\r\n\t\taudioOn.on(MouseEventType.CLICK, onAudioOn);\r\n\t\taudioOn.on(TouchEventType.TAP, onAudioOn);\r\n\t\t\r\n\t\tclose_btn = cast(getChildByName(CLOSE_BTN), SmartButton);\r\n\t\tclose_btn.on(MouseEventType.CLICK, onClose);\r\n\t\tclose_btn.on(TouchEventType.TAP, onClose);\r\n\t\t\r\n\t\tmoreGame_btn = cast(getChildByName(MOREGAME_BTN), SmartButton);\r\n\t}\r\n\t\r\n\t\r\n\tprivate function onClose():Void{\r\n\t\tUIManager.getInstance().openScreen(Hud.getInstance());\r\n\t\tHud.getInstance().update();\r\n\t}\r\n\t\r\n\tprivate function onAudioOn():Void\r\n\t{\r\n\t\tHowler.mute(false);\r\n\t}\r\n\t\r\n\tprivate function onAudioOff():Void\r\n\t{\r\n\t\tHowler.mute(true);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport haxe.Constraints.Function;\r\nimport js.Lib;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass TimeBased extends MenuClosable \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TimeBased\r\n\t */\r\n\tprivate static var instance: TimeBased;\r\n\t\r\n\tprivate var btnSkip:SmartButton;\r\n\tprivate var buikdingName:TextSprite;\r\n\tprivate var time:TextSprite;\r\n\tprivate var price:TextSprite;\r\n\tprivate var hcSprite:UISprite;\r\n\tprivate var skipText:TextSprite;\r\n\t\r\n\tprivate var currentBuilding:Building;\r\n\t\r\n\tprivate var validationFunction:Function;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TimeBased {\r\n\t\tif (instance == null) instance = new TimeBased();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tbtnSkip = cast(getChildByName(\"btn_Skip\"), SmartButton);\r\n\t\tbuikdingName = cast(getChildByName(\"Title_Txt\"), TextSprite);\r\n\t\ttime = cast(getChildByName(\"RemainingTime_Txt\"), TextSprite);\r\n\t\tprice = cast(getChildByName(\"TimeBased_txt_HCDisplay\"), TextSprite);\r\n\t\tskipText = cast(getChildByName(\"SkipPrice_Txt\"), TextSprite);\r\n\t\thcSprite = cast(getChildByName(\"HCsprite\"), UISprite);\r\n\t\t\r\n\t\tinit();\r\n\t}\r\n\t\r\n\toverride public function open():Void \r\n\t{\r\n\t\tsuper.open();\r\n\t\tSoundManager.getSound(\"soundPlayerSkiptime\").play();\r\n\t}\r\n\t\r\n\tpublic function setText(pbuilding:Building):Void \r\n\t{\r\n\t\tcurrentBuilding = pbuilding;\r\n\t\tbuikdingName.text = currentBuilding.name;\r\n\t\tvalidationFunction = pbuilding.cdTimerSkiped;\r\n\t\t\r\n\t\tif(FTUEManager.isFTUEon()) {\r\n\t\t\tprice.text = \"Gratuit\";\r\n\t\t\thcSprite.visible = false;\r\n\t\t\tskipText.visible = false;\r\n\t\t\t\r\n\t\t}\r\n\t\telse price.text = \"3\";\r\n\t\t\r\n\t\tbtnSkip.on(MouseEventType.CLICK, onYes);\r\n\r\n\t\tbtnSkip.on(TouchEventType.TAP, onYes);\r\n\t}\r\n\t\r\n\t\r\n\tprivate function onYes()\r\n\t{\r\n\t\tif(validationFunction != null)validationFunction();\r\n\t\tUIManager.getInstance().closePopin(this);\r\n\t\tMapInteractor.getInstance().closeInfoPanel();\r\n\t}\r\n\t\r\n\tpublic function refreshText():Void {\r\n\t\r\n\t\tif (currentBuilding != null) {\r\n\t\t\t//Lib.debug();\r\n\t\t\tif(currentBuilding.timeConstruction != null) time.text = currentBuilding.timeConstruction;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass TutoSpecialFeature extends MenuClosable \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TutoSpecialFeature\r\n\t */\r\n\tprivate static var instance: TutoSpecialFeature;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TutoSpecialFeature {\r\n\t\tif (instance == null) instance = new TutoSpecialFeature();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\r\n\t\twidth += 650;\r\n\t\theight += 500;\r\n\t\t\r\n\t}\r\n\t\r\n\toverride function onClose():Void \r\n\t{\r\n\t\tsuper.onClose();\r\n\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\n\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\nimport com.isartdigital.ruby.ui.popin.MenuClosable;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.ruby.ui.popin.codex.Codex;\r\nimport com.isartdigital.ruby.ui.popin.codex.XenoCodexTypedef;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins / Guillaume Zegoudia\r\n */\r\nclass XenoPage extends MenuClosable\r\n{\r\n\r\n\tprivate var isDone:Bool;\r\n\tprivate  var return_btn:SmartButton;\r\n\tprivate var BTN_RETURN(default, null):String = \"btn_Return\";\r\n\r\n\tprivate var TXT_SPECIENAME(default, null):String=\"txt_SpecieName\";\r\n\tprivate var TXT_STAMINA(default, null):String=\"txt_StaminaXenoDisplay\";\r\n\tprivate var TXT_CLASSDISPLAY(default, null):String=\"txt_ClassDisplay\";\r\n\tprivate var TXT_CLASSDESCRIPTIONDISPLAY(default, null):String=\"txt_ClassDescriptionDisplay\";\r\n\tprivate var TXT_POWER(default, null):String=\"txt_Power\";\r\n\tprivate var TXT_POWERDESCRIPTION(default, null):String=\"txt_PowerDescriptionDisplay\";\r\n\tprivate var TXT_RANGE(default, null):String=\"txt_RangeDisplay\";\r\n\tprivate var TXT_AREA(default, null):String = \"txt_EffectiveAreaDisplay\";\r\n\r\n\tprivate var CLIP_SCHEMA(default, null):String = \"XenoPage_clipSchema\";\r\n\tprivate var XENO_ACTUAL(default, null):String = \"XenoEvolutionActual\";\r\n\tprivate var XENO_EVOLUTION1(default, null):String = \"XenoEvolution #1\";\r\n\tprivate var XENO_EVOLUTION2(default, null):String = \"XenoEvolution #2\";\r\n\r\n\tprivate var specieName:TextSprite;\r\n\tprivate var stamina:TextSprite;\r\n\tprivate var classDisplay:TextSprite;\r\n\tprivate var classDescription:TextSprite;\r\n\tprivate var power:TextSprite;\r\n\tprivate var powerDescription:TextSprite;\r\n\tprivate var range:TextSprite;\r\n\tprivate var area:TextSprite;\r\n\r\n\tprivate var clipSchema:SmartComponent;\r\n\tprivate var xenoActual:SmartComponent;\r\n\tprivate var xenoEvolution1:SmartComponent;\r\n\tprivate var xenoEvolution2:SmartComponent;\r\n\r\n\tprivate var currentAlien:XenoCodexTypedef;\r\n\tprivate var currentAlienCarac:Dynamic;\r\n\tprivate var description:Dynamic;\r\n\t/**\r\n\t * instance unique de la classe XenoPage\r\n\t */\r\n\tprivate static var instance: XenoPage;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): XenoPage\r\n\t{\r\n\t\tif (instance == null) instance = new XenoPage();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\r\n\t}\r\n\r\n\toverride function init():Void\r\n\t{\r\n\t\tdescription = GameLoader.getContent(\"descriptionAlien.json\");\r\n\t\tsuper.init();\r\n\t\treturn_btn = cast(getChildByName(BTN_RETURN), SmartButton);\r\n\t\treturn_btn.on(MouseEventType.CLICK, onReturn);\r\n\t\treturn_btn.on(TouchEventType.TAP, onReturn);\r\n\r\n\t\tspecieName = cast(getChildByName(TXT_SPECIENAME), TextSprite);\r\n\t\tstamina = cast(getChildByName(TXT_STAMINA), TextSprite);\r\n\t\tclassDisplay = cast(getChildByName(TXT_CLASSDISPLAY), TextSprite);\r\n\t\tclassDescription = cast(getChildByName(TXT_CLASSDESCRIPTIONDISPLAY), TextSprite);\r\n\t\tpower = cast(getChildByName(TXT_POWER), TextSprite);\r\n\t\tpowerDescription = cast(getChildByName(TXT_POWERDESCRIPTION), TextSprite);\r\n\t\trange = cast(getChildByName(TXT_RANGE), TextSprite);\r\n\t\tarea = cast(getChildByName(TXT_AREA), TextSprite);\r\n\r\n\t\tclipSchema\t\t= cast(getChildByName(CLIP_SCHEMA), SmartComponent);\r\n\t\txenoActual\t\t= cast(getChildByName(XENO_ACTUAL), SmartComponent);\r\n\t\txenoEvolution1\t= cast(getChildByName(XENO_EVOLUTION1), SmartComponent);\r\n\t\txenoEvolution2\t= cast(getChildByName(XENO_EVOLUTION2), SmartComponent);\r\n\r\n\t}\r\n\r\n\tpublic function setAlienInfoToDisplay(pAlien:XenoCodexTypedef):Void\r\n\t{\r\n\t\tif (currentAlien == null && !isDone)\r\n\t\t{\r\n\t\t\tcurrentAlien = pAlien;\r\n\t\t\tfor (alien in Alien.alienElementList)\r\n\t\t\t{\r\n\t\t\t\tif (alien.name == currentAlien.name)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tcurrentAlienCarac = alien;\r\n\t\t\t\t\talien.stamina != 0 ? stamina.text = Std.string(alien.stamina) : stamina.text = \"\";\r\n\t\t\t\t\t//alien.stamina != 0 ? stamina.text = \"Stamina : \" + alien.stamina : stamina.text = \"\";\r\n\r\n\t\t\t\t\txenoActual.getChildByName(\"XenoSprite\").visible = false;\r\n\t\t\t\t\tassignCorrectAsset();\r\n\t\t\t\t\t//xenoActual.getChildByName(\"XenoSprite\").visible = false;\r\n\r\n\t\t\t\t\tspecieName.text = currentAlien.nomenclature;\r\n\t\t\t\t\tclassDisplay.text = StringTools.replace(currentAlien.type,\"Alien\",\"\") + \" : \";\r\n\t\t\t\t\tpowerDescription.text = Reflect.field(description, currentAlien.name) != null ? Reflect.field(description, currentAlien.name) : { powerDescription.text =\"\"; power.text = \"\"; range.text = \"\"; area.text = \"\"; };\r\n\t\t\t\t\tclassDescription.text = Reflect.field(description, currentAlien.type);\r\n\t\t\t\t\tisDone = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function assignCorrectAsset():Void\r\n\t{\r\n\t\t\r\n\t\tvar assetEvolution1:UISprite;\r\n\t\tvar assetEvolution2:UISprite;\r\n\t\tvar lAsset:UISprite;\r\n\t\tif (currentAlien.type == \"AlienForeur\")\r\n\t\t{\r\n\t\t\tfor (child in xenoEvolution1.children) child.visible = false;\r\n\t\t\tfor (child in xenoEvolution2.children) child.visible = false;\r\n\t\t\t\r\n\t\t lAsset = new UISprite(\"XenoPage_\"+currentAlien.name);\r\n\t\t}\r\n\r\n\t\telse\r\n\t\t{\r\n\t\t\tswitch (Std.parseInt(currentAlienCarac.carac.nbUpgrade))\r\n\t\t\t{\r\n\t\t\t\tcase 0:\r\n\r\n\t\t\t\tfor (child in xenoEvolution1.children) child.visible = false;\r\n\t\t\t\tfor (child in xenoEvolution2.children) child.visible = false;\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\tfor (child in xenoEvolution2.children) child.visible = false;\r\n\t\t\t\txenoEvolution1.getChildByName(\"XenoSprite\").visible = false;\r\n\t\t\t\tassetEvolution1 = new UISprite(\"XenoPage_\" + currentAlien.name + (currentAlienCarac.level == \"2\" ? \"_1_Normal\":\"_2_Disabled\")/* +  \"_Normal\"*/);\r\n\t\t\t\tassetEvolution1.position = xenoEvolution1.getChildByName(\"XenoSprite\").position.clone();\r\n\t\t\t\txenoEvolution1.addChild(assetEvolution1);\r\n\t\t\t\t\r\n\t\t\tdefault:\r\n\t\t\t\txenoEvolution1.getChildByName(\"XenoSprite\").visible = false;\r\n\t\t\t\tassetEvolution1 = new UISprite(\"XenoPage_\" + currentAlien.name + (currentAlienCarac.level >= \"2\" ? \"_1_Normal\":\"_2_Disabled\")/* +  \"_Normal\"*/);\r\n\t\t\t\tassetEvolution1.position = xenoEvolution1.getChildByName(\"XenoSprite\").position.clone();\r\n\t\t\t\txenoEvolution1.addChild(assetEvolution1);\r\n\t\t\t\t\r\n\t\t\t\txenoEvolution2.getChildByName(\"XenoSprite\").visible = false;\r\n\t\t\t\tassetEvolution2 = new UISprite(\"XenoPage_\" + currentAlien.name + (currentAlienCarac.level == \"3\" ? \"_2_Normal\":\"_3_Disabled\")/* + \"_Normal\" */);\r\n\t\t\t\tassetEvolution2.position = xenoEvolution2.getChildByName(\"XenoSprite\").position.clone();\r\n\t\t\t\txenoEvolution2.addChild(assetEvolution2);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlAsset = new UISprite(\"XenoPage_\"+currentAlien.name+\"_\"+ currentAlienCarac.level);\r\n\t\t}\r\n\t\t\r\n\t\tlAsset.position = xenoActual.getChildByName(\"XenoSprite\").position.clone();\r\n\t\txenoActual.addChild(lAsset);\r\n\t}\r\n\r\n\tprivate function onReturn():Void\r\n\t{\r\n\t\tUIManager.getInstance().closePopin(this);\r\n\t}\r\n\r\n\toverride function onClose():Void\r\n\t{\r\n\t\tonReturn();\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin;\r\nimport com.greensock.TweenMax;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.items.switchItems.XenosPanelSwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.XenosPanelSwitchTab;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass XenosPanel extends Menu \r\n{\r\n\t\r\n\tstatic inline var CONTEXTUAL:String = \"Contextual\";\r\n\tstatic inline var BTN_XENO_PAGE:String = \"btn_UnitXenoPage\";\r\n\tstatic inline var BTN_UPGRADE:String = \"btn_UnitUpgrade\";\r\n\tstatic inline var BTN_STORE:String = \"btn_UnitCryo\"; \r\n\t\r\n\tpublic var contextualItem:SmartComponent;\r\n\tprivate var xenoPageBtn:SmartButton;\r\n\tprivate var upgradeBtn:SmartButton;\r\n\tprivate var storeBtn:SmartButton;\r\n\t\r\n\tprivate var btnSell:SmartButton;\r\n\t\r\n\tpublic var alienSelected:AlienElement;\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe XenosPanel\r\n\t */\r\n\tprivate static var instance: XenosPanel;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): XenosPanel {\r\n\t\tif (instance == null) instance = new XenosPanel();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t}\r\n\t\r\n\toverride function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tcontextualItem = cast(getChildByName(CONTEXTUAL), SmartComponent);\r\n\t\tcontextualItem.visible = false;\r\n\t\tinitTab(XenosPanelSwitchTab);\r\n\t\tinitItems();\r\n\t\t\r\n\t\txenoPageBtn = cast(contextualItem.getChildByName(BTN_XENO_PAGE), SmartButton);\r\n\t\txenoPageBtn.on(MouseEventType.CLICK, onXenoPage);\r\n\t\txenoPageBtn.on(TouchEventType.TAP, onXenoPage);\r\n\t\t\r\n\t\tupgradeBtn = cast(contextualItem.getChildByName(BTN_UPGRADE), SmartButton);\r\n\t\tupgradeBtn.on(MouseEventType.CLICK, onUpgrade);\r\n\t\tupgradeBtn.on(TouchEventType.TAP, onUpgrade);\r\n\t\t\r\n\t\tstoreBtn = cast(contextualItem.getChildByName(BTN_STORE), SmartButton);\r\n\t\tstoreBtn.on(MouseEventType.CLICK, onStore);\r\n\t\tstoreBtn.on(TouchEventType.TAP, onStore);\r\n\t\t\r\n\t\tbtnSell = cast(getChildByName(\"btn_Sell\"), SmartButton);\r\n\t\tbtnSell.visible = false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * stock les item du popin dans un tableau de reference\r\n\t */\r\n\toverride private function initItems() {\r\n\t\titemContainer = cast(getChildByName(ITEM_CONTAINER), SmartComponent);\r\n\t\titemContainer.interactive = true;\r\n\t\t\r\n\t\tinitOffsetBetweenItems();\r\n\t\t\r\n\t\tupdateItems();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Crer les items et les places\r\n\t */\r\n\tpublic function updateItems() {\r\n\t\tdestroyAllChildInContainer(itemContainer);\r\n\t\r\n\t\tvar count:Int = 0;\r\n\t\tfor (i in 0...Alien.alienElementList.length) {\r\n\t\t\tif (Alien.alienElementList[i].type == \"AlienProducer\" || Alien.alienElementList[i].type == \"AlienBuffer\") {\r\n\t\t\t\r\n\t\t\t\tvar currentItem = new XenosPanelSwitchItem();\r\n\t\t\t\titemContainer.addChild(currentItem);\r\n\t\t\t\t\r\n\t\t\t\tcurrentItem.setInfo(Alien.alienElementList[i]);\r\n\t\t\t\tcurrentItem.x = offsetItem.x * count++;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function appearContextualMenuItemAt(pX:Float) {\r\n\t\tvar lY:Float = contextualItem.y;\r\n\t\t\r\n\t\tcontextualItem.x = pX;\r\n\t\tcontextualItem.visible = true;\r\n\t\tTweenMax.fromTo(contextualItem, 0.4, { y:lY + 50, alpha:0}, { y:lY, alpha:1} );\r\n\t}\r\n\tpublic function onUpgrade():Void\r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function onMove():Void \r\n\t{\r\n\t\t\r\n\t\t\r\n\t\tif (alienSelected != null) {\r\n\t\t\t\r\n\t\t\tMapInteractor.getInstance().alienSelected = alienSelected;\r\n\t\t\tMapInteractor.getInstance().highLightAlienBuildings();\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function onXenoPage():Void \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function onStore():Void \r\n\t{\r\n\t\t\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\t//xenoPageBtn.off(MouseEventType.CLICK, onXenoPage);\r\n\t\t//xenoPageBtn.off(TouchEventType.TAP, onXenoPage);\r\n\t\t//upgradeBtn.off(MouseEventType.CLICK, onUpgrade);\r\n\t\t//upgradeBtn.off(TouchEventType.TAP, onUpgrade);\r\n\t\t//storeBtn.off(MouseEventType.CLICK, onStore);\r\n\t\t//storeBtn.off(TouchEventType.TAP, onStore);\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.building;\r\n\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienIncubator;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienResearchCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingAutoOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanCommunication;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanHeadQuarter;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanPowerStation;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanTranslation;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.Slider;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuData;\r\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchTab;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuParams;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.flump.Sprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingMenu extends Menu\r\n{\r\n\t\r\n\tprivate static inline var BUILDING_INFO_NAME:String = \"BuildingMenu_clipBuildingInfos\";\r\n\tprivate static inline var BUILDING_ENERGY_BAR_NAME:String = \"BuildingMenu_clipBarEnergy\";\r\n\tprivate static inline var TEXT_ENERGY_BAR:String = \"txt_energyDisplay\";\r\n\tprivate static inline var CLOSE_BTN:String = \"btn_Close\";\r\n\tprivate static inline var BUILDING_BTN:String = \"btn_Building\";\r\n\tprivate static inline var SLIDER:String = \"Slider\";\r\n\t\r\n\t\r\n\t\r\n\tprivate var infoContainer:SmartComponent;\r\n\tprivate var energyBarContainer:SmartComponent;\r\n\tprivate var sliderContainer:SmartComponent;\r\n\r\n\tprivate var slider:Slider;\r\n\tpublic var panel:BuildingPanel;\r\n\t\r\n\tpublic static var saveCurrentIndex = 0;\r\n\t//affichage energy\r\n\tvar lComponent:SmartComponent;\r\n\tvar lTextField:TextSprite;\r\n\tvar lMovieclipQuiFaitLErreur:SmartComponent;\r\n\t\r\n\t\r\n\tprivate var lastItemX:Float;\r\n\tprivate var firstItemX:Float;\r\n\t\r\n\r\n\tprivate var txtContainer:SmartText;\r\n\t\r\n\r\n\r\n\t/**\r\n\t * instance unique de la classe BuildingMenu\r\n\t */\r\n\tprivate static var instance: BuildingMenu;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): BuildingMenu\r\n\t{\r\n\t\tif (instance == null) instance = new BuildingMenu();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\toverride private function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * Initialise le BuildingMenu, recupere tout les container\r\n\t */\r\n\toverride private function init()\r\n\t{\r\n\r\n\t\tsuper.init();\r\n\t\tcurrentIndex = saveCurrentIndex;\r\n\t\t//buildingEnergyBarContainer = cast(getChildByName(BUILDING_ENERGY_BAR_NAME), SmartComponent);\r\n\t\tinitTab(BuildingMenuSwitchTab);\r\n\t\tinitItems();\r\n\t\tinfoContainer = cast(getChildByName(BUILDING_INFO_NAME), SmartComponent);\r\n\t\tpanel = new BuildingPanel();\r\n\t\tpanel.init(infoContainer);\r\n\t\tftueRegister();\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t\t\r\n\t}\r\n\r\n\t/*\t######### ITEMS DU MENU ######### */\r\n\t\r\n\t\r\n\t/**\r\n\t * stock les item du popin dans un tableau de reference\r\n\t */\r\n\toverride private function initItems() {\r\n\t\tsliderContainer = cast(getChildByName(SLIDER), SmartComponent);\r\n\t\titemContainer = cast(sliderContainer.getChildByName(ITEM_CONTAINER), SmartComponent);\r\n\t\titemContainer.interactive = true;\r\n\t\t\r\n\t\tinitOffsetBetweenItems();\r\n\t\t\r\n\t\tslider = new Slider();\r\n\t\tslider.init(sliderContainer, itemContainer);\r\n\t\t\r\n\t\tupdateItems();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Crer les items et les places\r\n\t */\r\n\tpublic function updateItems() {\r\n\t\tdestroyAllChildInContainer(itemContainer);\r\n\t\tsaveCurrentIndex = currentIndex;\r\n\t\tfor (i in 0 ... BuildingMenuData.getInstance().datas[currentIndex].length) {\r\n\t\t\tvar currentItemInfo:BuildingMenuParams = BuildingMenuData.getInstance().datas[currentIndex][i];\r\n\t\t\tvar currentItem = new BuildingMenuSwitchItem();\r\n\t\t\titemContainer.addChild(currentItem);\r\n\t\t\tcurrentItem.x = offsetItem.x * i;\r\n\t\t\tcurrentItem.setInfo(currentItemInfo);\r\n\t\t\tcurrentItem.id = i;\r\n\t\t\tFTUEManager.register(currentItem);\r\n\t\t}\r\n\t\t\r\n\t\tslider.update();\r\n\t}\r\n\r\n\tpublic function updateEnergy():Void\r\n\t{\r\n\t\t/*lComponent = cast(getChildByName(BUILDING_ENERGY_BAR_NAME), SmartComponent);\r\n\t\tlTextField = cast(lComponent.getChildByName(TEXT_ENERGY_BAR), TextSprite);\r\n\t\tlTextField.text = Std.string(Player.getInstance().currentEnergy) + \"/\" + Std.string(Player.getInstance().maxEnergy);*/\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.building;\r\n\r\nimport com.isartdigital.utils.save.BuildingTypes.BuildingType;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingPanel\r\n{\r\n\t\r\n\tprivate static inline var BUILDING_NAME:String = \"BuildingMenutxt_BatimentName\";\r\n\tprivate static inline var BUILD_TIME:String = \"txt_buildTimeDisplay\";\r\n\tprivate static inline var SC_PRICE = \"txt_SCPrice\";\r\n\tprivate static inline var HC_PRICE = \"txt_HCPrice\";\r\n\tprivate static inline var DARK_MATTER_PRICE:String = \"txtMNPrice\";\r\n\tprivate static inline var ENERGY:String = \"txt_energyBuildingDisplay\";\r\n\tprivate static inline var DESCRIPTION:String = \"txt_descriptionBuilding\";\r\n\t\r\n\tprivate var mainContainer:SmartComponent;\r\n\tprivate var buildingName:TextSprite;\r\n\tprivate var buildTime:TextSprite;\r\n\tprivate var scPrice:TextSprite;\r\n\tprivate var hcPrice:TextSprite;\r\n\tprivate var dmPrice:TextSprite;\r\n\tprivate var energy:TextSprite;\r\n\tprivate var description:TextSprite;\r\n\t\r\n\tpublic function new() {\r\n\r\n\t}\r\n\t\r\n\tpublic function init(pInfoContainer:SmartComponent) {\r\n\t\tmainContainer = pInfoContainer;\r\n\t\tbuildingName = getTextSprite(BUILDING_NAME);\r\n\t\t\r\n\t\tbuildTime = getTextSprite(BUILD_TIME);\r\n\t\t\r\n\t\tscPrice = getTextSprite(SC_PRICE);\r\n\t\t\r\n\t\thcPrice = getTextSprite(HC_PRICE);\r\n\t\t\r\n\t\tdmPrice = getTextSprite(DARK_MATTER_PRICE);\r\n\t\t\r\n\t\tdescription = getTextSprite(DESCRIPTION);\r\n\t\t\r\n\t\tenergy = getTextSprite(ENERGY);\r\n\t\t\r\n\t\treset();\r\n\t}\r\n\t\r\n\tprivate function getTextSprite(pName:String):TextSprite {\r\n\t\treturn cast(mainContainer.getChildByName(pName), TextSprite);\r\n\t}\r\n\t\r\n\tpublic function reset() {\r\n\t\t\r\n\t\tmainContainer.visible = false;\r\n\t\tbuildingName.text = \"\";\r\n\t\tbuildTime.text = \"\";\r\n\t\tscPrice.text = \"\";\r\n\t\thcPrice.text = \"\";\r\n\t\tdmPrice.text = \"\";\r\n\t\tdescription.text = \"\";\r\n\t\tenergy.text = \"\";\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setInfo(pBuildingType:BuildingType) {\r\n\t\t\r\n\t\tmainContainer.visible = true;\r\n\t\r\n\t\tvar h:Int = pBuildingType.buildingTime.getHours()-1;\r\n\t\tvar m:Int = pBuildingType.buildingTime.getMinutes();\r\n\t\tvar s:Int = pBuildingType.buildingTime.getSeconds();\r\n\t\tbuildingName.text = LocalizationByType.getInstance().translateFromType(pBuildingType.buildingName);\r\n\t\tbuildTime.text = \"\" + ((h>0)?h+\" H \":\"\") + ((m>0)?m+\" m \":\"\") + ((s>0)?s+\" s\":\"\");\r\n\t\tscPrice.text = \"\" + pBuildingType.softCurrencyCost;\r\n\t\thcPrice.text = \"\" + pBuildingType.hardCurrencyCost;\r\n\t\tdmPrice.text = \"\" + pBuildingType.ressourcesCost;\r\n\t\tdescription.text = \"\" + LocalizationByType.getInstance().translateFromType(pBuildingType.description);\r\n\t\tenergy.text = \"\" + pBuildingType.energyCost;\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.building.datas;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingMenuData \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe BuildingMenuData\r\n\t */\r\n\tprivate static var instance: BuildingMenuData;\r\n\t\r\n\tpublic var datas:Array<Array<BuildingMenuParams>>;\r\n\tpublic var foo:Float;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): BuildingMenuData {\r\n\t\tif (instance == null) instance = new BuildingMenuData();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function init(pBuildingMenuData: Dynamic) {\r\n\t\tdatas = pBuildingMenuData;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.buyRegion;\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.contextual.ContextualPopin;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass BuyRegion extends ContextualPopin\r\n{\r\n\tpublic var tooltip:RegionSwitch;\r\n\tpublic var yesBtn:SmartButton;\r\n\tprivate var noBtn:SmartButton;\r\n\t\r\n\tprivate var ownRegion:Region;\r\n\t\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t\t\r\n\t\ttooltip = cast(getChildByName(\"RegionSwitch\"), RegionSwitch);\r\n\t\tyesBtn = cast(getChildByName(\"btn_YesBuySC\"), SmartButton);\r\n\t\tnoBtn = cast(getChildByName(\"btn_NoBuySC\"), SmartButton);\r\n\t\ttooltip.setOwnPopin(this);\r\n\t\thideConfirmButtons();\r\n\t\t\r\n\t\tyesBtn.on(MouseEventType.CLICK, buyRegion);\r\n\t\tyesBtn.on(TouchEventType.TAP, buyRegion);\r\n\t\t\r\n\t\t//setCost();\r\n\t}\r\n\t\r\n\tpublic function setOwnRegion(pRegion:Region) {\r\n\t\r\n\t\townRegion = pRegion;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function displayCost():Void {\r\n\t\r\n\t\ttooltip.setText(World.getInstance().unlockRegionCost);\r\n\t}\r\n\t\r\n\tpublic function displayConfirmButtons():Void {\r\n\t\r\n\t\tyesBtn.visible = true;\r\n\t\t//noBtn.visible = true;\r\n\t}\r\n\t\r\n\tpublic function hideConfirmButtons():Void {\r\n\t\r\n\t\tyesBtn.visible = false;\r\n\t\tnoBtn.visible = false;\r\n\t}\r\n\t\r\n\tprivate function unlock():Void {\r\n\t\r\n\t\tif (ownRegion == null) return;\r\n\t\t\r\n\t\townRegion.unlock();\r\n\t}\r\n\t\r\n\tprivate function pay():Void {\r\n\t\r\n\t\tif (!GameManager.getInstance().godMode) {\r\n\t\t\tPlayer.getInstance().changePlayerValue(-World.getInstance().unlockRegionCost, Player.TYPE_SOFTCURRENCY, false);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function canAffortIt():Bool {\r\n\t\r\n\t\tif (GameManager.getInstance().godMode) return true;\r\n\t\telse {\r\n\t\t\r\n\t\t\tvar lHasEnoughSC:Bool = Player.getInstance().hasEnoughQuantity(World.getInstance().unlockRegionCost, Player.getInstance().softCurrency);\r\n\t\t\tif (lHasEnoughSC) return true;\r\n\t\t\telse {\r\n\t\t\t\tHud.getInstance().noSCAnimation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function buyRegion():Void {\r\n\t\r\n\t\tif (canAffortIt()) {\r\n\t\t\r\n\t\t\tpay();\r\n\t\t\tunlock();\r\n\t\t}\r\n\t}\r\n}","package com.isartdigital.ruby.ui.popin.buyRegion;\r\n\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass RegionSwitch extends Item\r\n{\r\n\tprivate var container:SmartComponent;\r\n\tpublic var text:TextSprite;\r\n\tprivate var popin:BuyRegion;\r\n\t\r\n\tprivate var counter:Int = 0;\r\n\t\r\n\tprivate var isDisplaying:Bool = false;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tcontainer = cast(getChildByName(\"ConfirmationPose_clipPriceHCInfos\"), SmartComponent);\r\n\t\ttext = cast(container.getChildByName(\"txt_SCPrice\"), TextSprite);\r\n\t}\r\n\t\r\n\tpublic function setText(pCost:Int):Void {\r\n\t\t\r\n\t\ttext.text = Std.string(pCost);\r\n\t}\r\n\t\r\n\tpublic function setOwnPopin(pPopin:BuyRegion):Void {\r\n\t\r\n\t\tpopin = pPopin;\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\r\n\t\tisDisplaying ? hide() : display();\r\n\t}\r\n\t\r\n\tprivate function display():Void {\r\n\t\r\n\t\tisDisplaying = true;\r\n\t\tpopin.displayConfirmButtons();\r\n\t}\r\n\t\r\n\tprivate function hide():Void {\r\n\t\r\n\t\tisDisplaying = false;\r\n\t\tcounter = 0;\r\n\t\tpopin.hideConfirmButtons();\r\n\t}\r\n\t\r\n\tpublic function count():Void {\r\n\t\r\n\t\tif (isDisplaying) {\r\n\t\t\t\r\n\t\t\tif (++counter >= 180) hide();\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.centreForage;\r\n\r\nimport com.isartdigital.ruby.game.player.MissionsManager;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SFGameManager;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingBuilding;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.DrillingFriendItem;\r\nimport com.isartdigital.ruby.ui.items.DrillingXenoItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.DrillingButtonSwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.MissionSwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.XenoSlotSwitchItem;\r\nimport com.isartdigital.ruby.ui.popin.Menu;\r\nimport com.isartdigital.ruby.ui.popin.contextual.BuildingContextualMenu;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureScreen;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.BuildingMenuData;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.Missions;\r\nimport com.isartdigital.ruby.ui.items.switchItems.BuildingMenuSwitchItem;\r\nimport com.isartdigital.ruby.ui.specialButtons.SlotButton;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport js.Lib;\r\nimport js.html.MouseEvent;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.extras.MovieClip;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author \r\n */\r\nclass CentreForage extends Menu \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe CentreForage\r\n\t */ \r\n\tprivate static var instance: CentreForage;\r\n\t\r\n\tprivate static inline var SLIDER:String = \"Slider\";\r\n\tprivate static inline var VERTICAL_SLIDER:String = \"VerticalSlider\";\r\n\tprivate static inline var DOWN_ARROW:String = \"btn_Fleche\";\r\n\tprivate static inline var UP_ARROW:String = \"btn_Fleche #1\";\r\n\tprivate static inline var DRILL:String = \"btn_Forage\";\r\n\tprivate static inline var CHOOSE_TEAM_BTN:String = \"\";\r\n\tprivate static inline var FRIENDS_TAB:String = \"ItemContainerFriendList\";\r\n\tprivate static inline var ALIENS_TAB:String = \"ItemContainerXenosList\";\r\n\tprivate static inline var ALIEN_CLASS:String = \"txt_CentreForageXenoClass\";\r\n\tprivate static inline var ALIEN_NAME:String = \" txt_CentreForageXenoName\";\r\n\tprivate static inline var BTN_SWITCH_XENOS_FRIEND:String = \"CentreForage_clipXenoSocial\";\r\n\t\r\n\tprivate static inline var XENO_SLOT_CONTAINER:String = \"XenoSlotContainer\";\r\n\t\r\n\tprivate static inline var MISSIONS_PANEL:String = \"CentreForage_clipMissionStats\";\r\n\tprivate static inline var MISSION_REWARDS:String = \"CentreForage_spriteReward\";\r\n\tprivate static inline var MISSION_NAME:String = \"txt_missionName\";\r\n\tprivate static inline var MISSION_CONDITION_PANEL:String = \"CentreForage_clipMissionConditions\";\r\n\tprivate static inline var MISSION_CENTERCOUNT:String = \"txt_neededCentersDisplay\";\r\n\tprivate static inline var MISSION_TIMER:String = \"txt_drillTimeDisplay\";\r\n\tprivate static inline var XENO_SLOT:String = \"Item #\";\r\n\tprivate static inline var MISSION_CONTAINER:String = \"MissionContainer\";\r\n\tprivate static inline var MISSION:String = \"Mission\";\r\n\tprivate static inline var MISSION_THUMBNAIL = \"CentreForage_spriteApercuMission\";\r\n\t\r\n\t\r\n\tprivate var missionPanelContainer:SmartComponent;\r\n\tprivate var missionConditionContainer:SmartComponent;\r\n\tprivate var missionName:TextSprite;\r\n\tprivate var missionCountCenter:TextSprite;\r\n\tprivate var missionReward:SmartComponent;\r\n\tprivate var missionTimer:TextSprite;\r\n\tprivate var missionIndex:Int = 0;\r\n\t\r\n\tprivate var xenoSlots:Array<SlotButton>;\r\n\tprivate var mission:Missions;\r\n\tprivate var xenoList:Array<AlienElement>;\r\n\t\r\n\tpublic var xenoSlotList:Array<SlotButton>;\r\n\tprivate var xenoSlotContainer:SmartComponent;\r\n\t\r\n\tprivate var offsetXenoItem:Point;\r\n\tprivate var offsetFriendItem:Point;\r\n\tprivate var offsetMissionItem:Point;\r\n\t\r\n\tprivate var drillBtn:SwitchItem;\r\n\t\r\n\tprivate var friendsTab:SmartComponent;\r\n\tprivate var xenosTab:SmartComponent;\r\n\tprivate var btnSwitchXenosSocial:SmartComponent;\r\n\tprivate var sliderContainerHorizontal:SmartComponent;\r\n\tprivate var sliderContainerVertical:SmartComponent;\r\n\tprivate var sliderHorizontal:Slider;\r\n\tprivate var arrowUp:SmartComponent;\r\n\tprivate var arrowDown:SmartComponent;\r\n\tprivate var availableMissions:Array<MissionSwitchItem>;\r\n\tprivate var missionsContainer:SmartComponent;\r\n\tprivate var firstMissionPosition:Point;\r\n\tpublic var alienSelected:AlienElement;\r\n\t\r\n\t\r\n\tprivate var sablierContainer:SmartComponent;\r\n\tprivate var spriteSablier:UISprite;\r\n\tprivate var sablierText:TextSprite;\r\n\tprivate var outpostText:TextSprite;\r\n\t\r\n\tprivate var rewardContainer:SmartComponent;\r\n\tprivate var scSprite:UISprite;\r\n\tprivate var hcSprite:UISprite;\r\n\tprivate var gene1Sprite:UISprite;\r\n\tprivate var gene2Sprite:UISprite;\r\n\tprivate var gene3Sprite:UISprite;\r\n\tprivate var gene4Sprite:UISprite;\r\n\tprivate var gene5Sprite:UISprite;\r\n\tprivate var schemaSprite:UISprite;\r\n\tprivate var mnSprite:UISprite;\r\n\tprivate var missionThumbnail:UISprite;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tprivate var maxXenosForThisMission:Int;\r\n\t\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): CentreForage {\r\n\t\tif (instance == null) instance = new CentreForage();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t}\r\n\t\r\n\toverride private function init():Void\r\n\t{\r\n\t\tsuper.init();\r\n\t\tavailableMissions = new Array<MissionSwitchItem>();\r\n\t\t\r\n\t\tsliderContainerVertical = cast(getChildByName(VERTICAL_SLIDER), SmartComponent);\r\n\t\tmissionsContainer =  cast(sliderContainerVertical.getChildByName(MISSION_CONTAINER), SmartComponent);\r\n\t\txenoSlotList = new Array<SlotButton>();\r\n\t\t\r\n\t\tinitSlider();\r\n\t\tinitFriendsTab();\r\n\t\tinitXenoItem();\r\n\t\t\r\n\t\tsliderHorizontal.init(sliderContainerHorizontal, xenosTab);\r\n\t\tdrillBtn = cast(getChildByName(DRILL), SwitchItem);\r\n\t\t\r\n\t\t\r\n\t\t//si tous les slots sont remplis\r\n\t\t\r\n\t\tdrillBtn.on(MouseEventType.CLICK, openDrillingFeature);\r\n\t\tdrillBtn.on(TouchEventType.TAP, openDrillingFeature);\r\n\t\tdrillBtn.visible = false;\r\n\t\tFTUEManager.register(drillBtn);\r\n\t\t\r\n\t\txenoList = new Array<AlienElement>();\r\n\t\t\r\n\t\t\r\n\t\tinitMissionTab();\r\n\t\tinitInfoMissionPanel();\r\n\t\tarrowUp = cast(getChildByName(UP_ARROW), SmartComponent);\r\n\t\tarrowDown = cast(getChildByName(DOWN_ARROW), SmartComponent);\r\n\t\t\r\n\t\tarrowUp.on(MouseEventType.CLICK, upMission);\r\n\t\tarrowDown.on(MouseEventType.CLICK, downMission);\r\n\t\r\n\t\tactiveXenos();\r\n\t\tupdateItems();\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t}\r\n\t\r\n\t\r\n\tpublic function onClickMission(pParams:Missions):Void\r\n\t{\r\n\t\thcSprite.visible = true;\r\n\t\tmission = pParams;\r\n\t\tmissionName.text = mission.name;\r\n\t\tmaxXenosForThisMission = mission.alienSpawner;\r\n\t\t\r\n\t\tif (missionPanelContainer.getChildByName(\"thumbnail\") != null) missionPanelContainer.removeChild(missionPanelContainer.getChildByName(\"thumbnail\"));\r\n\t\tmissionThumbnail = cast(missionPanelContainer.getChildByName(MISSION_THUMBNAIL), UISprite);\r\n\t\tvar assetThumbail:UISprite = new UISprite(\"Thumbnail_\"+StringTools.replace(mission.name,\" \",\"\"));\r\n\t\tassetThumbail.position = missionThumbnail.position.clone();\r\n\t\tassetThumbail.y -= 20;\r\n\t\tassetThumbail.name = \"thumbnail\";\r\n\t\tmissionPanelContainer.addChild(assetThumbail);\r\n\t\tmissionThumbnail.visible = false;\r\n\t\t\r\n\t\tdrillBtn.visible = true;\r\n\t\tdrillBtn.interactive = false;\r\n\t\tdrillBtn.setDisabled();\r\n\t\tinitXenoSlot();\r\n\t\tmissionPanelContainer.visible = true;\r\n\t\t\r\n\t\tif(mission.name == \"Mission 25\") outpostText.text = \"6 / 6\";\r\n\t\t\r\n\t\thcSprite.visible = true;\r\n\t\tscSprite.visible = true;\r\n\t\tschemaSprite.visible = true;\r\n\t\tmnSprite.visible = true;\r\n\t\tgene1Sprite.visible = true;\r\n\t\tgene2Sprite.visible = true;\r\n\t\tgene3Sprite.visible = true;\r\n\t\tgene4Sprite.visible = true;\r\n\t\tgene5Sprite.visible = true;\r\n\t\t\r\n\t\tif(mission.rewards.hc == 0) hcSprite.visible = false;\r\n\t\tif(mission.rewards.sc == 0) scSprite.visible = false;\r\n\t\tif(mission.rewards.darkMatter == 0) mnSprite.visible = false;\r\n\t\tif(mission.rewards.schema == 0) schemaSprite.visible = false;\r\n\t\tif(mission.rewards.gene1 == 0) gene1Sprite.visible = false;\r\n\t\tif(mission.rewards.gene2 == 0) gene2Sprite.visible = false;\r\n\t\tif(mission.rewards.gene3 == 0) gene3Sprite.visible = false;\r\n\t\tif(mission.rewards.gene4 == 0) gene4Sprite.visible = false;\r\n\t\tif(mission.rewards.gene5 == 0) gene5Sprite.visible = false;\r\n\r\n\t\t//missionCountCenter.text = \"Drilling Centers : \" + DrillingBuilding.drillingBuildingCount + \" / \" + lMission.centerRequired;\r\n\t\t//missionTimer.text = lMission.time;\r\n\t\t//missionReward * 6 boucle?*/\r\n\t}\r\n\t\r\n\tprivate function initXenoSlot() {\r\n\t\twhile (xenoSlotList.length > 0) xenoSlotList.pop();\r\n\t\t\r\n\t\txenoSlotContainer = cast(missionPanelContainer.getChildByName(XENO_SLOT_CONTAINER), SmartComponent);\r\n\t\tfor (i in 0...3)\r\n\t\t\txenoSlotList.push(cast(xenoSlotContainer.getChildByName(XENO_SLOT + i), SlotButton));\r\n\t\tfor (i in 0...xenoSlotList.length) {\r\n\t\t\txenoSlotList[i].visible = true;\r\n\t\t\txenoSlotList[i].alien = null;\r\n\t\t\tif (i > maxXenosForThisMission - 1) xenoSlotList[i].visible = false;\r\n\t\t\t\r\n\t\t}\r\n\t\tFTUEManager.register(xenoSlotList[0]);\r\n\t\tmaxXenosForThisMission++;\r\n\t}\r\n\t\r\n\r\n\tprivate function initFriendsTab() {\r\n\t\tfriendsTab = cast(sliderContainerHorizontal.getChildByName(FRIENDS_TAB), SmartComponent);\r\n\t\toffsetFriendItem = new Point(friendsTab.children[0].x - friendsTab.children[1].x, friendsTab.children[0].y - friendsTab.children[1].y);\r\n\t}\r\n\t\r\n\tprivate function initXenoItem() {\r\n\t\txenosTab =  cast(sliderContainerHorizontal.getChildByName(ALIENS_TAB), SmartComponent);\r\n\t\toffsetXenoItem = new Point(xenosTab.children[0].x - xenosTab.children[1].x, xenosTab.children[0].y - xenosTab.children[1].y);\r\n\t\tsliderHorizontal.init(sliderContainerHorizontal, xenosTab);\r\n\t}\r\n\t\r\n\tprivate function initSlider() {\r\n\t\tsliderContainerHorizontal = cast(getChildByName(SLIDER), SmartComponent);\r\n\t\tsliderHorizontal = new Slider();\r\n\t}\r\n\t\r\n\tprivate function initInfoMissionPanel():Void\r\n\t{\r\n\t\tmissionPanelContainer = cast(getChildByName(MISSIONS_PANEL), SmartComponent);\r\n\t\tmissionPanelContainer.visible = false;\r\n\t\t\r\n\t\tsablierContainer = cast(missionPanelContainer.getChildByName(\"CentreForage_clipMissionConditions\"), SmartComponent);\r\n\t\tsablierText = cast(sablierContainer.getChildByName(\"txt_drillTimeDisplay\"), TextSprite);\r\n\t\toutpostText = cast(sablierContainer.getChildByName(\"txt_neededCentersDisplay\"), TextSprite);\r\n\t\tspriteSablier = cast(sablierContainer.getChildByName(\"CentreForage_spriteCooldown\"), UISprite);\r\n\t\tspriteSablier.visible = false;\r\n\t\tsablierText.visible = false;\r\n\t\toutpostText.text = \"1 / 1\";\r\n\t\t\r\n\t\trewardContainer = cast(missionPanelContainer.getChildByName(\"RewardContainer\"), SmartComponent);\r\n\t\tscSprite = cast(rewardContainer.getChildByName(\"Calque 2\"), UISprite);\r\n\t\thcSprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #5\"), UISprite);\r\n\t\tschemaSprite = cast(rewardContainer.getChildByName(\"Calque 3\"), UISprite);\r\n\t\tmnSprite = cast(rewardContainer.getChildByName(\"Calque 4\"), UISprite);\r\n\t\tgene1Sprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #2\"), UISprite);\r\n\t\tgene2Sprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #4\"), UISprite);\r\n\t\tgene3Sprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #0\"), UISprite);\r\n\t\tgene4Sprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #1\"), UISprite);\r\n\t\tgene5Sprite = cast(rewardContainer.getChildByName(\"CentreForage_spriteReward #3\"), UISprite);\r\n\t\t\r\n\t\tmissionName = cast(missionPanelContainer.getChildByName(MISSION_NAME), TextSprite);\t\r\n\t\t\r\n\t\t\r\n\t\t//for (child in missionPanelContainer.children);\r\n\t\t\t\r\n\t}\r\n\t\r\n\t\r\n\tpublic function switchXenosSocial() {\r\n\t\tif (friendsTab.visible)\r\n\t\t\tactiveXenos();\r\n\t\telse\r\n\t\t\tactiveFriend();\r\n\t\t\t\r\n\t\tupdateItems();\r\n\t\tsliderHorizontal.update();\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function activeFriend():Void \r\n\t{\r\n\t\tfriendsTab.visible = true;\r\n\t\txenosTab.visible = false;\r\n\t\tsliderHorizontal.initContainer(sliderContainerHorizontal, friendsTab);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function initMissionTab():Void \r\n\t{\r\n\t\toffsetMissionItem = new Point(missionsContainer.children[0].x - missionsContainer.children[1].x, missionsContainer.children[0].y - missionsContainer.children[1].y);\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\tif(firstMissionPosition == null) firstMissionPosition =  missionsContainer.getChildByName(MISSION + \" #0\").position;\t\r\n\t\t\tdestroyAllChildInContainer(missionsContainer);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tupdateMission();\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function updateMission() {\r\n\t\tfor (i in 0...4) {\r\n\t\t\t\r\n\t\t\t\tavailableMissions.push(Type.createInstance(MissionSwitchItem, []));\r\n\t\t\t\tavailableMissions[i].x = firstMissionPosition.x + i * offsetMissionItem.x;\r\n\t\t\t\tavailableMissions[i].y = firstMissionPosition.y + i * offsetMissionItem.y;\r\n\t\t\t\tavailableMissions[i].setInfo(MissionsManager.getInstance().missions[missionIndex + i]);\r\n\t\t\t\tavailableMissions[i].name = \"centreForageMission\" + missionIndex + i;\r\n\t\t\t\tmissionsContainer.addChild(availableMissions[i]);\r\n\t\t\t\tFTUEManager.register(availableMissions[i]);\r\n\t\t\t}\r\n\t}\r\n\tprivate function activeXenos():Void\r\n\t{\r\n\t\tfriendsTab.visible = false;\r\n\t\txenosTab.visible = true;\r\n\t\tsliderHorizontal.initContainer(sliderContainerHorizontal, xenosTab);\r\n\t}\r\n\t\r\n    public function updateItems() {\r\n\t\tif (sliderHorizontal == null) return;\r\n\t\t\r\n\t\tif (sliderHorizontal.itemContainer == xenosTab) {\r\n\t\t\tupdateXenosItems();\r\n\t\t}else {\r\n\t\t\tupdateFriendsItems();\r\n\t\t}\r\n\t\t\r\n\t\tsliderHorizontal.update();\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tprivate function updateXenosItems() {\r\n\t\t\r\n\t\t\r\n\t\tdestroyAllChildInContainer(xenosTab);\r\n\t\t\t//reste  chercher les datas\r\n\t\t\t//faire une fonction d'initialisation pour init les objet cr via ces donne\r\n\t\tvar index:Int = 0;\r\n\t\tfor (i in 0...Alien.alienElementList.length)\r\n\t\t{\r\n\t\t\t\r\n\t\t\tif (Alien.alienElementList[i].type == \"AlienForeur\")\r\n\t\t\t{\r\n\t\t\t\tvar currentItem = new DrillingXenoItem();\r\n\t\t\t\txenosTab.addChild(currentItem);\r\n\t\t\t\tcurrentItem.initAlien(Alien.alienElementList[i]);\r\n\t\t\t\tcurrentItem.x = offsetXenoItem.x * index;\r\n\t\t\t\tcurrentItem.id = index;\r\n\t\t\t\tcurrentItem.name = \"xeno\" + index;\r\n\t\t\t\tFTUEManager.register(currentItem);\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function updateFriendsItems() {\r\n\t\tdestroyAllChildInContainer(friendsTab);\r\n\t\tif (DataManager.getInstance().alienFriendsList.length == 0) return;\t\r\n\t\tfor (i in 0...DataManager.getInstance().alienFriendsList.length) {\r\n\t\t\tvar currentItem = new DrillingFriendItem();\r\n\t\t\tcurrentItem.setAlienElem(DataManager.getInstance().alienFriendsList[i]);\r\n\t\t\tfriendsTab.addChild(currentItem);\r\n\t\t\tcurrentItem.x = offsetFriendItem.x * i;\r\n\t\t\tFTUEManager.register(currentItem);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction upMission() {\r\n\t\tmissionIndex--;\r\n\t\tif (missionIndex < 0) missionIndex = 0;\r\n\t\tupdateMission();\r\n\t}\r\n\t\r\n\tfunction downMission() {\r\n\t\tmissionIndex++;\r\n\t\ttrace((missionIndex+4) + \" \" + MissionsManager.getInstance().missions.length);\r\n\t\tif (missionIndex+4 > MissionsManager.getInstance().missions.length) missionIndex--;\r\n\t\tupdateMission();\r\n\t}\r\n/*\tprivate function closeSpecialFeature():VoidMission\r\n\t{\r\n\t\t\r\n\t}*/\r\n\t\r\n\tpublic function checkIfMissionCanBeStarted():Void {\r\n\t\r\n\t\tfor (slot in xenoSlotList)\r\n\t\t\tif (slot.alien != null) {\r\n\t\t\t\t\r\n\t\t\t\tdrillBtn.setNormal();\r\n\t\t\t\tdrillBtn.interactive = true;\r\n\t\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\r\n\tprivate function openDrillingFeature() {\r\n\t\tif (mission == null) return;\r\n\t\tSoundManager.getSound(\"soundPlayerLaunchMission\").play();\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tfor (slot in xenoSlotList) {\r\n\t\t\tif (slot.visible) {\r\n\t\t\t\txenoList.push(slot.alien);\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tSFGameManager.getInstance().init(mission, xenoList);\t\t\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.codex;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.items.switchItems.CodexSwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.CodexSwitchTab;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Codex extends Menu \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Codex\r\n\t */\r\n\tprivate static var instance: Codex;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Codex {\r\n\t\tif (instance == null) instance = new Codex();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t}\r\n\t\r\n\toverride public function open():Void \r\n\t{\r\n\t\tsuper.open();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = true;\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = false;\r\n\t}\r\n\t/**\r\n\t * Initialise le BuildingMenu, recupere tout les container\r\n\t */\r\n\toverride private function init()\r\n\t{\r\n\r\n\t\tsuper.init();\r\n\t\tinitTab(CodexSwitchTab);\r\n\t\tinitItems();\r\n\t\tftueRegister();\r\n\t\t\r\n\t}\r\n\t\r\n\t\t/**\r\n\t * stock les item du popin dans un tableau de reference\r\n\t */\r\n\toverride private function initItems() {\r\n\t\titemContainer = cast(getChildByName(ITEM_CONTAINER), SmartComponent);\r\n\t\titemContainer.interactive = true;\r\n\t\t\r\n\t\tinitOffsetBetweenItems();\r\n\t\t\r\n\t\tupdateItems();\r\n\t}\r\n\t\r\n\toverride function initOffsetBetweenItems() \r\n\t{\r\n\t\tsuper.initOffsetBetweenItems();\r\n\t\tvar lFirstItemNextLine:Point = itemContainer.getChildByName(ITEM +\" #6\").position;\r\n\t\toffsetItem.y = lFirstItemNextLine.y - firstItemPosition.y;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Crer les items et les places\r\n\t */\r\n\tpublic function updateItems() {\r\n\t\tdestroyAllChildInContainer(itemContainer);\r\n\t\tvar currentLine:Int = 0;\r\n\t\r\n\t\t\r\n\t\tfor (i in 0 ... CodexData.getInstance().listXeno.length) {\r\n\t\t\r\n\t\t\tif (i > 0 && i % 6 == 0)\r\n\t\t\t\tcurrentLine++;\r\n\t\t\t\t\r\n\t\t\tvar currentItem = new CodexSwitchItem();\r\n\t\t\titemContainer.addChild(currentItem);\r\n\t\t\tcurrentItem.setInfo(CodexData.getInstance().listXeno[i]);\r\n\t\t\tcurrentItem.x = offsetItem.x * i%6;\r\n\t\t\tcurrentItem.y = offsetItem.y * currentLine;\r\n\t\t\tcurrentItem.id = i;\r\n\t\t\tFTUEManager.register(currentItem);\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\tpublic function updateItemsByTypes(pType:String, ?pType2:String = \"\"):Void\r\n\t{\r\n\t\tdestroyAllChildInContainer(itemContainer);\r\n\t\tvar counter:Int = 0;\r\n\t\tvar currentLine:Int = 0;\r\n\t\t\r\n\t\tfor (i in 0 ... CodexData.getInstance().listXeno.length) \r\n\t\t{\r\n\t\t\tif (CodexData.getInstance().listXeno[i].type == pType || CodexData.getInstance().listXeno[i].type == pType2)\r\n\t\t\t{\r\n\t\t\t\tif (counter > 0 && counter % 6 == 0) currentLine++;\t\t\t\t\r\n\t\t\t\tvar currentItem = new CodexSwitchItem();\r\n\t\t\t\titemContainer.addChild(currentItem);\r\n\t\t\t\tcurrentItem.setInfo(CodexData.getInstance().listXeno[i]);\r\n\t\t\t\tcurrentItem.x = offsetItem.x * i%6;\r\n\t\t\t\tcurrentItem.y = offsetItem.y * currentLine;\r\n\t\t\t\tcurrentItem.id = i;\r\n\t\t\t\tFTUEManager.register(currentItem);\r\n\t\t\t\tcounter++;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.codex;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienEsthetique;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass CodexData \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe CodexData\r\n\t */\r\n\tprivate static var instance: CodexData;\r\n\t\r\n\tpublic var data:Array<XenoCodexTypedef>;\r\n\t\r\n\tpublic var listXeno:Array<XenoCodexTypedef> = new Array<XenoCodexTypedef>();\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): CodexData {\r\n\t\tif (instance == null) instance = new CodexData();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function init(pData:Dynamic) {\r\n\t\tdata = pData.xenos;\r\n\t}\r\n\t\r\n\tpublic function listAllAlienTypesInCodex():Void\r\n\t{\r\n\t\tfor (buffer in AlienBuffer.bufferTypes)\r\n\t\t{\r\n\t\t\tlistXeno.push(createNewXenoType(buffer.name, \"AlienBuffer\",buffer.nomenclature));\r\n\t\t}\r\n\t\t\r\n\t\tfor (producer in AlienProducer.prodTypes)\r\n\t\t{\r\n\t\t\tlistXeno.push(createNewXenoType(producer.name, \"AlienProducer\", producer.nomenclature));\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tfor (foreur in SpecialFeatureAliens.speFeatTypes)\r\n\t\t{\r\n\t\t\tlistXeno.push(createNewXenoType(foreur.name, \"AlienForeur\", foreur.nomenclature));\r\n\t\t}\r\n\t\t\r\n\t\tcountAlienByName();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function countAlienByName():Void\r\n\t{\r\n\t\tfor (xeno in listXeno)\r\n\t\t{\r\n\t\t\txeno.quantity = Alien.countAliensByName(xeno.name);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function createNewXenoType(pName:String, pType:String, ?pNomenclature:String = \"\", ?pQuantity:Int = 0):XenoCodexTypedef \r\n\t{\r\n\t\tvar lXeno:XenoCodexTypedef = \r\n\t\t{\r\n\t\t\tname:pName,\r\n\t\t\tquantity:pQuantity,\r\n\t\t\ttype:pType,\r\n\t\t\tnomenclature:pNomenclature\r\n\t\t}\r\n\t\treturn lXeno;\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\t//listAllAlienTypesInCodex = [];\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.contextual;\r\n\r\nimport com.greensock.easing.Quart;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienIncubator;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingBuilding;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanHeadQuarter;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanTranslation;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingCenter;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.UIManager;\r\nimport com.isartdigital.ruby.ui.popin.enclos.Enclos;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.ruby.ui.popin.translationCenter.TranslationCenter;\r\nimport com.isartdigital.ruby.ui.popin.upgradeCenter.UpgradeCenter;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.Camera;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.greensock.TimelineMax;\r\nimport com.greensock.TweenMax;\r\nimport haxe.Timer;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass BuildingContextualMenu extends ContextualPopin \r\n{\t\r\n\tprivate static inline var LEFT_CONTAINER:String = \"LeftButtonsPanel\";\r\n\t\tprivate static inline var BTN_DESTROY:String = \"btn_Destroy\";\r\n\t\tprivate static inline var BTN_MOVE:String = \"btn_Move\";\r\n\t\tprivate static inline var BTN_INFO:String = \"btn_Info\";\r\n\t\t\r\n\tprivate static inline var RIGHT_CONTAINER:String = \"RightButtonsPanel\";\r\n\t\tprivate static inline var BTN_UPGRADE:String = \"btn_Upgrade\";\r\n\t\tprivate static inline var BTN_HARVEST:String = \"btn_Harvest\";\r\n\t\tprivate static inline var BTN_FEATURE:String = \"btn_Feature\";\r\n\t\t\r\n\tprivate static inline var INFO_PANEL:String = \"InfoPanel\";\r\n\t\tprivate static inline var TEXTFIELD_NAME:String = \"txt_BuildingName\";\r\n\t\tprivate static inline var TEXTFIELD_DESCRIPTION:String = \"txt_descriptionBuilding\";\r\n\t\tprivate static inline var TEXTFIELD_LEVEL:String = \"txt_levelBuilding\";\r\n\t\t\r\n\tprivate static inline var CONFIRM_UPGRADE:String = \"ConfirmUpgrade\";\r\n\t\tprivate static inline var BTN_UPGRADE_YES:String = \"btn_YesBuyHC\";\r\n\t\tprivate static inline var BTN_UPGRADE_NO:String = \"btn_NoBuyHC\";\r\n\t\tprivate static inline var UPGRADE_COST:String = \"UpgradeCost\";\r\n\t\t\tprivate static inline var UPGRADE_TXT_CONTAINER:String = \"BuildingContextualMenu_clipCostContainer\";\r\n\t\t\t\tprivate static inline var UPGRADE_TXT_MN_COST:String = \"UpgradeBuilding_txt_MNCost\";\r\n\t\t\t\tprivate static inline var UPGRADE_TXT_SC_COST:String = \"UpgradeBuilding_txt_SCCost\";\r\n\t\t\r\n\tprivate var leftButtons:Array<SmartButton>;\r\n\tprivate var rightButtons:Array<SmartButton>;\r\n\tprivate var leftFinalPosition:Array<Point>;\r\n\tprivate var rightFinalPosition:Array<Point>;\r\n\t\r\n\tprivate var leftContainer:SmartComponent;\r\n\t\tprivate var destroyBtn:SmartButton;\r\n\t\tprivate var moveBtn:SmartButton;\r\n\t\tprivate var infoBtn:SmartButton;\r\n\t\t\r\n\tprivate var rightContainer:SmartComponent;\r\n\t\tprivate var harvestBtn:SmartButton;\r\n\t\tprivate var upgradeBtn:SmartButton;\r\n\t\tprivate var featureBtn:SmartButton;\r\n\t\t\r\n\tprivate var confirmUpgradeContainer:SmartComponent;\r\n\t\tprivate var confirmUpgradeCostContainer:SmartComponent;\r\n\t\t\tprivate var confirmUpgradeCostTextContainer:SmartComponent;\r\n\t\t\t\tprivate var mnCost:TextSprite;\r\n\t\t\t\tprivate var scCost:TextSprite;\r\n\t\tprivate var yesUpgradeBtn:SmartButton;\r\n\t\tprivate var noUpgradeBtn:SmartButton;\r\n\t\r\n\tprivate var infoContainer:SmartComponent;\r\n\t\tprivate var description:TextSprite;\r\n\t\tprivate var buildingName:TextSprite;\r\n\t\tprivate var levelBuilding:TextSprite;\r\n\t\r\n\t\t\r\n\t\tprivate var currentBuilding:Building;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe BuildingContextualMenu\r\n\t */\r\n\tprivate static var instance: BuildingContextualMenu;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): BuildingContextualMenu {\r\n\t\tif (instance == null) instance = new BuildingContextualMenu();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function init():Void {\r\n\t\t\r\n\t\tmodal = false;\r\n\t\tvisible = false;\r\n\t\tinitLeft();\r\n\t\tinitRight();\r\n\t\tinitInfoPanel();\t\r\n\t\tinitConfirmUpgrade();\t\t\r\n\t\tvisible = true;\r\n\t}\r\n\t\r\n\toverride function initPositionCenterTarget() \r\n\t{\r\n\t\tsuper.initPositionCenterTarget();\r\n\t\tcurrentBuilding = cast(target, Building);\r\n\t\tcurrentBuilding.removeHoverFilter();\r\n\t}\r\n\t\r\n\t\r\n\tprivate function initLeft() {\r\n\t\tleftButtons = new Array<SmartButton>();\r\n\t\tleftFinalPosition = new Array<Point>();\r\n\t\t\r\n\t\tleftContainer = cast(getChildByName(LEFT_CONTAINER), SmartComponent);\r\n\t\t\tmoveBtn = cast(leftContainer.getChildByName(BTN_MOVE), SmartButton);\r\n\t\t\tmoveBtn.on(MouseEventType.CLICK, moveBuilding);\r\n\t\t\tmoveBtn.on(TouchEventType.TAP, moveBuilding);\r\n\t\t\tif (Std.is(target, AlienPaddock)) moveBtn.visible = false;\r\n\t\t\t\r\n\t\t\tdestroyBtn = cast(leftContainer.getChildByName(BTN_DESTROY), SmartButton);\r\n\t\t\tdestroyBtn.on(MouseEventType.CLICK, destroyBuilding);\r\n\t\t\tdestroyBtn.on(TouchEventType.TAP, destroyBuilding);\r\n\t\t\tif (Std.is(target, UrbanHeadQuarter)) destroyBtn.visible = false;\r\n\t\t\t\r\n\t\t\tinfoBtn = cast(leftContainer.getChildByName(BTN_INFO), SmartButton);\r\n\t\t\tinfoBtn.on(MouseEventType.CLICK, showInfo);\r\n\t\t\tinfoBtn.on(TouchEventType.TAP, showInfo);\r\n\t\t\t\r\n\t\tfor (child in leftContainer.children) {\t\r\n\t\t\tleftButtons.push(cast(child, SmartButton));\r\n\t\t\tleftFinalPosition.push(child.position.clone());\r\n\t\t\tchild.x = 0;\r\n\t\t\tchild.y = 0;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function initRight() {\r\n\t\trightButtons = new Array<SmartButton>();\r\n\t\trightFinalPosition = new Array<Point>();\r\n\t\trightContainer = cast(getChildByName(RIGHT_CONTAINER), SmartComponent);\r\n\t\t\tupgradeBtn = cast(rightContainer.getChildByName(BTN_UPGRADE), SmartButton);\r\n\t\t\tupgradeBtn.on(MouseEventType.CLICK, clickUpgrade);\r\n\t\t\tupgradeBtn.on(TouchEventType.TAP, clickUpgrade);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif (target.maxLevel == target.level || Std.is(target, UrbanAntenna) || Std.is(target, AlienTrainingCenter))\r\n\t\t\t{\r\n\t\t\t\tupgradeBtn.visible = false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (Std.is(target, UrbanHeadQuarter) || target.level < Building.HQinstance.level) upgradeBtn.visible = true;\r\n\t\t\t\telse upgradeBtn.visible = false;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tfeatureBtn = cast(rightContainer.getChildByName(BTN_FEATURE), SmartButton);\r\n\t\t\tfeatureBtn.on(MouseEventType.CLICK, openFeature);\r\n\t\t\tfeatureBtn.on(TouchEventType.TAP, openFeature);\r\n\t\t\tif (!Std.is(target, DrillingCenter) && !Std.is(target, DrillingOutPost) && !Std.is(target, AlienIncubator) &&  !Std.is(target, UrbanTranslation) && !Std.is(target, AlienTrainingCenter)&& !Std.is(target, AlienPaddock))\r\n\t\t\t\tfeatureBtn.visible = false;\r\n\t\t\t\r\n\t\t\tharvestBtn = cast(rightContainer.getChildByName(BTN_HARVEST), SmartButton);\r\n\t\t\tharvestBtn.on(MouseEventType.CLICK, harvest);\r\n\t\t\tharvestBtn.on(TouchEventType.TAP, harvest);\r\n\t\t\t\r\n\t\t\tif (!Std.is(target, AlienPaddock))\r\n\t\t\t\tharvestBtn.visible = false;\r\n\t\t\t\t\r\n\t\tfor (child in rightContainer.children) {\t\r\n\t\t\trightButtons.push(cast(child, SmartButton));\r\n\t\t\trightFinalPosition.push(child.position.clone());\r\n\t\t\tchild.x = 0;\r\n\t\t\tchild.y = 0;\r\n\t\t}\r\n\t\tFTUEManager.register(featureBtn);\r\n\t\tTimer.delay(sendEvent, 500);\r\n\t}\r\n\t\r\n\tprivate function sendEvent():Void\r\n\t{\r\n\t\t\r\n\t\ttrace(\"\");// !!!! NE PAS VIRER !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n\t\tSmartPopinRegister.event.emit(\"onInit\");\r\n\t}\r\n\t\r\n\tprivate function initInfoPanel() {\r\n\t\tinfoContainer = cast(getChildByName(INFO_PANEL), SmartComponent);\r\n\t\tinfoContainer.visible = false;\r\n\t\t\tbuildingName = cast(getChildByName(TEXTFIELD_NAME), TextSprite);\r\n\t\t\t\r\n\t\t\tdescription = cast(infoContainer.getChildByName(TEXTFIELD_DESCRIPTION), TextSprite);\r\n\t\t\tdescription.text = \"\";\r\n\t\t\r\n\t\t\tlevelBuilding = cast(infoContainer.getChildByName(TEXTFIELD_LEVEL), TextSprite);\r\n\t\t\tlevelBuilding.text = \"\";\r\n\t}\r\n\t\r\n\tprivate function initConfirmUpgrade() {\r\n\t\tconfirmUpgradeContainer = cast(getChildByName(CONFIRM_UPGRADE), SmartComponent);\r\n\t\tconfirmUpgradeContainer.visible = false;\r\n\t\t\tyesUpgradeBtn = cast(confirmUpgradeContainer.getChildByName(BTN_UPGRADE_YES), SmartButton);\r\n\t\t\tyesUpgradeBtn.visible = false;\r\n\t\t\tyesUpgradeBtn.on(MouseEventType.CLICK, upgradeBuilding);\r\n\t\t\tyesUpgradeBtn.on(TouchEventType.TAP, upgradeBuilding);\r\n\t\t\tnoUpgradeBtn = cast(confirmUpgradeContainer.getChildByName(BTN_UPGRADE_NO), SmartButton);\r\n\t\t\tnoUpgradeBtn.visible = false;\r\n\t\t\tnoUpgradeBtn.on(MouseEventType.CLICK, clickUpgrade);\r\n\t\t\tnoUpgradeBtn.on(TouchEventType.TAP, clickUpgrade);\r\n\t\t\tconfirmUpgradeCostContainer = cast(confirmUpgradeContainer.getChildByName(UPGRADE_COST), SmartComponent);\r\n\t\t\t\tconfirmUpgradeCostTextContainer = cast(confirmUpgradeCostContainer.getChildByName(UPGRADE_TXT_CONTAINER), SmartComponent);\r\n\t\t\t\t\tscCost = cast(confirmUpgradeCostTextContainer.getChildByName(UPGRADE_TXT_SC_COST), TextSprite);\r\n\t\t\t\t\tmnCost = cast(confirmUpgradeCostTextContainer.getChildByName(UPGRADE_TXT_MN_COST), TextSprite);\r\n\t}\r\n\t\r\n\tpublic function update():Void \r\n\t{\r\n\t\tbuildingName.text = Std.string(currentBuilding.buildingName);\r\n\t\tdescription.text = currentBuilding.description;\r\n\t\tanimationsContainers();\r\n\t}\r\n\t\r\n\tprivate function playSFX():Void{\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t}\r\n\tpublic function animationsButtons() {\r\n\t\t\r\n\t\tplaySFX();\r\n\t\t\r\n\t\tfor (i in 0 ... leftFinalPosition.length) {\r\n\t\t\t\r\n\t\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\t\tleftButtons[i],\r\n\t\t\t\t0.2, \r\n\t\t\t\t\t{ x : leftFinalPosition[i].x, \r\n\t\t\t\t\t  y: leftFinalPosition[i].y,\r\n\t\t\t\t\t  ease:Quart.easeIn,\r\n\t\t\t\t\t  onComplete:playSFX\r\n\t\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tfor (i in 0 ... rightFinalPosition.length) {\r\n\t\t\t\r\n\t\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\t\trightButtons[i],\r\n\t\t\t\t0.2, \r\n\t\t\t\t\t{ x : rightFinalPosition[i].x, \r\n\t\t\t\t\t  y: rightFinalPosition[i].y,\r\n\t\t\t\t\t  ease:Quart.easeIn \r\n\t\t\t\t\t  \r\n\t\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function animationsContainers() {\r\n\t\tvar lLeftPoint:Point = leftContainer.position.clone();\r\n\t\tleftContainer.position = new Point(0, 0);\r\n\t\tvar lRightPoint:Point = rightContainer.position.clone();\r\n\t\trightContainer.position = new Point(0, 0);\r\n\t\t\r\n\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\tleftContainer,\r\n\t\t\t0.2, \r\n\t\t\t\t{ x : lLeftPoint.x, \r\n\t\t\t\t  y: lLeftPoint.y,\r\n\t\t\t\t  onComplete:animationsButtons,\r\n\t\t\t\t  ease:Quart.easeIn \r\n\t\t\t\t  \r\n\t\t\t\t}\r\n\t\t);\r\n\t\t\r\n\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\trightContainer,\r\n\t\t\t0.2, \r\n\t\t\t\t{ x : lRightPoint.x, \r\n\t\t\t\t  y: lRightPoint.y,\r\n\t\t\t\t  onComplete:animationsButtons,\r\n\t\t\t\t  ease:Quart.easeIn \r\n\t\t\t\t  \r\n\t\t\t\t}\r\n\t\t);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function animationsInfoPanel() {\r\n\t\t\r\n\t\tinfoContainer.scale.x = 0;\r\n\t\tinfoContainer.scale.y = 0;\r\n\t\t\r\n\t\tvar tween : TweenMax = new TweenMax(\r\n\t\t\tinfoContainer.scale,\r\n\t\t\t0.3, \r\n\t\t\t{ \r\n\t\t\t  x:1,\r\n\t\t\t  y:1,\r\n\t\t\t  ease:Quart.easeIn \r\n\t\t\t}\r\n\t\t);\t\r\n\t}\r\n\t\r\n\tpublic function animationConfirmUpgrade() {\r\n\t\tconfirmUpgradeContainer.visible = true;\r\n\t\tTweenMax.fromTo(confirmUpgradeContainer.scale, 0.2, { x :0, y:0}, { x:1, y:1} );\r\n\t}\r\n\t\r\n\tprivate function animationConfirmBtns() {\r\n\t\tyesUpgradeBtn.visible = true;\r\n\t\tnoUpgradeBtn.visible = true;\r\n\t\t\r\n\t\tTweenMax.fromTo(yesUpgradeBtn, 0.1, { x : confirmUpgradeCostContainer.x, y : confirmUpgradeCostContainer.y, alpha : 0 }, { x:yesUpgradeBtn.x, y:yesUpgradeBtn.y, alpha : 1, delay:0.2 } );\r\n\t\tTweenMax.fromTo(noUpgradeBtn, 0.1, { x : confirmUpgradeCostContainer.x, y : confirmUpgradeCostContainer.y, alpha : 0}, { x:noUpgradeBtn.x, y:noUpgradeBtn.y, alpha : 1, delay:0.2} );\r\n\t}\r\n\t\r\n\tprivate function upgradeBuilding():Void {\r\n\t\tif (currentBuilding.canAffordUpgrade()) currentBuilding.startUpgrading();\r\n\t}\r\n\t\r\n\tprivate function clickUpgrade() {\r\n\t\tif (!confirmUpgradeContainer.visible) {\r\n\t\t\tanimationConfirmUpgrade();\r\n\t\t\tanimationConfirmBtns();\r\n\t\t\tupdateConfirmInfo();\r\n\t\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\t}\r\n\t\telse confirmUpgradeContainer.visible = false;\r\n\t}\r\n\t\r\n\tprivate function updateConfirmInfo() {\r\n\t\tscCost.text = currentBuilding.costUpgradeSC+\"\";\r\n\t\tmnCost.text = currentBuilding.costUpgradeMN+\"\";\r\n\t}\r\n\t\r\n\tprivate function destroyBuilding():Void {\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tUIManager.getInstance().openPopin(Destruction.getInstance());\r\n\t}\r\n\t\r\n\tprivate function openFeature():Void \r\n\t{\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tUIManager.getInstance().closeAllPopins();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = true;\r\n        if(Std.is(target, DrillingCenter) || Std.is(target, DrillingOutPost))\r\n            UIManager.getInstance().openPopin(CentreForage.getInstance());\r\n        else if (Std.is(target, UrbanTranslation))\r\n        {\r\n            UIManager.getInstance().openPopin(TranslationCenter.getInstance());    \r\n        }\r\n        else if (Std.is(target, AlienIncubator))\r\n        {\r\n            var lCurBuilding:AlienIncubator = cast(target, AlienIncubator);\r\n            UIManager.getInstance().openPopin(Incubator.getInstance());\r\n\t\t\tIncubator.getInstance().initializationCurrentBuildingIncubator(lCurBuilding);\r\n        }\r\n\t\t\r\n\t\telse if (Std.is(target, AlienTrainingCenter))\r\n\t\t{\r\n\t\t\tvar lCurBuilding:AlienTrainingCenter = cast(target, AlienTrainingCenter);\r\n\t\t\tUpgradeCenter.getInstance().initializationCurrentBuildingTrainingCenter(lCurBuilding);\r\n\t\t\tUIManager.getInstance().openPopin(UpgradeCenter.getInstance());\r\n\t\t\t\r\n\t\t}\r\n\t\telse if (Std.is(target, AlienPaddock))\r\n        {\r\n            var lCurBuilding:AlienPaddock = cast(target, AlienPaddock);\r\n            UIManager.getInstance().openPopin(Enclos.getInstance());\r\n            Enclos.getInstance().initPopin(lCurBuilding);\r\n        }\r\n    }\r\n\t\r\n\tprivate function harvest():Void {\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tvar lApaddock:AlienPaddock = cast(target, AlienPaddock);\r\n\t\tlApaddock.setModeCollectable();\r\n\t\tlApaddock.onCollect();\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function isDestroyConfirmed():Void \r\n\t{\r\n\t\tvar SoftCurrency:Int = Std.int(Reflect.field(currentBuilding.buildingType, \"SellingCost\"));\r\n\t\tPlayer.getInstance().changePlayerValue(SoftCurrency, Player.TYPE_SOFTCURRENCY);\r\n\t\ttarget.setModeDestroy();\r\n\t}\r\n\t\r\n\tprivate function moveBuilding():Void \r\n\t{\r\n\r\n\t\tcurrentBuilding.setModeMove();\r\n\t\t//MapInteractor.getInstance().closeInfoPanel();\r\n\t}\r\n\t\r\n\tprivate function showInfo():Void {\r\n\t\tSoundManager.getSound(\"soundPlayerSwitchMode\").play();\r\n\t\tif (!infoContainer.visible) {\r\n\t\t\tinfoContainer.visible = true;\r\n\t\t\t\r\n\t\t\tdescription.text = currentBuilding.description;\r\n\t\t\tlevelBuilding.text = target.level + \" / \" + target.maxLevel;\r\n\t\t\tanimationsInfoPanel();\r\n\t\t\t//if (Std.is(currentBuilding, AlienPaddock))//show produce; \r\n\t\t\t\r\n\t\t}else\r\n\t\t\tinfoContainer.visible = false;\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tremoveAllListeners(MouseEventType.CLICK);\r\n\t\tremoveAllListeners(TouchEventType.TAP);\r\n\t\tcurrentBuilding.contextualOpened = false;\r\n\t\tsuper.close();\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tremoveAllListeners(MouseEventType.CLICK);\r\n\t\tremoveAllListeners(TouchEventType.TAP);\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.contextual;\r\nimport com.isartdigital.ruby.game.Spawner;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass YesNoPose extends ContextualPopin \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe YesNoPose\r\n\t */\r\n\tprivate static var instance: YesNoPose;\r\n\t\r\n\tprivate static inline var YES_BTN:String = \"btn_Yes\";\r\n\tprivate static inline var NO_BTN:String = \"btn_No\";\r\n\t\r\n\tprivate var yesButton:SmartButton;\r\n\tprivate var noButton:SmartButton;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): YesNoPose {\r\n\t\tif (instance == null) instance = new YesNoPose();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t\tmodal = false;\r\n\t\t\r\n\t\tyesButton = cast(getChildByName(YES_BTN),SmartButton);\r\n\t\tnoButton = cast(getChildByName(NO_BTN), SmartButton);\r\n\r\n\t\tyesButton.on(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.on(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.on(TouchEventType.TAP, onYes);\r\n\t\tnoButton.on(TouchEventType.TAP, onNo);\r\n\t}\r\n\t\r\n\tprivate function onYes()\r\n\t{\r\n\t\tSmartPopinRegister.event.emit(\"onYes\");\r\n\t\tSoundManager.getSound(\"soundPlayerFinishCreateBuilding\").play();\r\n\t\tSpawner.getInstance().onClick();\r\n\t}\r\n\r\n\tprivate function onNo()\r\n\t{\r\n\t\t\r\n\t\t\r\n\t\tSpawner.getInstance().cancel();\r\n\t\tUIManager.getInstance().closeCurrentPopin();\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tyesButton.off(MouseEventType.CLICK, onYes);\r\n\t\tnoButton.off(MouseEventType.CLICK, onNo);\r\n\r\n\t\tyesButton.off(TouchEventType.TAP, onYes);\r\n\t\tnoButton.off(TouchEventType.TAP, onNo);\r\n\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.enclos;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienPaddock;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.ruby.ui.popin.codex.XenoCodexTypedef;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Enclos extends MenuClosable \r\n{\r\n\tprivate static inline var NAME = \"txt_XenoName #\";\r\n\tprivate static inline var CONTEXTUAL_CNTNER = \"clipContextualButtonsContainer\";\r\n\tprivate static inline var LEVEL_CNTNER = \"clipLevelContainer\";\r\n\tprivate static inline var XENO_CNTNER = \"clipXenoContainer\";\r\n\t\r\n\tprivate static inline var LEVEL_PICTO = \"Enclos_clipUnitLevel #\";\r\n\tprivate static inline var LEVEL_TEXT = \"Enclos_txt_Level\";\r\n\t\r\n\tprivate static inline var XENO_SWITCH = \"Enclos_clipUnitSwitch #\";\r\n\t\r\n\tprivate static inline var BTN_MOVE = \"Enclos_btn_UnitMove\";\r\n\tprivate static inline var BTN_INFO = \"Enclos_btn_UnitXenoPage\";\r\n\tprivate static inline var BTN_FREEZE = \"Enclos_btn_UnitCryo\";\r\n\tprivate static inline var BTN_UPGRADE = \"Enclos_btn_UnitUpgrade\";\r\n\t\r\n\tpublic var alienSelected:AlienElement;\r\n\t\r\n\tprivate var nameList:Array<TextSprite>;\r\n\tprivate var lvlList:Array<TextSprite>;\r\n\tprivate var lvlPictoList:Array<SmartComponent>;\r\n\tprivate var switchList:Array<EnclosSwitchItem>;\r\n\tprivate var contextualMenu:SmartComponent;\r\n\tprivate var levelContainer:SmartComponent;\r\n\tprivate var xenoContainer:SmartComponent;\r\n\t\r\n\tprivate var currentPaddock:AlienPaddock;\r\n\t\r\n\tprivate var moveBtn:SmartButton;\r\n\tprivate var infoBtn:SmartButton;\r\n\tprivate var freezeeBtn:SmartButton;\r\n\tprivate var upgradeBtn:SmartButton;\r\n\t/**\r\n\t * instance unique de la classe Enclos\r\n\t */\r\n\tprivate static var instance: Enclos;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Enclos {\r\n\t\tif (instance == null) instance = new Enclos();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t\tinit();\r\n\t}\r\n\t\r\n\toverride function init():Void \r\n\t{\r\n\t\tsuper.init();\r\n\t\t\r\n\t\tnameList = new Array<TextSprite>();\r\n\t\tlvlList = new Array<TextSprite>();\r\n\t\tswitchList = new Array<EnclosSwitchItem>();\r\n\t\tlvlPictoList = new Array<SmartComponent>();\r\n\t\tcontextualMenu = cast(getChildByName(CONTEXTUAL_CNTNER), SmartComponent);\r\n\t\tlevelContainer = cast(getChildByName(LEVEL_CNTNER), SmartComponent);\r\n\t\txenoContainer = cast(getChildByName(XENO_CNTNER), SmartComponent);\r\n\t\t\r\n\t\tfor (i in 0...6) {\r\n\t\t\r\n\t\t\tvar lName:TextSprite = cast(getChildByName(NAME+i), TextSprite);\r\n\t\t\tnameList.push(lName);\r\n\t\t\t\r\n\t\t\tvar lLevelPicto:SmartComponent = cast(levelContainer.getChildByName(LEVEL_PICTO + i), SmartComponent);\r\n\t\t\tlvlPictoList.push(lLevelPicto);\r\n\t\t\tvar lLevelText:TextSprite = cast(lLevelPicto.getChildByName(LEVEL_TEXT), TextSprite);\r\n\t\t\tlvlList.push(lLevelText);\r\n\t\t\t\r\n\t\t\tvar lSwitch:EnclosSwitchItem = cast(xenoContainer.getChildByName(XENO_SWITCH + i), EnclosSwitchItem);\r\n\t\t\tlSwitch.setNormal();\r\n\t\t\tswitchList.push(lSwitch);\r\n\t\t}\r\n\t\t\r\n\t\tmoveBtn = cast(contextualMenu.getChildByName(BTN_MOVE), SmartButton);\r\n\t\tinfoBtn = cast(contextualMenu.getChildByName(BTN_INFO), SmartButton);\r\n\t\tfreezeeBtn = cast(contextualMenu.getChildByName(BTN_FREEZE), SmartButton);\r\n\t\tupgradeBtn = cast(contextualMenu.getChildByName(BTN_UPGRADE), SmartButton);\r\n\t\t\r\n\t\tmoveBtn.on(MouseEventType.CLICK, moveAlien);\r\n\t\tmoveBtn.on(TouchEventType.TAP, moveAlien);\r\n\t\tinfoBtn.on(MouseEventType.CLICK, infoAlien);\r\n\t\tinfoBtn.on(TouchEventType.TAP, infoAlien);\r\n\t\tfreezeeBtn.on(MouseEventType.CLICK, freezeAlien);\r\n\t\tfreezeeBtn.on(TouchEventType.TAP, freezeAlien);\r\n\t\tupgradeBtn.on(MouseEventType.CLICK, upgradeAlien);\r\n\t\tupgradeBtn.on(TouchEventType.TAP, upgradeAlien);\r\n\t\t\r\n\t\tcontextualMenu.visible = false;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\tpublic function initPopin(pPaddock:AlienPaddock):Void {\r\n\t\r\n\t\tcurrentPaddock = pPaddock;\r\n\t\t\r\n\t\tfor (i in 0...switchList.length) \r\n\t\t{\r\n\t\t\tnameList[i].text = \"Emplacement vide\";\r\n\t\t\t\r\n\t\t\tif (i > currentPaddock.room - 1) {\r\n\t\t\t\t\t\r\n\t\t\t\tswitchList[i].visible = false;\r\n\t\t\t\tnameList[i].visible = false;\r\n\t\t\t\tlvlList[i].visible = false;\r\n\t\t\t\tlvlPictoList[i].visible = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (i in 0...currentPaddock.totalAliens.length) {\r\n\t\t\r\n\t\t\tvar lAlien:AlienElement = currentPaddock.totalAliens[i];\r\n\t\t\tswitchList[i].setAlien(lAlien);\r\n\t\t\t//nameList[i].text = lAlien.nomPropre;\r\n\t\t\tnameList[i].text = lAlien.name;\r\n\t\t\tlvlList[i].text = Std.string(lAlien.level);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function positionContextualMenu(pPosition:Point):Void {\r\n\t\r\n\t\tcontextualMenu.visible = true;\r\n\t\tcontextualMenu.position = pPosition;\r\n\t}\r\n\t\r\n\t\r\n\tprivate function moveAlien():Void {\r\n\t\r\n\t\tif (alienSelected == null) return;\r\n\t\t\r\n\t\tcurrentPaddock.removeAlien(alienSelected);\r\n\t\tMapInteractor.getInstance().highLightAlienBuildings();\r\n\t}\r\n\t\r\n\tprivate function infoAlien():Void {\r\n\t\r\n\t\tif (alienSelected == null) return;\r\n\t\tUIManager.getInstance().openPopin(XenoPage.getInstance());\r\n\t\t//var lxenoType:XenoCodexTypedef = new XenoCodexTypedef();\r\n\t\t//lxenoType.name = \"trololo\";\r\n\t\t//XenoPage.getInstance().setAlienInfoToDisplay(lxenoType);\r\n\t}\r\n\t\r\n\tprivate function freezeAlien():Void {\r\n\t\r\n\t\tif (alienSelected == null) return;\r\n\t}\r\n\t\r\n\tprivate function upgradeAlien():Void {\r\n\t\r\n\t\tif (alienSelected == null) return;\r\n\t}\r\n\t\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = false;\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.enclos;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass EnclosSwitchItem extends SwitchGroupItem\r\n{\r\n\tpublic var alien: AlienElement;\r\n\tprivate var asset:UISprite;\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tonOff();\r\n\t\tprefix = \"XenosThumbnail_\";\r\n\t\tasset = cast(currentState.getChildByName(\"asset\"), UISprite);\r\n\t\tasset.visible = false;\r\n\t\tbtnNormal.interactive = false;\r\n\t\taddStateSuffix = true;\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\t\r\n\t\t\r\n\t\tsuper.setSelected();\r\n\t\tEnclos.getInstance().alienSelected = alien;\r\n\t\tEnclos.getInstance().positionContextualMenu(position);\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\toverride function onDown():Void \r\n\t{\r\n\t\tsuper.onDown();\r\n\t\tsetAsset();\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\tpublic function setAlien(pAlienElem):Void {\r\n\t\r\n\t\talien = pAlienElem;\r\n\t\tassetName = alien.name;\r\n\t\tsetAsset();\r\n\t\t//asset.visible = true;\r\n\t\tbtnNormal.interactive = true;\r\n\t\tonListen();\r\n\t}\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass GeneButton extends SwitchGroupItem\r\n{\r\n\t\r\n\tprivate static inline var TEXT_QUANTITY:String = \"txt_geneQuantity\";\r\n\tpublic var quantity:Int;\r\n\tprivate var textQuantity:TextSprite;\r\n\tprivate var geneAsset:UISprite;\r\n\tpublic var idGene:Int;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t/*Incubator.arrayGeneButton.push(this);\r\n\t\t\r\n\t\ton(MouseEventType.CLICK, changeIncubatorCurrentGeneButton);\r\n\t\ton(TouchEventType.TAP, \t changeIncubatorCurrentGeneButton);*/\r\n\t\t/*interactive = false;\r\n\t\tbuttonMode = false;*/\r\n\t}\r\n\t\r\n\t\r\n\tpublic function initSup():Void\r\n\t{\r\n\t\tgeneAsset = new UISprite(\"IncubatorGene\" + idGene);\r\n\t\tquantity = Reflect.getProperty(Player.getInstance(), \"gene\" + idGene);\r\n\t\tcurrentState.addChild(geneAsset);\r\n\t}\r\n\t\r\n\tpublic function updateQuantityGene():Void\r\n\t{\r\n\t\tquantity = Reflect.getProperty(Player.getInstance(), \"gene\" + idGene);\r\n\t}\r\n\t\r\n\tprivate function setInfo() {\r\n\t\ttextQuantity = cast(currentState.getChildByName(TEXT_QUANTITY), TextSprite);\r\n\t\ttextQuantity.text = Std.string(quantity);\r\n\t\tif (geneAsset == null || currentState == null) return;\r\n \t\tif (currentState.children.indexOf(geneAsset) == -1) currentState.addChild(geneAsset);\r\n\r\n\t}\r\n\t\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tsetInfo();\r\n\t}\r\n\t\r\n\toverride public function setDisabled() \r\n\t{\r\n\t\tsuper.setDisabled();\r\n\t\tsetInfo();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\t//super.setSelected();\r\n\t\tsetInfo();\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\t/*super.monClick();\r\n\t\tIncubator.getInstance().geneSelected = idGene;\r\n\t\tIncubator.getInstance().quantityMax = quantity;*/\r\n\t\tsetInfo();\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\t//super.onOver();\r\n\t\tsetInfo();\r\n\t}\t\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\t//super.onOut();\r\n\t\tsetInfo();\r\n\t}\r\n\t\r\n\tprivate function changeIncubatorCurrentGeneButton():Void\r\n\t{\r\n\t\t\r\n\t\t/*geneNumber = cast(Std.parseInt(this.name.split(\"\").pop()), UInt);\r\n\t\tIncubator.getInstance().currentGeneButton = this;\r\n\t\tIncubator.getInstance().checkSpotAndGene();*/\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\n\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport haxe.ds.ArraySort;\r\nimport pixi.flump.Sprite;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass GeneSpot extends SwitchGroupItem\r\n{\r\n\tprivate var NAME:String = \"ItemName\";\r\n\tprivate var textSpot(default, null):TextSprite;\r\n\tprivate var assetGene:UISprite;\r\n\tpublic var geneId:Int;\r\n\tpublic var geneQuant:Int;\r\n\tpublic var isSelected:Bool = false;\r\n\tpublic var inseminator:Inseminator;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\tfunction updateTextChild() {\r\n\t\ttextSpot = cast(getChildByName(NAME), TextSprite);\r\n\t}\r\n\t\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\r\n\t\r\n\toverride public function setDisabled() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\tupdateTextChild();\r\n\t\tupdate(true);\r\n\t}\r\n\t\r\n\tpublic function initGene(pGene:Int):Void\r\n\t{\r\n\t\tgeneId = pGene;\r\n\t\tsetNormal();\r\n\t\ttextSpot.text = \"\";\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tupdateTextChild();\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tpublic function update(?isSelected = false) {\r\n\t\tif (geneId == null) return;\r\n\t\tif (geneQuant != null) textSpot.text = Std.string(geneQuant);\r\n\t\tif (assetGene != null && !isSelected) currentState.addChild(assetGene);\r\n\t}\r\n\t\r\n\toverride function monClick():Void \r\n\t{\r\n\t\tsuper.monClick();\t\t\r\n\t\tif (Incubator.getInstance().geneSelected == geneId && Incubator.getInstance().quantityMax >= geneQuant)\r\n\t\t{\r\n\t\t\tisSelected = true;\r\n\t\t\tsetSelected();\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tfor (gene in inseminator.listGenoSpot) {\r\n\t\t\t    setNormal();\r\n\t\t\t\tgene.isSelected = false;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tpublic function setInfoGene(pId:Int, pQuant:Int):Void\r\n\t{\r\n\t\tgeneId = pId;\r\n\t\tgeneQuant = pQuant;\r\n\t\tassetGene = new UISprite(\"IncubatorGene\" + pId);\r\n\t\tisSelected = true;\r\n\t\tupdate();\r\n\t}\r\n\t\r\n\tpublic function unsetInfoGene():Void\r\n\t{\r\n\t\tgeneId = null;\r\n\t\tgeneQuant = null;\r\n\t\tisSelected = false;\r\n\t\tupdate();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienIncubator;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienEsthetique;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.translationClass.Schemas;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.popin.incubator.GeneButton;\r\nimport com.isartdigital.ruby.ui.popin.incubator.GeneSpot;\r\nimport com.isartdigital.ruby.ui.popin.Menu;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport haxe.ds.ArraySort;\r\nimport haxe.ds.Vector;\r\nimport js.Lib;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\n\r\ntypedef CurrentAlienIncubator=\r\n{\r\n\tvar alienIncubator:AlienIncubator;\r\n\tvar alienIncubatorId:String;\r\n\tvar alienIncubatorLevel:Int;\r\n\tvar alienIncubatorCurrentAlien1:AlienCarac;\r\n\tvar alienIncubatorCurrentAlien2:AlienCarac;\r\n}\r\nclass Incubator extends Menu\r\n{\r\n\t\r\n\t/****** REWORK DES VARIABLES ******/\r\n\t\r\n\t/** STRING **/\r\n\t\r\n\t//CONTAINERS\r\n\tprivate static var GENE_CONTAINER:String = \"GeneContainer\";\r\n\tprivate var INSEMINATE_CONTAINER:String = \"Incubator\";\r\n\tprivate static var SCHEMA_CONTAINER:String = \"SchemaContainer\";\r\n\tprivate static var FILTER_CONTAINER:String = \"TabContainer\";\r\n\tprivate var FILTER_BUTTON:String = \"TabSwitch2\";\r\n\tprivate var SCHEMA_BUTTON:String = \"Incubator_clipSwitchSchema\";\r\n\t\r\n\tprivate var TXT_GENE:String = \"txt_Genes\";\r\n\r\n\tpublic static var listSchema:Map<String, IncubatorSchema> = new Map<String, IncubatorSchema>();\t\r\n\tprivate var geneContainer:SmartComponent;\r\n\tprivate var currentBuilding:AlienIncubator;\r\n\tprivate var schemaContainer:SmartComponent;\r\n\tprivate var offsetSchemaItem:Point;\r\n\tprivate var availableSchema:Array<SchemaSwitchItem>;\r\n\t\r\n\tprivate var inseminator1:Inseminator;\r\n\tprivate var inseminator2:Inseminator;\r\n\t\r\n\tpublic var geneSelected:Int;\r\n\tpublic var quantityMax:Int;\r\n\t\r\n\tpublic var listGeneBtn:Array<GeneButton>;\r\n\r\n\t/**\r\n\t * instance unique de la classe Incubator\r\n\t */\r\n\tprivate static var instance: Incubator;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Incubator\r\n\t{\r\n\t\tif (instance == null) instance = new Incubator();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t}\r\n\r\n\toverride function init()\r\n\t{\r\n\t\tsuper.init();\r\n\t\t\r\n\t\tavailableSchema = new Array<SchemaSwitchItem>();\r\n\t\tgeneContainer = cast(getChildByName(GENE_CONTAINER), SmartComponent);\r\n\t\tschemaContainer = cast(getChildByName(SCHEMA_CONTAINER), SmartComponent);\r\n\t\t\r\n\t\tinitSchemaList();\r\n\t\tlistGeneBtn = new Array<GeneButton>();\r\n\t\tvar currentGene : GeneButton;\r\n\t\tfor (i in 0 ... geneContainer.children.length) {\r\n\t\t\tif (geneContainer.children[i].name.substr(0, 4) == \"Gene\")\r\n\t\t\t{\r\n\t\t\t\tcurrentGene = cast(geneContainer.children[i], GeneButton);\r\n\t\t\t\tcurrentGene.init();\r\n\t\t\t\tcurrentGene.idGene = i + 1;\r\n\t\t\t\tcurrentGene.initSup();\r\n\t\t\t\tlistGeneBtn.push(currentGene);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tinitInseminators();\r\n\t}\r\n\tprivate function initSchemaButtons():Void\r\n\t{\r\n\t\tvar currentGene : GeneButton;\r\n\t\tfor (i in 0 ... schemaContainer.children.length) {\r\n\t\t\tcurrentGene = cast(geneContainer.children[i], GeneButton);\r\n\t\t\tcurrentGene.id = i+1;\r\n\t\t\tcurrentGene.init();\r\n\t\t}\r\n\t}\r\n\tprivate function newSchemaButton(pContainer:SmartComponent, pSchema:IncubatorSchema, pID:Int, pFirstOffSet:Point):Void\r\n\t{\r\n\t\tavailableSchema.push(Type.createInstance(SchemaSwitchItem, []));\r\n\t\tavailableSchema[pID].x = pFirstOffSet.x + pID * offsetSchemaItem.x;\r\n\t\tavailableSchema[pID].y = pFirstOffSet.y + pID * offsetSchemaItem.y;\r\n\t\tavailableSchema[pID].setInfo(pSchema);\r\n\t\tavailableSchema[pID].name = \"IncubatorSchema\" + pID;\r\n\t\tschemaContainer.addChild(availableSchema[pID]);\r\n\t\tFTUEManager.register(availableSchema[pID]);\r\n\t}\r\n\tprivate function initSchemaList():Void\r\n\t{\t\r\n\t\toffsetSchemaItem = new Point(schemaContainer.children[0].x - schemaContainer.children[1].x, schemaContainer.children[0].y - schemaContainer.children[1].y);\r\n\t\tvar lFirstItemPosition:Point =  schemaContainer.getChildByName(\"Schema #0\").position;\r\n\t\tdestroyAllChildInContainer(schemaContainer);\r\n\t\t\r\n\t\tvar lList:Array<Schemas> = DataManager.getInstance().getUnlockedSchemas();\r\n\t\tvar lSchema:IncubatorSchema;\r\n\t\tfor (i in 0...lList.length) \r\n\t\t{\r\n\t\t\tif(i > 4) break;\r\n\t\t\tlSchema = listSchema.get(Std.string(lList[i].idSchema));\r\n\t\t\tnewSchemaButton(schemaContainer, lSchema, i, lFirstItemPosition);\r\n\t\t\t//var lSprite:UISprite = \r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function initInseminators():Void\r\n\t{\r\n\t\tinseminator1 = cast(getChildByName(\"Incubator #0\"), Inseminator);\r\n\t\tinseminator2 = cast(getChildByName(\"Incubator #1\"), Inseminator);\r\n\t\tinseminator1.init();\r\n\t\tinseminator2.init();\r\n\t}\r\n\r\n\tpublic function initializationCurrentBuildingIncubator(pAlienIncubator:AlienIncubator):Void\r\n\t{\r\n\t\tcurrentBuilding = pAlienIncubator;\r\n\t\tinitAlienInIncubator();\r\n\t}\r\n\t\r\n\tpublic function onClickSchema(pInfo:IncubatorSchema)\r\n\t{\r\n\t\tif (!inseminator1.isBusy) inseminator1.setInfo(pInfo);\r\n\t\telse if (!inseminator2.isBusy) inseminator2.setInfo(pInfo);\r\n\t\telse return;\r\n\t}\r\n\r\n\tprivate function checkQuantity(pKey:IncubatorSchema):Bool\r\n\t{\r\n\t\tvar quantity1:Int= Reflect.getProperty(Player.getInstance(), \"gene\" + pKey.gene1);\r\n\t\tvar quantity2:Int= Reflect.getProperty(Player.getInstance(), \"gene\" + pKey.gene2);\r\n\t\tvar quantity3:Int= Reflect.getProperty(Player.getInstance(), \"gene\" + pKey.gene2);\r\n\t\tif (quantity1 >= 100 && quantity2 >= 100 && quantity3 >= 100 )\r\n\t\t{\r\n\t\t\tquantity1 -= 100;\r\n\t\t\tquantity2 -= 100;\r\n\t\t\tquantity3 -= 100;\r\n\t\t\tReflect.setProperty(Player.getInstance(), \"gene\" + pKey.gene1, quantity1);\r\n\t\t\tReflect.setProperty(Player.getInstance(), \"gene\" + pKey.gene2, quantity2);\r\n\t\t\tReflect.setProperty(Player.getInstance(), \"gene\" + pKey.gene3, quantity3);\r\n\r\n\t\t\tvar txtNumberGene:TextSprite = cast(getChildByName(\"txt_gene\" +  pKey.gene1 + \"Quantity\"), TextSprite);\r\n\t\t\ttxtNumberGene.text = Std.string(quantity1);\r\n\r\n\t\t\tvar txtNumberGene:TextSprite = cast(getChildByName(\"txt_gene\" +  pKey.gene2+ \"Quantity\"), TextSprite);\r\n\t\t\ttxtNumberGene.text = Std.string(quantity2);\r\n\r\n\t\t\tvar txtNumberGene:TextSprite = cast(getChildByName(\"txt_gene\" +  pKey.gene3 + \"Quantity\"), TextSprite);\r\n\t\t\ttxtNumberGene.text = Std.string(quantity3);\r\n\r\n\t\t\tDataBaseAction.getInstance().updateGene();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic function createAlien(pInfo:IncubatorSchema, pInsemitaor:Inseminator):Void\r\n\t{\r\n\t\tvar lString:String = pInfo.tableXenos == \"SpecialFeatureAliens\"? \"AlienForeur\":pInfo.tableXenos;\r\n\t\tvar lType:Dynamic = Alien.getAlienType(pInfo.type, DataManager.getInstance().getAlienArray(lString));\r\n\t\tvar alienID:String = pInfo.type+Date.now().getTime();\r\n\t\tvar lDate:Date = Date.fromString(lType.time);\r\n\t\tvar lTimeStamp:Float = TimeManager.getInstance().convertInStamp(lDate.getSeconds(), lDate.getMinutes(), lDate.getHours()-1);\r\n\t\tvar lDelta:Date = DateTools.delta(Date.now(), lTimeStamp);\r\n\t\tvar lAlien:AlienElement =\r\n\t\t{\r\n\t\t\tidAlien:alienID,\r\n\t\t\tidBuilding:currentBuilding.instanceID,\r\n\t\t\tmode:\"Constructing\",\r\n\t\t\tname:pInfo.type,\r\n\t\t\ttype:lString,\r\n\t\t\tnomPropre:pInfo.xenoName,\r\n\t\t\tstamina:6,\r\n\t\t\tlevel:1,\r\n\t\t\tstartTime:Date.now().toString(),\r\n\t\t\tendTime:lDelta.toString(),\r\n\t\t\tcarac:lType,\r\n\t\t\tidPlayer:Player.getInstance().id\r\n\t\t}\r\n\t\tAlien.alienElementList.push(lAlien);\r\n\t\tDataBaseAction.getInstance().addAlien(lAlien.idAlien, lAlien.idBuilding, lAlien.type, lAlien.name, lAlien.nomPropre, lAlien.stamina, lType.time);\t\t\r\n\t\tpInsemitaor.setTime(lAlien.endTime, lAlien);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function initAlienInIncubator():Void\r\n\t{\r\n\t\tvar counter:Int = 0;\r\n\t\tvar lInseminator:Inseminator;\r\n\t\tfor (alien in Alien.alienElementList) \r\n\t\t{\r\n\t\t\tif (counter >= 2) break;\r\n\t\t\tif (alien.idBuilding == currentBuilding.instanceID) \r\n\t\t\t{\r\n\t\t\t\tlInseminator = counter == 0? inseminator1:inseminator2;\r\n\t\t\t\tlInseminator.setAlien(alien);\r\n\t\t\t\tcounter++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = false;\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.core.sprites.Sprite;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass Inseminator extends SmartComponent\r\n{\r\n\t\r\n\tpublic static var list:Array<Inseminator> = new Array<Inseminator>();\r\n\t\r\n\tprivate var SPOT_CONTAINER:String = \"spotContainer\";\r\n\tprivate var RESULTAT:String = \"resultat\";\r\n\tprivate var XENO_NAME:String = \"xenoName\";\r\n\tprivate var XENO_TEXTNAME:String = \"txt_xenoNameUpgrading\";\r\n\tprivate var INSEMINATE_BUTTON:String = \"inseminateBtn\";\r\n\tprivate var INSEMINATE_TIME_TEXT:String = \"txt_timer\";\r\n\tprivate var SKIP_BUTTON:String = \"skipBtn\";\r\n\tprivate var MANAGE_BUTTON:String = \"manageBtn\";\r\n\t\r\n\tprivate var result:UISprite;\r\n\tprivate var spotContainer:SmartComponent;\r\n\tprivate var manageBtn:SmartButton;\r\n\tprivate var skipBtn:SmartButton;\r\n\tprivate var inseminateBtn:TimerIncubator;\r\n\tprivate var inseminateTimeText:TextSprite;\r\n\tprivate var xenoName:SmartComponent;\r\n\tprivate var xenoTextName:TextSprite;\r\n\tprivate var xenoSprite:UISprite;\r\n\t\r\n\tpublic var listGenoSpot:Array<GeneSpot>;\r\n\tpublic var isBusy:Bool = false;\r\n\tpublic var geneInfo:IncubatorSchema;\r\n\tpublic var endTime:String;\r\n\t\r\n\tprivate var alien:AlienElement;\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\tpublic function init():Void {\r\n\t\tlist.push(this);\r\n\t\tresult = cast(getChildByName(RESULTAT), UISprite);\r\n\t\tspotContainer = cast(getChildByName(SPOT_CONTAINER), SmartComponent);\r\n\t\txenoName = cast(getChildByName(XENO_NAME), SmartComponent);\r\n\t\txenoTextName = cast(xenoName.getChildByName(XENO_TEXTNAME), TextSprite);\r\n\t\tinseminateBtn = cast(getChildByName(INSEMINATE_BUTTON), TimerIncubator);\r\n\t\tinseminateTimeText = cast(inseminateBtn.getChildByName(INSEMINATE_TIME_TEXT), TextSprite);\r\n\t\tskipBtn = cast(getChildByName(SKIP_BUTTON), SmartButton);\r\n\t\tmanageBtn = cast(getChildByName(MANAGE_BUTTON), SmartButton);\t\r\n\t\t\r\n\t\tstockGeneSpot();\r\n\t\tif (!isBusy)\r\n\t\t{\r\n\t\t\tmanageBtn.visible = false;\r\n\t\t\tskipBtn.visible = false;\r\n\t\t\tinseminateTimeText.textField.text = \"\";\r\n\t\t\t//inseminateTimeText.visible = false;\r\n\t\t\txenoTextName.text = \"\";\r\n\t\t\tinseminateBtn.on(MouseEventType.CLICK, onInseminate);\r\n\t\t\tinseminateBtn.on(TouchEventType.TAP, onInseminate);\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\tprivate function stockGeneSpot():Void\r\n\t{\r\n\t\tlistGenoSpot = new Array<GeneSpot>();\r\n\t\tfor (i in 0...spotContainer.children.length) \r\n\t\t{\r\n\t\t\tlistGenoSpot.push(cast(spotContainer.children[i], GeneSpot));\r\n\t\t\tlistGenoSpot[i].inseminator = this;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function isGenesFilled():Bool\r\n\t{\r\n\t\tfor (spot in listGenoSpot) if (!spot.isSelected) return false;\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\tprivate function lockGeneSpot():Void\r\n\t{\r\n\t\tfor (spot in listGenoSpot) spot.visible = false;\r\n\t}\r\n\r\n\tprivate function onInseminate():Void\r\n\t{\r\n\t\tif (!isGenesFilled()) return;\r\n\t\tlockGeneSpot();\r\n\t\tisBusy = true;\r\n\t\tupdatePlayerGene();\r\n\t\tIncubator.getInstance().createAlien(geneInfo, this);\r\n\t}\r\n\t\r\n\tprivate function updatePlayerGene():Void\r\n\t{\r\n\t\tvar lGene:Int;\r\n\t\tfor (gene in listGenoSpot) \r\n\t\t{\r\n\t\t\tlGene = Std.int(Reflect.getProperty(Player.getInstance(), \"gene\" + gene.geneId)) - gene.geneQuant;\r\n\t\t\tReflect.setProperty(Player.getInstance(), \"gene\" + gene.geneId, lGene);\r\n\t\t}\r\n\t\tDataBaseAction.getInstance().updateGene();\r\n\t\tfor (geneBtn in Incubator.getInstance().listGeneBtn) geneBtn.updateQuantityGene();\r\n\t}\r\n\t\r\n\tpublic function setInfo(pInfo:IncubatorSchema):Void\r\n\t{\r\n\t\tvar lString:String;\r\n\t\tgeneInfo = pInfo;\r\n\t\tlistGenoSpot[0].setInfoGene(pInfo.gene1, pInfo.gene1quant);\r\n\t\tlistGenoSpot[1].setInfoGene(pInfo.gene2, pInfo.gene2quant);\r\n\t\tlistGenoSpot[2].setInfoGene(pInfo.gene3, pInfo.gene3quant);\t\r\n\t\t\r\n\t\txenoTextName.text = pInfo.xenoName; // a changer, pas les bons noms\r\n\t\tif (xenoSprite != null) result.removeChild(xenoSprite);\r\n\t\t\r\n\t\txenoSprite = new UISprite(\"XenoPage_\" + pInfo.type + (pInfo.tableXenos == \"SpecialFeatureAliens\" ? \"\" :\"_1\"));\r\n\t\tresult.addChild(xenoSprite);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function isSkiped():Void\r\n\t{\r\n\t\tendTime = null;\r\n\t\talien.endTime = Date.now().toString();\r\n\t\tDataBaseAction.getInstance().releaseAlienMode(alien.idAlien, \"Wait\", Date.now());\r\n\t}\r\n\t\r\n\tpublic function isTransfered():Void\r\n\t{\t\r\n\t\tresult.removeChild(xenoSprite);\r\n\t\txenoTextName.text = \"\";\r\n\t\tendTime = null;\r\n\t\tfor (gene in listGenoSpot)\r\n\t\t{\r\n\t\t\tgene.unsetInfoGene();\r\n\t\t\tgene.visible = true;\r\n\t\t}\r\n\t\tisBusy = false;\r\n\t\ttrace(alien);\r\n\t\talien.idBuilding = \"\";\r\n\t\talien.endTime = Date.now().toString();\r\n\t\tinseminateBtn.on(MouseEventType.CLICK, onInseminate);\r\n\t\tinseminateBtn.on(TouchEventType.TAP, onInseminate);\r\n\t}\r\n\t\r\n\tpublic function setAlien(pAlien:AlienElement):Void\r\n\t{\r\n\t\tisBusy = true;\r\n\t\talien = pAlien;\r\n\t\tlockGeneSpot();\r\n\t\txenoTextName.textField.text = pAlien.nomPropre;\r\n\t\ttrace(pAlien);\r\n\t\txenoSprite = new UISprite(\"XenoPage_\" + pAlien.name + (pAlien.type == \"AlienForeur\" ? \"\" :\"_1\"));\r\n\t\tresult.addChild(xenoSprite);\r\n\t\tif (Date.fromString(pAlien.endTime).getTime() < Date.now().getTime()) \r\n\t\t{\r\n\t\t\tinseminateBtn.visible = false;\r\n\t\t\tmanageBtn.visible = true;\r\n\t\t}\r\n\t\telse setTime(pAlien.endTime, pAlien);\r\n\t}\r\n\r\n\tpublic function setTime(pTime:String, pAlien:AlienElement):Void\r\n\t{\r\n\t\talien = pAlien;\r\n\t\tendTime = pTime;\r\n\t\tinseminateBtn.off(MouseEventType.CLICK, onInseminate);\r\n\t\tinseminateBtn.off(TouchEventType.TAP, onInseminate);\r\n\t\t//inseminateTimeText.visible = true;\r\n\t\tvar lTime:String = TimeManager.getInstance().getTimeToFinishBuildingStringFormat(Date.fromString(pTime));\r\n\t\t//inseminateTimeText.textField.text = lTime;\r\n\t\tinseminateBtn.currentText = lTime;\r\n\t\tinseminateBtn.initText(this);\r\n\t}\r\n\t\r\n\tpublic function doAction():Void\r\n\t{\r\n\t\tif (endTime == null || inseminateTimeText == null) return;\r\n\t\tinseminateBtn.currentText = TimeManager.getInstance().getTimeToFinishBuildingStringFormat(Date.fromString(endTime));\r\n\t\tinseminateBtn.updateText();\r\n\t\t//inseminateTimeText.textField.text = TimeManager.getInstance().getTimeToFinishBuildingStringFormat(Date.fromString(endTime));\r\n\t}\r\n\t\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tlist.remove(this);\r\n\t\tsuper.destroy();\r\n\t\tinseminateBtn.off(MouseEventType.CLICK, onInseminate);\r\n\t\tinseminateBtn.off(TouchEventType.TAP, onInseminate);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\n\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchGroupItem;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass SchemaSwitchItem extends SwitchGroupItem\r\n{\r\n\tprivate static var NAME = \"txt_xenoName\";\r\n\tprivate static var ASSET = \"asset\";\r\n\t\r\n\tprivate var nameText:TextSprite;\r\n\tprivate var assetSchema:UISprite;\r\n\t\r\n\tprivate var schemaInfo:IncubatorSchema;\r\n\t\r\n\t\r\n\r\n\tpublic function new(pID:String=null) {\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n\t\r\n\toverride public function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\t\r\n\t\t/*assetSchema = cast(getChildByName(ASSET),UISprite);\r\n\t\tassetSchema.visible = false;*/\r\n\t}\r\n\tpublic function setInfo(pParams:IncubatorSchema):Void {\r\n\t\r\n\t\tschemaInfo = pParams;\r\n\t\tsetNormal();\r\n\t}\r\n\t\r\n\tprivate function updateInfo() {\r\n\t\tif (schemaInfo == null) return;\r\n\t\tnameText.text = schemaInfo.type;\r\n\t}\r\n\toverride public function setNormal() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride public function setDisabled() \r\n\t{\r\n\t\tsuper.setDisabled();\r\n\t\t\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride public function setSelected() \r\n\t{\r\n\t\tsuper.setNormal();\r\n\t\t//CentreForage.getInstance().onClickMission(missionParams);\r\n\t\tIncubator.getInstance().onClickSchema(schemaInfo);\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tsuper.onOver();\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tsuper.onOut();\r\n\t\tupdateTextChild();\r\n\t\tupdateInfo();\r\n\t}\r\n\t\r\n\tfunction updateTextChild() {\r\n\t\tnameText = cast(currentState.getChildByName(NAME), TextSprite);\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui.smart;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass SmartButton extends SmartComponent\r\n{\r\n\r\n\tprivate var box:DisplayObject;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = false;\r\n\t\tinteractive = true;\r\n\t\tbuttonMode = true;\r\n\t\t\r\n\t\ton(MouseEventType.MOUSE_OVER, _mouseOver);\r\n\t\ton(MouseEventType.MOUSE_DOWN, _mouseDown);\r\n\t\ton(MouseEventType.CLICK, _click);\r\n\t\ton(MouseEventType.MOUSE_OUT, _mouseOut);\r\n\t\ton(MouseEventType.MOUSE_UP_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t\ton(TouchEventType.TOUCH_START, _mouseDown);\r\n\t\ton(TouchEventType.TAP, _click);\r\n\t\ton(TouchEventType.TOUCH_END, _mouseOut);\r\n\t\ton(TouchEventType.TOUCH_END_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function registerClick (pCallBack:EventTarget->Void):Void {\r\n\t\ton(MouseEventType.CLICK, pCallBack);\r\n\t\ton(TouchEventType.TAP, pCallBack);\r\n\t}\r\n\t\r\n\tpublic function unregisterClick (pCallBack:EventTarget->Void):Void {\r\n\t\toff(MouseEventType.CLICK, pCallBack);\r\n\t\toff(TouchEventType.TAP, pCallBack);\r\n\t}\r\n\t\r\n\toverride public function build(pFrame:Int = 0):Void \r\n\t{\r\n\t\tsuper.build(3);\t\t\r\n\t\thitArea = getBounds().clone();\r\n\t\t_mouseOut();\r\n\t}\r\n\t\r\n\tpublic function overBuild(pFrame:Int):Void {\r\n\t\tclear();\r\n\t\tsuper.build(pFrame);\r\n\t}\r\n\t\r\n\tprivate function clear(): Void {\r\n\t\twhile (children.length > 0) removeChildAt(0);\r\n\t}\r\n\t\r\n\tprivate function _click (pEvent:EventTarget=null): Void {\r\n\t\t_mouseOut();\r\n\t}\t\r\n\t\r\n\tprivate function _mouseDown (pEvent:EventTarget=null): Void {\r\n\t\tclear();\r\n\t\tsuper.build(2);\r\n\t}\r\n\t\r\n\tprivate function _mouseOver (pEvent:EventTarget=null): Void {\r\n\t\tclear();\r\n\t\tSoundManager.getSound(\"soundPlayerClic\").play();\r\n\t\tsuper.build(1);\r\n\t}\r\n\t\r\n\tprivate function _mouseOut (pEvent:EventTarget=null): Void {\r\n\t\tclear();\r\n\t\tsuper.build();\r\n\t}\r\n\t\r\n\toverride public function destroy ():Void {\r\n\t\t\r\n\t\toff(MouseEventType.MOUSE_OVER, _mouseOver);\r\n\t\toff(MouseEventType.MOUSE_DOWN, _mouseDown);\r\n\t\toff(MouseEventType.CLICK, _click);\r\n\t\toff(MouseEventType.MOUSE_OUT, _mouseOut);\r\n\t\toff(MouseEventType.MOUSE_UP_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t\toff(TouchEventType.TOUCH_START, _mouseDown);\r\n\t\toff(TouchEventType.TAP, _click);\r\n\t\toff(TouchEventType.TOUCH_END, _mouseOut);\r\n\t\toff(TouchEventType.TOUCH_END_OUTSIDE, _mouseOut);\r\n\r\n\t\tsuper.destroy();\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.incubator;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass TimerIncubator extends SmartButton\r\n{\r\n\tprivate var INSEMINATE_TIME_TEXT:String = \"txt_timer\";\r\n\tprivate var INSEMINATE_TEXT:String = \"txt_inseminate\";\r\n\tprivate var inseminateTimeText:TextSprite;\r\n\tprivate var inseminateText:TextSprite;\r\n\tprivate var hardToSkipTimer:Int = 3;\r\n\tprivate var inseminator:Inseminator;\r\n\t\r\n\tpublic var currentName:String;\r\n\tpublic var currentText:String;\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initText(pIns:Inseminator):Void\r\n\t{\r\n\t\tinseminator = pIns;\r\n\t\tcurrentName = \"Passer\";\r\n\t\ton(MouseEventType.CLICK, onSkip);\r\n\t\ton(TouchEventType.TAP, onSkip);\t\r\n\t\tupdateText();\r\n\t}\r\n\t\r\n\toverride function _mouseOver(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tsuper._mouseOver(pEvent);\r\n\t\tupdateText();\r\n\t} \r\n\t\r\n\toverride function _mouseDown(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tsuper._mouseDown(pEvent);\r\n\t\tupdateText();\r\n\t}\r\n\t\r\n\toverride function _mouseOut(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tsuper._mouseOut(pEvent);\r\n\t\tupdateText();\r\n\t}\r\n\t\r\n\tpublic function updateText():Void\r\n\t{\r\n\t\tinseminateTimeText = cast(getChildByName(INSEMINATE_TIME_TEXT), TextSprite);\r\n\t\tinseminateText = cast(getChildByName(INSEMINATE_TEXT), TextSprite);\r\n\t\tif (currentText != null) inseminateTimeText.textField.text = currentText;\r\n\t\telse inseminateTimeText.textField.text = \"\";\r\n\t\tinseminateText.textField.text = currentName == null?\"Inseminate\":currentName;\r\n\t}\r\n\t\r\n\toverride function _click(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tsuper._click(pEvent);\r\n\t\tupdateText();\r\n\t}\r\n\t\r\n\tprivate function onSkip():Void\r\n\t{\r\n\t\tSoundManager.getSound(\"soundPlayerSkiptime\").play();\r\n\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\tif (!FTUEManager.isFTUEon()) DynamicPopin.getInstance().init(\"Acclerer le temps en dpensant \" + hardToSkipTimer + \" cristaux ?\", onSkiped);\r\n\t\telse DynamicPopin.getInstance().init(\"Gratuit pour cette fois\", onSkiped);\r\n\t}\r\n\t\r\n\tprivate function onSkiped():Void\r\n\t{\r\n\t\tif (Player.getInstance().hasEnoughQuantity(hardToSkipTimer, Player.getInstance().hardCurrency))\r\n\t\t{\r\n\t\t\tcurrentName = \"Transferer\";\r\n\t\t\tcurrentText = \"Terminer\";\r\n\t\t\tupdateText();\r\n\t\t\toff(MouseEventType.CLICK, onSkip);\r\n\t\t\toff(TouchEventType.TAP, onSkip);\r\n\t\t\tif (!FTUEManager.isFTUEon()) Player.getInstance().changePlayerValue( -hardToSkipTimer, Player.TYPE_HARDCURRENCY);\r\n\t\t\ton(MouseEventType.CLICK, onTransfert);\r\n\t\t\ton(TouchEventType.TAP, onTransfert);\r\n\t\t\tinseminator.isSkiped();\r\n\t\t}\r\n\t\telse Hud.getInstance().noHCAnimation();\r\n\t}\r\n\t\r\n\tprivate function onTransfert():Void\r\n\t{\r\n\t\tcurrentName = \"Inseminate\";\r\n\t\tcurrentText = \"Terminer\";\r\n\t\tupdateText();\r\n\t\tinseminator.isTransfered();\r\n\t\toff(MouseEventType.CLICK, onTransfert);\r\n\t\toff(TouchEventType.TAP, onTransfert);\r\n\t}\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tsuper.destroy();\r\n\t\toff(MouseEventType.CLICK, onSkip);\r\n\t\toff(TouchEventType.TAP, onSkip);\t\t\r\n\t}   \r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.shop;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.GainParams.Gain;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopData;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopItemParams;\r\nimport com.isartdigital.ruby.ui.items.switchItems.ShopSwitchTab;\r\nimport pixi.core.math.Point;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.ui.popin.Menu;\r\n\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopItemParams.Money;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.SmartPopin;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\n\tclass Shop extends Menu \r\n{\r\n\t\r\n\tprivate static inline var SHOP_TITLE:String = \"txt_tabTitle\";\t\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Shop\r\n\t */\r\n\tprivate static var instance: Shop;\r\n\t\r\n\t/**\r\n\t * element de titre du wireframe\r\n\t */\r\n\tprivate var title:TextSprite;\r\n\t/**\r\n\t * tableau des titre correspondant  chaque onglet\r\n\t */\r\n\tpublic var shopTitles:Array<String>;\r\n\tpublic var shopAssetTitles:Array<String>;\r\n\tprivate var itemPositions:Array<Point>;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Shop {\r\n\t\tif (instance == null) instance = new Shop();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\t\r\n\t}\r\n\t\r\n\t\t/**\r\n\t * initialisation  l'ouverture de la popin\r\n\t */\r\n\toverride function init() \r\n\t{\r\n\t\tsuper.init();\r\n\t\tshopTitles = [\"Pack\", \"Pieces d'or\", \"Genes\", \"Pack Genes\", \"Cristaux\"];\r\n\t\tshopAssetTitles = [\"Pack\", \"SC\", \"Genes\", \"Pack Genes\", \"HC\"];\r\n\t\ttitle = cast(getChildByName(SHOP_TITLE),TextSprite);\r\n\t\t\r\n\t\tinitTab(ShopSwitchTab);\r\n\t\tinitItems();\r\n\t}\r\n\t\r\n\r\n\r\n\toverride private function initItems() {\r\n\t\titemContainer = cast(getChildByName(ITEM_CONTAINER), SmartComponent);\r\n\t\tinitPositionItem();\r\n\t\tupdateItems();\r\n\t}\r\n\t\r\n\r\n\t\r\n\tprivate function initPositionItem() {\r\n\t\titemPositions = new Array<Point>();\r\n\t\t\r\n\t\tfor (i in 0 ... itemContainer.children.length) {\r\n\t\t\titemPositions.push(itemContainer.getChildByName(ITEM+\" #\"+i).position.clone());\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function updateItems() {\r\n\t\ttitle.text = shopTitles[currentIndex];\r\n\t\tdestroyAllChildInContainer(itemContainer);\r\n\t\tvar currentItem:ShopItem;\r\n\t\tfor (i in 0 ...  itemPositions.length) {\r\n\t\t\tif(i>=ShopData.getInstance().datas[currentIndex].length)return;\r\n\t\t\tvar currentItemInfo:ShopItemParams = ShopData.getInstance().datas[currentIndex][i];\r\n\t\t\r\n\r\n\t\t\tcurrentItem = new ShopItemMedium();\r\n\t\t\t\t\r\n\t\t\titemContainer.addChild(currentItem);\r\n\t\t\tcurrentItem.position = itemPositions[i].clone();\r\n\t\t\tcurrentItem.setInfo(currentItemInfo);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * callBack appel lors du click sur un onglet\r\n\t * et initialise set proprit du popin en fonction\r\n\t * @param\tpTarget le bouton cliqu\r\n\t */\r\n\toverride function onTabSelected(pId:Int):Void {\r\n\t\tsuper.onTabSelected(pId);\r\n\t\tupdateItems();\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.shop;\r\nimport com.isartdigital.ruby.ui.ftue.FTUEManager;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.ruby.ui.items.ItemAsset;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.GainParams;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopItemParams;\r\nimport com.isartdigital.services.monetization.Bank;\r\nimport com.isartdigital.services.monetization.Wallet;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.core.sprites.Sprite;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\n\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopItemParams.Money;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ShopItem extends Item\r\n{\r\n\r\n\tpublic static var positions:Array<Point> = new Array<Point>();\r\n\r\n\t/*Constante de ciblage*/\r\n\tprivate static inline var ITEM_NAME:String = \"txt_itemName\";\r\n\tprivate static inline var PRICE_HC:String = \"txt_priceHC\";\r\n\tprivate static inline var PRICE_SC:String = \"txt_priceSC\";\r\n\tprivate static inline var PRICE:String = \"txt_price\";\r\n\tprivate static inline var PROMO:String = \"promo\";\r\n\tprivate static inline var TEXT_PROMO:String = \"txt_promo\";\r\n\tprivate static inline var ASSET_ITEM:String = \"spriteItemAsset\";\r\n\tprivate static inline var ASSET_CURRENCY:String = \"spriteCurrencie\";\r\n\tprivate static inline var ASSET_PREFIX:String = \"Shop_spriteItemAsset_\";\r\n\tprivate static inline var ASSET_CURRENCY_PREFIX:String = \"Shop_spriteCurrencie_\";\r\n\r\n\t/*Composents Graphiques*/\r\n\tprivate var itemName:TextSprite;\r\n\tprivate var textHC:TextSprite;\r\n\tprivate var textSC:TextSprite;\r\n\tprivate var textPrice:TextSprite;\r\n\tprivate var textQuantity:TextSprite;\r\n\tprivate var textPromo:TextSprite;\r\n\tprivate var promoCmp:SmartComponent;\r\n\tprivate var assetsItem:UISprite;\r\n\t/*Datas*/\r\n\tpublic var price:Float;\r\n\tpublic var money:Money;\r\n\tpublic var gains:Array<GainParams>;\r\n\tpublic var promo:Float;\r\n\tpublic var quantity:Int;\r\n\r\n\tpublic function new(pID:String=null)\r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\r\n\t/**\r\n\t * Initialise le shopItem\r\n\t * @param\tpShopItemType\r\n\t * le type def infrent toute les informations dont le ShopItem a besoin\r\n\t */\r\n\tpublic function setInfo(pShopItemParams:ShopItemParams)\r\n\t{\r\n\t\titemName = cast(getChildByName(ITEM_NAME), TextSprite);\r\n\t\titemName.text = pShopItemParams.name;\r\n\r\n\t\tpromo = pShopItemParams.promo;\r\n\t\tpromoCmp = cast(getChildByName(PROMO), SmartComponent);\r\n\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t// retravailler\r\n\t\tcast(getChildByName(ASSET_ITEM), UISprite).visible = false;\r\n\t\tassetsItem = new UISprite(ASSET_PREFIX+StringTools.replace(Shop.getInstance().shopAssetTitles[Shop.getInstance().currentIndex], \" \",\"_\")+\"_\"+StringTools.replace(pShopItemParams.name, \" \", \"_\"));\r\n\t\tassetsItem.position = cast(getChildByName(ASSET_ITEM), UISprite).position;\r\n\t\taddChild(assetsItem);\r\n\r\n\t\tif (promoCmp.getChildByName(TEXT_PROMO) != null)\r\n\t\t{\r\n\t\t\ttextPromo = cast(promoCmp.getChildByName(TEXT_PROMO), TextSprite);\r\n\t\t\ttextPromo.text = promo + \" %\\nFREE\";\r\n\t\t}\r\n\r\n\t\tif (promo == 0) promoCmp.visible = false;\r\n\r\n\t\tprice = round(pShopItemParams.price-(pShopItemParams.price * promo / 100), 2);\r\n\t\ttextPrice = cast(getChildByName(PRICE), TextSprite);\r\n\t\ttextPrice.text = price+\"\";\r\n\t\tgains = pShopItemParams.gains;\r\n\t\tmoney = pShopItemParams.typeMoney;\r\n\t\t\r\n\t\tvar lStringMoney:String = money+\"\";\r\n\t\tswitch (lStringMoney)\r\n\t\t{\r\n\t\t\tcase \"Money.HardCurrency\":\r\n\t\t\t\tcast(getChildByName(ASSET_CURRENCY), UISprite).visible = false;\r\n\t\t\t\tassetsItem = new UISprite(ASSET_CURRENCY_PREFIX+\"HC\");\r\n\t\t\t\tassetsItem.position = cast(getChildByName(ASSET_CURRENCY), UISprite).position;\r\n\t\t\t\taddChild(assetsItem);\r\n\t\t\t\t\r\n\t\t\tcase \"Money.IsartPoint\":\r\n\t\t\t\tcast(getChildByName(ASSET_CURRENCY), UISprite).visible = false;\r\n\t\t\t\tassetsItem = new UISprite(ASSET_CURRENCY_PREFIX+\"IsartPoint\");\r\n\t\t\t\tassetsItem.position = cast(getChildByName(ASSET_CURRENCY), UISprite).position;\r\n\t\t\t\taddChild(assetsItem);\r\n\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tinteractive = true;\r\n\t\tname = itemName.text;\r\n\t\tFTUEManager.register(this);\r\n\r\n\t}\r\n\r\n\tprivate function Buy()\r\n\t{\r\n\t\tcheckMoneyAndDecreasePrice();\r\n\t}\r\n\r\n\tprivate function checkMoneyAndDecreasePrice():Void\r\n\t{\r\n\t\t//en attendant de trouver comment recup un enum depuis un json.\r\n\t\tvar lStringMoney:String = money+\"\";\r\n\t\tswitch (lStringMoney)\r\n\t\t{\r\n\t\t\tcase \"Money.HardCurrency\":\r\n\r\n\t\t\t\tif(!FTUEManager.isFTUEon()) Player.getInstance().changePlayerValue(-Std.int(price), Player.TYPE_HARDCURRENCY);\r\n\t\t\t\tgiveAllTheGainsToPlayer();\r\n\t\t\tcase \"Money.SoftCurrency\":\r\n\t\t\t\tPlayer.getInstance().changePlayerValue(-Std.int(price), Player.TYPE_SOFTCURRENCY);\r\n\t\t\t\tgiveAllTheGainsToPlayer();\r\n\t\t\tcase \"Money.IsartPoint\":\r\n\t\t\t\tWallet.getMoney(Player.getInstance().email, callBackWallet);\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function callBackWallet (pData:Dynamic):Void\r\n\t{\r\n\r\n\t\tif (pData == null) trace (\"Erreur Service\");\r\n\r\n\t\telse if (pData.error != null) trace (pData.error);\r\n\r\n\t\telse \r\n\t\t{\r\n\t\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\t\tDynamicPopin.getInstance().init(\"Voulez-vous acheter cet objet pour \"+price + \" IsartPoints ? Il vous reste actuellement : \"+Reflect.field(pData,\"money\"), checkWalletPlayer);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate function checkWalletPlayer():Void\r\n\t{\r\n\t\tif (Player.getInstance().currentIsartPoint >= price) \r\n\t\t{\r\n\t\t\tWallet.buy(Player.getInstance().email, price, callBackBuy);\r\n\t\t\tPlayer.getInstance().currentIsartPoint -= price;\r\n\t\t}\r\n\t\t\r\n\t\telse\r\n\t\t{\r\n\t\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\t\tDynamicPopin.getInstance().init(\"Dsol, vous n'avez plus assez d'IsartPoints :(\", null);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function callBackBuy(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData == null) trace (\"Erreur Service\");\r\n\r\n\t\telse if (pData.error != null) trace (pData.error);\r\n\r\n\t\telse\r\n\t\t{\r\n\t\t\tgiveAllTheGainsToPlayer();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function giveAllTheGainsToPlayer()\r\n\t{\r\n\t\tfor (gain in gains)\r\n\t\t{\r\n\t\t\t//en attendant de trouver comment recup un enum depuis un json.\r\n\t\t\tvar lStringGain:String = gain.type+\"\";\r\n\t\t\tswitch (lStringGain)\r\n\t\t\t{\r\n\t\t\t\tcase \"Gain.SoftCurrency\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayerBuyScpack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), Player.TYPE_SOFTCURRENCY);\r\n\t\t\t\tcase \"Gain.HardCurrency\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayerBuyHcpack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), Player.TYPE_HARDCURRENCY);\r\n\t\t\t\tcase \"Gain.DarkMatter\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayerBuyBundle\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), Player.TYPE_RESSOURCE);\r\n\t\t\t\tcase \"Gain.GeneBeta\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene1\");\r\n\t\t\t\tcase \"Gain.GeneIota\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene2\");\r\n\t\t\t\tcase \"Gain.GeneRho\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene2\");\r\n\t\t\t\tcase \"Gain.GeneSigma\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene3\");\r\n\t\t\t\tcase \"Gain.GeneUpsilon\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene4\");\r\n\t\t\t\tcase \"Gain.GeneMultiple\":\r\n\t\t\t\t\tSoundManager.getSound(\"soundPlayBuyGenepack\").play();\r\n\t\t\t\t\tfor (i in 0 ... 6)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tPlayer.getInstance().changePlayerValue(Std.int(gain.quantity), \"gene\"+i);\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\ttrace(\"pas encore gr\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tHud.getInstance().update();\r\n\t}\r\n\r\n\toverride function monClick():Void\r\n\t{\r\n\t\tBuy();\r\n\t}\r\n\r\n\t\r\n\tpublic static function round(number:Float, ?precision=2): Float\r\n\t{\r\n\t\tnumber *= Math.pow(10, precision);\r\n\t\treturn Math.round(number) / Math.pow(10, precision);\r\n\t}\r\n\r\n\toverride public function destroy():Void\r\n\t{\r\n\t\toff(MouseEventType.CLICK, Buy);\r\n\r\n\t\tif (parent!=null)\r\n\t\t\tparent.removeChild(this);\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.shop;\r\nimport com.isartdigital.ruby.ui.popin.shop.ShopItem;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ShopItemBig extends ShopItem\r\n{\r\n\r\n\tpublic function new(pID:String=null){\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.shop;\r\nimport com.isartdigital.ruby.ui.popin.shop.ShopItem;\r\n\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ShopItemMedium extends ShopItem\r\n{\r\n\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.shop.datas;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.GainParams.Gain;\r\nimport com.isartdigital.ruby.ui.popin.shop.datas.ShopItemParams.Money;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass ShopData \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe ShopData\r\n\t */\r\n\tprivate static var instance: ShopData;\r\n\t\r\n\tpublic var datas:Array<Array<ShopItemParams>>;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ShopData {\r\n\t\tif (instance == null) instance = new ShopData();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function init(pShopData: Dynamic) {\r\n\t\tdatas = pShopData;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.translationCenter;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.translationClass.SchemaType;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.translationClass.Schemas;\r\nimport com.isartdigital.ruby.game.world.MapInteractor;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.ruby.ui.popin.MenuClosable;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.save.DataBaseAction;\r\nimport com.isartdigital.utils.save.DataManager;\r\nimport com.isartdigital.utils.system.Localization;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport js.html.MouseEvent;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass TranslationCenter extends MenuClosable \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TranslationCenter\r\n\t */\r\n\tprivate static var instance: TranslationCenter;\r\n\t\r\n\t//private var PlayerSchemas:Array<>\r\n\t\r\n\tprivate static inline var TXT_TRAD:String = \"LABEL_TRANSLATION_CENTER_NO_SCHEMA\";\r\n\r\n\tprivate static inline var TXT_TITLE:String = \"TranslationCenter_txt_TranslationCenter\";\r\n\t\r\n\tprivate static inline var PARCHEMIN:String = \"TranslationCenter_clipSwitchParchment\";\r\n\t\tprivate static inline var TXT_PARCH_COUNT:String = \"TranslationCenter_txt_parchmentCount\";\r\n\t\tprivate static inline var TXT_PARCH_NAME:String = \"TranslationCenter_txt_ParchmentName\";\r\n\r\n\t\t\r\n\tprivate static inline var BTN_SKIPTIME:String = \"TranslationCenter_btn_SkipTime\";\r\n\t\r\n\tprivate static inline var TIMER_WINDOW:String = \"TranslationCenter_TimerWindow\";\r\n\t\tprivate static inline var TXT_TIMER:String = \"TranslationCenter_txt_timerWindowtimer\";\r\n\t\r\n\tprivate static inline var BTN_TRANSLATE:String = \"TranslationCenter_btn_Translate\";\r\n\t\r\n\tprivate var lockedSchema:Int;\r\n\r\n\t\r\n\tprivate var txtTitle:TextSprite;\r\n\tprivate var parchemin:SmartComponent;\t\t\r\n\t\tprivate var txtParcheminCount:TextSprite;\r\n\t\tprivate var txtParcheminName:TextSprite;\r\n\r\n\tprivate var btnSkipTimer:SmartButton;\r\n\t\r\n\tprivate var timer:SmartComponent;\r\n\t\tprivate var txtTimer:TextSprite;\r\n\t\r\n\tprivate var btnTranslate:SmartButton;\r\n\t\r\n\tprivate var schema:Schemas;\r\n\t\r\n\tpublic var schemaInDecryptMode:Array<Schemas> = [];\r\n\tpublic var currentSchema:Schemas;\r\n\t\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TranslationCenter {\r\n\t\tif (instance == null) instance = new TranslationCenter();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinit();\r\n\t}\r\n\t\r\n\toverride public function init():Void\r\n\t{\r\n\t\tsuper.init();\r\n\r\n\t\t\r\n\t\ttxtTitle = cast(getChildByName(TXT_TITLE), TextSprite);\r\n\t\t\r\n\t\tparchemin = cast(getChildByName(PARCHEMIN), SmartComponent); \t\r\n\t\t\t\ttxtParcheminCount = cast(parchemin.getChildByName(TXT_PARCH_COUNT), TextSprite); \r\n\t\t\t\ttxtParcheminName = cast(parchemin.getChildByName(TXT_PARCH_NAME), TextSprite);\r\n\t\t\r\n\t\tbtnSkipTimer = cast(getChildByName(BTN_SKIPTIME), SmartButton);\r\n\t\t\r\n\t\ttimer = cast(getChildByName(TIMER_WINDOW), SmartComponent);\r\n\t\t\ttxtTimer = cast(timer.getChildByName(TXT_TIMER), TextSprite);\r\n\t\t\r\n\t\tbtnTranslate = cast(getChildByName(BTN_TRANSLATE), SmartButton);\r\n\t\t\r\n\t\tupdatePoppin();\r\n\t\tvar lockedSchemaList:Array<Schemas> = DataManager.getInstance().getLockedSchemas();\r\n\t\tfor (schema in lockedSchemaList)\r\n\t\t{\r\n\t\t\tif (schema.isLocked == 1 && (schema.startDecrypt) != Date.fromString(\"0000-00-00 00:00:00\"))\r\n\t\t\t{\r\n\t\t\t\t//translate();\r\n\t\t\t\tcurrentSchema = schema;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\tpublic function updatePoppin():Void\r\n\t{\r\n\t\tlockedSchema = DataManager.getInstance().getPlayerSchemaCount(true);\r\n\t\t\r\n\t\ttxtParcheminCount.text = Std.string(\"x \"+lockedSchema);\r\n\t\t\r\n\t\tif (lockedSchema == 0)\r\n\t\t{\r\n\t\t\tbtnSkipTimer.visible = false;\r\n\t\t\ttimer.visible = false;\r\n\t\t\tbtnTranslate.visible = false;\r\n\t\t\ttxtParcheminCount.visible = false;\r\n\t\t\ttxtParcheminName.text = Localization.getLabel(TXT_TRAD);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbtnTranslate.on(MouseEventType.CLICK, translate);\r\n\t\t\tbtnTranslate.on(TouchEventType.TAP, translate);\r\n\t\t\tbtnTranslate.visible = true;\r\n\t\t\tbtnSkipTimer.visible = false;\r\n\t\t\ttimer.visible = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tpublic function translate():Void\r\n\t{\r\n\t\tbtnTranslate.visible = false;\r\n\t\tbtnSkipTimer.visible = true;\r\n\t\ttimer.visible = true;\r\n\t\tdecryptSchema();\r\n\t}\r\n\t\r\n\tpublic function decryptSchema():Void\r\n\t{\r\n\t\tbtnTranslate.off(MouseEventType.CLICK, translate);\r\n\t\tbtnTranslate.off(TouchEventType.TAP, translate);\r\n\t\t\r\n\t\tbtnSkipTimer.on(MouseEventType.CLICK, skipTime);\r\n\t\tbtnSkipTimer.on(TouchEventType.TAP, skipTime);\r\n\t\t\r\n\t\tvar lockedSchemaList:Array<Schemas> = DataManager.getInstance().getLockedSchemas();\r\n\t\tschema = lockedSchemaList[lockedSchemaList.length - 1];\r\n\r\n\t\tvar lShemaType:IncubatorSchema = Incubator.listSchema.get(\"\" + schema.idSchema);\r\n\t\tvar decryptTime:String = lShemaType.decryptTime;\r\n\t\t\r\n\t\tschema.startDecrypt = Date.now();\r\n\t\tschema.endDecrypt = Date.fromTime(schema.startDecrypt.getTime() + Date.fromString(decryptTime).getTime());\r\n\r\n\t\t//DataBaseAction.getInstance().startUnlockSchema(schema.idSchema, schema.startDecrypt, schema.endDecrypt);\r\n\t\tschemaInDecryptMode.push(schema);\r\n\t\tcurrentSchema = schemaInDecryptMode[0];\r\n\t}\r\n\r\n\t\r\n\tpublic function doAction():Void\r\n\t{\r\n\t\tif (currentSchema == null || checkDecryptTime(currentSchema)) return;\r\n\t\t\r\n\t\ttxtTimer.text = TimeManager.getInstance().getTimeToFinishBuildingStringFormat(currentSchema.endDecrypt);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function checkDecryptTime(pSchema:Schemas):Bool\r\n\t{\t\r\n\t\tif (Date.now().getTime() > pSchema.endDecrypt.getTime())\r\n\t\t{\r\n\t\t\tDataBaseAction.getInstance().unlockSchema(pSchema.idSchema);\r\n\t\t\tvar lIndex:Int = DataManager.getInstance().schemasList.indexOf(pSchema);\r\n\t\t\tpSchema.isLocked = 0;\r\n\t\t\tDataManager.getInstance().schemasList[lIndex] = pSchema;\r\n\t\t\tschemaInDecryptMode.pop();\r\n\t\t\tupdatePoppin();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tpublic function skipTime():Void\r\n\t{\r\n\t\tvar HCCost:Int = 5;\r\n\t\t\r\n\t\tUIManager.getInstance().openPopin(DynamicPopin.getInstance());\r\n\t\tDynamicPopin.getInstance().init(\"Acclerer le temps en dpensant \" + HCCost + \" cristaux ?\", timerSkipped);\r\n\t}\r\n\t\r\n\tpublic function timerSkipped():Void\r\n\t{\r\n\t\tvar HCCost:Int = 5;\r\n\t\tif (Player.getInstance().hasEnoughQuantity(HCCost, Player.getInstance().hardCurrency))\r\n\t\t{\r\n\t\t\tPlayer.getInstance().changePlayerValue(-HCCost,\"hardCurrency\");\r\n\t\t\tbtnSkipTimer.off(MouseEventType.CLICK, skipTime);\r\n\t\t\tbtnSkipTimer.off(TouchEventType.TAP, skipTime);\r\n\t\t\tcurrentSchema.isLocked = 0;\r\n\t\t\tschemaInDecryptMode.pop();\r\n\t\t\t//currentSchema.startDecrypt = Date.fromTime(currentSchema.endDecrypt);\r\n\t\t\tDataBaseAction.getInstance().unlockSchema(currentSchema.idSchema);\r\n\t\t\tupdatePoppin();\r\n\t\t}\r\n\t\telse Hud.getInstance().noHCAnimation();\r\n\t}\r\n\t\r\n\toverride public function close():Void \r\n\t{\r\n\t\tsuper.close();\r\n\t\tMapInteractor.getInstance().modalPopinOpened = false;\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.popin.upgradeCenter;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.ruby.ui.items.switchItems.SwitchItem;\r\nimport com.isartdigital.ruby.ui.items.switchItems.UpgradeCenterSwitchItem;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport js.Lib;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass TankUpgrade extends SmartComponent\r\n{\r\n\r\n\tpublic var tankXenos:SmartComponent;\r\n\tpublic var cartouche:SmartComponent;\r\n\tprivate var xenoName:TextSprite;\r\n\tprivate var time:TextSprite;\r\n\tprivate var costMN:TextSprite;\r\n\t\r\n\t\r\n\t\r\n\tprivate var isEmpty:Bool;\r\n\t\r\n\tprivate var level:TextSprite;\r\n\tprivate var btnUpgrade:SmartButton;\r\n\tprivate var btnManage:SmartButton;\r\n\tprivate var btnSkip:SmartButton;\r\n\t\r\n\t\r\n\tpublic var alien:AlienElement;\r\n\t\r\n\tprivate static var XENO_SLOT:String = \"SwitchSlotXeno\";\r\n\tprivate static var CARTOUCHE:String = \"UpgradeCenter_clipIntituleXenos\";\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tinitTank();\r\n\t}\r\n\t\r\n\tprivate function initTank():Void\r\n\t{\r\n\t\ttankXenos =  cast(getChildByName(XENO_SLOT), SmartComponent) ;\r\n\t\t\r\n\t\tcartouche =  cast(getChildByName(CARTOUCHE), SmartComponent) ;\r\n\t\txenoName = cast(cartouche.getChildByName(\"txt_xenoNameUpgrading\"), TextSprite) ;\r\n\t\ttime = cast(cartouche.getChildByName(\"txt_UpgradeDelayDisplay\"), TextSprite) ;\r\n\t\ttime.visible = false;\r\n\t\tcostMN = cast(cartouche.getChildByName(\"txt_CostUpgradeDisplay\"), TextSprite) ;\r\n\t\t\r\n\t\tlevel = cast(getChildByName(\"txt_level\"), TextSprite) ;\r\n\t\t\r\n\t\tbtnManage =  cast(getChildByName(\"btn_Manage\"), SmartButton) ;\r\n\t\tbtnManage.visible = false;\r\n\t\tbtnUpgrade =  cast(getChildByName(\"btn_Upgrade\"), SmartButton) ;\r\n\t\tbtnSkip =  cast(getChildByName(\"btn_Skip\"), SmartButton) ;\r\n\t\tbtnSkip.visible = false;\r\n\t\txenoName.text = \"tutui tiu\";\r\n\t\t\r\n\t\tcostMN.text = \"1000\";\r\n\t\t\r\n\t\tif (!isEmpty)\r\n\t\t{\r\n\t\t\ttankXenos.getChildByName(\"Disabled\").visible = false;\r\n\t\t\ttankXenos.getChildByName(\"Selected\").visible = false;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setAlien(pAlien:AlienElement):Void\r\n\t{\r\n\t\talien = pAlien;\r\n\t\txenoName.visible = false;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.ui.popin.upgradeCenter;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.SmartPopinRegister;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins / Guillaume Zegoudia\r\n */\r\nclass UpgradeCenter extends Menu \r\n{\r\n\t\r\n\tprivate var currentCenter:AlienTrainingCenter;\r\n\t\r\n\tprivate var container:SmartComponent;\r\n\t\r\n\tpublic var firstSlot:TankUpgrade;\r\n\tpublic var secondSlot:Dynamic;\r\n\tpublic var thirdSlot:Dynamic;\r\n\t\r\n\tpublic var array:Array<TankUpgrade> = [];\r\n\t\r\n\t/**\r\n\t * instance unique de la classe UpgradeCenter\r\n\t */\r\n\tprivate static var instance: UpgradeCenter;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): UpgradeCenter {\r\n\t\tif (instance == null) instance = new UpgradeCenter();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tmodal = true;\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function initializationCurrentBuildingTrainingCenter(pCenter:AlienTrainingCenter):Void\r\n\t{\r\n\t\tcurrentCenter = pCenter;\r\n\t\t\r\n\t\tcontainer = cast(getChildByName(\"UpgradeCenter_clipXenoListUpgrading\"), SmartComponent);\r\n\t\tfirstSlot = cast(container.getChildByName(\"SlotUpgrade #1\"), TankUpgrade);\r\n\t\t\r\n\t\t\r\n\t\tif (currentCenter.slot1Bought) getChildByName(\"btn_AddSlot #1\").visible = false;\r\n\t\telse \r\n\t\t{\r\n\t\t\tvar lTankeur:SmartComponent = cast(getChildByName(\"UpgradeCenter_clipXenoListUpgrading\"), SmartComponent);\r\n\t\t\tlTankeur.getChildByName(\"SlotUpgrade #1\").visible = false;\r\n\t\t}\r\n\t\tif (currentCenter.slot2Bought) getChildByName(\"btn_AddSlot #2\").visible = false;\r\n\t\telse \r\n\t\t{\r\n\t\t\tvar lTankeur:SmartComponent = cast(getChildByName(\"UpgradeCenter_clipXenoListUpgrading\"), SmartComponent);\r\n\t\t\tlTankeur.getChildByName(\"SlotUpgrade #2\").visible = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function setAlien():Void {\r\n\t\r\n\t\tfirstSlot.setAlien(currentCenter.alien);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.screens;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass PubImage extends SmartScreenRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe PubImage\r\n\t */\r\n\tprivate static var instance: PubImage;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): PubImage {\r\n\t\tif (instance == null) instance = new PubImage();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.screens;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass PubVideo extends SmartScreenRegister \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe PubVideo\r\n\t */\r\n\tprivate static var instance: PubVideo;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): PubVideo {\r\n\t\tif (instance == null) instance = new PubVideo();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.screens;\r\n\r\nimport com.isartdigital.ruby.game.GameManager;\r\nimport com.isartdigital.ruby.preloadgame.PreloadMiniGame;\r\nimport com.isartdigital.ruby.ui.popin.Confirm;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport com.isartdigital.utils.ui.Screen;\r\nimport haxe.Http;\r\nimport js.Browser;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.interaction.EventTarget;\r\n\r\n\t\r\n/**\r\n * Exemple de classe hritant de Screen\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass TitleCard extends Screen \r\n{\r\n\tprivate var background:Sprite;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TitleCard\r\n\t */\r\n\tprivate static var instance: TitleCard;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TitleCard {\r\n\t\tif (instance == null) instance = new TitleCard();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tbackground = new Sprite(Texture.fromImage(Config.url(Config.assetsPath + \"SplashScreen.png\")));\r\n\t\tbackground.anchor.set(0.5, 0.5);\r\n\t\taddChild(background);\r\n\t\tinteractive = true;\r\n\t\tbuttonMode = true;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function onClick (pEvent:EventTarget): Void {\r\n\t\tSoundManager.getSound(\"click\").play();\r\n\t\t//UIManager.getInstance().openPopin(Confirm.getInstance());\r\n\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.ui.specialButtons;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.ui.popin.centreForage.CentreForage;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.UISprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass SlotButton extends SmartButton\r\n{\r\n\r\n\tpublic static var list:Array<SlotButton> = new Array<SlotButton>();\r\n\tpublic var alien:AlienElement;\r\n\tprivate var prefix:String;\r\n\tprivate var assetName:String;\r\n\tstatic inline var PREFIX:String = \"XenosThumbnail_\";\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tlist.push(this);\r\n\t}\r\n\t\r\n\toverride function _click(pEvent:EventTarget = null):Void \r\n\t{\r\n\t\tsuper._click(pEvent);\r\n\t\tplaceXeno(CentreForage.getInstance().alienSelected);\r\n\t}\r\n\t\r\n\tpublic function invisibleGreySquare() {\r\n\t\tgetChildByName(\"asset\").visible = false;\r\n\t}\r\n\tprivate function placeXeno(pAlien:AlienElement) {\r\n\t\t\r\n\t\t\r\n\t\tif (pAlien != alien)\r\n\t\t\tfor (slot in CentreForage.getInstance().xenoSlotList) {\r\n\t\t\t\r\n\t\t\t\tif (slot.alien == pAlien) slot.removeXeno(pAlien);\r\n\t\t\t}\r\n\t\t\talien = pAlien;\r\n\t\t\tif (alien != null) {\r\n\t\t\tassetName = alien.name+\"_Normal\";\r\n\t\t\tprefix = PREFIX;\r\n\t\t\tsetAsset();\r\n\t\t\tCentreForage.getInstance().alienSelected = null;\r\n\t\t\tCentreForage.getInstance().checkIfMissionCanBeStarted();\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function removeXeno(pAlien:AlienElement):Void {\r\n\t\r\n\t\ttrace(\"remove\");\r\n\t\talien = null;\r\n\t}\r\n\t\r\n\tpublic function setAsset() {\r\n\t\tif (prefix == null  || children == null) return;\r\n\t\t\r\n\t\tif(alien == null && getChildByName(\"mainAsset\") != null)removeChild(getChildByName(\"mainAsset\"));\r\n\t\tvar lAsset:UISprite;\r\n\t\tvar lSpawnAsset:UISprite;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tlSpawnAsset = cast(getChildByName(\"asset\"), UISprite);\r\n\t\tlAsset = new UISprite(prefix + assetName);\r\n\t\t\r\n\t\tlAsset.name = \"mainAsset\";\r\n\t\tlAsset.position = lSpawnAsset.position.clone();\r\n\t\t\r\n\t\tif (getChildByName(lAsset.name) != null)\r\n\t\t\tremoveChild(getChildByName(lAsset.name));\r\n\t\t\t\r\n\t\taddChild(lAsset);\r\n\t\t\r\n\t\tlSpawnAsset.visible = false;\r\n\t}\r\n\toverride public function destroy():Void \r\n\t{\r\n\t\tsuper.destroy();\r\n\t\tlist.remove(this);\r\n\t}\r\n}","package com.isartdigital.ruby.ui.specialButtons;\r\n\r\nimport com.isartdigital.ruby.ui.items.Item;\r\nimport com.isartdigital.ruby.ui.popin.ConfirmationPose;\r\nimport com.isartdigital.utils.ui.smart.SmartButton;\r\nimport com.isartdigital.utils.ui.smart.SmartComponent;\r\nimport com.isartdigital.utils.ui.smart.TextSprite;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass Textbutton extends Item\r\n{\r\n\r\n\t\r\n\tprivate static inline var HC_TEXT_CNTNER:String = \"ConfirmationPose_clipPriceHCInfos\";\r\n\tprivate static inline var SCMN_TEXT_CNTNER:String = \"ConfirmationPose_clipPriceSCInfos\";\r\n\tprivate static inline var SC_TEXT:String = \"txt_SCPrice\";\r\n\tprivate static inline var HC_TEXT:String = \"txt_HCPrice\";\r\n\tprivate static inline var MN_TEXT:String = \"txt_MNPrice\";\r\n\tprivate static inline var PAY_BTN:String = \"pay_btn\";\r\n\t\r\n\tprivate var scmnInfoContainerNormal:SmartComponent;\r\n\tprivate var hcInfoContainerNormal:SmartComponent;\r\n\t\r\n\tprivate var scTextNormal:TextSprite;\r\n\tprivate var hcTextNormal:TextSprite;\r\n\tprivate var mnTextNormal:TextSprite;\r\n\tprivate var payBtn:SmartButton;\r\n\t\r\n\tpublic var scValue:String;\r\n\tpublic var mnValue:String;\r\n\tpublic var hcValue:String;\r\n\t\r\n\tprivate var isInHCMode:Bool = false;\r\n\t\r\n\tpublic function new(pID:String=null) \r\n\t{\r\n\t\tsuper(pID);\r\n\t\tscmnInfoContainerNormal = cast(getChildByName(SCMN_TEXT_CNTNER), SmartComponent);\r\n\t\thcInfoContainerNormal = cast(getChildByName(HC_TEXT_CNTNER), SmartComponent);\r\n\t\tscTextNormal = cast(scmnInfoContainerNormal.getChildByName(SC_TEXT), TextSprite);\r\n\t\tmnTextNormal = cast(scmnInfoContainerNormal.getChildByName(MN_TEXT), TextSprite);\r\n\t\thcTextNormal = cast(hcInfoContainerNormal.getChildByName(HC_TEXT), TextSprite);\r\n\t\tpayBtn = cast(getChildByName(PAY_BTN), SmartButton);\r\n\t}\r\n\t\r\n\tpublic function HCMode():Void {\r\n\t\r\n\t\tisInHCMode = true;\r\n\t\tscmnInfoContainerNormal.visible = false;\r\n\t}\r\n\t\r\n\tpublic function SCMNMode():Void {\r\n\t\r\n\t\thcInfoContainerNormal.visible = false;\r\n\t}\r\n\t\r\n\toverride function onOver():Void \r\n\t{\r\n\t\tpayBtn.overBuild(1);\r\n\t}\r\n\t\r\n\toverride function onOut():Void \r\n\t{\r\n\t\tpayBtn.overBuild(0);\r\n\t}\r\n\t\r\n\toverride function onDown():Void \r\n\t{\r\n\t\tpayBtn.overBuild(2);\r\n\t}\r\n\t//override function _mouseOver(pEvent:EventTarget = null):Void \r\n\t//{\r\n\t\t//super._mouseOver(pEvent);\r\n\t\t//isInHCMode ? displayTextHC():displayTextSCMN();\r\n\t\t//\r\n\t//}\r\n\t//\r\n\t//override function _mouseOut(pEvent:EventTarget = null):Void \r\n\t//{\r\n\t\t//super._mouseOut(pEvent);\r\n\t\t////isInHCMode ? displayTextHC():displayTextSCMN();\r\n\t//}\r\n\t\r\n\tpublic function displayTextHC():Void {\r\n\t\t\r\n\t\tHCMode();\r\n\t\thcTextNormal.text = ConfirmationPose.getInstance().hcValue;\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function displayTextSCMN():Void {\r\n\t\r\n\t\tSCMNMode();\r\n\t\tscTextNormal.text = ConfirmationPose.getInstance().scValue;\r\n\t\tmnTextNormal.text = ConfirmationPose.getInstance().mnValue;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.utils;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass BezierCurve\r\n{\r\n\r\n\tprivate  function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic static function customEase(pTime:Float):Float\r\n\t{\r\n\t\tvar lPoint:Point = calculCurve(new Point(0, 0), new Point(0.91, 0.1), new Point(0.16, 0.99), new Point(1, 1), pTime);\r\n\t\treturn lPoint.y;\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t * @param\tpA : point de dpart\r\n\t * @param\tpB : point de tangeante  pA\r\n\t * @param\tpC : point de tangeante  pD\r\n\t * @param\tpD : point d'arrive\r\n\t * @param\ttime compris entre 0 et 1\r\n\t * @return le point sur la courbe de bzier  l'instant time\r\n\t */\r\n\tpublic static function calculCurve(pA:Point,pB:Point,pC:Point,pD:Point,t:Float, ?pCustomEase:Bool=false):Point\r\n\t{\r\n\t\tvar lPoint:Point = new Point(0, 0);\r\n\t\tif (pCustomEase) t = customEase(t);\t\r\n\t\t\r\n\t\tvar s:Float = 1 - t;\r\n\r\n\t\tlPoint.x = s * s * s * pA.x + 3 * t * s * s * pB.x + 3 * t * t * s * pC.x + t * t * t * pD.x;\r\n\t\tlPoint.y = s * s * s * pA.y + 3 * t * s * s * pB.y + 3 * t * t * s * pC.y + t * t * t * pD.y;\r\n\t\treturn lPoint;\r\n\t}\r\n\t\r\n}","package com.isartdigital.ruby.utils;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.filters.color.ColorMatrixFilter;\r\nimport pixi.flump.Movie;\r\n\r\n\r\ntypedef ColorFilterParams=\r\n{\r\n\t/**\r\n\t * red/green/blue/orangeblack/white\r\n\t */\r\n\tvar colorToApply:String;\r\n\tvar colorAmount:Float;\r\n\tvar duration:Int;\r\n}\r\n\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass ColorFilterManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe ColorFilter\r\n\t */\r\n\tprivate static var instance: ColorFilterManager;\r\n\t\r\n\r\n\tprivate var colorMatrix:Array<Float> = new Array<Float>();\r\n\r\n\r\n\tprivate var listElements:Array<GameObject> = new Array<GameObject>();\r\n\tprivate var listParams:Array<ColorFilterParams> = new Array<ColorFilterParams>();\r\n\t\r\n\tprivate var currentElement:Int;\r\n\r\n\r\n\tpublic var tint:Int;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ColorFilterManager {\r\n\t\tif (instance == null) instance = new ColorFilterManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t/**\r\n\t * Applique un filtre de couleur  un GameObject grce  une liste de Paramtre de rglages\r\n\t * @param\tpTarget\r\n\t * @param\tpParams\r\n\t */\r\n\tpublic function applyFilter(pTarget:GameObject, pParams:ColorFilterParams)\r\n\t{\r\n\t\tlistElements.push(pTarget);\r\n\t\tlistParams.push(pParams);\r\n\t}\r\n\t\r\n\tpublic function doAction():Void\r\n\t{\r\n\t\tif (listElements.length <= 0) return;\r\n\t\t\r\n\t\tfor (element in 0...listElements.length) \r\n\t\t{\r\n\t\t\tcurrentElement = element;\r\n\t\t\tif (listParams[element].duration != 0)\tlistParams[element].colorAmount -= 0.01;\r\n\t\t\t \r\n\r\n\t\t\tif (listParams[element].colorToApply == \"red\") colorMatrix = [1, 0, 0, listParams[element].colorAmount, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 1, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 1, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 1, 0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tif (listParams[element].colorToApply  == \"green\") colorMatrix = [0, 0, 0, 0, 0, \r\n\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 1, 0, 0, 0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1, 0,0 , 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 0, 0, 0, 0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tif (listParams[element].colorToApply  == \"blue\") colorMatrix = [1, 0, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 1, 0, 0, 0, \r\n\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 1, 1, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 0, 0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tif (listParams[element].colorToApply  == \"pink\") colorMatrix = [listParams[element].colorAmount, 1, 0, 0, 0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 0, 0, 0, 0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 1, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 1, 0, 0, 0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tif (listParams[element].colorToApply  == \"white\") colorMatrix = [1, 0, 0, 0, listParams[element].colorAmount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 1, 0, 0, listParams[element].colorAmount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 1, 0, listParams[element].colorAmount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 0, listParams[element].colorAmount];\r\n\r\n\t\t\tif (listParams[element].colorToApply == \"black\") colorMatrix = [0, 0, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1, 1, 0, 0, 0];\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\tif (listParams[element].colorToApply == \"orange\") colorMatrix = [listParams[element].colorAmount, 0.5, 0.25, 0.25, listParams[element].colorAmount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlistParams[element].colorAmount, 0.4, 0, 0.19, listParams[element].colorAmount,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, 0, 0, 0, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1, 0, 0, 0, 0];\r\n\r\n\t\t\tlistElements[element].colorFilter.matrix = colorMatrix;\r\n\t\t\tlistElements[element].filters = [listElements[element].colorFilter];\r\n\t\t\t\t\r\n\t\t\tif (listParams[element].colorAmount <= 0)\r\n\t\t\t{\t\r\n\t\t\t\tresetColor();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * supprime le filtre\r\n\t */\r\n\tpublic function resetColor():Void\r\n\t{\r\n\t\tif (currentElement == null) return;\r\n\t\tlistElements[currentElement].colorFilter.reset();\r\n\t\tlistElements[currentElement].filters = null;\r\n\t\tlistElements.remove(listElements[currentElement]);\r\n\t\tlistParams.remove(listParams[currentElement]);\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.utils;\r\n\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.popin.contextual.ContextualPopin;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.interaction.InteractionManager;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass Focus extends DisplayObject \r\n{\r\n\t\r\n\tprivate var oldPosition:Point;\r\n\tprivate var direction:Point;\r\n\t/**\r\n\t * instance unique de la classe Focus\r\n\t */\r\n\tprivate static var instance: Focus;\r\n\tprivate var graphic:Graphics;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Focus {\r\n\t\tif (instance == null) instance = new Focus();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\tsuper();\r\n\t\tgraphic = new Graphics();\r\n\t\t//GameStage.getInstance().getGameContainer().addChild(graphic);\r\n\t\toldPosition = position;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * fonction utilitaire si besoin de voir le point du focus\r\n\t */\r\n\tpublic function draw() {\r\n\t\t\t\t\r\n\t\t//GameStage.getInstance().removeChild(graphic);\r\n\t\tgraphic.clear();\r\n\t\tgraphic.beginFill(0xFFFFFF);\r\n\t\tgraphic.drawCircle(x, y, 10);\r\n\t\tgraphic.endFill();\r\n\t\t//GameStage.getInstance().addChild(graphic);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * fonction utilitaire permettant de savoir les coordonn de la region\r\n\t * @return coordonn region\r\n\t */\r\n\tpublic function getRegionOn():Point{\r\n\t\tvar lPoint:Point = IsoManager.localToModel(position);\r\n\t\t\r\n\t\tlPoint.x /= Region.WIDTH;\r\n\t\tlPoint.y /= Region.HEIGHT;\r\n\t\tlPoint.x = Math.floor(lPoint.x);\r\n\t\tlPoint.y = Math.floor(lPoint.y);\r\n\t\treturn lPoint;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Inform si la region sur laquelle se trouve le focus est active\r\n\t * @return actif ?\r\n\t */\r\n\tpublic function isOnActiveRegion():Bool{\r\n\t\tvar lPoint = getRegionOn();\r\n\t\tif (World.getInstance().getRegion(cast(lPoint.x, Int), cast(lPoint.y, Int)) != null) \r\n\t\t{\r\n\t\t\treturn World.getInstance().getRegion(cast(lPoint.x,Int), cast(lPoint.y,Int)).isActive;\t\r\n\t\t}\r\n\t\telse return false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * met  jour la position, ne la met pas  jour si la position future est sur une region inactive\r\n\t */\r\n\r\n\tpublic function toMove(pToAdd:Point):Void {\r\n\t\t\r\n\t\toldPosition = position.clone();\r\n\t\tposition.x += pToAdd.x;\r\n\t\tposition.y += pToAdd.y;\t\r\n\t\tvar lCooCurrentRegion:Point = getRegionOn();\r\n\t\tposition = oldPosition.clone();\r\n\t\t\r\n\t\tif (World.getInstance().getRegion(cast(lCooCurrentRegion.x, Int), cast(lCooCurrentRegion.y, Int)) == null)\r\n\t\t\treturn;\r\n\t\t\r\n\t\t\r\n\t\tmove(pToAdd);\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function move(pToAdd:Point) {\r\n\t\t\r\n\t\tposition.x += pToAdd.x;\r\n\t\tposition.y += pToAdd.y;\t\r\n\t\t\r\n\t}\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.utils;\r\nimport cloudkid.Emitter;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Timer;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.textures.Texture;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass ParticleManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe ParticleManager\r\n\t */\r\n\tprivate static var instance: ParticleManager;\r\n\tprivate var emitterList:Array<Emitter> = [];\r\n\tprivate static inline var PARTICLE_SPEED:Float = 0.01;\r\n\tprivate static inline var CONTAINER_DIMENSION:Float = 500;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ParticleManager {\r\n\t\tif (instance == null) instance = new ParticleManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * http://pixijs.github.io/pixi-particles-editor/#pixieDust pour paramtrer\r\n\t * n'oubliez pas d'importer le json et l'asset dans le main\r\n\t * @param\tpJsonConfig\r\n\t * @param\tpTextures\r\n\t * @param\tpDuration\r\n\t * @return\r\n\t */\r\n\tpublic function createParticle(pJsonConfig:String,pTextures:Array<String>, pDuration:Int=10000):Container\r\n\t{\r\n\t\tif (DeviceCapabilities.system != DeviceCapabilities.SYSTEM_DESKTOP) return new Container();\r\n\t\tvar lNewContainer:Container = new Container();\r\n\t\tvar lTextureArray:Array<Texture> = [];\r\n\t\t\r\n\t\t\r\n\t\tfor (lElement in pTextures)\r\n\t\t{\r\n\t\t\tlTextureArray.push(Texture.fromImage(\"assets/particles/assets/\" + lElement + \".png\", false));\r\n\t\t}\r\n\t\t\r\n\t\tvar lEmitter = new Emitter(lNewContainer, lTextureArray, GameLoader.getContent(\"particles/json/\"+pJsonConfig+\".json\"));\r\n\t\t\r\n\t\tlNewContainer.width = CONTAINER_DIMENSION;\r\n\t\tlNewContainer.height = CONTAINER_DIMENSION;\r\n\t\temitterList.push(lEmitter);\r\n\t\t\r\n\t\tvar timer = new haxe.Timer(pDuration); \r\n\t\ttimer.run = function() \r\n\t\t{ \r\n\t\t\tkillParticle(lNewContainer, lEmitter);\r\n\t\t\ttimer.stop();\r\n\t\t};\r\n\t\t\r\n\t\treturn lNewContainer;\r\n\t}\r\n\t\r\n\tpublic function update():Void\r\n\t{\r\n\t\t//Lib.debug();\r\n\t\tfor (lEmitter in emitterList)\r\n\t\t{\r\n\t\t\tlEmitter.update(PARTICLE_SPEED);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function killParticle(pContainer:Container, pEmitter:Emitter):Void\r\n\t{\r\n\t\tpEmitter.destroy();\r\n\t\tpContainer.parent.removeChild(pContainer);\r\n\t\temitterList.splice(emitterList.indexOf(pEmitter), 1);\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.utils;\r\nimport com.greensock.TweenMax;\r\nimport com.greensock.easing.Back;\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.utils.ColorFilterManager.ColorFilterParams;\r\nimport com.isartdigital.ruby.utils.RessourceEffect;\r\nimport com.isartdigital.ruby.ui.hud.Hud;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.ui.SmartText;\r\nimport com.isartdigital.utils.game.GameObject;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\n\r\ntypedef RessourcesEffectParams = \r\n{\r\n\tvar originalPosition:Point;\r\n\tvar destinationPosition:Point;\r\n\tvar whereToAddchild:Container;\r\n\tvar numObjectsToInstanciate:Int;\r\n\tvar duration:Float;\r\n\tvar secondsBtwnaddchilds:Float;\r\n\tvar speed:Float;\r\n\tvar animationType:String;\r\n\tvar ressource:RessourceType;\r\n}\r\n\r\nenum RessourceType\r\n{\r\n\tSoftCurrency;\r\n\tHardCurrency;\r\n\tItemHC0;\r\n\tItemHC1;\r\n    ItemHC2;\r\n\tItemBluePrint;\r\n\tItemBluePrintPart;\r\n\tItemDarkMatter0;\r\n\tItemDarkMatter1;\r\n\tItemDarkMatter2;\r\n\tItemGeneTwo0;\r\n    ItemGeneTwo1;\r\n    ItemGeneTwo2;\r\n    ItemGeneOne0;\r\n    ItemGeneOne1;\r\n    ItemGeneOne2;\r\n\tItemGeneFive0;\r\n\tItemGeneFive1;\r\n\tItemGeneFive2;\r\n\tItemGeneFour0;\r\n\tItemGeneFour1;\r\n\tItemGeneFour2;\r\n\tItemGeneThree0;\r\n\tItemGeneThree1;\r\n\tItemGeneThree2;\r\n}\t\r\n/** \r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass RessourcesEffectManager \r\n{\r\n\r\n\tprivate var element:PoolObject;\r\n\tprivate var bubble:PoolObject;\r\n\tprivate var params:RessourcesEffectParams;\r\n\tprivate var isAnimEnd:Bool = false;\r\n\tprivate var container:Container;\r\n\tprivate var originalPos:Point;\r\n\tprivate var destinationPosition:Point;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * instance unique de la classe RessourcesEffectManager\r\n\t */\r\n\tprivate static var instance: RessourcesEffectManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): RessourcesEffectManager {\r\n\t\tif (instance == null) instance = new RessourcesEffectManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialise l'effet grace a une liste de params\r\n\t * @param\tpParams\r\n\t */\r\n\tpublic function SetEffect(pParams:RessourcesEffectParams):Void\r\n\t{\t\t\r\n\t\tparams = pParams;\r\n\t\tcontainer = pParams.whereToAddchild;\r\n\t\toriginalPos = pParams.originalPosition;\r\n\t\tdestinationPosition = pParams.destinationPosition;\r\n\t\tOnStartEffect();\r\n\t\tfor (i in 0...pParams.numObjectsToInstanciate) \r\n\t\t{\r\n\t\t\tbubble = PoolManager.getFromPool(\"Bubble\");\r\n\t\t\tbubble.init(null);\r\n\t\t\tbubble.position.x = pParams.originalPosition.x + Math.random()*30-15;\r\n\t\t\tbubble.position.y = pParams.originalPosition.y + Math.random() * 30 - 15;\r\n\t\t\t\r\n\t\t\tcast(bubble, RessourceEffect).setModeInit(pParams.animationType, pParams.destinationPosition, pParams.ressource,new Point(bubble.position.x - pParams.originalPosition.x, bubble.position.y - pParams.originalPosition.y));\r\n\t\t\tpParams.whereToAddchild.addChild(bubble);\r\n\t\t\t\t\t\t\t\r\n\t\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"bubble\", [\"smoke01\"], 5000);\r\n\t\t\tlParticle.position = bubble.position;\r\n\t\t\tcontainer.addChild(lParticle);\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dfinistion de l'effet de couleur  appliquer au dmarage de l'animation\r\n\t */\r\n\tpublic function OnStartEffect():Void\r\n\t{\r\n\t\tvar lParticle:Container = ParticleManager.getInstance().createParticle(\"smoke\", [\"smoke01\",\"bubble\"], 5000);\r\n\t\tlParticle.position = originalPos;\r\n\t\tcontainer.addChild(lParticle);\r\n\t}\r\n\t/**\r\n\t * Dfinistion de l'effet de couleur  appliquer  la fin de l'animation\r\n\t */\r\n\tpublic function OnEffectEnd():Void\r\n\t{\r\n\t\tvar lParticle2:Container = ParticleManager.getInstance().createParticle(\"explosionStars\", [\"smoke03\",\"stars1\",\"stars3\",\"stars3\"], 5000);\r\n\t\tlParticle2.position = destinationPosition;\r\n\t\tcontainer.addChild(lParticle2);\r\n\t}\r\n\t\r\n\tpublic function getAnimEnd():Bool\r\n\t{\r\n\t\treturn isAnimEnd;\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\t\r\n\t\r\n\r\n}","package com.isartdigital.ruby.utils;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport com.isartdigital.utils.sounds.SoundManager;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\n\r\n\r\ntypedef ShakerParams = \r\n{\r\n\tvar originalPosition:Point;\r\n\tvar smoothness:Float;\r\n\tvar amplitude:Float;\r\n\tvar duration:Float;\r\n\tvar xQuantity:Float;\r\n\tvar yQuantity:Float;\r\n\tvar fadeOut:Float;\r\n\tvar randomShake:Bool;\r\n\t@:optional var sound:String;\r\n}\r\n\r\n/**\r\n * Class qui Shake un lment et diffuse un son\r\n * @author Julien Fournier\r\n */\r\nclass SmartShaker \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe SmartShake\r\n\t */\r\n\tprivate static var instance: SmartShaker;\r\n\t\r\n\tprivate static inline var MIN_RAND_SHAKE:Float = 0.8;\r\n\tprivate static inline var MAX_RAND_SHAKE:Float = 1;\r\n\tprivate var shaker:Point = new Point(0, 0);\r\n\r\n\tpublic var listElementToShake:Array<DisplayObject> = new Array<DisplayObject>();\r\n\tpublic var listParams:Array<ShakerParams> = new Array<ShakerParams>();\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): SmartShaker {\r\n\t\tif (instance == null) instance = new SmartShaker();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Configure et lance le Shaker\r\n\t * @param\tpElem2Shake\r\n\t * @param\tpParams\r\n\t */\r\n\tpublic function SetShaker(pElem2Shake:DisplayObject, pParams:ShakerParams):Void\r\n\t{\r\n\t\tfor (element in 0...listElementToShake.length) \r\n\t\t{\r\n\t\t\tif (pElem2Shake ==  listElementToShake[element])\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t\r\n\t\tlistElementToShake.push(pElem2Shake);\r\n\t\tlistParams.push(pParams);\r\n\t\tif (pParams.sound != null) SoundManager.getSound(pParams.sound).play();\r\n\r\n\t}\r\n\r\n\tpublic function doAction():Void\r\n\t{\r\n\t\tif (listElementToShake.length == 0) return;\r\n\r\n\t\tfor (element in 0...listElementToShake.length) \r\n\t\t{\r\n\t\t\tlistParams[element].duration--;\r\n\t\t\t\r\n\t\t\tif (listParams[element].duration <= 0) \r\n\t\t\t{\r\n\r\n\t\t\t\tlistElementToShake[element].position.set(listParams[element].originalPosition.x,listParams[element].originalPosition.y);\r\n\r\n\t\t\t\tlistElementToShake.remove(listElementToShake[element]);\r\n\t\t\t\tlistParams.remove(listParams[element]);\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tshaker.x = listParams[element].xQuantity * ((MIN_RAND_SHAKE + Math.random() * (MAX_RAND_SHAKE - MIN_RAND_SHAKE)) * Math.cos(listParams[element].duration * 2 * Math.PI / listParams[element].smoothness) * listParams[element].amplitude);\r\n\t\t\tshaker.y = listParams[element].yQuantity * ((MIN_RAND_SHAKE + Math.random() * (MAX_RAND_SHAKE - MIN_RAND_SHAKE)) * Math.sin(listParams[element].duration * 2 * Math.PI / listParams[element].smoothness) * listParams[element].amplitude);\r\n\t\t\t\r\n\t\t\tlistParams[element].amplitude *= listParams[element].fadeOut;\r\n\t\t\t\r\n\t\t\tlistElementToShake[element].x += shaker.x;\r\n\t\t\tlistElementToShake[element].y += shaker.y;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\t\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.ruby.utils;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Julien Fournier\r\n */\r\nclass TimeManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TimeManager\r\n\t */\r\n\tprivate static var instance: TimeManager;\r\n\tprivate var dateNow:Date;\r\n\tprivate var timer: Date;\r\n\tprivate var startTime:Float;\r\n\t\r\n\tpublic var timeServer(default, set):Date;\r\n\t\r\n\tfunction set_timeServer(pDate:Date)\r\n\t{\r\n\t\treturn timeServer = pDate;\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TimeManager {\r\n\t\tif (instance == null) instance = new TimeManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialise le TimeManager avec les infos de l'lment.\r\n\t * @param\tpElement\r\n\t */\r\n\tpublic function init(pElement:GameElement)\r\n\t{\r\n\t\tdateNow = Date.now();\r\n\t\t\r\n\t\tpElement.dateEndBuilding = DateTools.delta(\r\n\t\t\tdateNow,\r\n\t\t\tconvertInStamp(\r\n\t\t\t\tpElement.timeToBuild.seconds,\r\n\t\t\t\tpElement.timeToBuild.minutes,\r\n\t\t\t\tpElement.timeToBuild.hours,\r\n\t\t\t\tpElement.timeToBuild.days));\r\n\t}\r\n\r\n\t/**\r\n\t * Retourne la date de fin de construction\r\n\t * @return\r\n\t */\r\n\tpublic function getEndOfBuildDate(pElement:GameElement):Date\r\n\t{\r\n\t\treturn pElement.dateEndBuilding;\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Prend les infos de temps (secondes, minutes, heures, jours), les convertis en secondes, \r\n\t * puis additionne le tout et convertis le total en timeStanp\r\n\t * @param\tseconds\r\n\t * @param\tminutes\r\n\t * @param\thours\r\n\t * @param\tdays\r\n\t * @return TimeStamp (Float)\r\n\t */\r\n\tpublic function convertInStamp(seconds : Int, ?minutes : Int=0, ?hours : Int=0, ?days : Int=0):Float\r\n\t{\r\n\t\tvar lMin:Float = minutes;\r\n\t\tvar lHour:Float = hours;\r\n\t\tvar lDay:Float = days;\r\n\r\n\t\tlMin *= 60;\r\n\t\tlHour *= 3600;\r\n\t\tlDay *= (24 * 3600);\r\n\t\t\t\t\r\n\t\treturn DateTools.seconds(seconds + lMin + lHour + lDay);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Calcule le temps restant (en secondes) d'une construction en fonction de sa date de fin prvue\r\n\t * @param\tpDateEnd\r\n\t * @return temps restant en secondes\r\n\t */\r\n\tpublic function getTimeInSecondsToFinishBuilding(pDateEnd:Date):Float\r\n\t{\r\n\t\tvar difference:Float= Date.now().getTime() - pDateEnd.getTime();\r\n\t\treturn difference/1000;\r\n\t}\r\n\t\r\n\tpublic function getTimeToFinishBuildingStringFormat(pDateEnd:Date):String\r\n    {\r\n        var time:Float = pDateEnd.getTime() - Date.now().getTime();\r\n        time /= 1000;\r\n\r\n        var days:Int=0;\r\n        var hours:Int=0;\r\n        var minutes:Int=0;\r\n        var seconds:Int = 0;\r\n\t\t\r\n        days = Math.floor(time / 86400);\r\n        hours = Math.floor(time % 86400 / 3600);\r\n        minutes = Math.floor(time % 3600 / 60);\r\n        seconds = Math.floor(time % 60);\r\n        \r\n        if(days!=0) return days+\"d:\"+hours+\"h:\"+minutes+\"m:\"+seconds+\"s\";  \r\n        if(days ==0 && hours!=0) return hours+\"h:\"+minutes+\"m:\"+seconds+\"s\";  \r\n        if(days ==0 && hours ==0 && minutes != 0) return minutes+\"m:\"+seconds+\"s\";  \r\n        else return Std.string(seconds+\"s\");  \r\n    }\r\n\r\n\tpublic function getPercentage(pDateStart:Date, pDateEnd:Date):Int\r\n\t{\r\n\t\tvar percentage:Int = Math.round((Date.now().getTime() - pDateStart.getTime()) / (pDateEnd.getTime() - pDateStart.getTime()) * 100);\r\n\t\treturn percentage;\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.services.deltaDNA;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Http;\r\nimport haxe.Json;\r\n\r\ntypedef DeltaDNAEvent =\r\n{\r\n\tvar eventName:String;\r\n\tvar userID:String;\r\n\tvar sessionID:String;\r\n\tvar eventParams: Dynamic;\t\r\n}\r\n\r\ntypedef DeltaDNAEngage =\r\n{\r\n\tvar decisionPoint:String;\r\n\tvar userID:String;\r\n\tvar sessionID:String;\r\n\tvar platform:String;\r\n\tvar parameters: Dynamic;\t\r\n}\r\n\r\n/**\r\n * Classe permettant d'envoyer des donnes  la plateforme DeltaDNA \r\n * @author Mathieu Anthoine\r\n */\r\nclass DeltaDNA\r\n{\r\n\r\n\tpublic static inline var GAME_STARTED:String = \"gameStarted\";\r\n\tpublic static inline var GAME_ENDED:String = \"gameEnded\";\r\n\tpublic static inline var CLIENT_DEVICE:String = \"clientDevice\";\r\n\tpublic static inline var NEW_PLAYER:String = \"newPlayer\";\t\r\n\t\r\n\tprivate static var userID:String;\r\n\tprivate static var sessionID:String;\r\n\tprivate static var platform:String;\r\n\t\r\n\tprivate static var devices:Map<String,String> = \t[\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_ANDROID => \"ANDROID\",\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_IOS => \"IOS\",\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_BLACKBERRY => \"BLACKBERRY_MOBILE\",\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_BB_PLAYBOOK => \"BLACKBERRY_TABLET\",\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_WINDOWS_MOBILE => \"WINDOWS_MOBILE\",\r\n\t\t\t\t\t\tDeviceCapabilities.SYSTEM_DESKTOP => \"PC_CLIENT\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\r\n\tprivate static var collectURL : String;\r\n\tprivate static var engageURL : String;\r\n\t\r\n\tprivate static var devKey : String;\r\n\tprivate static var liveKey : String;\r\n\t\r\n\tpublic static var onData:String->Void;\r\n\tpublic static var onError:String->Void;\r\n\tpublic static var onGetUserID:String->Void;\t\r\n\t\r\n\tprivate static var list:Array<DeltaDNAEvent> = [];\r\n\t\r\n\tprivate static function _onData (pData:String): Void {\r\n\t\ttrace (\"DeltaDNA success: \"+pData);\r\n\t}\r\n\t\r\n\tprivate static function _onError (pError:String): Void {\r\n\t\ttrace (\"DeltaDNA error: \"+pError);\r\n\t}\t\r\n\t\r\n\tprivate static function _onGetUserID (pData:String):Void {\r\n\t\ttrace (Json.parse(pData).userID);\r\n\t}\r\n\t\t\r\n\tprivate static function request (pRequest:Http):Void {\r\n\t\tpRequest.onError = onError;\r\n\t\tpRequest.request(true);\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise le service\r\n\t */\r\n\tpublic static function init (pDevKey:String, pLiveKey:String, pCollectURL:String, pEngageURL:String,pUserID:String,pSessionID:String):Void {\r\n\t\tcollectURL = pCollectURL;\r\n\t\tengageURL = pEngageURL;\r\n\t\tdevKey = pDevKey;\r\n\t\tliveKey = pLiveKey;\t\t\r\n\t\tuserID = pUserID;\r\n\t\tsessionID = pSessionID;\r\n\t\tplatform = devices[DeviceCapabilities.system];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Rcupre un userID\r\n\t */\r\n\tpublic static function getUserID ():Void {\r\n\t\tvar lRequest:Http=new Http(collectURL+\"/uuid\");\r\n\t\tlRequest.onData = onGetUserID == null ? _onGetUserID : onGetUserID;\r\n\t\tlRequest.onError = onError==null ? _onError : onError;\r\n\t\trequest(lRequest);\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Permet d'ajouter un event DeltaDNA  la liste des events\r\n\t * @param\tpEventName Nom de l'event\r\n\t * @param\tpParams Objet dcrivant les paramtres  transmettre\r\n\t */\r\n\tpublic static function addEvent (pEventName:String,pParams:Dynamic=null):Void {\t\t\t\r\n\t\t\r\n\t\tif (pParams == null) pParams = {};\r\n\t\tpParams.platform = platform;\r\n\t\tvar lEvent:DeltaDNAEvent ={\r\n\t\t\teventName:pEventName,\r\n\t\t\tuserID:userID,\r\n\t\t\tsessionID:sessionID,\r\n\t\t\teventParams: pParams\r\n\t\t};\r\n\t\t\r\n\t\tlist.push(lEvent);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Permet d'envoyer tous les events ajouts\r\n\t * @param\tpLive Event LIVE ou DEV\r\n\t */\r\n\tpublic static function send (pLive:Bool=false):Void {\r\n\t\tvar lJson:Dynamic;\r\n\t\tvar lSuffix:String = \"\";\r\n\t\t\r\n\t\tif (list.length == 1) lJson = list[0];\r\n\t\telse if (list.length > 1) {\r\n\t\t\tlJson = { eventList : list }\r\n\t\t\tlSuffix = \"/bulk\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttrace(\"DeltaDNA: Pas d'Event  envoyer\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar lUrl:String = collectURL + \"/\" + (pLive ? liveKey : devKey) + lSuffix;\r\n\t\t\r\n\t\tvar lRequest:Http = new Http(lUrl);\r\n\t\tlRequest.addHeader(\"Content-Type\", \"application/json\");\r\n\t\tlRequest.setPostData(Json.stringify(lJson));\r\n\t\tlRequest.onData = onData==null ? _onData : onData;\r\n\t\tlRequest.onError = onError==null ? _onError : onError;\r\n\t\trequest(lRequest);\r\n\t\t\r\n\t\tlist = [];\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Permet d'interroger la platforme DeltaDNA sur la disponibilit de campagnes\r\n\t * @param\tpDecisionPoint le point de dcision interrog\r\n\t * @param\tpParams Objet dcrivant les paramtres  transmettre\r\n\t */\r\n\tpublic static function engage (pDecisionPoint:String,pLive:Bool=false,pParams:Dynamic=null):Void {\r\n\t\t\r\n\t\tif (pParams == null) pParams = {};\r\n\t\tvar lUrl: String = engage + \"/\" + (pLive ? liveKey : devKey);\r\n\t\t\r\n\t\tvar lEngage:DeltaDNAEngage=  {\r\n\t\t\tdecisionPoint: pDecisionPoint,\r\n\t\t\tuserID: userID,\r\n\t\t\tsessionID: sessionID,\r\n\t\t\tplatform: platform,\r\n\t\t\tparameters: pParams\r\n\t\t};\r\n\t\t\r\n\t\tvar lUrl:String = engageURL + \"/\" + (pLive ? liveKey : devKey);\r\n\t\t\r\n\t\tvar lRequest:Http = new Http(lUrl);\r\n\t\tlRequest.addHeader(\"Content-Type\", \"application/json\");\r\n\t\tlRequest.setPostData(Json.stringify(lEngage));\r\n\t\tlRequest.onData = onData==null ? _onData : onData;\r\n\t\tlRequest.onError = onError==null ? _onError : onError;\r\n\t\trequest(lRequest);\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n","package com.isartdigital.services.facebook;\r\n\r\nimport com.isartdigital.services.facebook.events.FacebookEventType;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Json;\r\nimport haxe.Timer;\r\nimport js.Browser;\r\nimport js.html.Element;\r\nimport js.html.HTMLDocument;\r\nimport js.html.ScriptElement;\r\nimport js.html.SourceElement;\r\n\r\n/**\r\n * Classe haxe permettant l'accs  l'api Facebook \r\n * @author Mathieu Anthoine\r\n * @version 0.2.0\r\n */\r\nclass Facebook\r\n{\r\n\t/**\r\n\t * reference vers l'objet Facebook Js ou CocoonJs\r\n\t */\r\n\tprivate static var fb:Dynamic;\r\n\t\r\n\t/**\r\n\t * access token\r\n\t */\r\n\tpublic static var token (default, null):String;\r\n\r\n\t/**\r\n\t * user id\r\n\t */\r\n\tpublic static var uid (default, null):String;\t\r\n\t\r\n\t/**\r\n\t * paramtres d'initialisation\r\n\t */\r\n\tprivate static var params:FacebookParams = { xfbml:true, version:\"v2.8\", cookie:true };\r\n\t\r\n\t/**\r\n\t * permissions de l'application\r\n\t */\r\n\tprivate static var permissions:Permissions = { scope:\"user_friends,email\" };\r\n\t\r\n\t/**\r\n\t * premiere demande de Login\r\n\t */\r\n\tprivate static var isFirstAttempt:Bool = true;\r\n\t\r\n\t/**\r\n\t * callback de connexion\r\n\t */\r\n\tpublic static var onLogin:Void->Void;\r\n\t\r\n\t/**\r\n\t * callback de dconnexion\r\n\t */\r\n\tpublic static var onLogout:Response->Void;\r\n\t\r\n\t/**\r\n\t * callback d'annulation d'une fenetre\r\n\t */\r\n\tpublic static var onCancel:Response-> Void;\r\n\t\r\n\t/**\r\n\t * Le plugin ou le SDK n'est pas charg\r\n\t */\r\n\tpublic static var onNotReady:Void->Void;\r\n\t\r\n\t/**\r\n\t * Chargement et connexion  l'app Facebook\r\n\t * @param\tpAppId\r\n\t * @param\tpPermissions\r\n\t * @param\tpParams\r\n\t */\r\n\tpublic static function load (pAppId:String,?pPermissions:Permissions=null,?pParams:FacebookParams=null):Void {\r\n\t\tif (fb != null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (pParams != null) params = pParams;\r\n\t\tparams.appId = pAppId; \r\n\t\t\r\n\t\tif (pPermissions!=null) permissions = pPermissions;\t\r\n\t\t\r\n\t\tif (DeviceCapabilities.isCocoonJS) {\r\n\t\t\tTimer.delay(onCocoonJsLoaded, 1000);\r\n\t\t} else {\r\n\t\t\tuntyped Browser.window.fbAsyncInit = initBrowser;\r\n\t\t\r\n\t\t\tvar lDoc:HTMLDocument = Browser.window.document;\r\n\t\t\tvar lScript:String = \"script\";\r\n\t\t\tvar lID:String = \"facebook-jssdk\";\r\n\t\t\tvar lJs:ScriptElement;\r\n\t\t\tvar lFjs:Element = lDoc.getElementsByTagName(lScript)[0];\r\n\t\t\t\t\t\r\n\t\t\tif (lDoc.getElementById(params.appId)!=null) return;\r\n\t\t\t\r\n\t\t\tlJs = cast (lDoc.createElement(lScript),ScriptElement);\r\n\t\t\tlJs.id = lID;\r\n\t\t\tlJs.src = \"//connect.facebook.net/en_US/sdk.js\";\r\n\t\t\tlFjs.parentNode.insertBefore(lJs, lFjs);\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialisation du plugin Facebook pour CocoonJs\r\n\t */\r\n\tprivate static function onCocoonJsLoaded ():Void {\r\n\t\tif (untyped Browser.window.Cocoon && untyped Browser.window.Cocoon.Social && untyped Browser.window.Cocoon.Social.Facebook) {\r\n\t\t\tfb = untyped Browser.window.Cocoon.Social.Facebook;\r\n\t\t\tfb.init(params, initCocoonJs);\r\n        } \r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialisation asynchrone de la lib Facebook pour navigateur\r\n\t */\r\n\tprivate static function initBrowser ():Void {\t\r\n\t\tfb = untyped FB;\r\n\t\tfb.init(params);\t\t\r\n\t\tfb.getLoginStatus(onLoginStatus);\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * callback d'initialisation du plugin Facebook pour CocoonJs\r\n\t * @param\tpError\r\n\t */\r\n\tprivate static function initCocoonJs (pError:Dynamic) {\r\n\t\tif (pError != null) trace (\"Init CocoonJs: \" + pError);\r\n\t\telse if (pError==false) {\r\n\t\t\tif (onCancel != null) onCancel({status:\"Facebook app not installed\"});\r\n\t\t} else {\r\n\t\t\tfb.on(\"loginStatusChanged\", onLoginStatus);\r\n\t\t\tfb.getLoginStatus(onLoginStatus);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Permet de dterminer su un utilisateur est logg dans Facebook et si il ne l'est pas tente de le connecter automatiquement\r\n\t * @param\tpResponse\r\n\t */\r\n\tprivate static function onLoginStatus (pResponse:Response):Void {\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tif (pResponse.status == FacebookEventType.CONNECTED) {\r\n\t\t\ttoken = pResponse.authResponse.accessToken;\r\n\t\t\tuid = pResponse.authResponse.userID;\r\n\t\t\tif (onLogin != null) onLogin();\r\n\t\t\telse trace (\"Facebook Log in\");\r\n\t\t} else if (isFirstAttempt) {\r\n\t\t\ttrace (\"Facebook retry Log in\");\r\n\t\t\tisFirstAttempt = false;\r\n\t\t\tlogin();\r\n\t\t} else if (pResponse.status == FacebookEventType.UNKNOWN) {\r\n\t\t\tif (onCancel != null) onCancel(pResponse);\r\n\t\t\telse trace (\"Facebook canceled Log in\");\r\n\t\t} else {\r\n\t\t\tif (onCancel != null) onCancel(pResponse);\r\n\t\t\telse trace (\"Facebook canceled action\");\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Ouvre la popin de Log in et permet  l'utilisateur de se logger\r\n\t * Est automatiquement appel par Facebook.load\r\n\t */\r\n\tpublic static function login ():Void {\r\n\t\tif (fb == null) notReady();\r\n\t\telse if (DeviceCapabilities.isCocoonJS) fb.login(permissions);\r\n\t\telse fb.login(onLoginStatus, permissions);\r\n\t}\r\n\t\r\n\tpublic static function logout ():Void {\r\n\t\tif (fb == null) notReady();\r\n\t\telse fb.logout(_onLogout);\r\n\t}\r\n\t\r\n\tprivate static function _onLogout (pResponse:Response): Void {\r\n\t\tif (onLogout != null) onLogout(pResponse);\r\n\t\telse trace (\"Facebook Log out\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * informations de l'application une fois connecte\r\n\t */\r\n\tpublic static function getAuthResponse ():AuthResponse {\r\n\t\tif (fb == null) {\r\n\t\t\tnotReady();\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn fb.getAuthResponse();\r\n\t}\r\n\t\r\n\tprivate static function notReady ():Void {\r\n\t\t//TODO: il faut une callback ici pour pouvoir ajouter une popup d'alerte disant qu'il faut se coneccter ou proposer une fenetre de connexion\r\n\t\tif (onNotReady != null) onNotReady();\r\n\t\tif (DeviceCapabilities.isCocoonJS) trace (\"Cocoon Facebook Plugin not loaded\");\r\n\t\telse trace (\"Facebook SDK not loaded\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * permet un appel  Graph API\r\n\t * La mthode peut tre appele de diffrentes facons:\r\n\t * \r\n\t * Facebook.api (pPath,pCallBack);\r\n\t * Facebook.api (pPath,pParams,pCallBack);\r\n\t * Facebook.api (pPath,pMethod,pParams,pCallBack);\r\n\t * \r\n\t * @param\tpPath path de la graph API\r\n\t * @param\tpMethod mthode HTTP (\"get\",\"post\", \"delete\")\r\n\t * @param\tpParams paramtres  passer  l'appel\r\n\t * @param\tpCallBack fonction de retour\r\n\t */\r\n\tpublic static function api (pPath:String,pMethod:Dynamic,?pParams:Dynamic,?pCallBack:Dynamic): Void {\r\n\t\tif (fb == null) notReady();\r\n\t\telse {\r\n\t\t\tif (DeviceCapabilities.isCocoonJS) {\r\n\t\t\t\tif (pParams == null) {\r\n\t\t\t\t\tpCallBack = pMethod;\r\n\t\t\t\t\tpParams = {};\r\n\t\t\t\t\tpMethod = \"get\";\r\n\t\t\t\t} else if (pCallBack == null) {\r\n\t\t\t\t\tpCallBack = pParams;\r\n\t\t\t\t\tpMethod = \"get\";\r\n\t\t\t\t}\r\n\t\t\t\tpParams.access_token = token;\r\n\t\t\t}\r\n\t\t\tfb.api(pPath, pMethod, pParams, pCallBack);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * permet de dclencher l'apparition de diffrentes fentres de dialogue UI\r\n\t * @param\tpParams paramtres de la fentre appele\r\n\t * @param\tpCallBack function appele  la fermeture de la fentre de dialogue\r\n\t */\r\n\tpublic static function ui (pParams:Dynamic,?pCallBack:Dynamic->Void): Void {\r\n\t\tif (fb == null) notReady();\r\n\t\telse {\r\n\t\t\tif (DeviceCapabilities.isCocoonJS) pParams.app_id = params.appId;\r\n\t\t\tfb.ui (pParams, pCallBack);\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n}\r\n\r\n\r\n","package com.isartdigital.services.monetization;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.events.LoadEventType;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.Popin;\r\nimport com.isartdigital.utils.ui.UIPosition;\r\nimport haxe.Json;\r\nimport haxe.Timer;\r\nimport js.Browser;\r\nimport js.Lib;\r\nimport js.html.VideoElement;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.text.Text;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.interaction.EventTarget;\r\nimport pixi.loaders.Loader;\r\n\r\n/**\r\n * Service permettant d'afficher des publicits des autres Builder\r\n * @author Mathieu Anthoine\r\n */\r\nclass Ads\r\n{\r\n\r\n\t/**\r\n\t * Publicit vido vu jusqu'au bout\r\n\t */\r\n\tpublic static inline var TYPE_END:String = \"end\";\r\n\t\r\n\t/**\r\n\t * Annulation du visionnage d'une publicit vido ou fermeture d'une publicit image\r\n\t */\r\n\tpublic static inline var TYPE_CANCEL:String = \"cancel\";\r\n\t\r\n\t/**\r\n\t * Fermeture d'une publicit image\r\n\t */\r\n\tpublic static inline var TYPE_CLOSE:String = \"close\";\r\n\t\r\n\t/**\r\n\t * click sur la publicit\r\n\t */\r\n\tpublic static inline var TYPE_CLICK:String = \"click\";\r\n\t\r\n\t/**\r\n\t * pub image\r\n\t */\r\n\tprivate static inline var IMAGE:String = \"image\";\r\n\r\n\t/**\r\n\t * pub vido\r\n\t */\r\n\tprivate static inline var MOVIE:String = \"movie\";\t\r\n\t\r\n\tprivate static var current:Ad;\r\n\t\r\n\tprivate static var callback:Dynamic->Void;\t\r\n\r\n\t/**\r\n\t * Demande l'affichage d'un publicit image\r\n\t * @param\tpCallback fonction  appele une fois la publicit affiche et quitte\r\n\t * @return true si la demande d'affichage est accepte, sinon false (quand une autre pub est en cours)\r\n\t */\r\n\tpublic static function getImage (pCallback:Dynamic->Void): Bool {\r\n\t\treturn askForImage(pCallback);\r\n\t}\r\n\t\r\n\tprivate static function askForImage (pCallback:Dynamic->Void,pVideo:String=\"\"):Bool {\r\n\t\tif (current!=null || (Config.data.ads!=null && !Config.data.ads)) return false;\r\n\t\t\r\n\t\tvar lRequest:HttpService = initService(pCallback);\r\n\t\tlRequest.addParameter(\"ad\", IMAGE);\r\n\t\tif (pVideo!=\"\") lRequest.addParameter(\"movie\", pVideo);\r\n\t\tlRequest.request();\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Demande l'affichage d'un publicit vido\r\n\t * @param\tpCallback fonction  appele une fois la publicit affiche et quitte\r\n\t * @return true si la demande d'affichage est accepte, sinon false (quand une autre pub est en cours)\r\n\t */\r\n\tpublic static function getMovie (pCallback:Dynamic->Void): Bool {\r\n\t\tif (current!=null || (Config.data.ads!=null && !Config.data.ads)) return false;\r\n\t\t\r\n\t\tif (DeviceCapabilities.isCanvasPlus) return getImage(pCallback);\r\n\t\t\r\n\t\tvar lRequest:HttpService = initService(pCallback);\r\n\t\tlRequest.addParameter(\"ad\", MOVIE);\r\n\t\tlRequest.request();\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\tprivate static function initService (pCallback:Dynamic->Void):HttpService {\r\n\t\tvar lRequest:HttpService = new HttpService(pCallback);\r\n\t\tcallback = pCallback;\r\n\t\tlRequest.addParameter(\"type\", DeviceCapabilities.textureType);\r\n\t\tlRequest.addParameter(\"lang\", Config.language);\r\n\t\tlRequest.onData = onData;\r\n\t\treturn lRequest;\r\n\t}\r\n\t\r\n\tprivate static function onData (pData:String): Void {\r\n\t\tvar lData:Dynamic = Json.parse(pData);\r\n\t\tif (lData.type == MOVIE) current=new AdMovie(lData.id,lData.url,lData.target);\r\n\t\telse current=new AdImage(lData.id,lData.url,lData.target);\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate static function onQuit (pClose:String):Void {\r\n\t\tvar lId:String = current.id;\r\n\t\tcurrent.close();\r\n\t\tcurrent = null;\r\n\t\t\r\n\t\tif (pClose == TYPE_END) askForImage(callback, lId);\r\n\t\telse {\r\n\t\t\tif (pClose == TYPE_CLOSE || pClose == TYPE_CLICK) {\r\n\t\t\t\tvar lRequest:HttpService = new HttpService();\t\t\t\r\n\t\t\t\tlRequest.addParameter(\"close\", pClose == TYPE_CLICK ? TYPE_CLICK : IMAGE);\r\n\t\t\t\tlRequest.request();\r\n\t\t\t}\r\n\t\t\tcallback({close:pClose});\r\n\t\t\tcallback = null;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\nprivate class Ad extends Popin {\r\n\t\r\n\tpublic var id:String;\r\n\tprivate var url:String;\r\n\tprivate var target:String;\r\n\tprivate var content:Sprite;\r\n\tprivate var btnQuit:Container;\r\n\tprivate var txtQuit:Text;\r\n\tprivate var timer:Timer;\r\n\tprivate var timerError:Timer;\r\n\tprivate var duration:Int;\r\n\t\r\n\tprivate static inline var CROSS_SIZE:Int = 20;\r\n\tprivate static inline var QUIT_SIZE:Int = 40;\t\r\n\t\r\n\tpublic function new (pId:String,pUrl:String,pTarget:String) {\r\n\t\tsuper();\r\n\t\tmodalImage = \"assets/black_bg.png\";\r\n\t\t\r\n\t\tid = pId;\r\n\t\turl = pUrl;\r\n\t\ttarget = pTarget;\r\n\t\t\r\n\t\tbtnQuit = new Container();\r\n\t\taddChild (btnQuit);\r\n\t\t\r\n\t\tpositionables.unshift( { item:btnQuit, align:Math.random() < 0.5 ? UIPosition.TOP_RIGHT : UIPosition.TOP_LEFT , offsetX:80, offsetY:80 } );\r\n\t\t\r\n\t\tvar lCircle:Graphics = new Graphics();\r\n\t\tlCircle.lineStyle(4, 0x000000);\r\n\t\tlCircle.beginFill(0xFFFFFF);\r\n\t\tlCircle.drawCircle(0, 0, QUIT_SIZE);\r\n\t\tlCircle.endFill();\r\n\t\tbtnQuit.addChild(lCircle);\r\n\t\t\r\n\t\ttxtQuit = new Text(\"\", { font: \"62px Arial\", fill: \"#000000\", align: \"center\" } );\r\n\t\ttxtQuit.anchor.set(0.5, 0.5);\r\n\t\tbtnQuit.addChild(txtQuit);\r\n\t\tbtnQuit.interactive = true;\r\n\t\tbtnQuit.visible = false;\r\n\t\ttimerError = new Timer(15000);\r\n\t\ttimerError.run = onError;\r\n\t\t\r\n\t\tx = GameStage.getInstance().safeZone.width / 2;\r\n\t\ty = GameStage.getInstance().safeZone.height / 2;\r\n\t\t\r\n\t\tGameStage.getInstance().addChild(this);\r\n\t\topen();\r\n\t\t\t\r\n\t}\r\n\t\r\n\tprivate function onError ():Void {\r\n\t\tif (!btnQuit.visible) {\r\n\t\t\tbtnQuit.visible = true;\r\n\t\t\tduration = 0;\r\n\t\t\tonTimer();\r\n\t\t}\r\n\t\ttimerError.stop();\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function onTimer():Void {\r\n\t\tif (duration <= 0) {\r\n\t\t\tif (timer!=null) timer.stop();\r\n\t\t\tallowQuit();\r\n\t\t} else {\r\n\t\t\ttxtQuit.text = Std.string(duration);\r\n\t\t}\r\n\t\tduration--;\r\n\t}\r\n\t\r\n\tprivate function allowQuit ():Void {\r\n\t\tbtnQuit.removeChild(txtQuit);\r\n\t\tvar lCross:Graphics = new Graphics();\r\n\t\tlCross.lineStyle(8, 0x000000);\r\n\t\tlCross.moveTo( -CROSS_SIZE, -CROSS_SIZE);\r\n\t\tlCross.lineTo(CROSS_SIZE, CROSS_SIZE);\r\n\t\tlCross.moveTo( -CROSS_SIZE, CROSS_SIZE);\r\n\t\tlCross.lineTo(CROSS_SIZE, -CROSS_SIZE);\r\n\t\tbtnQuit.addChild(lCross);\r\n\t\t\r\n\t\tbtnQuit.buttonMode = true;\r\n\t\tbtnQuit.once(MouseEventType.CLICK, onQuit);\r\n\t\tbtnQuit.once(TouchEventType.TAP, onQuit);\r\n\t}\r\n\t\r\n\tprivate function createContent ():Void {}\r\n\t\r\n\tprivate function onComplete(?pEvent:Loader=null):Void {\r\n\t\tcreateContent();\r\n\t\tcontent.anchor.set(0.5, 0.5);\r\n\t\tcontent.scale.set(1 /DeviceCapabilities.textureRatio , 1 / DeviceCapabilities.textureRatio);\r\n\t\taddChildAt(content, 0);\r\n\t\t\r\n\t\ttimer = new Timer(1000);\r\n\t\tduration = Math.random() < 0.5 ? 0 : 5;\r\n\t\ttimer.run = onTimer;\r\n\t\tonTimer();\r\n\t\tbtnQuit.visible = true;\r\n\t}\r\n\t\r\n\tprivate function quit (pType:String):Void {\r\n\t\tGameStage.getInstance().removeChild(this);\r\n\t\tuntyped Ads.onQuit(pType);\r\n\t}\r\n\t\r\n\tprivate function onQuit (pEvent:EventTarget):Void {\r\n\t}\r\n\t\r\n\toverride public function close (): Void {\r\n\t\tif (timer!=null) timer.stop();\r\n\t\tif (timerError!=null) timerError.stop();\r\n\t\tsuper.close();\r\n\t}\r\n}\r\n\r\nprivate class AdImage extends Ad {\r\n\tpublic function new (pId:String,pUrl:String,pTarget:String) {\r\n\t\tsuper(pId,pUrl, pTarget);\r\n\t\t\r\n\t\tvar lLoader:Loader = new Loader();\r\n\t\tlLoader.add(url);\r\n\t\tlLoader.once(LoadEventType.COMPLETE, onComplete);\r\n\t\tlLoader.load();\r\n\t}\r\n\t\r\n\toverride private function onComplete (?pEvent:Loader = null):Void {\r\n\t\tsuper.onComplete(pEvent);\r\n\t\tcontent.interactive = true;\r\n\t\tcontent.buttonMode = true;\r\n\t\tcontent.once(MouseEventType.CLICK, onOpen);\r\n\t\tcontent.once(TouchEventType.TAP, onOpen);\r\n\t}\r\n\t\r\n\toverride private function createContent ():Void {\r\n\t\tcontent = new Sprite(Texture.fromImage(url));\r\n\t}\r\n\t\r\n\tprivate function onOpen (pEvent:EventTarget):Void {\r\n\t\tBrowser.window.open(target+\"?\"+Type.getClassName(Type.getClass(this)).split(\".\").pop());\r\n\t\tquit(Ads.TYPE_CLICK);\r\n\t}\r\n\t\r\n\toverride private function onQuit (pEvent:EventTarget):Void {\r\n\t\tquit (Ads.TYPE_CLOSE);\r\n\t}\r\n}\r\n\r\nprivate class AdMovie extends Ad {\r\n\t\r\n\tpublic function new (pId:String,pUrl:String,pTarget:String) {\r\n\t\tsuper(pId,pUrl, pTarget);\r\n\t\tonComplete();\r\n\t}\r\n\t\r\n\toverride private function onComplete (?pEvent:Loader=null):Void {\r\n\t\tsuper.onComplete(pEvent);\r\n\t\t\r\n\t\tif (DeviceCapabilities.textureType == DeviceCapabilities.TEXTURE_LD) {\r\n\t\t\tcontent.scale.x *= 0.8;\r\n\t\t\tcontent.scale.y *= 0.8;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\toverride private function createContent ():Void {\r\n\t\tvar texture:Texture = Texture.fromVideoUrl(url);\r\n\t\tvar source:VideoElement = texture.baseTexture.source;\r\n\t\t\r\n\t\tsource.crossOrigin = \"anonymous\";\r\n\t\t\r\n\t\tcontent = new Sprite(texture);\r\n\t\tcast(content.texture.baseTexture.source, VideoElement).onended = onEnded;\r\n\t\t//Timer.delay(onEnded, 1000);\t\t\r\n\t\t\r\n\t}\r\n\r\n\toverride private function onQuit (pEvent:EventTarget):Void {\r\n\t\tquit (Ads.TYPE_CANCEL);\r\n\t}\t\r\n\t\r\n\tprivate function onEnded ():Void {\r\n\t\tquit(Ads.TYPE_END);\r\n\t}\r\n\t\r\n\toverride public function close ():Void {\r\n\t\tif (content != null) {\r\n\t\t\tcast(content.texture.baseTexture.source, VideoElement).onended = null;\r\n\t\t\tcast(content.texture.baseTexture.source, VideoElement).pause();\r\n\t\t}\r\n\t\tsuper.close();\r\n\t}\r\n\t\r\n}\r\n","package com.isartdigital.services.monetization;\r\nimport haxe.Json;\r\n\r\n/**\r\n * Service Bancaire\r\n * @author Mathieu Anthoine\r\n */\r\nclass Bank\r\n{\r\n\t/**\r\n\t * enregistrer les achats inApp\r\n\t * @param\tpAmount montant de l'achat\r\n\t * @param\tpCallback fonction appele au retour de l'information\r\n\t */\r\n\tpublic static function deposit (pAmount:Float,pCallback:Dynamic->Void): Void {\r\n\t\tinitService(\"deposit\", pAmount, pCallback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * rembourser un trop percu\r\n\t * @param\tpAmount montant  rembourser\r\n\t * @param\tpCallback fonction appele au retour de l'information\r\n\t */\r\n\tpublic static function refund (pAmount:Float,pCallback:Dynamic->Void): Void {\r\n\t\tinitService(\"refund\", pAmount, pCallback);\r\n\t}\t\r\n\t\r\n\t/**\r\n\t * donne accs au total des revenus gnrs\r\n\t * @param\tpCallback fonction appele au retour de l'information\r\n\t */\r\n\tpublic static function account (pCallback:Dynamic->Void=null): Void {\r\n\t\tvar lRequest:HttpService = new HttpService(pCallback);\r\n\t\tlRequest.addParameter(\"account\", \"\");\r\n\t\tlRequest.request(true);\r\n\t}\r\n\t\r\n\tprivate static function initService (pService:String,pAmount:Dynamic,pCallback:Dynamic->Void):Void {\r\n\t\tvar lRequest:HttpService = new HttpService(pCallback);\r\n\t\tif (pAmount <= 0) {\r\n\t\t\tlRequest.onData (Json.stringify({error: \"zero or negative value forbidden\", code: 21}));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlRequest.addParameter(pService, Std.string(pAmount));\r\n\t\tlRequest.request(true);\r\n\t}\r\n\t\r\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n#if sys\n\nimport sys.net.Host;\nimport sys.net.Socket;\n\n#end\n\n/**\n\tThis class can be used to handle Http requests consistently across\n\tplatforms. There are two intended usages:\n\n\t- call `haxe.Http.requestUrl(url)` and receive the result as a `String`\n\t(not available on flash)\n\t- create a `new haxe.Http(url)`, register your callbacks for `onData`, \n\t`onError` and `onStatus`, then call `request()`.\n**/\nclass Http {\n\n\t/**\n\t\tThe url of `this` request. It is used only by the `request()` method and\n\t\tcan be changed in order to send the same request to different target\n\t\tUrls.\n\t**/\n\tpublic var url : String;\n\tpublic var responseData(default, null) : Null<String>;\n#if sys\n\tpublic var noShutdown : Bool;\n\tpublic var cnxTimeout : Float;\n\tpublic var responseHeaders : Map<String,String>;\n\tvar chunk_size : Null<Int>;\n\tvar chunk_buf : haxe.io.Bytes;\n\tvar file : { param : String, filename : String, io : haxe.io.Input, size : Int, mimeType : String };\n#elseif js\n\tpublic var async : Bool;\n\tpublic var withCredentials : Bool;\n#end\n\tvar postData : String;\n\tvar headers : List<{ header:String, value:String }>;\n\tvar params : List<{ param:String, value:String }>;\n\n\t#if sys\n\tpublic static var PROXY : { host : String, port : Int, auth : { user : String, pass : String } } = null;\n\t#end\n\n\t/**\n\t\tCreates a new Http instance with `url` as parameter.\n\n\t\tThis does not do a request until `request()` is called.\n\n\t\tIf `url` is null, the field url must be set to a value before making the\n\t\tcall to `request()`, or the result is unspecified.\n\n\t\t(Php) Https (SSL) connections are allowed only if the OpenSSL extension\n\t\tis enabled.\n\t**/\n\tpublic function new( url : String ) {\n\t\tthis.url = url;\n\t\theaders = new List<{ header:String, value:String }>();\n\t\tparams = new List<{ param:String, value:String }>();\n\n\t\t#if js\n\t\tasync = true;\n\t\twithCredentials = false;\n\t\t#elseif sys\n\t\tcnxTimeout = 10;\n\t\t#end\n\t\t#if php\n\t\tnoShutdown = ! untyped __call__('function_exists', 'stream_socket_shutdown');\n\t\t#end\n\t}\n\n\t/**\n\t\tSets the header identified as `header` to value `value`.\n\n\t\tIf `header` or `value` are null, the result is unspecified.\n\n\t\tThis method provides a fluent interface.\n\t**/\n\tpublic function setHeader( header : String, value : String ):Http {\n\t\theaders = Lambda.filter(headers, function(h) return h.header != header);\n\t\theaders.push({ header:header, value:value });\n\t\treturn this;\n\t}\n\n\tpublic function addHeader( header : String, value : String ):Http {\n\t\theaders.push({ header:header, value:value });\n\t\treturn this;\n\t}\n\n\t/**\n\t\tSets the parameter identified as `param` to value `value`.\n\n\t\tIf `header` or `value` are null, the result is unspecified.\n\n\t\tThis method provides a fluent interface.\n\t**/\n\tpublic function setParameter( param : String, value : String ):Http {\n\t\tparams = Lambda.filter(params, function(p) return p.param != param);\n\t\tparams.push({ param:param, value:value });\n\t\treturn this;\n\t}\n\n\tpublic function addParameter( param : String, value : String ):Http {\n\t\tparams.push({ param:param, value:value });\n\t\treturn this;\n\t}\n\n\t/**\n\t\tSets the post data of `this` Http request to `data`.\n\n\t\tThere can only be one post data per request. Subsequent calls overwrite\n\t\tthe previously set value.\n\n\t\tIf `data` is null, the post data is considered to be absent.\n\n\t\tThis method provides a fluent interface.\n\t**/\n\tpublic function setPostData( data : String ):Http {\n\t\tpostData = data;\n\t\treturn this;\n\t}\n\n\t#if (js || flash)\n\n\t#if js\n\tvar req:js.html.XMLHttpRequest;\n\t#elseif flash\n\tvar req:flash.net.URLLoader;\n\t#end\n\n\t/**\n\t\tCancels `this` Http request if `request` has been called and a response\n\t\thas not yet been received.\n\t**/\n\tpublic function cancel()\n\t{\n\t\tif (req == null) return;\n\t\t#if js\n\t\treq.abort();\n\t\t#elseif flash\n\t\treq.close();\n\t\t#end\n\t\treq = null;\n\t}\n\t#end\n\n\t/**\n\t\tSends `this` Http request to the Url specified by `this.url`.\n\n\t\tIf `post` is true, the request is sent as POST request, otherwise it is\n\t\tsent as GET request.\n\n\t\tDepending on the outcome of the request, this method calls the\n\t\t`onStatus()`, `onError()` or `onData()` callback functions.\n\n\t\tIf `this.url` is null, the result is unspecified.\n\n\t\tIf `this.url` is an invalid or inaccessible Url, the `onError()` callback\n\t\tfunction is called.\n\n\t\t[js] If `this.async` is false, the callback functions are called before\n\t\tthis method returns.\n\t**/\n\tpublic function request( ?post : Bool ) : Void {\n\t\tvar me = this;\n\t#if js\n\t\tme.responseData = null;\n\t\tvar r = req = js.Browser.createXMLHttpRequest();\n\t\tvar onreadystatechange = function(_) {\n\t\t\tif( r.readyState != 4 )\n\t\t\t\treturn;\n\t\t\tvar s = try r.status catch( e : Dynamic ) null;\n\t\t\tif ( s != null && untyped __js__('\"undefined\" !== typeof window') ) {\n\t\t\t\t// If the request is local and we have data: assume a success (jQuery approach):\n\t\t\t\tvar protocol = js.Browser.location.protocol.toLowerCase();\n\t\t\t\tvar rlocalProtocol = ~/^(?:about|app|app-storage|.+-extension|file|res|widget):$/;\n\t\t\t\tvar isLocal = rlocalProtocol.match( protocol );\n\t\t\t\tif ( isLocal ) {\n\t\t\t\t\ts = r.responseText != null ? 200 : 404;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( s == untyped __js__(\"undefined\") )\n\t\t\t\ts = null;\n\t\t\tif( s != null )\n\t\t\t\tme.onStatus(s);\n\t\t\tif( s != null && s >= 200 && s < 400 ) {\n\t\t\t\tme.req = null;\n\t\t\t\tme.onData(me.responseData = r.responseText);\n\t\t\t}\n\t\t\telse if ( s == null ) {\n\t\t\t\tme.req = null;\n\t\t\t\tme.onError(\"Failed to connect or resolve host\");\n\t\t\t}\n\t\t\telse switch( s ) {\n\t\t\tcase 12029:\n\t\t\t\tme.req = null;\n\t\t\t\tme.onError(\"Failed to connect to host\");\n\t\t\tcase 12007:\n\t\t\t\tme.req = null;\n\t\t\t\tme.onError(\"Unknown host\");\n\t\t\tdefault:\n\t\t\t\tme.req = null;\n\t\t\t\tme.responseData = r.responseText;\n\t\t\t\tme.onError(\"Http Error #\"+r.status);\n\t\t\t}\n\t\t};\n\t\tif( async )\n\t\t\tr.onreadystatechange = onreadystatechange;\n\t\tvar uri = postData;\n\t\tif( uri != null )\n\t\t\tpost = true;\n\t\telse for( p in params ) {\n\t\t\tif( uri == null )\n\t\t\t\turi = \"\";\n\t\t\telse\n\t\t\t\turi += \"&\";\n\t\t\turi += StringTools.urlEncode(p.param)+\"=\"+StringTools.urlEncode(p.value);\n\t\t}\n\t\ttry {\n\t\t\tif( post )\n\t\t\t\tr.open(\"POST\",url,async);\n\t\t\telse if( uri != null ) {\n\t\t\t\tvar question = url.split(\"?\").length <= 1;\n\t\t\t\tr.open(\"GET\",url+(if( question ) \"?\" else \"&\")+uri,async);\n\t\t\t\turi = null;\n\t\t\t} else\n\t\t\t\tr.open(\"GET\",url,async);\n\t\t} catch( e : Dynamic ) {\n\t\t\tme.req = null;\n\t\t\tonError(e.toString());\n\t\t\treturn;\n\t\t}\n\t\tr.withCredentials = withCredentials;\n\t\tif( !Lambda.exists(headers, function(h) return h.header == \"Content-Type\") && post && postData == null )\n\t\t\tr.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n\n\t\tfor( h in headers )\n\t\t\tr.setRequestHeader(h.header,h.value);\n\t\tr.send(uri);\n\t\tif( !async )\n\t\t\tonreadystatechange(null);\n\t#elseif flash\n\t\tme.responseData = null;\n\t\tvar loader = req = new flash.net.URLLoader();\n\t\tloader.addEventListener( \"complete\", function(e) {\n\t\t\tme.req = null;\n\t\t\tme.responseData = loader.data;\n\t\t\tme.onData( loader.data );\n\t\t});\n\t\tloader.addEventListener( \"httpStatus\", function(e:flash.events.HTTPStatusEvent){\n\t\t\t// on Firefox 1.5, Flash calls onHTTPStatus with 0 (!??)\n\t\t\tif( e.status != 0 )\n\t\t\t\tme.onStatus( e.status );\n\t\t});\n\t\tloader.addEventListener( \"ioError\", function(e:flash.events.IOErrorEvent){\n\t\t\tme.req = null;\n\t\t\tme.responseData = loader.data;\n\t\t\tme.onError(e.text);\n\t\t});\n\t\tloader.addEventListener( \"securityError\", function(e:flash.events.SecurityErrorEvent){\n\t\t\tme.req = null;\n\t\t\tme.onError(e.text);\n\t\t});\n\n\t\t// headers\n\t\tvar param = false;\n\t\tvar vars = new flash.net.URLVariables();\n\t\tfor( p in params ){\n\t\t\tparam = true;\n\t\t\tReflect.setField(vars,p.param,p.value);\n\t\t}\n\t\tvar small_url = url;\n\t\tif( param && !post ){\n\t\t\tvar k = url.split(\"?\");\n\t\t\tif( k.length > 1 ) {\n\t\t\t\tsmall_url = k.shift();\n\t\t\t\tvars.decode(k.join(\"?\"));\n\t\t\t}\n\t\t}\n\t\t// Bug in flash player 9 ???\n\t\tvar bug = small_url.split(\"xxx\");\n\n\t\tvar request = new flash.net.URLRequest( small_url );\n\t\tfor( h in headers )\n\t\t\trequest.requestHeaders.push( new flash.net.URLRequestHeader(h.header,h.value) );\n\n\t\tif( postData != null ) {\n\t\t\trequest.data = postData;\n\t\t\trequest.method = \"POST\";\n\t\t} else {\n\t\t\trequest.data = vars;\n\t\t\trequest.method = if( post ) \"POST\" else \"GET\";\n\t\t}\n\n\t\ttry {\n\t\t\tloader.load( request );\n\t\t}catch( e : Dynamic ){\n\t\t\tme.req = null;\n\t\t\tonError(\"Exception: \"+Std.string(e));\n\t\t}\n\t#elseif sys\n\t\tvar me = this;\n\t\tvar output = new haxe.io.BytesOutput();\n\t\tvar old = onError;\n\t\tvar err = false;\n\t\tonError = function(e) {\n\t\t\t#if neko\n\t\t\tme.responseData = neko.Lib.stringReference(output.getBytes());\n\t\t\t#else\n\t\t\tme.responseData = output.getBytes().toString();\n\t\t\t#end\n\t\t\terr = true;\n\t\t\t// Resetting back onError before calling it allows for a second \"retry\" request to be sent without onError being wrapped twice\n\t\t\tonError = old;\n\t\t\tonError(e);\n\t\t}\n\t\tcustomRequest(post,output);\n\t\tif( !err )\n\t\t#if neko\n\t\t\tme.onData(me.responseData = neko.Lib.stringReference(output.getBytes()));\n\t\t#else\n\t\t\tme.onData(me.responseData = output.getBytes().toString());\n\t\t#end\n\t#end\n\t}\n\n#if sys\n\n\t/**\n      Note: Deprecated in 4.0\n\t **/\n\t@:noCompletion\n\tinline public function fileTransfert( argname : String, filename : String, file : haxe.io.Input, size : Int, mimeType = \"application/octet-stream\" ) {\n\t    fileTransfer(argname, filename, file, size, mimeType);\n    }\n\n\tpublic function fileTransfer( argname : String, filename : String, file : haxe.io.Input, size : Int, mimeType = \"application/octet-stream\" ) {\n\t\tthis.file = { param : argname, filename : filename, io : file, size : size, mimeType : mimeType };\n\t}\n\n\tpublic function customRequest( post : Bool, api : haxe.io.Output, ?sock : sys.net.Socket, ?method : String  ) {\n\t\tthis.responseData = null;\n\t\tvar url_regexp = ~/^(https?:\\/\\/)?([a-zA-Z\\.0-9_-]+)(:[0-9]+)?(.*)$/;\n\t\tif( !url_regexp.match(url) ) {\n\t\t\tonError(\"Invalid URL\");\n\t\t\treturn;\n\t\t}\n\t\tvar secure = (url_regexp.matched(1) == \"https://\");\n\t\tif( sock == null ) {\n\t\t\tif( secure ) {\n\t\t\t\t#if php\n\t\t\t\tsock = new php.net.SslSocket();\n\t\t\t\t#elseif java\n\t\t\t\tsock = new java.net.SslSocket();\n\t\t\t\t#elseif (!no_ssl && (hxssl || cpp || (neko && !(macro || interp))))\n\t\t\t\tsock = new sys.ssl.Socket();\n\t\t\t\t#else\n\t\t\t\tthrow \"Https is only supported with -lib hxssl\";\n\t\t\t\t#end\n\t\t\t} else\n\t\t\t\tsock = new Socket();\n\t\t}\n\t\tvar host = url_regexp.matched(2);\n\t\tvar portString = url_regexp.matched(3);\n\t\tvar request = url_regexp.matched(4);\n\t\tif( request == \"\" )\n\t\t\trequest = \"/\";\n\t\tvar port = if ( portString == null || portString == \"\" ) secure ? 443 : 80 else Std.parseInt(portString.substr(1, portString.length - 1));\n\t\tvar data;\n\n\t\tvar multipart = (file != null);\n\t\tvar boundary = null;\n\t\tvar uri = null;\n\t\tif( multipart ) {\n\t\t\tpost = true;\n\t\t\tboundary = Std.string(Std.random(1000))+Std.string(Std.random(1000))+Std.string(Std.random(1000))+Std.string(Std.random(1000));\n\t\t\twhile( boundary.length < 38 )\n\t\t\t\tboundary = \"-\" + boundary;\n\t\t\tvar b = new StringBuf();\n\t\t\tfor( p in params ) {\n\t\t\t\tb.add(\"--\");\n\t\t\t\tb.add(boundary);\n\t\t\t\tb.add(\"\\r\\n\");\n\t\t\t\tb.add('Content-Disposition: form-data; name=\"');\n\t\t\t\tb.add(p.param);\n\t\t\t\tb.add('\"');\n\t\t\t\tb.add(\"\\r\\n\");\n\t\t\t\tb.add(\"\\r\\n\");\n\t\t\t\tb.add(p.value);\n\t\t\t\tb.add(\"\\r\\n\");\n\t\t\t}\n\t\t\tb.add(\"--\");\n\t\t\tb.add(boundary);\n\t\t\tb.add(\"\\r\\n\");\n\t\t\tb.add('Content-Disposition: form-data; name=\"');\n\t\t\tb.add(file.param);\n\t\t\tb.add('\"; filename=\"');\n\t\t\tb.add(file.filename);\n\t\t\tb.add('\"');\n\t\t\tb.add(\"\\r\\n\");\n\t\t\tb.add(\"Content-Type: \"+file.mimeType+\"\\r\\n\"+\"\\r\\n\");\n\t\t\turi = b.toString();\n\t\t} else {\n\t\t\tfor( p in params ) {\n\t\t\t\tif( uri == null )\n\t\t\t\t\turi = \"\";\n\t\t\t\telse\n\t\t\t\t\turi += \"&\";\n\t\t\t\turi += StringTools.urlEncode(p.param)+\"=\"+StringTools.urlEncode(p.value);\n\t\t\t}\n\t\t}\n\n\t\tvar b = new StringBuf();\n\t\tif( method != null ) {\n\t\t\tb.add(method);\n\t\t\tb.add(\" \");\n\t\t} else if( post )\n\t\t\tb.add(\"POST \");\n\t\telse\n\t\t\tb.add(\"GET \");\n\n\t\tif( Http.PROXY != null ) {\n\t\t\tb.add(\"http://\");\n\t\t\tb.add(host);\n\t\t\tif( port != 80 ) {\n\t\t\t\tb.add(\":\");\n\t\t\t\tb.add(port);\n\t\t\t}\n\t\t}\n\t\tb.add(request);\n\n\t\tif( !post && uri != null ) {\n\t\t\tif( request.indexOf(\"?\",0) >= 0 )\n\t\t\t\tb.add(\"&\");\n\t\t\telse\n\t\t\t\tb.add(\"?\");\n\t\t\tb.add(uri);\n\t\t}\n\t\tb.add(\" HTTP/1.1\\r\\nHost: \"+host+\"\\r\\n\");\n\t\tif( postData != null )\n\t\t\tb.add(\"Content-Length: \"+postData.length+\"\\r\\n\");\n\t\telse if( post && uri != null ) {\n\t\t\tif( multipart || !Lambda.exists(headers, function(h) return h.header == \"Content-Type\") ) {\n\t\t\t\tb.add(\"Content-Type: \");\n\t\t\t\tif( multipart ) {\n\t\t\t\t\tb.add(\"multipart/form-data\");\n\t\t\t\t\tb.add(\"; boundary=\");\n\t\t\t\t\tb.add(boundary);\n\t\t\t\t} else\n\t\t\t\t\tb.add(\"application/x-www-form-urlencoded\");\n\t\t\t\tb.add(\"\\r\\n\");\n\t\t\t}\n\t\t\tif( multipart )\n\t\t\t\tb.add(\"Content-Length: \"+(uri.length+file.size+boundary.length+6)+\"\\r\\n\");\n\t\t\telse\n\t\t\t\tb.add(\"Content-Length: \"+uri.length+\"\\r\\n\");\n\t\t}\n\t\tb.add(\"Connection: close\\r\\n\");\n\t\tfor( h in headers ) {\n\t\t\tb.add(h.header);\n\t\t\tb.add(\": \");\n\t\t\tb.add(h.value);\n\t\t\tb.add(\"\\r\\n\");\n\t\t}\n\t\tb.add(\"\\r\\n\");\n\t\tif( postData != null)\n\t\t\tb.add(postData);\n\t\telse if( post && uri != null )\n\t\t\tb.add(uri);\n\t\ttry {\n\t\t\tif( Http.PROXY != null )\n\t\t\t\tsock.connect(new Host(Http.PROXY.host),Http.PROXY.port);\n\t\t\telse\n\t\t\t\tsock.connect(new Host(host),port);\n\t\t\tsock.write(b.toString());\n\t\t\tif( multipart ) {\n\t\t\t\tvar bufsize = 4096;\n\t\t\t\tvar buf = haxe.io.Bytes.alloc(bufsize);\n\t\t\t\twhile( file.size > 0 ) {\n\t\t\t\t\tvar size = if( file.size > bufsize ) bufsize else file.size;\n\t\t\t\t\tvar len = 0;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlen = file.io.readBytes(buf,0,size);\n\t\t\t\t\t} catch( e : haxe.io.Eof ) break;\n\t\t\t\t\tsock.output.writeFullBytes(buf,0,len);\n\t\t\t\t\tfile.size -= len;\n\t\t\t\t}\n\t\t\t\tsock.write(\"\\r\\n\");\n\t\t\t\tsock.write(\"--\");\n\t\t\t\tsock.write(boundary);\n\t\t\t\tsock.write(\"--\");\n\t\t\t}\n\t\t\treadHttpResponse(api,sock);\n\t\t\tsock.close();\n\t\t} catch( e : Dynamic ) {\n\t\t\ttry sock.close() catch( e : Dynamic ) { };\n\t\t\tonError(Std.string(e));\n\t\t}\n\t}\n\n\tfunction readHttpResponse( api : haxe.io.Output, sock : sys.net.Socket ) {\n\t\t// READ the HTTP header (until \\r\\n\\r\\n)\n\t\tvar b = new haxe.io.BytesBuffer();\n\t\tvar k = 4;\n\t\tvar s = haxe.io.Bytes.alloc(4);\n\t\tsock.setTimeout(cnxTimeout);\n\t\twhile( true ) {\n\t\t\tvar p = sock.input.readBytes(s,0,k);\n\t\t\twhile( p != k )\n\t\t\t\tp += sock.input.readBytes(s,p,k - p);\n\t\t\tb.addBytes(s,0,k);\n\t\t\tswitch( k ) {\n\t\t\tcase 1:\n\t\t\t\tvar c = s.get(0);\n\t\t\t\tif( c == 10 )\n\t\t\t\t\tbreak;\n\t\t\t\tif( c == 13 )\n\t\t\t\t\tk = 3;\n\t\t\t\telse\n\t\t\t\t\tk = 4;\n\t\t\tcase 2:\n\t\t\t\tvar c = s.get(1);\n\t\t\t\tif( c == 10 ) {\n\t\t\t\t\tif( s.get(0) == 13 )\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tk = 4;\n\t\t\t\t} else if( c == 13 )\n\t\t\t\t\tk = 3;\n\t\t\t\telse\n\t\t\t\t\tk = 4;\n\t\t\tcase 3:\n\t\t\t\tvar c = s.get(2);\n\t\t\t\tif( c == 10 ) {\n\t\t\t\t\tif( s.get(1) != 13 )\n\t\t\t\t\t\tk = 4;\n\t\t\t\t\telse if( s.get(0) != 10 )\n\t\t\t\t\t\tk = 2;\n\t\t\t\t\telse\n\t\t\t\t\t\tbreak;\n\t\t\t\t} else if( c == 13 ) {\n\t\t\t\t\tif( s.get(1) != 10 || s.get(0) != 13 )\n\t\t\t\t\t\tk = 1;\n\t\t\t\t\telse\n\t\t\t\t\t\tk = 3;\n\t\t\t\t} else\n\t\t\t\t\tk = 4;\n\t\t\tcase 4:\n\t\t\t\tvar c = s.get(3);\n\t\t\t\tif( c == 10 ) {\n\t\t\t\t\tif( s.get(2) != 13 )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse if( s.get(1) != 10 || s.get(0) != 13 )\n\t\t\t\t\t\tk = 2;\n\t\t\t\t\telse\n\t\t\t\t\t\tbreak;\n\t\t\t\t} else if( c == 13 ) {\n\t\t\t\t\tif( s.get(2) != 10 || s.get(1) != 13 )\n\t\t\t\t\t\tk = 3;\n\t\t\t\t\telse\n\t\t\t\t\t\tk = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t#if neko\n\t\tvar headers = neko.Lib.stringReference(b.getBytes()).split(\"\\r\\n\");\n\t\t#else\n\t\tvar headers = b.getBytes().toString().split(\"\\r\\n\");\n\t\t#end\n\t\tvar response = headers.shift();\n\t\tvar rp = response.split(\" \");\n\t\tvar status = Std.parseInt(rp[1]);\n\t\tif( status == 0 || status == null )\n\t\t\tthrow \"Response status error\";\n\n\t\t// remove the two lasts \\r\\n\\r\\n\n\t\theaders.pop();\n\t\theaders.pop();\n\t\tresponseHeaders = new haxe.ds.StringMap();\n\t\tvar size = null;\n\t\tvar chunked = false;\n\t\tfor( hline in headers ) {\n\t\t\tvar a = hline.split(\": \");\n\t\t\tvar hname = a.shift();\n\t\t\tvar hval = if( a.length == 1 ) a[0] else a.join(\": \");\n\t\t\thval = StringTools.ltrim( StringTools.rtrim( hval ) );\n\t\t\tresponseHeaders.set(hname, hval);\n\t\t\tswitch(hname.toLowerCase())\n\t\t\t{\n\t\t\t\tcase \"content-length\":\n\t\t\t\t\tsize = Std.parseInt(hval);\n\t\t\t\tcase \"transfer-encoding\":\n\t\t\t\t\tchunked = (hval.toLowerCase() == \"chunked\");\n\t\t\t}\n\t\t}\n\n\t\tonStatus(status);\n\n\t\tvar chunk_re = ~/^([0-9A-Fa-f]+)[ ]*\\r\\n/m;\n\t\tchunk_size = null;\n\t\tchunk_buf = null;\n\n\t\tvar bufsize = 1024;\n\t\tvar buf = haxe.io.Bytes.alloc(bufsize);\n\t\tif( chunked ) {\n\t\t\ttry {\n\t\t\t\twhile( true ) {\n\t\t\t\t\tvar len = sock.input.readBytes(buf,0,bufsize);\n\t\t\t\t\tif( !readChunk(chunk_re,api,buf,len) )\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} catch ( e : haxe.io.Eof ) {\n\t\t\t\tthrow \"Transfer aborted\";\n\t\t\t}\n\t\t} else if( size == null ) {\n\t\t\tif( !noShutdown )\n\t\t\t\tsock.shutdown(false,true);\n\t\t\ttry {\n\t\t\t\twhile( true ) {\n\t\t\t\t\tvar len = sock.input.readBytes(buf,0,bufsize);\n\t\t\t\t\tapi.writeBytes(buf,0,len);\n\t\t\t\t}\n\t\t\t} catch( e : haxe.io.Eof ) {\n\t\t\t}\n\t\t} else {\n\t\t\tapi.prepare(size);\n\t\t\ttry {\n\t\t\t\twhile( size > 0 ) {\n\t\t\t\t\tvar len = sock.input.readBytes(buf,0,if( size > bufsize ) bufsize else size);\n\t\t\t\t\tapi.writeBytes(buf,0,len);\n\t\t\t\t\tsize -= len;\n\t\t\t\t}\n\t\t\t} catch( e : haxe.io.Eof ) {\n\t\t\t\tthrow \"Transfer aborted\";\n\t\t\t}\n\t\t}\n\t\tif( chunked && (chunk_size != null || chunk_buf != null) )\n\t\t\tthrow \"Invalid chunk\";\n\t\tif( status < 200 || status >= 400 )\n\t\t\tthrow \"Http Error #\"+status;\n\t\tapi.close();\n\t}\n\n\tfunction readChunk(chunk_re : EReg, api : haxe.io.Output, buf : haxe.io.Bytes, len ) {\n\t\tif( chunk_size == null ) {\n\t\t\tif( chunk_buf != null ) {\n\t\t\t\tvar b = new haxe.io.BytesBuffer();\n\t\t\t\tb.add(chunk_buf);\n\t\t\t\tb.addBytes(buf,0,len);\n\t\t\t\tbuf = b.getBytes();\n\t\t\t\tlen += chunk_buf.length;\n\t\t\t\tchunk_buf = null;\n\t\t\t}\n\t\t\t#if neko\n\t\t\tif( chunk_re.match(neko.Lib.stringReference(buf)) ) {\n\t\t\t#else\n\t\t\tif( chunk_re.match(buf.toString()) ) {\n\t\t\t#end\n\t\t\t\tvar p = chunk_re.matchedPos();\n\t\t\t\tif( p.len <= len ) {\n\t\t\t\t\tvar cstr = chunk_re.matched(1);\n\t\t\t\t\tchunk_size = Std.parseInt(\"0x\"+cstr);\n\t\t\t\t\tif( cstr == \"0\" ) {\n\t\t\t\t\t\tchunk_size = null;\n\t\t\t\t\t\tchunk_buf = null;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tlen -= p.len;\n\t\t\t\t\treturn readChunk(chunk_re,api,buf.sub(p.len,len),len);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// prevent buffer accumulation\n\t\t\tif( len > 10 ) {\n\t\t\t\tonError(\"Invalid chunk\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tchunk_buf = buf.sub(0,len);\n\t\t\treturn true;\n\t\t}\n\t\tif( chunk_size > len ) {\n\t\t\tchunk_size -= len;\n\t\t\tapi.writeBytes(buf,0,len);\n\t\t\treturn true;\n\t\t}\n\t\tvar end = chunk_size + 2;\n\t\tif( len >= end ) {\n\t\t\tif( chunk_size > 0 )\n\t\t\t\tapi.writeBytes(buf,0,chunk_size);\n\t\t\tlen -= end;\n\t\t\tchunk_size = null;\n\t\t\tif( len == 0 )\n\t\t\t\treturn true;\n\t\t\treturn readChunk(chunk_re,api,buf.sub(end,len),len);\n\t\t}\n\t\tif( chunk_size > 0 )\n\t\t\tapi.writeBytes(buf,0,chunk_size);\n\t\tchunk_size -= len;\n\t\treturn true;\n\t}\n\n#end\n\n\t/**\n\t\tThis method is called upon a successful request, with `data` containing\n\t\tthe result String.\n\n\t\tThe intended usage is to bind it to a custom function:  \n\t\t`httpInstance.onData = function(data) { // handle result }`\n\t**/\n\tpublic dynamic function onData( data : String ) {\n\t}\n\n\t/**\n\t\tThis method is called upon a request error, with `msg` containing the\n\t\terror description.\n\n\t\tThe intended usage is to bind it to a custom function:  \n\t\t`httpInstance.onError = function(msg) { // handle error }`\n\t**/\n\tpublic dynamic function onError( msg : String ) {\n\t}\n\n\t/**\n\t\tThis method is called upon a Http status change, with `status` being the\n\t\tnew status.\n\n\t\tThe intended usage is to bind it to a custom function:  \n\t\t`httpInstance.onStatus = function(status) { // handle status }`\n\t**/\n\tpublic dynamic function onStatus( status : Int ) {\n\t}\n\n#if !flash\n\t/**\n\t\tMakes a synchronous request to `url`.\n\n\t\tThis creates a new Http instance and makes a GET request by calling its\n\t\t`request(false)` method.\n\n\t\tIf `url` is null, the result is unspecified.\n\t**/\n\tpublic static function requestUrl( url : String ) : String {\n\t\tvar h = new Http(url);\n\t#if js\n\t\th.async = false;\n\t#end\n\t\tvar r = null;\n\t\th.onData = function(d){\n\t\t\tr = d;\n\t\t}\n\t\th.onError = function(e){\n\t\t\tthrow e;\n\t\t}\n\t\th.request(false);\n\t\treturn r;\n\t}\n#end\n\n}\n","package com.isartdigital.services.monetization;\r\nimport com.isartdigital.utils.Config;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport haxe.Http;\r\nimport haxe.Json;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass HttpService extends Http\r\n{\r\n\r\n\tprivate var callback:Dynamic->Void;\t\r\n\t\r\n\tpublic static inline var SERVICE_PATH:String = \"://fbgame.isartdigital.com/2018_builder/pedago/broadcast/\";\r\n\t\r\n\tpublic function new(pCallback:Dynamic->Void=null) \r\n\t{\r\n\t\t\r\n\t\tcallback = pCallback;\r\n\t\tsuper((DeviceCapabilities.isCocoonJS ? \"http\" : \"https\") + SERVICE_PATH);\r\n\t\tif (callback!=null) {\r\n\t\t\tonData = _onData;\r\n\t\t\tonError = _onError;\r\n\t\t}\r\n\t\tif (Config.debug) addParameter(\"debug\", \"\");\r\n\t}\r\n\r\n\tprivate function _onData (pData:String): Void {\r\n\t\tcallback(Json.parse(pData));\r\n\t\tcallback = null;\r\n\t}\r\n\t\r\n\tprivate function _onError (pError:String): Void {\r\n\t\ttrace (pError);\r\n\t\tcallback = null;\r\n\t}\t\r\n\t\r\n}","package com.isartdigital.services.monetization;\r\n\r\nimport com.isartdigital.services.monetization.HttpService;\r\nimport haxe.Http;\r\nimport haxe.Json;\r\n\r\n\t\r\n/**\r\n * Service permettant de crer un porte monnaie par joueur des Builder\r\n * Le porte monnaie est partag entre tous les Builder\r\n * @author Mathieu Anthoine\r\n */\r\nclass Wallet \r\n{\t\r\n\r\n\t/**\r\n\t * Retourne le montant du porte maonnaie virtuel de l'utilisateur\r\n\t * @param\tpMail mail de l'utilisateur\r\n\t * @param\tpCallback fonction appele au retour de l'information\r\n\t */\r\n\tpublic static function getMoney (pMail:String,pCallback:Dynamic->Void): Void {\r\n\t\tinitService(pMail,pCallback).request(true);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Retire une somme au porte monnaie virtuel de l'utilisateur\r\n\t * @param\tpMail mail de l'utilisateur\r\n\t * @param\tpCallback fonction appele au retour de l'information\r\n\t */\r\n\tpublic static function buy (pMail:String, pAmount:Float,pCallback:Dynamic->Void): Void {\r\n\t\tvar lRequest:HttpService = initService(pMail, pCallback);\r\n\t\t\t\t\t\r\n\t\tif (pAmount <= 0) {\r\n\t\t\tlRequest.onData (Json.stringify({error: \"zero or negative value forbidden\", code: 21}));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tlRequest.addParameter(\"buy\", Std.string(pAmount));\r\n\t\tlRequest.request(true);\r\n\t}\r\n\t\r\n\tprivate static function initService (pMail:String,pCallback:Dynamic->Void):HttpService {\r\n\t\tvar lRequest:HttpService = new HttpService(pCallback);\r\n\t\tlRequest.addParameter(\"wallet\", pMail);\r\n\t\treturn lRequest;\r\n\t}\r\n\t\r\n\r\n\r\n}","package com.isartdigital.utils;\r\n\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport js.Browser;\r\nimport js.html.Image;\r\n\r\n\r\n/**\r\n * Classe de Debug\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Debug\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe Main\r\n\t */\r\n\tprivate static var instance: Debug;\t\r\n\t\r\n\tpublic var fps:Perf;\r\n\tprivate static inline var QR_SIZE:Float = 0.35;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Debug {\r\n\t\tif (instance == null) instance = new Debug();\r\n\t\treturn instance;\r\n\t}\t\r\n\t\r\n\tprivate function new() {}\r\n\t\r\n\t/**\r\n\t * initialisation du dbogueur\r\n\t * @param\tpGameDispatcher\r\n\t */\r\n\tpublic function init():Void \r\n\t{\r\n\t\tif (Config.fps) fps = new Perf(\"TL\");\r\n\t\t\r\n\t\tif (Config.qrcode && !DeviceCapabilities.isCocoonJS) \r\n\t\t{\r\n\t\t\tvar lQr:Image = new Image();\r\n\t\t\tlQr.style.position = 'absolute';\r\n\t\t\tlQr.style.right = '0px';\r\n\t\t\tlQr.style.bottom = '0px';\r\n\t\t\tvar lSize:Int = Std.int(QR_SIZE * DeviceCapabilities.getSizeFactor());\r\n\t\t\tlQr.src = 'https://chart.googleapis.com/chart?chs='+lSize+'x'+lSize+'&cht=qr&chl=' + Browser.location.href + '&choe=UTF-8';\r\n\t\t\tBrowser.document.body.appendChild(lQr);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic static function error (pArg:Dynamic): Void {\r\n\t\tBrowser.console.error(pArg);\r\n\t}\r\n\t\r\n\tpublic static function warn (pArg:Dynamic): Void {\r\n\t\tBrowser.console.warn (pArg);\r\n\t}\r\n\r\n\tpublic static function table (pArg:Dynamic): Void {\r\n\t\tBrowser.console.table (pArg);\r\n\t}\r\n\r\n\tpublic static function info (pArg:Dynamic): Void {\r\n\t\tBrowser.console.info (pArg);\r\n\t}\r\n\t\r\n\tpublic function destroy (): Void {}\r\n\r\n}","package com.isartdigital.utils.game;\r\n\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\r\n/**\r\n * Classe Camera\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Camera\r\n{\r\n\r\n\tprivate var render:Dynamic;\r\n\t\r\n\tpublic var target (default,null):DisplayObject;\r\n\tpublic var focus (default, null):DisplayObject;\r\n\t\r\n\tprivate var inertiaMax:Point = new Point(40, 20);\r\n\tprivate var inertiaMin:Point = new Point(2, 8);\r\n\tprivate var countH:UInt = 0;\r\n\tprivate var delayH:UInt = 30;\r\n\tprivate var countV:UInt = 0;\r\n\tprivate var delayV:UInt = 30;\r\n\t\r\n\t\r\n\tprivate static inline var MIN_RAND_SHAKE:Float = 0.8;\r\n\tprivate static inline var MAX_RAND_SHAKE:Float = 1;\r\n\tprivate var shakeSmoothness:Float;\r\n\tprivate var shakeFadeOut:Float;\r\n\tprivate var shakeTimer:Float;\r\n\tprivate var shakeAmplitude:Float;\r\n\tprivate var shakeXQuantity:Float;\r\n\tprivate var shakeYQuantity:Float;\r\n\tprivate var cameraShaker:Point = new Point(0, 0);\r\n\tprivate var shaking:Bool = false;\r\n\t\r\n\tprivate var previousFrameX:Int = 0;\r\n\tprivate var previousFrameY:Int = 0;\r\n\t\r\n\tpublic var hasJustStopped:Bool = false;\r\n\tpublic var canStop:Bool = true;\r\n\t\r\n\t/**\r\n\t * instance unique de la classe GamePlane\r\n\t */\r\n\tprivate static var instance: Camera;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Camera {\r\n\t\tif (instance == null) instance = new Camera();\r\n\t\treturn instance;\r\n\t}\t\r\n\t\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dfini la cible de la camra\r\n\t * @param\tpTarget cible\r\n\t */\r\n\tpublic function setTarget (pTarget:DisplayObject):Void {\r\n\t\ttarget = pTarget;\r\n\t}\r\n\t\r\n\tpublic function getTarget():Point\r\n\t{\r\n\t\treturn new Point(target.x, target.y);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dfini l'lement  repositionner au centre de l'cran\r\n\t * @param\tpFocus focus\r\n\t */\r\n\tpublic function setFocus(pFocus:DisplayObject):Void {\r\n\t\tfocus = pFocus;\r\n\t}\r\n\t\r\n\t/**\r\n\t * recadre la camra\r\n\t * @param\tpDelay si false, la camra est recadre instantannment\r\n\t */\r\n\tprivate function changePosition (?pDelay:Bool = true) :Void {\r\n\t\t\r\n\t\tif (target == null || focus == null) return;\r\n\t\t\r\n\t\tcountH++;\r\n\t\tcountV++;\r\n\t\t\r\n\t\tvar lCenter:Rectangle = DeviceCapabilities.getScreenRect(target.parent);\t\t\t\t\r\n\t\tvar lFocus:Point = focus.position;//= getFocusCoord();\r\n\t\t\r\n\t\tvar lInertiaX:Float = pDelay ? getInertiaX() : 1;\r\n\t\tvar lInertiaY:Float = pDelay ? getInertiaY() : 1;\r\n\t\t\r\n\t\tvar lDeltaX:Float = (lCenter.x + lCenter.width / 2 - lFocus.x - target.x) /*/ lInertiaX*/;\r\n\t\tvar lDeltaY:Float = (lCenter.y + lCenter.height / 2 - lFocus.y - target.y) /*/ lInertiaY*/;\r\n\t\t\r\n\t\t\r\n\t\r\n\t\ttarget.x += lDeltaX;\r\n\t\ttarget.y += lDeltaY;\r\n\t\t\r\n\t\tvar lCurrentframeX : Int = cast(Math.round(target.x), Int);\r\n\t\tvar lCurrentframeY : Int = cast(Math.round(target.y), Int);\r\n\t\t\r\n\t\tif (!canStop && hasJustStopped) hasJustStopped = false;\r\n\t\t\r\n\t\tif (lCurrentframeX == previousFrameX && lCurrentframeY == previousFrameY && canStop) {\r\n\t\t\thasJustStopped = true;\r\n\t\t\tcanStop = false;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tpreviousFrameX = lCurrentframeX;\r\n\t\tpreviousFrameY = lCurrentframeY;\r\n\t\t\r\n\t\t//GameStage.getInstance().getInfoBulleContainer().position.set(target.x, target.y);\r\n\t\t\r\n\t\tif (shaking) \r\n\t\t{\r\n\t\t\tupdateShake();\r\n\t\t\ttarget.x += cameraShaker.x;\r\n\t\t\ttarget.y += cameraShaker.y;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Shakes the screen\r\n\t * @param\tpSmoothness How many frames will it take to the screen to make a move back and forth\r\n\t * @param\tpAmplitude How much should the screen go nuts\r\n\t * @param\tpDuration How many frames should the shaking last\r\n\t * @param\tpFadeOut How shall the shake fadeout : 1 = no fadeout, 0 = shake get canceled\r\n\t * @param\tpMoveX Will it only move on X\r\n\t * @param\tpMoveY Will it only move on Y\r\n\t */\r\n\tpublic function shakeScreen(pSmoothness:Float = 10, pAmplitude:Float = 20, pDuration:Float = 30, pXQuantity:Float = 1, pYQuantity:Float = 1, pFadeOut:Float = 0.95):Void {\r\n\t\tif (shaking && shakeAmplitude >= pAmplitude) return;\r\n\t\tshaking = true;\r\n\t\tshakeSmoothness = pSmoothness;\r\n\t\tshakeTimer = pDuration;\r\n\t\tshakeAmplitude = pAmplitude;\r\n\t\tshakeFadeOut = pFadeOut;\r\n\t\tshakeXQuantity = pXQuantity;\r\n\t\tshakeYQuantity = pYQuantity;\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function updateShake() \r\n\t{\r\n\t\tshakeTimer--;\r\n\t\tif (shakeTimer <= 0) {\r\n\t\t\tshaking = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcameraShaker.x = shakeXQuantity * ((MIN_RAND_SHAKE + Math.random() * (MAX_RAND_SHAKE - MIN_RAND_SHAKE)) * Math.cos(shakeTimer * 2 * Math.PI / shakeSmoothness) * shakeAmplitude);\r\n\t\tcameraShaker.y = shakeYQuantity * ((MIN_RAND_SHAKE + Math.random() * (MAX_RAND_SHAKE - MIN_RAND_SHAKE)) * Math.sin(shakeTimer * 2 * Math.PI / shakeSmoothness) * shakeAmplitude);\r\n\t\t\r\n\t\tshakeAmplitude *= shakeFadeOut;\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne une inertie en X variable suivant le temps\r\n\t * @return inertie en X\r\n\t */\r\n\tprivate function getInertiaX() : Float {\r\n\t\tif (countH > delayH) return inertiaMin.x;\r\n\t\treturn inertiaMax.x + (inertiaMin.x-inertiaMax.x)*countH/delayH;\r\n\t}\r\n\r\n\t/**\r\n\t * retourne une inertie en Y variable suivant le temps\r\n\t * @return inertie en Y\r\n\t */\t\r\n\tprivate function getInertiaY() : Float {\r\n\t\tif (countV > delayV) return inertiaMin.y;\r\n\t\treturn inertiaMax.y + (inertiaMin.y-inertiaMax.y)*countV/delayV;\r\n\t}\r\n\t\r\n\t/**\r\n\t * cadre instantannment la camra sur le focus\r\n\t */\r\n\tpublic function setPosition():Void {\r\n\t\tGameStage.getInstance().render();\r\n\t\tchangePosition(false);\r\n\t}\r\n\t\r\n\t/**\r\n\t * cadre la camra sur le focus avec de l'inertie\r\n\t */\r\n\tpublic function move():Void {\r\n\t\tchangePosition();\r\n\t}\r\n\t\r\n\t/**\r\n\t * remet  zro le compteur qui fait passer la camra de l'inertie en X maximum  minimum\r\n\t */\r\n\tpublic function resetX():Void {\r\n\t\tcountH = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * remet  zro le compteur qui fait passer la camra de l'inertie en Y maximum  minimum\r\n\t */\r\n\tpublic function resetY():Void {\r\n\t\tcountV = 0;\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne les coordonnes du focus dans le repre de la target\r\n\t */\r\n\tpublic function getFocusCoord ():Point {\r\n\t\treturn target.toLocal(focus.position, focus.parent);\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game;\r\n\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.graphics.GraphicsData;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.core.sprites.Sprite;\r\n\r\n/**\r\n * Classe utilitaire permettant de tester diverses collisions entre boites, formes et points\r\n * @author Mathieu ANTHOINE\r\n * @version 0.9.0\r\n */\r\nclass CollisionManager \r\n{\r\n\r\n\tprivate function new() {}\r\n\t\t\r\n\t/**\r\n\t * test la collision entre les boites englobantes de deux DisplayObject\r\n\t * @param\tpObjectA objet  tester\r\n\t * @param\tpObjectB objet  tester\r\n\t * @return rsultat du test de collision\r\n\t */\r\n\tpublic static function hitTestObject(pObjectA:DisplayObject, pObjectB:DisplayObject):Bool {\r\n\t\t\r\n\t\treturn getIntersection(pObjectA.getBounds(), pObjectB.getBounds());\r\n\r\n\t}\r\n\t\r\n\t/**\r\n\t * test la collision entre l'objet et un point (prend en compte la hitArea si elle est dfinie). Lgre adaptation de la mthode hitTest de la classe InteractionManager\r\n\t * @param\tpObject objet  tester\r\n\t * @param\tpPoint point exprim en coordonnes globales\r\n\t * @return\trsultat du test de collision\r\n\t */\r\n\tpublic static function hitTestPoint (pItem:DisplayObject, pGlobalPoint:Point):Bool {\r\n\r\n\t\tvar lPoint:Point=pItem.toLocal(pGlobalPoint);\r\n\t\tvar x:Float = lPoint.x;\r\n\t\tvar y:Float = lPoint.y;\r\n\t\t\r\n\t\tif (pItem.hitArea != null && pItem.hitArea.contains != null) {\r\n\t\t\treturn pItem.hitArea.contains(x, y);\t\t\r\n\t\t}\r\n\t\telse if (Std.is(pItem, Sprite)) {\t\r\n\t\t\t\r\n\t\t\tvar lSprite:Sprite = cast(pItem, Sprite);\r\n\t\t\t\r\n\t\t\tvar lWidth:Float = lSprite.texture.frame.width;\r\n\t\t\tvar lHeight:Float = lSprite.texture.frame.height;\r\n\t\t\tvar lX1:Float = -lWidth * lSprite.anchor.x;\r\n\t\t\tvar lY1:Float;\r\n\t \r\n\t\t\tif (x > lX1 && x < lX1 + lWidth)\r\n\t\t\t{\r\n\t\t\t\tlY1 = -lHeight * lSprite.anchor.y;\r\n\t\t\t\tif (y > lY1 && y < lY1 + lHeight) return true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (Std.is(pItem, Graphics)) {\r\n\t\t\tvar lGraphicsData:Array<GraphicsData> = untyped pItem.graphicsData;\t\t\r\n\t\t\tfor (i in 0...lGraphicsData.length) {\r\n\t\t\t\tvar lData = lGraphicsData[i];\r\n\t\t\t\t // only deal with fills..\r\n\t\t\t\tif (! untyped lData.fill) continue;\t\t\t\r\n\t\t\t\tif(lData.shape!=null && lData.shape.contains(x, y)) return true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (Std.is (pItem, Container)) {\r\n\t\t\tvar lContainer:Container = cast(pItem, Container);\r\n\t\t\tvar lLength:Int = lContainer.children.length;\r\n\t\t\tfor (i in 0...lLength) {\r\n\t\t\t\tif (hitTestPoint(lContainer.children[i], pGlobalPoint)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param\tpHitBoxA boite englobante principale\r\n\t * @param\tpHitBoxB boite englobante principale\r\n\t * @param\tpPointsA liste de points de collision\r\n\t * @param\tpPointsB liste de points de collision\r\n\t * @return  rsultat de la collision\r\n\t */\r\n\tpublic static function hasCollision (pHitBoxA:DisplayObject, pHitBoxB:DisplayObject, pPointsA:Array<Point> = null, pPointsB:Array<Point> = null): Bool {\r\n\t\tif (pHitBoxA == null || pHitBoxB == null) return false;\r\n\t\t\r\n\t\t// test des boites de collision principale\r\n\t\tif (!hitTestObject(pHitBoxA,pHitBoxB)) return false;\r\n\t\t\r\n\t\t// si il n'y a pas de boites de collision plus prcises on valide\r\n\t\tif (pPointsA == null && pPointsB == null) return true;\t\t\t\r\n\t\t\r\n\t\t// test points vers la forme de la boite principale \r\n\t\tif (pPointsA!=null) return testPoints(pPointsA, pHitBoxB);\r\n\t\tif (pPointsB!=null) return testPoints(pPointsB, pHitBoxA);\r\n\t\t\r\n\t\treturn false;\r\n\r\n\t}\r\n\t\r\n\t/**\r\n\t * teste l'intersection des boites englobantes\r\n\t * @param\tpRectA rectangle  tester\r\n\t * @param\tpRectB rectangle  tester\r\n\t * @return rsultat de l'intersection\r\n\t */\r\n\tprivate static function getIntersection (pRectA:Rectangle, pRectB:Rectangle): Bool {\r\n\t\treturn !(pRectB.x > (pRectA.x + pRectA.width) || (pRectB.x + pRectB.width) < pRectA.x || pRectB.y > (pRectA.y + pRectA.height) || (pRectB.y + pRectB.height) < pRectA.y);\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t * @param\tpHitPoints liste de points de collision (dont le repre est dj converti en global)\r\n\t * @param\tpHitBox boite englobante\r\n\t * @return  rsultat de la collision\r\n\t */\r\n\tprivate static function testPoints (pHitPoints:Array<Point>, pHitBox:DisplayObject): Bool {\r\n\t\tvar lLength:Int = pHitPoints.length;\r\n\t\tfor (i in 0...lLength) {\r\n\t\t\tif (hitTestPoint(pHitBox,pHitPoints[i])) return true;\r\n\t\t}\r\n\t\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game;\r\n\r\nimport com.isartdigital.ruby.game.controller.MouseController;\r\nimport com.isartdigital.utils.events.EventType;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.filters.blur.BlurFilter;\r\n\r\n/**\r\n * Classe en charge de mettre en place la structure graphique du jeu (conteneurs divers)\r\n * et la gestion du redimensionnement de la zone de jeu en fonction du contexte\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass GameStage extends Container\r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe GameStage\r\n\t */\r\n\tprivate static var instance: GameStage;\r\n\r\n\tprivate var _alignMode: GameStageAlign = GameStageAlign.CENTER;\t\r\n\r\n\tprivate var _scaleMode: GameStageScale = GameStageScale.SHOW_ALL;\r\n\t\r\n\tprivate var _safeZone:Rectangle= new Rectangle(0,0,SAFE_ZONE_WIDTH,SAFE_ZONE_HEIGHT);\r\n\r\n\t/**\r\n\t * callback de render\r\n\t */\r\n\tprivate var _render:Void->Void;\t\r\n\t\r\n\t/**\r\n\t * largeur minimum pour le contenu visible par dfaut\r\n\t */\r\n\tprivate static inline var SAFE_ZONE_WIDTH: Int = 2048;\r\n\r\n\t/**\r\n\t * hauteur minimum pour le contenu visible par dfaut\r\n\t */\r\n\tprivate static inline var SAFE_ZONE_HEIGHT: Int = 1366;\r\n\t\t\r\n\t/**\r\n\t * conteneur des pop-in\r\n\t */\r\n\tprivate var popinsContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur du Hud\r\n\t */\r\n\tprivate var hudContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des crans d'interface\r\n\t */\r\n\tprivate var screensContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur du jeu\r\n\t */\r\n\tprivate var gameContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des infobulle, timer etc...\r\n\t */\r\n\tprivate var infoBulleContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des Contextual, timer etc...\r\n\t */\r\n\tprivate var contextualContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des effets de Particles\r\n\t */\r\n\t private var particlesContainer:Container;\t\r\n\t\r\n\t/**\r\n\t * conteneur des effets de Particles\r\n\t */\r\n\tprivate var ressourcesContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des effets de Particles\r\n\t */\r\n\tprivate var bubblesContainer:Container;\r\n\t\r\n\t/**\r\n\t * conteneur des effets de Particles\r\n\t */\r\n\tprivate var alienContainer:Container;\r\n\r\n\t/**\r\n\t * conteneur des FTUE\r\n\t */\r\n\tprivate var ftueContainer:Container;\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\t\t\t\r\n\t\tcontextualContainer = new Container();\r\n\t\tcontextualContainer.name = \"contextualContainer\";\r\n\t\taddChild(contextualContainer);\r\n\t\t\r\n\t\tinfoBulleContainer = new Container();\r\n\t\tinfoBulleContainer.name = \"infoBulleContainer\";\r\n\t\tcontextualContainer.addChild(infoBulleContainer);\r\n\t\t\r\n\t\talienContainer = new Container();\r\n\t\talienContainer.name = \"alienContainer\";\r\n\t\tinfoBulleContainer.addChild(alienContainer);\r\n\t\t\r\n\t\tgameContainer = new Container();\r\n\t\tgameContainer.name = \"gameContainer\";\r\n\t\talienContainer.addChild(gameContainer);\r\n\t\t\r\n\t\tscreensContainer = new Container();\r\n\t\tscreensContainer.name = \"screenContainer\";\r\n\t\taddChild(screensContainer);\r\n\t\t\r\n\t\thudContainer = new Container();\r\n\t\thudContainer.name = \"hudContainer\";\r\n\t\taddChild(hudContainer);\r\n\t\t\r\n\t\tpopinsContainer = new Container();\r\n\t\tpopinsContainer.name = \"popinContainer\";\r\n\t\taddChild(popinsContainer);\r\n\t\t\r\n\t\tftueContainer = new Container();\r\n\t\tftueContainer.name = \"ftueContainer\";\r\n\t\taddChild(ftueContainer);\r\n\t\t\r\n\t\tparticlesContainer = new Container();\r\n\t\tparticlesContainer.name = \"particlesContainer\";\r\n\t\taddChild(particlesContainer);\t\t\t\r\n\t\t\r\n\t\tressourcesContainer = new Container();\r\n\t\tressourcesContainer.name = \"ressourcesContainer\";\r\n\t\taddChild(ressourcesContainer);\t\r\n\t\t\r\n\t\tbubblesContainer = new Container();\r\n\t\tbubblesContainer.name = \"bubblesContainer\";\r\n\t\taddChild(bubblesContainer);\t\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialisation de la zone de jeu\r\n\t * @param   pRender Callback qui fait le rendu pour mettre  jour le systme de coordonnes avant de reconstruire d'ventuels lments\r\n\t * @param\tpSafeZoneWidth largeur de la safeZone\r\n\t * @param\tpSafeZoneHeight hauteur de la safeZone\r\n\t * @param\tcenterGameContainer centrer ou pas le conteneur des lements InGame\r\n\t * @param\tcenterScreensContainer centrer ou pas le conteneur des Ecrans\r\n\t * @param\tcenterPopinContainer centrer ou pas le conteneur des Popins\r\n\t * @param\tcenterHudContainer centrer ou pas le conteneur\r\n\t */\r\n\tpublic function init (pRender:Void->Void, ?pSafeZoneWidth:UInt = SAFE_ZONE_WIDTH, ?pSafeZoneHeight:UInt = SAFE_ZONE_WIDTH, ?pCenterGameContainer:Bool = false, ?pCenterInfoBulleContainer:Bool = false, ?pCenterScreensContainer:Bool = true, ?pCenterPopinContainer:Bool = true, ?pCenterHudContainer:Bool = false, ?pCenterFtueContainer = false, ?pCenterContextualContainer = false,?pCenterParticlesContainer=false,?pCenterRessourcesContainer=false, ?pCenterBubblesContainer=false, ?pAlienContainer=false):Void {\r\n\t\t\r\n\t\t_safeZone = new Rectangle (0, 0, pSafeZoneWidth, pSafeZoneHeight);\r\n\t\t\r\n\t\tif (pCenterGameContainer) {\r\n\t\t\tgameContainer.x = safeZone.width / 2;\r\n\t\t\tgameContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\r\n\t\tif (pCenterInfoBulleContainer) {\r\n\t\t\tinfoBulleContainer.x = safeZone.width / 2;\r\n\t\t\tinfoBulleContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t\r\n\t\tif (pCenterScreensContainer) {\r\n\t\t\tscreensContainer.x = safeZone.width / 2;\r\n\t\t\tscreensContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t\r\n\t\tif (pCenterPopinContainer) {\r\n\t\t\tpopinsContainer.x = safeZone.width / 2;\r\n\t\t\tpopinsContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t\r\n\t\tif (pCenterHudContainer) {\r\n\t\t\thudContainer.x = safeZone.width / 2;\r\n\t\t\thudContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t\r\n\t\tif (pCenterFtueContainer) {\r\n\t\t\tftueContainer.x = safeZone.width / 2;\r\n\t\t\tftueContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\r\n\t\t\r\n\t\tif (pCenterContextualContainer) {\r\n\t\t\tcontextualContainer.x = safeZone.width / 2;\r\n\t\t\tcontextualContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\r\n\r\n\t\tif (pCenterParticlesContainer) {\r\n\t\t\tparticlesContainer.x = safeZone.width / 2;\r\n\t\t\tparticlesContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\t\t\r\n\t\t\r\n\t\tif (pCenterRessourcesContainer) {\r\n\t\t\tressourcesContainer.x = safeZone.width / 2;\r\n\t\t\tressourcesContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\t\t\r\n\t\t\r\n\t\t\r\n\t\tif (pCenterBubblesContainer) {\r\n\t\t\tbubblesContainer.x = safeZone.width / 2;\r\n\t\t\tbubblesContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\r\n\t\t\r\n\t\tif (pAlienContainer) {\r\n\t\t\talienContainer.x = safeZone.width / 2;\r\n\t\t\talienContainer.y = safeZone.height / 2;\r\n\t\t}\r\n\t\t_render = pRender;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): GameStage {\r\n\t\tif (instance == null) instance = new GameStage();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Redimensionne la scne du jeu en fonction de la taille disponible pour l'affichage\r\n\t */\r\n\tpublic function resize (): Void {\r\n\t\t\r\n\t\tvar lWidth:UInt = DeviceCapabilities.width;\r\n\t\tvar lHeight:UInt = DeviceCapabilities.height;\r\n\t\t\t\t\r\n\t\tvar lRatio:Float = Math.round(10000 * Math.min( lWidth / safeZone.width, lHeight / safeZone.height)) / 10000;\r\n\t\t\r\n\t\tif (scaleMode == GameStageScale.SHOW_ALL) scale.set(lRatio, lRatio);\r\n\t\telse scale.set (DeviceCapabilities.textureRatio, DeviceCapabilities.textureRatio);\r\n\t\t\r\n\t\tif (alignMode == GameStageAlign.LEFT || alignMode == GameStageAlign.TOP_LEFT || alignMode == GameStageAlign.BOTTOM_LEFT) x = 0;\r\n\t\telse if (alignMode == GameStageAlign.RIGHT || alignMode == GameStageAlign.TOP_RIGHT || alignMode == GameStageAlign.BOTTOM_RIGHT) x = lWidth - safeZone.width * scale.x;\r\n\t\telse x = (lWidth - safeZone.width * scale.x) / 2;\r\n\t\t\r\n\t\tif (alignMode == GameStageAlign.TOP || alignMode == GameStageAlign.TOP_LEFT || alignMode == GameStageAlign.TOP_RIGHT) y = 0;\r\n\t\telse if (alignMode == GameStageAlign.BOTTOM || alignMode == GameStageAlign.BOTTOM_LEFT || alignMode == GameStageAlign.BOTTOM_RIGHT) y = lHeight - safeZone.height * scale.y;\r\n\t\telse y = (lHeight - safeZone.height * scale.y) / 2;\r\n\t\t\r\n\t\t\r\n\t\trender();\r\n\t\t\r\n\t\temit (EventType.RESIZE, { width:lWidth, height:lHeight } );\r\n\t\tif (DeviceCapabilities.system == DeviceCapabilities.SYSTEM_DESKTOP)\r\n\t\t\tMouseController.getInstance().init();\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * fait le rendu de l'cran\r\n\t */\r\n\tpublic function render (): Void {\r\n\t\tif (_render!=null) _render();\r\n\t}\t\r\n\t\r\n\t/*\r\n\t * style d'alignement au sein de l'cran\r\n\t */\r\n\tpublic var alignMode (get, set) : GameStageAlign;\r\n\t\r\n\tprivate function get_alignMode( ) { \r\n\t\treturn _alignMode;\r\n\t}\r\n\t\r\n\tprivate function set_alignMode(pAlign:GameStageAlign) {\r\n\t\t_alignMode = pAlign;\r\n\t\tresize();\r\n\t\treturn _alignMode;\r\n\t}\r\n\r\n\t/*\r\n\t * style de redimensionnement au sein de l'cran\r\n\t */\r\n\tpublic var scaleMode (get, set) : GameStageScale;\r\n\t\r\n\tprivate function get_scaleMode( ) { \r\n\t\treturn _scaleMode;\r\n\t}\r\n\t\r\n\tprivate function set_scaleMode(pScale:GameStageScale) {\r\n\t\t_scaleMode = pScale;\r\n\t\tresize();\r\n\t\treturn _scaleMode;\r\n\t}\t\r\n\t\r\n\t/**\r\n\t * Rectangle dlimitant le contenu minimum visible\r\n\t */\r\n\tpublic var safeZone (get, never):Rectangle;\r\n\t\r\n\tprivate function get_safeZone () {\r\n\t\treturn _safeZone;\r\n\t}\r\n\r\n\t/**\r\n\t * accs en lecture au conteneur de jeu\r\n\t * @return gameContainer\r\n\t */\r\n\tpublic function getGameContainer (): Container {\r\n\t\treturn gameContainer;\r\n\t}\r\n\r\n\t/**\r\n\t * accs en lecture au conteneur d'info bulle\r\n\t * @return gameContainer\r\n\t */\r\n\tpublic function getInfoBulleContainer (): Container {\r\n\t\treturn infoBulleContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur d'crans\r\n\t * @return screensContainer\r\n\t */\r\n\tpublic function getScreensContainer (): Container {\r\n\t\treturn screensContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de hud\r\n\t * @return hudContainer\r\n\t */\r\n\tpublic function getHudContainer (): Container {\r\n\t\treturn hudContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de PopIn\r\n\t * @return popinContainer\r\n\t */\r\n\tpublic function getPopinsContainer (): Container {\r\n\t\treturn popinsContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de FTUE\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getFtueContainer (): Container {\r\n\t\treturn ftueContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de FTUE\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getContextualContainer (): Container {\r\n\t\treturn contextualContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de Particles\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getParticlesContainer (): Container {\r\n\t\treturn particlesContainer;\r\n\t}\r\n\r\n\t/**\r\n\t * accs en lecture au conteneur de RessourceEffects\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getRessourcesContainer (): Container {\r\n\t\treturn ressourcesContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de RessourceEffects\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getAlienContainer (): Container {\r\n\t\treturn alienContainer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * accs en lecture au conteneur de Bulles Effet Particules\r\n\t * @return ftueContainer\r\n\t */\r\n\tpublic function getBubblesContainer (): Container {\r\n\t\treturn bubblesContainer;\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\toverride public function destroy (): Void {\r\n\t\tinstance = null;\r\n\t\tsuper.destroy(true);\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.clipping;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.utils.save.ElementSave;\r\n\r\n/**\r\n * Cellule de la grille de clipping \r\n * contenant une liste d'id (String)\r\n * @author Adrien Bourdon\r\n */\r\nclass Cell\r\n{\r\n\r\n\tpublic var list:Array<String>;\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tlist = new Array<String>();\r\n\t}\r\n\t\r\n\tpublic function add(pInstance:String):Void \r\n\t{\r\n\t\tif (list.indexOf(pInstance) == -1) {\r\n\t\t\tlist.push(pInstance);\r\n\t\t}\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game.clipping;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.save.ElementSave;\r\nimport haxe.ds.ObjectMap;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\r\n\t\r\n/**\r\n * Gestion de la grille de clipping\r\n * @author Adrien Bourdon\r\n */\r\nclass CellManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe CellManager\r\n\t */\r\n\tprivate static var instance: CellManager;\r\n\t\r\n\t//grille du niveaux\r\n    public static var level:Map<Int, Map<Int, Cell>>;\r\n\tpublic var listElementSave:Map<String, Element>;\r\n\t\r\n\tpublic var xMin:Int;\r\n\tpublic var xMax:Int;\r\n\tpublic var yMin:Int;\r\n\tpublic var yMax:Int;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): CellManager {\r\n\t\tif (instance == null) instance = new CellManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise la grille de cellule en fonction de la taille du niveaux\r\n\t */\r\n\tpublic function initGrid(pLevelContainer:Rectangle):Void \r\n\t{\t\t\r\n\t\tlevel = new Map<Int, Map<Int, Cell>>();\r\n\t\tvar lMap:Map<Int , Cell>;\r\n\t\tvar lCell:Cell;\r\n\t\txMin = Math.floor(pLevelContainer.x);\r\n\t\tyMin = Math.floor(pLevelContainer.y);\r\n\t\txMax = Math.ceil((xMin + pLevelContainer.width) / ClippingManager.CELL_WIDTH);\r\n\t\tyMax = Math.ceil((yMin + pLevelContainer.height) / ClippingManager.CELL_HEIGHT);\r\n\t\tfor (i in xMin...xMax) \r\n\t\t{\r\n\t\t\tlMap = new Map<Int, Cell>();\r\n\t\t\tfor (j in yMin...yMax) \r\n\t\t\t{\r\n\t\t\t\tlCell = new Cell();\r\n\t\t\t\tlMap.set(j, lCell);\r\n\t\t\t}\r\n\t\t\tlevel.set(i, lMap);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Ajoute un ElementSave aux cell qui vont le contenir\r\n\t * @param\tpElem : ElementSave\r\n\t */\r\n\tpublic function setCell(pElem:Element)\r\n\t{\r\n\t\tvar lArray:Array<Point> = getCells(pElem.globalX, pElem.globalY , pElem.width, pElem.height);\r\n\t\tvar lPoint:Point;\r\n\t\tvar lCell:Cell;\r\n\t\t\r\n\t\tfor (i in 0...lArray.length)\r\n\t\t{\r\n\t\t\tlPoint = lArray[i];\r\n\t\t\tif (isCellExist(lPoint) == null) increaseGrid(cast(lPoint.x, Int), cast(lPoint.y, Int));\r\n\t\t\tlCell = level.get(cast(lPoint.x, Int)).get(cast(lPoint.y, Int));\r\n\t\t\tlCell.add(pElem.instanceID);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne les cell qui vont contenir un element;\r\n\t * @param\tpX : position x de l'element\r\n\t * @param\tpY : position y de l'element\r\n\t * @param\tpWidth : longeur de l'element\r\n\t * @param\tpHeight : hauteur de l'element\r\n\t * @return un tableau de points pour chaque index de cell\r\n\t */\r\n\tprivate function getCells(pX:Float, pY:Float, pWidth:Float, pHeight:Float):Array<Point>\r\n\t{\r\n\t\tvar lArray:Array<Point> = new Array<Point>();\r\n\t\tvar lXmin:Int = Math.floor(pX / ClippingManager.CELL_WIDTH);\r\n\t\tvar lYmin:Int = Math.floor(pY / ClippingManager.CELL_HEIGHT);\r\n\t\tvar lPoint:Point = new Point(lXmin, lYmin);\r\n\t\t\r\n\t\tvar lNumberCellX:Int = checkNextCell(lXmin, ClippingManager.CELL_WIDTH, lXmin + pWidth);\r\n\t\tvar lNumberCellY:Int = checkNextCell(lYmin, ClippingManager.CELL_HEIGHT, lYmin + pHeight);\r\n\t\t\r\n\t\tfor (i in 0...lNumberCellX + 1) \r\n\t\t{\r\n\t\t\tfor (j in 0...lNumberCellY + 1) \r\n\t\t\t{\r\n\t\t\t\tlPoint = new Point(lXmin + i, lYmin + j);\r\n\t\t\t\tlArray.push(lPoint);\r\n\t\t\t}\t\t\t\r\n\t\t}\t\t\t\t\r\n\t\treturn lArray;\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * verifie la grille contient une Cell au coordonne d'un point\r\n\t * @param\tpPoint : coordonne de la Cell\r\n\t * @return  la Cell si elle exist, sinon null\r\n\t */\r\n\tprivate function isCellExist(pPoint:Point):Cell\r\n\t{\r\n\t\tif (level.get(cast(pPoint.x, Int)) == null) return null;\r\n\t\treturn level.get(cast(pPoint.x, Int)).get(cast(pPoint.y, Int));\r\n\t}\r\n\t\r\n\t/**\r\n\t * agrandit la grille en crant une nouvelle Cell au coordonne pX et pY\r\n\t * @param\tpX \r\n\t * @param\tpY\r\n\t */\r\n\tprivate function increaseGrid(pX:Int, pY:Int):Void \r\n\t{\r\n\t\tif (level.get(pX) == null) \r\n\t\t{\r\n\t\t\tvar lMap:Map<Int, Cell> = new Map<Int ,Cell>();\r\n\t\t\tlevel.set(pX, lMap);\t\t\r\n\t\t}\r\n\t\tif (level.get(pX).get(pY) == null)\r\n\t\t{\r\n\t\t\tvar lCell = new Cell();\r\n\t\t\tlevel.get(pX).set(pY, lCell);\r\n\t\t}\r\n\t\tchangeGridSize(pX, pY);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * change les valeurs xMin, xMax, yMin, yMax reprsentant la taille de la grille\r\n\t * si besoin\r\n\t * @param\tpX \r\n\t * @param\tpY\r\n\t */\r\n\tprivate function changeGridSize(pX:Int, pY:Int):Void \r\n\t{\r\n\t\tif (pX < xMin) xMin = pX;\r\n\t\telse if (pX > xMax) xMax = pX;\r\n\t\t\r\n\t\tif (pY < yMin) yMin = pY;\r\n\t\telse if (pY > yMax) yMax = pY; \r\n\t}\r\n\t\r\n\t/**\r\n\t * compte combien il y a de segment d'une certaine taille entre 2 points\r\n\t * @param\tpX : point de depart\r\n\t * @param\tpStepsSize : taille d'un segment\r\n\t * @param\tpDistance : point d'arriv\r\n\t * @return nombre de segment\r\n\t */\r\n\tprivate function checkNextCell(pX:Int, pStepsSize:Int, pDistance:Float):Int\r\n\t{\r\n\t\tvar lNumberCell:Int = 0;\r\n\t\tif (pX + pStepsSize <= pDistance) \r\n\t\t{\r\n\t\t\tlNumberCell = checkNextCell(pX + pStepsSize, pStepsSize, pDistance) + 1;\r\n\t\t}\t\t\r\n\t\treturn lNumberCell;\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.clipping;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.ElementSave;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\r\n\t\r\n/**\r\n * Initialisation de la grille de clipping par rapport a une liste d'Element\r\n * Gestion des Element a clipper en fonction de la position de l'cran\r\n * @author Adrien Bourdon\r\n */\r\n\r\nclass ClippingManager \r\n{\t\r\n\t/**\r\n\t * instance unique de la classe ClippingManager\r\n\t */\r\n\tprivate static var instance: ClippingManager;\r\n\r\n\t// Dimension Cellules de la grille de clipping\r\n\tpublic static inline var CELL_WIDTH:Int = 400;\r\n\tpublic static inline var CELL_HEIGHT:Int = 400;\r\n\t\r\n\t// Marge de la limite de clipping en nombre de cellules\r\n\tprivate static inline var MARGIN_X:Int = 4;\r\n\tprivate static inline var MARGIN_Y:Int = 4;\r\n\t\r\n\t// Dimension et position de l'ecran\r\n\tprivate var screen:Rectangle;\r\n\t\r\n    // Sauvegarde de la derniere position de la zone de clipping sur la grille\r\n\tprivate var oldColLeft:Int;\r\n\tprivate var oldColRight:Int;\r\n\tprivate var oldRowTop:Int;\r\n\tprivate var oldRowBot:Int;\r\n\t\r\n\t// Stock les cellules en fonction des instances\r\n\tprivate var instances:Map<String, Array<Cell>>;\r\n\t\r\n\t// Stock les instance remove\r\n\tprivate var saveInstances:Map<String, Array<Cell>> = new Map<String, Array<Cell>>();\r\n\t\r\n\t// Element a afficher\r\n\tprivate var toAdd:Map<String, Bool>;\r\n\t\r\n\t// Element a retirer\r\n\tprivate var toRemove:Map<String, Bool>;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): ClippingManager {\r\n\t\tif (instance == null) instance = new ClippingManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialisation du clipping\r\n\t * @param\tpScreen : Game Container\r\n\t */\r\n\tpublic function init(pScreen:Rectangle) \r\n\t{\r\n\t\tscreen = pScreen;\r\n\t\tCellManager.getInstance().initGrid(screen);\r\n\t\tsetLevel(getData());\r\n\t\tinitClippingArea(screen);\r\n\t}\r\n\t\r\n\t/**\r\n\t * initialise la position de la de la zone de clipping dans la grille\r\n\t * @param\tpScreen : Game Container\r\n\t */\r\n\tprivate function initClippingArea(pScreen:Rectangle) \r\n\t{\r\n\t\ttoAdd = new Map<String, Bool>();\r\n\t\tvar i:Int = PoolObject.activeObjectList.length -1;\r\n\t\twhile (i >= 0) \r\n\t\t{\r\n\t\t\tPoolObject.activeObjectList[i].dispose();\r\n\t\t\ti--;\r\n\t\t}\r\n\t\t\r\n\t\tvar lHeight:Float = pScreen.height;\r\n\t\tvar lWidth:Float = pScreen.width;\t\t\r\n\t\toldColLeft  = (Math.floor(pScreen.x / CELL_WIDTH)) - MARGIN_X; \r\n\t\toldColRight = (Math.ceil((pScreen.x + lWidth) / CELL_WIDTH)) + MARGIN_X; \r\n\t\toldRowTop   = (Math.floor(pScreen.y / CELL_HEIGHT)) - MARGIN_Y; \r\n\t\toldRowBot   = (Math.ceil((pScreen.y + lHeight) / CELL_HEIGHT)) + MARGIN_Y;\r\n\t\t\r\n\t\tsetToAddInGrid(oldColLeft, oldColRight, oldRowTop, oldRowBot);\r\n\t\tdisplayToAdd();\r\n\t}\r\n\t\r\n\t/**\r\n\t * ajoute les elements du jeu a la grille de clipping\r\n\t * @param\tpArray : tableau contenant les elements de jeux\r\n\t */\r\n\tprivate function setLevel(pArray:Array<Element>) :Void\r\n\t{\r\n\t\tif (pArray.length <= 0) return;\t\r\n\t\tfor (i in 0...pArray.length) \r\n\t\t{\r\n\t\t\tCellManager.getInstance().setCell(pArray[i]);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * recupre la liste des elements du jeu\r\n\t * @return liste des elements du jeu\r\n\t */\r\n\tprivate function getData():Array<Element> \r\n\t{\r\n\t    var lArray:Array<Element> = new Array<Element>();\r\n\t\tfor (elem in PoolObject.elementList) \r\n\t\t{\r\n\t\t\tlArray.push(elem);\r\n\t\t}\r\n\t\treturn lArray;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Ajoute ou retir les elements du jeu en fonction de la position de l'ecran \r\n\t * @param\tpScreen : GameContainer\r\n\t */\r\n\tpublic function clipping(pScreen:Rectangle):Void \r\n\t{\r\n\t\tvar lHeight:Float = pScreen.height;\r\n\t\tvar lWidth:Float = pScreen.width;\t\t\r\n\t\tvar colLeft:Int  = (Math.floor(pScreen.x / CELL_WIDTH)) - MARGIN_X ;\r\n\t\tvar colRight:Int = (Math.ceil((pScreen.x + lWidth) / CELL_WIDTH)) + MARGIN_X;\r\n\t\tvar rowTop:Int   = (Math.floor(pScreen.y / CELL_HEIGHT)) - MARGIN_Y;\r\n\t\tvar rowBot:Int   = (Math.ceil((pScreen.y + lHeight) / CELL_HEIGHT)) + MARGIN_Y;\r\n\t\tvar direction:Int;\r\n\t\tif (colLeft < oldColLeft || colRight > oldColRight || rowTop < oldRowTop || rowBot > oldRowBot)\r\n\t\t{\r\n\t\t\ttoAdd = new Map<String, Bool>();\r\n\t\t\t//entr col\r\n\t\t\tif (colLeft < oldColLeft) setToAddInGrid(colLeft, oldColLeft, rowTop, rowBot, -1);\t\t\r\n\t\t\tif (colRight > oldColRight) setToAddInGrid(oldColRight, colRight, rowTop, rowBot, 1);\t\t\t\r\n\t\t\t//entr ligne\r\n\t\t\tif (rowTop < oldRowTop) setToAddInGrid(colLeft, colRight, rowTop, oldRowTop, 0, -1);\r\n\t\t\tif (rowBot > oldRowBot) setToAddInGrid(colLeft, colRight, oldRowBot, rowBot, 0, 1);\t\t\t\t\r\n\t\t\toldColLeft = colLeft;\r\n\t\t\toldColRight = colRight;\t\t\t\r\n\t\t\toldRowBot = rowBot;\r\n\t\t\toldRowTop = rowTop;\t\r\n\t\t\t\r\n\t\t\tdisplayToAdd();\r\n\t\t\tsortTilesInRegions();\r\n\t\t}\r\n\t\t\r\n\t\tif (colLeft > oldColLeft || colRight < oldColRight || rowTop > oldRowTop || rowBot < oldRowBot)\r\n\t\t{\r\n\t\t\ttoRemove = new Map<String, Bool>();\r\n\t\t\t//sorti col\r\n\t\t\tif (colLeft > oldColLeft) setToAddInGrid(oldColLeft, colLeft, rowTop, rowBot, -1, 0, true);\r\n\t\t\tif (colRight < oldColRight) setToAddInGrid(colRight, oldColRight, rowTop, rowBot, 1 , 0, true);\t\r\n\t\t\t//sorti ligne\r\n\t\t\tif (rowTop > oldRowTop) setToAddInGrid(colLeft, colRight, oldRowTop, rowTop,0, -1, true);\r\n\t\t\tif (rowBot < oldRowBot) setToAddInGrid(colLeft, colRight, rowBot, oldRowBot, 0, 1, true);\t\t\t\r\n\t\t\toldColLeft = colLeft;\r\n\t\t\toldColRight = colRight;\t\r\n\t\t\toldRowBot = rowBot;\r\n\t\t\toldRowTop = rowTop;\r\n\t\t\t\r\n\t\t\tremoveToDisplay();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * fait un z-sorting sur les elements des regions actives \r\n\t */\r\n\tprivate function sortTilesInRegions():Void \r\n\t{\r\n\t\t\tfor (lMap in World.getInstance().worldMap) \r\n\t\t\t{\r\n\t\t\t\tfor (lRegion in lMap) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (lRegion.isActive) {\r\n\t\t\t\t\t\tlRegion.layers[1].container.children = IsoManager.sortTiles(lRegion.layers[1].container.children);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * ajoute des instance a la map toAdd a partir de ligne et colone de la grille level\r\n\t * @param\tpColLeft\r\n\t * @param\tpColRight\r\n\t * @param\tpRowBot\r\n\t * @param   pDirectionI : 1 si droite, -1 si gauche et 0 si aucun des 2\r\n\t * @param   pDirectionJ : 1 si bas, -1 si haut et 0 si aucun des 2\r\n     * @param\tpRemove : pour rajouter des element  la map toRemove au lieu de toAdd, mettre  true\r\n     */\t\r\n\tprivate function setToAddInGrid(pColLeft:UInt, pColRight:UInt, pRowTop:UInt, pRowBot:UInt, ?pDirectionI:Int = 0, ?pDirectionJ:Int = 0, ?pRemove:Bool = false):Void \r\n\t{\r\n\t\tfor (i in pColLeft...pColRight) \r\n\t\t{\r\n\t\t\tif (CellManager.level[i] != null) \r\n\t\t\t{\r\n\t\t\t\tfor (j in pRowTop...pRowBot)\r\n\t\t\t\t{\t\r\n\t\t\t\t\tif (CellManager.level[i][j] != null) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (i <= CellManager.getInstance().xMax && i >= CellManager.getInstance().xMin && j <= CellManager.getInstance().yMax && j >= CellManager.getInstance().yMin && CellManager.level[i][j].list.length > 0) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tfor (instance in CellManager.level[i][j].list)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (pRemove) \r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttoRemove.set(instance, true);\r\n\r\n\t\t\t\t\t\t\t\t\tif (CellManager.level[i -pDirectionI] != null)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (CellManager.level[i - pDirectionI][j - pDirectionJ] != null) \r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tif (CellManager.level[i - pDirectionI][j - pDirectionJ].list.indexOf(instance) != -1) toRemove[instance] = false;\r\n\t\t\t\t\t\t\t\t\t\t\telse toRemove.set(instance, true);\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttoAdd.set(instance, true);\r\n\t\t\t\t\t\t\t\t\tif (pDirectionI != 0 || pDirectionJ != 0) \r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (CellManager.level[i -pDirectionI] != null)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tif (CellManager.level[i - pDirectionI][j - pDirectionJ] != null) \r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (CellManager.level[i - pDirectionI][j - pDirectionJ].list.indexOf(instance) != -1) toAdd[instance] = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\telse toAdd.set(instance, true);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor (object in PoolObject.activeObjectList) if (instance == object.instanceID) toAdd[instance] = false;\t\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * affiche les element contenu dans la map toAdd\r\n\t */\t\r\n\tprivate function displayToAdd():Void \r\n\t{\r\n\t\tfor (instance in toAdd.keys()) \r\n\t\t{\r\n\t\t\tif (toAdd[instance]) \r\n\t\t\t{\r\n\t\t\t\tDisplayManager.getInstance().displayElement(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\ttoAdd = new Map<String, Bool>();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * retire les element de l'affichage\r\n\t */\r\n\tprivate function removeToDisplay():Void \r\n\t{\r\n\t\tvar lParent:Container;\r\n\t\t \r\n\t\tfor (instance in toRemove.keys())\r\n\t\t{\r\n\t\t\tif (toRemove[instance])\r\n\t\t\t{\r\n\t\t\t\tDisplayManager.getInstance().removeElement(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\ttoRemove = new Map<String, Bool>();\r\n\t}\r\n\t\r\n\t/**\r\n\t * vide le tableau saveInstances\r\n\t */\r\n\tpublic static function clearSave():Void \r\n\t{\r\n\t\t//saveInstances = new Map<String, Array<Cell>>();\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n}","package com.isartdigital.utils.game.clipping;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.save.ElementSave;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\n\r\n\t\r\n/**\r\n * Classe Modifiable en fonction du projet \r\n * Affichage ou retrait de l'affichage des elements du jeu\r\n * @author Adrien Bourdon\r\n */\r\nclass DisplayManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe DisplayManager\r\n\t */\r\n\tprivate static var instance: DisplayManager;\r\n\t\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): DisplayManager {\r\n\t\tif (instance == null) instance = new DisplayManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialise et Start un elements du jeu \r\n\t * @param   pInstance : nom de l'instance\r\n\t */\r\n\tpublic function displayElement(pInstance:String):Void \r\n\t{\r\n\t\tvar lElem:Element = PoolObject.elementList.get(pInstance);\r\n\t\tvar lObject:PoolObject = PoolManager.getFromPool(lElem.type);\r\n\t\t//trace(\"display : \" + lElem.type + \" : \" + lElem.x + \" \"+lElem.y );\r\n\t\tWorld.getInstance().getRegion(lElem.regionX, lElem.regionY).layers[1].container.addChild(lObject);\r\n\t\tlObject.init(lElem);\r\n\t\tlObject.start();\r\n\t\tvar lPoint:Point = new Point(lElem.x, lElem.y);\r\n\t\tlObject.position = IsoManager.modelToIsoView(lPoint);\r\n\t}\r\n\t\r\n\t/**\r\n\t * retire un element de l'affichage\r\n\t * @param\tpInstance : nom de l'instance\r\n\t */\r\n\tpublic function removeElement(pInstance:String):Void \r\n\t{\r\n\t\tfor (object in PoolObject.activeObjectList) \r\n\t\t{\r\n\t\t\tif (object.instanceID == pInstance) {\r\n\t\t\t\tobject.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.factory;\r\n\r\nimport pixi.core.display.Container;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass AnimFactory\r\n{\r\n\r\n\tprivate var anim:Container;\r\n\t\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function getAnim ():Container {\r\n\t\treturn anim;\r\n\t}\r\n\t\r\n\tpublic function create (pID:String):Container {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\tpublic function update (pId:String):Void {\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function setFrame (?pAutoPlay:Bool=true, ?pStart:UInt = 0): Void {\r\n\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game.factory;\r\n\r\nimport pixi.core.display.Container;\r\nimport pixi.flump.Movie;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass FlumpMovieAnimFactory extends AnimFactory \r\n{\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\toverride public function getAnim ():Container {\r\n\t\tif (anim !=null) {\r\n\t\t\tanim.parent.removeChild(anim);\r\n\t\t\tanim.destroy();\r\n\t\t\tanim = null;\r\n\t\t}\r\n\t\treturn super.getAnim();\r\n\t}\r\n\t\r\n\toverride public function create (pID:String):Container {\r\n\t\tanim = new Movie(pID);\r\n\t\treturn anim;\r\n\t}\r\n\t\r\n\toverride public function setFrame (?pAutoPlay:Bool = true, ?pStart:UInt = 0): Void {\r\n\t\tvar lAnim:Movie = cast(anim, Movie);\r\n\t\t\r\n\t\tif (lAnim.totalFrames > 1) {\r\n\t\t\tif (pAutoPlay) lAnim.gotoAndPlay(pStart);\r\n\t\t\telse lAnim.gotoAndStop(pStart);\r\n\t\t}\r\n\t\telse if (!pAutoPlay) lAnim.stop();\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.factory;\r\n\r\nimport pixi.core.display.Container;\r\nimport pixi.flump.Sprite;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass FlumpSpriteAnimFactory extends AnimFactory \r\n{\r\n\t\r\n\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\toverride public function getAnim ():Container {\r\n\t\tif (anim !=null) {\r\n\t\t\tanim.parent.removeChild(anim);\r\n\t\t\tanim.destroy();\r\n\t\t\tanim = null;\r\n\t\t}\r\n\t\treturn super.getAnim();\r\n\t}\r\n\t\r\n\toverride public function create (pID:String):Container {\r\n\t\tanim = new Sprite(pID);\r\n\t\treturn anim;\r\n\t}\r\n\t\r\n\toverride public function setFrame (?pAutoPlay:Bool=true, ?pStart:UInt = 0): Void {\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.factory;\r\nimport haxe.Json;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.extras.MovieClip;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass MovieClipAnimFactory extends AnimFactory\r\n{\r\n\r\n\t/**\r\n\t * longueur de la numrotation des textures\r\n\t */\r\n\tpublic static var textureDigits (default, set) :UInt = 4;\r\n\t\r\n\tprivate static function set_textureDigits (pDigits:UInt) : UInt {\r\n\t\tdigits = \"\";\r\n\t\tfor (i in 0...pDigits) digits += \"0\";\r\n\t\treturn textureDigits = pDigits;\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dfinition des textures (nombre d'images)\r\n\t */\r\n\tprivate static var texturesDefinition:Map<String,Int>;\r\n\t\r\n\t/**\r\n\t * dfinition des ancres des textures\r\n\t */\r\n\tprivate static var texturesAnchor:Map<String,Point>;\r\n\t\r\n\t/**\r\n\t * cache des textures de tous les StateGraphic\r\n\t */\r\n\tprivate static var texturesCache:Map<String,Array<Texture>>;\r\n\t\r\n\t/**\r\n\t * nombre de zro  ajouter pour construire un nom de frame\r\n\t */\r\n\tprivate static var digits:String;\t\r\n\t\r\n\t/**\r\n\t * Analyse et cre les dfinitions de textures\r\n\t * @param\tpJson objet contenant la description des assets\r\n\t */\r\n\tstatic public function addTextures (pJson:Json): Void {\r\n\t\t\r\n\t\tvar lFrames:Dynamic = Reflect.field(pJson, \"frames\");\r\n\t\t\r\n\t\tif (texturesDefinition == null) texturesDefinition = new Map<String,Int>();\r\n\t\tif (texturesAnchor == null) texturesAnchor = new Map<String,Point>();\r\n\t\tif (texturesCache == null) texturesCache = new Map<String,Array<Texture>>();\r\n\t\tif (digits == null) textureDigits = textureDigits;\r\n\t\t\r\n\t\tvar lID:String;\r\n\t\tvar lNum:Int;\r\n\t\t\r\n\t\tfor (lName in Reflect.fields(lFrames)) {\r\n\t\t\t\r\n\t\t\tlID = lName.split(\".\")[0];\r\n\t\t\tlNum = Std.parseInt(lID.substr(-1*textureDigits));\r\n\t\t\tif (lNum != null) lID = lID.substr(0, lID.length - textureDigits);\r\n\t\t\t\r\n\t\t\tif (texturesDefinition[lID] == null) texturesDefinition[lID] = lNum == null ? 1 : lNum;\r\n\t\t\telse if (lNum > texturesDefinition[lID]) texturesDefinition[lID] = lNum;\r\n\t\t\t\r\n\t\t\tif (texturesAnchor[lID] == null) texturesAnchor[lID] = Reflect.field(lFrames, lName).pivot;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Vide le cache de textures correspondant  la description passe en paramtres\r\n\t * @param\tpJson objet contenant la description des assets\r\n\t */\r\n\tstatic public function clearTextures (pJson:Json): Void {\r\n\t\t\r\n\t\tvar lFrames:Dynamic = Reflect.field(pJson, \"frames\");\r\n\t\t\r\n\t\tif (texturesDefinition == null) return;\r\n\t\t\r\n\t\tvar lID:String;\r\n\t\tvar lNum:Int;\r\n\t\t\r\n\t\tfor (lID in Reflect.fields(lFrames)) {\r\n\t\t\t\r\n\t\t\tlID = lID.split(\".\")[0];\r\n\t\t\tlNum = Std.parseInt(lID.substr(-1*textureDigits));\r\n\t\t\tif (lNum != null) lID = lID.substr(0, lID.length - textureDigits);\r\n\t\t\t\r\n\t\t\ttexturesDefinition[lID] = null;\r\n\t\t\ttexturesAnchor[lID] = null;\r\n\t\t\ttexturesCache[lID] = null;\r\n\t\t}\r\n\t}\t\r\n\t\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\tsuper();\r\n\t\t\r\n\t}\r\n\t\r\n\toverride public function create (pID:String):Container {\r\n\t\tanim = new MovieClip(getTextures(pID));\r\n\t\tcast (anim,MovieClip).anchor = texturesAnchor[pID];\r\n\t\treturn anim;\r\n\t}\r\n\t\r\n\toverride public function update (pID:String):Void {\r\n\t\tvar lAnim:MovieClip = cast(anim, MovieClip);\r\n\t\tlAnim.textures = getTextures(pID);\r\n\t\tlAnim.anchor = texturesAnchor[pID];\r\n\t}\r\n\t\r\n\toverride public function setFrame (?pAutoPlay:Bool=true, ?pStart:UInt = 0): Void {\r\n\t\tvar lAnim:MovieClip = cast(anim, MovieClip);\t\t\r\n\t\tlAnim.gotoAndStop(pStart);\r\n\t\tif (pAutoPlay) lAnim.play();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Cherche dans le cache gnral de textures le tableau de textures correspondant au state et le retourne.\r\n\t * Si le tableau de texture n'xiste pas, il le cre et le stocke dans le cache\r\n\t * @param\tpID ID complet de l'anim\r\n\t * @return\tle tableau de texture correspondant au state de l'instance\r\n\t */\r\n\tprivate function getTextures(pID:String):Array<Texture> {\r\n\t\t\r\n\t\tif (texturesCache[pID] == null) {\r\n\t\t\tvar lFrames:UInt = texturesDefinition[pID];\r\n\t\t\tif (lFrames == 1) texturesCache[pID] =[Texture.fromFrame(pID+\".png\")];\r\n\t\t\telse {\r\n\t\t\t\ttexturesCache[pID] = new Array<Texture>();\r\n\t\t\t\tfor (i in 1...lFrames+1) texturesCache[pID].push(Texture.fromFrame(pID+(digits + i).substr(-1*textureDigits) + \".png\"));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn texturesCache[pID];\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.game.filtersManagement;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.renderers.webgl.filters.AbstractFilter;\r\nimport pixi.filters.twist.TwistFilter;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Jordan Dachicourt\r\n */\r\nclass TwistFilterManager \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe TwistFilterManager\r\n\t */\r\n\tprivate static var instance: TwistFilterManager;\r\n\t\r\n\tprivate var gameContainer: Container;\r\n\tprivate var twists:Array<AbstractFilter>;\r\n\tprivate var timer:Float;\r\n\tprivate var elapseTime:Float;\r\n\tprivate var offsetLimit:Float;\r\n\tprivate var direction:Point;\r\n\tprivate var start:Point;\r\n\tprivate var speed:Float;\r\n\tprivate var maxTwist:Float;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): TwistFilterManager {\r\n\t\tif (instance == null) instance = new TwistFilterManager();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic function init(pGameContainer:Container, pTimer:Float) {\r\n\t\tgameContainer = pGameContainer;\r\n\t\ttimer = pTimer;\r\n\t\telapseTime = 0;\r\n\t\ttwists = new Array<AbstractFilter>();\r\n\t\tdirection = new Point(0.5, 0.5);\r\n\t\tstart = new Point( -1, -1);\r\n\t\toffsetLimit = 1.5;\r\n\t\tspeed = 0.01;\r\n\t\tmaxTwist = 10;\r\n\t}\r\n\t\r\n\tpublic function addTwist() {\r\n\t\tif (gameContainer == null || twists.length > maxTwist) return;\r\n\r\n\t\tvar lTwist:TwistFilter = new TwistFilter();\r\n\t\tlTwist.angle = 0.03;\r\n\t\tlTwist.radius = 0.5;\r\n\t\tlTwist.padding = 0;\r\n\t\tlTwist.offset.x = start.x;\r\n\t\tlTwist.offset.y = start.y;\r\n\t\ttwists.push(lTwist);\r\n\t\tgameContainer.filters = twists;\r\n\t}\r\n\t\r\n\tpublic function doAction() {\r\n\t\t\tmoveTwist();\r\n\t\t\taddTwistOnTick();\r\n\t}\r\n\t\r\n\tprivate function moveTwist() {\r\n\t\t\r\n\t\tif (gameContainer.filters == null) return;\r\n\r\n\t\tfor (i in 0 ... gameContainer.filters.length) {\r\n\t\t\t\r\n\t\t\tvar lTwist:TwistFilter = cast(gameContainer.filters[i], TwistFilter);\r\n\t\r\n\t\t\tlTwist.offset.x += direction.x * speed;\r\n\t\t\tlTwist.offset.y += direction.y * speed;\r\n\t\t\r\n\t\t\tif (lTwist.offset.x > offsetLimit || lTwist.offset.y > offsetLimit) {\r\n\t\t\t\ttwists.remove(gameContainer.filters[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function addTwistOnTick() {\r\n\t\telapseTime += 0.1;\r\n\t\tif (elapseTime >= timer) {\r\n\t\t\taddTwist();\r\n\t\t\telapseTime = 0;\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.game.iso;\r\n\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport js.Lib;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\n\r\n/**\r\n * Manager Iso\r\n * @author Mathieu Anthoine\r\n * @version 0.3.0\r\n */\r\nclass IsoManager\r\n{\t\r\n\t\r\n\tprivate static var halfWidth:Float;\r\n\tprivate static var halfHeight:Float;\r\n\t\r\n\t/**\r\n\t * Initialisation du Manager Iso\r\n\t * @param\tpTileWidth largeur des tuiles\r\n\t * @param\tpTileHeight hauteur des tuiles\r\n\t */\r\n\tpublic static function init (pTileWidth:UInt, pTileHeight:UInt): Void {\r\n\t\thalfWidth = pTileWidth / 2;\r\n\t\thalfHeight = pTileHeight / 2;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Conversion du modle  la vue Isomtrique\r\n\t * @param\tpPoint colonne et ligne dans le modle\r\n\t * @return point en x, y dans la vue\r\n\t */\r\n\tpublic static function modelToIsoView(pPoint:Point):Point {\r\n\t\treturn new Point (\r\n\t\t\t(pPoint.x - pPoint.y)*halfWidth,\r\n\t\t\t(pPoint.x + pPoint.y)*halfHeight\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Conversion de la vue Isomtrique au modle\r\n\t * @param\tpPoint coordonnes dans la vue\r\n\t * @return colonne et ligne dans le modle (valeurs non arrondies)\r\n\t */\r\n\tpublic static function isoViewToModel(pPoint:Point):Point {\r\n\t\treturn new Point (\r\n\t\t\t(pPoint.y/halfHeight+pPoint.x/halfWidth)/2,\r\n\t\t\t(pPoint.y/halfHeight-pPoint.x/halfWidth)/2\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * toGlobal depuis la position model d'un building dans sa region\r\n\t * @param\tpBuilding :Building\r\n\t * @return position global d'un building \r\n\t */\r\n\tpublic static function getGlobalPositionOfBuilding(pBuilding:GameElement):Point\r\n\t{\r\n\t\tvar lPoint:Point = new Point(pBuilding.elem.regionX * Region.WIDTH + pBuilding.elem.x, pBuilding.elem.regionY * Region.HEIGHT + pBuilding.elem.y);\r\n\t\tlPoint = modelToIsoView(lPoint);\r\n\t\treturn lPoint;\r\n\t}\r\n\t\r\n\tpublic static function localToModel(pPoint:Point):Point {\t\t\r\n\t\tvar lTileWidth:Float = halfWidth * 2;\t\t\r\n\t\tvar lTileHeight:Float = halfHeight * 2;\t\t\r\n\t\t\t\t\r\n\t\treturn new Point (\t\t\r\n\t\t\tMath.floor((pPoint.y / lTileHeight) + (pPoint.x / lTileWidth)),\t\t\r\n\t\t\tMath.floor((-pPoint.x / lTileWidth) + (pPoint.y / lTileHeight))\t\t\r\n\t\t);\t\t\r\n\t}\t\t\r\n\t\t\t\r\n\tpublic static function localToIso(pPoint:Point):Point {\t\t\r\n\t\treturn modelToIsoView(localToModel(pPoint));\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtermine si l'objet A est devant l'objet B\r\n\t * @param\tpA Objet \"IZsortable\" A\r\n\t * @param\tpB Objet \"IZsortable\" B\r\n\t * @return pA, pB ou null si les objets ne se superposent pas\r\n\t */\r\n\tpublic static function isInFrontOf (pA:DisplayObject, pB:DisplayObject):DisplayObject {\r\n\t\t\r\n\t\tif ((Std.is(pA, StateGraphic) && untyped pA.boxType == BoxType.NONE) || (Std.is(pB, StateGraphic) && untyped pB.boxType == BoxType.NONE)) {\r\n\t\t\tthrow \"IsoManager.isFrontOf :: la proprit boxType des StateGraphic ne doit pas tre dfinie  NONE\";\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\tif (!Std.is(pA, IZSortable) || !Std.is(pB, IZSortable)) throw \"Les objets passs en paramtre doivent implmenter IZSortable\";\r\n\t\t\r\n\t\tvar lBoxA:DisplayObject = Std.is(pA, StateGraphic) ? cast(pA, StateGraphic).hitBox : pA;\r\n\t\tvar lBoxB:DisplayObject = Std.is(pB, StateGraphic) ? cast(pB, StateGraphic).hitBox : pB;\r\n\t\tif (!CollisionManager.hitTestObject(lBoxA, lBoxB)) return null;\r\n\t\t\r\n\t\tvar lA:IZSortable = cast (pA, IZSortable);\r\n\t\tvar lB:IZSortable = cast (pB, IZSortable);\r\n\t\t\r\n\t\tif (lA.rowMax < lB.rowMin) return pB; \r\n\t\telse if (lB.rowMax < lA.rowMin) return pA;\r\n\t\t\r\n\t\tif (lA.colMax < lB.colMin) return pB; \r\n\t\telse if (lB.colMax < lA.colMin) return pA;\r\n\t\t\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Z-sorting des objets transmis  la mthode\r\n\t * @param\tpTiles tableau des DisplayObject  trier en Z\r\n\t * @return\ttableau tri en Z\r\n\t */\r\n\tpublic static function sortTiles (pTiles:Array<DisplayObject>):Array<DisplayObject> {\r\n\r\n\t\tvar lNumTiles:Int=pTiles.length;\r\n\t\tvar lTile:IZSortable;\r\n\t\t\r\n\t\tfor (i in 0...lNumTiles) {\r\n\t\t\tlTile = cast(pTiles[i], IZSortable);\r\n\t\t\tlTile.behind = [];\r\n\t\t\tlTile.inFront = [];\r\n\t\t}\r\n\r\n\t\tvar lA:IZSortable;\r\n\t\tvar lB:IZSortable;\r\n\t\tvar lFrontTile:DisplayObject;\r\n\t\t\r\n\t\tfor (i in 0...lNumTiles) {\r\n\t\t\tlA = cast(pTiles[i],IZSortable);\r\n\t\t\tfor (j in (i + 1)...lNumTiles) {\r\n\t\t\t\tlB = cast(pTiles[j], IZSortable);\r\n\t\t\t\tlFrontTile = isInFrontOf(pTiles[i],pTiles[j]);\r\n\t\t\t\tif (lFrontTile!=null) {\r\n\t\t\t\t\tif (lA == cast(lFrontTile,IZSortable)) {\r\n\t\t\t\t\t\tlA.behind.push(lB);\r\n\t\t\t\t\t\tlB.inFront.push(lA);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlB.behind.push(lA);\r\n\t\t\t\t\t\tlA.inFront.push(lB);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t//TODO: test des tableaux devant derriere\r\n\t\t\r\n\t\t\r\n\t\tvar lToDraw:Array<IZSortable> = [];\r\n\r\n\t\tfor (i in 0...lNumTiles) {\r\n\t\t\tlTile = cast(pTiles[i], IZSortable);\r\n\t\t\tif (lTile.behind.length == 0) lToDraw.push(lTile);\r\n\t\t}\r\n\r\n\t\tvar lTilesDrawn:Array<DisplayObject> = [];\r\n\t\tvar lFrontTile:IZSortable;\r\n\t\t\r\n\t\twhile (lToDraw.length > 0) {\r\n\r\n\t\t\tlTile = lToDraw.pop();\r\n\t\t\tlTilesDrawn.push(cast(lTile, DisplayObject));\t\t\t\r\n\t\t\tfor (j in 0...lTile.inFront.length) {\r\n\t\t\t\tlFrontTile = lTile.inFront[j];\r\n\t\t\t\tlFrontTile.behind.remove(lTile);\r\n\t\t\t\tif (lFrontTile.behind.length == 0) lToDraw.push(lFrontTile);\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t\t\r\n\t\treturn lTilesDrawn;\r\n\t};\r\n\t\r\n\t\r\n}","package com.isartdigital.utils.game.pooling;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.Bomber;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.Driller;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.Healer;\r\nimport com.isartdigital.ruby.game.specialFeature.aliens.Tank;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.AlienSpawn;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Clue;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.HardBrick;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Lava;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.SpecialFeatureItem;\r\nimport com.isartdigital.ruby.game.specialFeature.tiles.classes.Walls;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienCryoCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienIncubator;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienResearchCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.AlienTrainingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks.AlienPaddockBig;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks.AlienPaddockMedium;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks.AlienPaddockSmall;\r\nimport com.isartdigital.ruby.game.sprites.elements.alienbuilding.paddocks.AlienPaddockTiny;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.CosmeticBuilding;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule1;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule2;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticCapsule3;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant1;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant2;\r\nimport com.isartdigital.ruby.game.sprites.elements.cosmeticbuilding.cosmetictype.BuildingCosmeticPlant3;\r\nimport com.isartdigital.ruby.game.sprites.elements.destructible.Destructible;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingAutoOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingCenter;\r\nimport com.isartdigital.ruby.game.sprites.elements.drillingbuilding.DrillingOutPost;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanAntenna;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanCommunication;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanHeadQuarter;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanPowerStation;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.UrbanTranslation;\r\nimport com.isartdigital.ruby.game.sprites.ressources.Bubble;\r\nimport com.isartdigital.ruby.game.sprites.ressources.RessourceHardCurrency;\r\nimport com.isartdigital.ruby.game.sprites.ressources.RessourceSoftCurrency;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport haxe.Json;\r\n\r\n\r\n\r\n\r\n/**\r\n * Gere le pooling, l'ajout et la sortie du pool et son initialisation\r\n * @author dachicourt jordan\r\n */\r\nclass PoolManager\r\n{\r\n\tpublic static var pool: Map<String, Array<PoolObject>> = new Map<String, Array<PoolObject>>();\r\n\r\n\tprivate function new()\r\n\t{\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Initialise le pooling en fonction du fichier json en parametre\r\n\t * @param\tpPool json contenant les pool de depart\r\n\t */\r\n\tstatic public function init(pPool:Json)\r\n\t{\r\n\r\n\t\tfor (lClassName in Reflect.fields(pPool))\r\n\t\t{\r\n\t\t\tpool.set(lClassName, new Array<PoolObject>());\r\n\r\n\t\t\tvar numberOfInstance:Int = Reflect.field(pPool, lClassName);\r\n\r\n\t\t\tfor (i in 0 ... numberOfInstance)\r\n\t\t\t{\r\n\t\t\t\taddToPool(lClassName, getInstance(lClassName));\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ajoute une instance dansle pool\r\n\t * @param\tpType asset du l'objet\r\n\t * @param\tpInstance instance de l'objet\r\n\t */\r\n\tpublic static function addToPool(pType:String, pInstance:PoolObject):Void\r\n\t{\r\n\t\tif (pType == null || pInstance == null)\r\n\t\t\treturn null;\r\n\r\n\t\tif (!pool.exists(pType))\r\n\t\t\tpool.set(pType,  new Array<PoolObject>());\r\n\r\n\t\tpool.get(pType).push(pInstance);\r\n\t}\r\n\r\n\t/**\r\n\t * Prend une instance dans la piscine\r\n\t * @param\tpType asset voulu\r\n\t * @return instance correspondant  l'asset\r\n\t */\r\n\tpublic static function getFromPool(pType:String):PoolObject\r\n\t{\r\n\t\tif (pType == null) return null;\r\n\t\tif (!pool.exists(pType) ||  pool.get(pType).length == 0)\r\n\t\t\taddToPool(pType, getInstance(pType));\r\n\r\n\t\treturn pool.get(pType).pop();\r\n\t}\r\n\r\n\t/**\r\n\t * Retourne l'instance correspondant au type\r\n\t * @param\tpType asset voulu\r\n\t * @return l'instance voulu\r\n\t */\r\n\tprivate static function getInstance(pType:String):PoolObject\r\n\t{\r\n\r\n\t\tif (pType == ElementType.POWERSTATION) return new UrbanPowerStation();\r\n\t\telse if (pType == ElementType.ANTENNA) return new UrbanAntenna();\r\n\t\telse if (pType == ElementType.HQ) return new UrbanHeadQuarter();\r\n\t\telse if (pType == ElementType.COMMUNICATION) return new UrbanCommunication();\r\n\t\telse if (pType == ElementType.TRANSLATION) return new UrbanTranslation();\r\n\r\n\t\telse if (pType == ElementType.DRILLING_CENTER) return new DrillingCenter();\r\n\t\telse if (pType == ElementType.DRILLING_AUTO_OUTPOST) return new DrillingAutoOutPost();\r\n\t\telse if (pType == ElementType.DRILLING_OUTPOST) return new DrillingOutPost();\r\n\r\n\t\telse if (pType == ElementType.INCUBATOR) return new AlienIncubator();\r\n\t\telse if (pType == ElementType.PADDOCK_TINY) return new AlienPaddockTiny();\r\n\t\telse if (pType == ElementType.PADDOCK_SMALL) return new AlienPaddockSmall();\r\n\t\telse if (pType == ElementType.PADDOCK_MEDIUM) return new AlienPaddockMedium();\r\n\t\telse if (pType == ElementType.PADDOCK_BIG) return new AlienPaddockBig();\r\n\t\telse if (pType == ElementType.RESEARCH_CENTER) return new AlienResearchCenter();\r\n\t\telse if (pType == ElementType.TRAINING_CENTER) return new AlienTrainingCenter();\r\n\t\telse if (pType == ElementType.CRYO_CENTER) return new AlienCryoCenter();\r\n\t\telse if (pType == ElementType.COSMETIC) return new CosmeticBuilding();\r\n\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE1) return new BuildingCosmeticCapsule1();\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE2) return new BuildingCosmeticCapsule2();\r\n\t\telse if (pType == ElementType.COSMETIC_CASPULE3) return new BuildingCosmeticCapsule3();\r\n\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT1) return new BuildingCosmeticPlant1();\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT2) return new BuildingCosmeticPlant2();\r\n\t\telse if (pType == ElementType.COSMETIC_PLANT3) return new BuildingCosmeticPlant3();\r\n\r\n\t\telse if (pType == ElementType.DESTRUCTIBLE) return new Destructible();\r\n\r\n\t\telse if (pType == ElementType.RESSOURCE_BUBBLE) return new Bubble();\r\n\t\telse if (pType == ElementType.RESSOURCE_SC) return new RessourceSoftCurrency();\r\n\t\telse if (pType == ElementType.RESSOURCE_HC) return new RessourceHardCurrency();\r\n\r\n\t\telse if (pType == ElementType.ALIEN_1) return new AlienSpawn(ElementType.ALIEN_1);\r\n\t\telse if (pType == ElementType.ALIEN_2) return new AlienSpawn(ElementType.ALIEN_2);\r\n\t\telse if (pType == ElementType.ALIEN_3) return new AlienSpawn(ElementType.ALIEN_3);\r\n\r\n\t\telse if (pType == ElementType.WALL_TOP) return new Walls(ElementType.WALL_TOP);\r\n\t\telse if (pType == ElementType.WALL_BOT) return new Walls(ElementType.WALL_BOT);\r\n\t\telse if (pType == ElementType.WALL_LEFT) return new Walls(ElementType.WALL_LEFT);\r\n\t\telse if (pType == ElementType.WALL_RIGHT) return new Walls(ElementType.WALL_RIGHT);\r\n\r\n\t\telse if (pType == ElementType.CLUE_RESSOURCE) return new Clue(ElementType.CLUE_RESSOURCE);\r\n\t\telse if (pType == ElementType.CLUE_BLUEPRINT) return new Clue(ElementType.CLUE_BLUEPRINT);\r\n\t\telse if (pType == ElementType.CLUE_EMPTY) return new Clue(ElementType.CLUE_EMPTY);\r\n\r\n\t\telse if (pType == ElementType.CLUE_EMPTY_ORANGE) return new Clue(ElementType.CLUE_EMPTY_ORANGE);\r\n\t\telse if (pType == ElementType.CLUE_EMPTY_BLUE) return new Clue(ElementType.CLUE_EMPTY_BLUE);\r\n\t\telse if (pType == ElementType.CLUE_EMPTY_GREEN) return new Clue(ElementType.CLUE_EMPTY_GREEN);\r\n\r\n\t\telse if (pType == ElementType.HARDBRICK) return new HardBrick(ElementType.HARDBRICK);\r\n\r\n\t\telse if (pType == ElementType.LAVA) return new Lava(ElementType.LAVA);\r\n\r\n\t\telse if (pType == ElementType.ITEM_GENEFIVE) return new SpecialFeatureItem(ElementType.ITEM_GENEFIVE);\r\n\t\telse if (pType == ElementType.ITEM_GENEFOUR) return new SpecialFeatureItem(ElementType.ITEM_GENEFOUR);\r\n\t\telse if (pType == ElementType.ITEM_GENETHREE) return new SpecialFeatureItem(ElementType.ITEM_GENETHREE);\r\n\t\telse if (pType == ElementType.ITEM_GENETWO) return new SpecialFeatureItem(ElementType.ITEM_GENETWO);\r\n\t\telse if (pType == ElementType.ITEM_GENEONE) return new SpecialFeatureItem(ElementType.ITEM_GENEONE);\r\n\r\n\t\telse if (pType == ElementType.ITEM_DARKMATTER) return new SpecialFeatureItem(ElementType.ITEM_DARKMATTER);\r\n\t\t//else if (pType == ElementType.ITEM_BLUEPRINT_PART_0) return new Item(ElementType.ITEM_BLUEPRINT_PART_0);\r\n\t\telse if (pType == ElementType.ITEM_BLUEPRINT) return new SpecialFeatureItem(ElementType.ITEM_BLUEPRINT);\r\n\r\n\t\telse if (pType == ElementType.ITEM_HC) return new SpecialFeatureItem(ElementType.ITEM_HC);\r\n\t\telse if (pType == ElementType.ITEM_SC) return new SpecialFeatureItem(ElementType.ITEM_SC);\r\n\r\n\t\telse if (pType == ElementType.ALIEN_DRILLER1) return new Driller(ElementType.ALIEN_DRILLER1);\r\n\t\telse if (pType == ElementType.ALIEN_DRILLER2) return new Driller(ElementType.ALIEN_DRILLER2);\r\n\t\telse if (pType == ElementType.ALIEN_DRILLER3) return new Driller(ElementType.ALIEN_DRILLER3);\r\n\r\n\t\telse if (pType == ElementType.ALIEN_BOMBER1) return new Bomber(ElementType.ALIEN_BOMBER1);\r\n\t\telse if (pType == ElementType.ALIEN_BOMBER2) return new Bomber(ElementType.ALIEN_BOMBER2);\r\n\t\telse if (pType == ElementType.ALIEN_BOMBER3) return new Bomber(ElementType.ALIEN_BOMBER3);\r\n\r\n\t\telse if (pType == ElementType.ALIEN_HEALER1) return new Healer(ElementType.ALIEN_HEALER1);\r\n\t\telse if (pType == ElementType.ALIEN_HEALER2) return new Healer(ElementType.ALIEN_HEALER2);\r\n\t\telse if (pType == ElementType.ALIEN_HEALER3) return new Healer(ElementType.ALIEN_HEALER3);\r\n\r\n\t\telse if (pType == ElementType.ALIEN_TANK1) return new Tank(ElementType.ALIEN_TANK1);\r\n\t\telse if (pType == ElementType.ALIEN_TANK2) return new Tank(ElementType.ALIEN_TANK2);\r\n\t\telse if (pType == ElementType.ALIEN_TANK3) return new Tank(ElementType.ALIEN_TANK3);\r\n\r\n\t\telse return null;\r\n\t}\r\n\r\n\t/**\r\n\t * efface ce qu'il y a dans le tableau de pool, si un type est pass en parametre il efface seulement les instance correspondante.\r\n\t * @param\tpType\r\n\t */\r\n\tpublic static function clear(?pType:String = null):Void\r\n\t{\r\n\r\n\t\t/*si le type est defini on ne supprime qu'un type du pool*/\r\n\t\tif (pType != null)\r\n\t\t{\r\n\t\t\tpool.remove(pType);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t/*supression du tableau de tout le tableau de pool*/\r\n\t\tvar it : Iterator<String> = pool.keys();\r\n\t\twhile (it.hasNext()) pool.remove(it.next());\r\n\t}\r\n\r\n}","package com.isartdigital.utils.save;\r\nimport com.isartdigital.ruby.Main;\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.ui.popin.DailyReward;\r\nimport com.isartdigital.ruby.ui.popin.translationCenter.TranslationCenter;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport eventemitter3.EventEmitter;\r\nimport haxe.DynamicAccess;\r\nimport haxe.Http;\r\nimport haxe.Json;\r\n\r\ntypedef TempoBuildingInfo =\r\n{\r\n\tvar buildingType:String;\r\n\tvar regionX:Int;\r\n\tvar regionY:Int;\r\n\tvar x:Int;\r\n\tvar y:Int;\r\n\tvar globalX:Float;\r\n\tvar globalY:Float;\r\n\tvar layer:Int;\r\n\tvar buildingId:String;\r\n}\r\n\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass DataBaseAction\r\n{\r\n\r\n\t/**\r\n\t * instance unique de la classe DataBaseAction\r\n\t */\r\n\tprivate static var instance: DataBaseAction;\r\n\r\n\tpublic var activeData = false;\r\n\tpublic static inline var CONNECT:String = \"connexion\";\r\n\tpublic static inline var NEW_PLAYER:String = \"newPlayer\";\r\n\tpublic static inline var NEW_BUILDING:String = \"addBuilding\";\r\n\tpublic static inline var GET_BUILDINGS:String = \"getBuildings\";\r\n\tpublic static inline var GET_REGIONS:String = \"getRegions\";\r\n\tpublic static inline var MOVE_BUILDINGS:String = \"releaseBuildingPosition\";\r\n\tpublic static inline var DESTROY_BUILDINGS:String = \"destroyBuilding\";\r\n\tpublic static inline var MODE_BUILDINGS:String = \"releaseBuildingMode\";\r\n\tpublic static inline var ADD_REGION:String = \"addRegion\";\r\n\tpublic static inline var CHANGE_ENDTIME_BUILDING:String = \"changeEndTimeBuilding\";\r\n\tpublic static inline var CHANGE_ENERGY:String = \"changeEnergy\";\r\n\tpublic static inline var CHANGE_MAX_ENERGY:String = \"changeMaxEnergy\";\r\n\tpublic static inline var CHECK_VALUE:String = \"checkValue\";\r\n\tpublic static inline var FTUE_ADVANCE:String = \"ftueNewStep\";\r\n\tpublic static inline var NEW_DESTRUCTIBLE:String = \"addDestructible\";\r\n\tpublic static inline var MODE_DESTRUCTIBLE:String = \"releaseDestructibleMode\";\r\n\tpublic static inline var DESTROY_DESTRUCTIBLE:String = \"destroyDestructible\";\r\n\tpublic static inline var TIME:String = \"time\";\r\n\tpublic static inline var GET_ALIEN:String = \"getAlien\";\r\n\tpublic static inline var CHANGE_LEVEL:String = \"changeXpLevel\";\r\n\tpublic static inline var CHANGE_BUILDING_LEVEL:String = \"changeBuildingLevel\";\r\n\tpublic static inline var ADD_ALIEN:String = \"addAlien\";\r\n\tpublic static inline var MODE_ALIEN:String = \"modeAlien\";\r\n\tpublic static inline var CHANGE_ALIEN_IDBUILDING:String = \"changeAlienIdBuilding\";\r\n\r\n\tpublic static inline var TYPE_SOFTCURRENCY:String = \"softCurrency\";\r\n\tpublic static inline var TYPE_HARDCURRENCY:String = \"hardCurrency\";\r\n\tpublic static inline var TYPE_RESSOURCE:String = \"ressource\";\r\n\tpublic static inline var UPDATE_GENE:String = \"updateGene\";\r\n\t\r\n\tpublic static inline var ADD_SCHEMA:String = \"addSchema\";\r\n\tpublic static inline var UNLOCK_SCHEMA:String = \"unlockSchema\";\r\n\tpublic static inline var START_UNLOCK_SCHEMA:String = \"startUnlockSchema\";\r\n\tpublic static inline var GET_DECRYPT_TIME:String = \"getSchemaTimeToDecrypt\";\r\n\t\r\n\r\n\tprivate var tempoBuilding:TempoBuildingInfo;\r\n\r\n\tprivate var firstCo:Bool = false;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): DataBaseAction\r\n\t{\r\n\t\tif (instance == null) instance = new DataBaseAction();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\r\n\t}\r\n\r\n\tpublic function addBuildingAndChangeRessource(pIdPlayer:Int, pTypeValue:String, pValue:Int, pBuildingType:String,pBuildingId:String, pRegionX:Int, pRegionY:Int, pX:Int, pY:Int, pGlobalX:Float, pGlobalY:Float, pLayer:Int, ?pMNCost :Int = 0):Void\r\n\t{\r\n\t\ttempoBuilding = {\r\n\t\t\tbuildingType:pBuildingType,\r\n\t\t\tregionX:pRegionX,\r\n\t\t\tregionY:pRegionY,\r\n\t\t\tx:pX,\r\n\t\t\ty:pY,\r\n\t\t\tglobalX:pGlobalX,\r\n\t\t\tglobalY:pGlobalY,\r\n\t\t\tlayer:pLayer,\r\n\t\t\tbuildingId:pBuildingId\r\n\t\t}\r\n\t\tchangeCurrency(pIdPlayer, pTypeValue, pValue, true);\r\n\t\tif (pMNCost != 0) changeCurrency(pIdPlayer, \"ressource\", pMNCost);\r\n\t}\r\n\r\n\tpublic function getData(pAction:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?\"+pAction);\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function setData(pAction:String, pContent:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + pAction);\r\n\t\t\tlCall.setParameter(\"data\", pContent);\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * check la BDD, recupre les information du joueurs en fonction de son idFb\r\n\t * si le joueurs n'existe pas, un nouveau joueur est cr avant\r\n\t * @param\tpContent\r\n\t */\r\n\tpublic function connexionPlayer(pIdFb:String, pName:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pIdFb != \"\")\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CONNECT);\r\n\t\t\t\tlCall.setParameter(\"data\", pIdFb);\r\n\t\t\t\tlCall.setParameter(\"name\", pName);\r\n\t\t\t\tlCall.onData = onPlayerInfo;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"pas d'id facebook\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\t// les callback :\r\n\tpublic function onPlayerInfo(pData:Dynamic):Void\r\n\t{\r\n\t\tvar lData:Dynamic = Json.parse(pData);\r\n\t\tDataManager.getInstance().savePlayerInfo(lData);\r\n\t\t//DataManager.getInstance().saveRegionsJson(lData.region);\r\n\t\t//DataManager.getInstance().saveBuildingJson(lData.buidings);\r\n\r\n\t\ttrace(lData.firstTime);\r\n\t\tif (lData.firstTime) \r\n\t\t{\r\n\t\t\ttrace(\"ton pere c'est sa premiere fois\");\r\n\t\t\t//Main.getInstance().eventNewPlayer(lData.playerInfo.idFb);\r\n\t\t}\r\n\t\tgetServerTime();\r\n\t\tMain.getInstance().onSaveLoaded();\r\n\t}\r\n\r\n\tpublic function addBuilding(pBuildingType:String, pBuildingId:String, pRegionX:Int, pRegionY:Int, pX:Int, pY:Int, pGlobalX:Float, pGlobalY:Float, pLayer:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pBuildingType != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + NEW_BUILDING);\r\n\t\t\t\tlCall.setParameter(\"type\", pBuildingType);\r\n\t\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"regionX\", Std.string(pRegionX));\r\n\t\t\t\tlCall.setParameter(\"regionY\", Std.string(pRegionY));\r\n\t\t\t\tlCall.setParameter(\"x\", Std.string(pX));\r\n\t\t\t\tlCall.setParameter(\"y\", Std.string(pY));\r\n\t\t\t\tlCall.setParameter(\"globalX\", Std.string(pGlobalX));\r\n\t\t\t\tlCall.setParameter(\"globalY\", Std.string(pGlobalY));\r\n\t\t\t\tlCall.setParameter(\"layer\", Std.string(pLayer));\r\n\t\t\t\tlCall.setParameter(\"buildingID\", pBuildingId);\r\n\t\t\t\tlCall.onData = onAddBuilding;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"pas de type de building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function addAlien(pAlienID:String, pBuildingId:String, pType:String, pName:String, pNomPropre:String, pStamina:Int, pTime:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\ttrace(\"add alien\");\r\n\t\t\tif (pType != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + ADD_ALIEN);\r\n\t\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"buildingID\", pBuildingId);\r\n\t\t\t\tlCall.setParameter(\"alienID\", pAlienID);\r\n\t\t\t\tlCall.setParameter(\"type\", pType);\r\n\t\t\t\tlCall.setParameter(\"name\", pName);\r\n\t\t\t\tlCall.setParameter(\"nomPropre\", pNomPropre);\r\n\t\t\t\tlCall.setParameter(\"stamina\", Std.string(pStamina));\r\n\t\t\t\tlCall.setParameter(\"time\", pTime);\r\n\t\t\t\tlCall.onData = onAlienAdd;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"pas de type de building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\t\r\n\t\r\n\tpublic function changeAlienIdBuilding(pAlienID:String, pBuildingId:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pAlienID != null &&  pBuildingId != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_ALIEN_IDBUILDING);\r\n\t\t\t\tlCall.setParameter(\"buildingID\", pBuildingId);\r\n\t\t\t\tlCall.setParameter(\"alienID\", pAlienID);\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"pas de parametres\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tprivate function onAlienAdd(pData:Dynamic):Void\r\n\t{\r\n\t\r\n\t\t\r\n\t}\r\n\r\n\tpublic function onAddBuilding(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData != \"\")\r\n\t\t{\r\n\t\t\tvar lData:Dynamic = Json.parse(pData);\r\n\t\t\tDataManager.getInstance().saveBuildingJson(lData);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function releaseBuildingPosition(pID:String, pRegionX:Int, pRegionY:Int, pX:Int, pY:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + MOVE_BUILDINGS);\r\n\t\t\t\tlCall.setParameter(\"id\", pID);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"regionX\", Std.string(pRegionX));\r\n\t\t\t\tlCall.setParameter(\"regionY\", Std.string(pRegionY));\r\n\t\t\t\tlCall.setParameter(\"x\", Std.string(pX));\r\n\t\t\t\tlCall.setParameter(\"y\", Std.string(pY));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur position Building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function destroyBuilding(pID:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + DESTROY_BUILDINGS);\r\n\t\t\t\tlCall.setParameter(\"id\", pID);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur destroy Building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function changeExperience(pXp:Int, pLevel:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pXp != null && pLevel != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_LEVEL);\r\n\t\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"xp\", Std.string(pXp));\r\n\t\t\t\tlCall.setParameter(\"level\", Std.string(pLevel));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur changeExperience\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function changeBuildingLevel(pID:String, pLevel:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null && pLevel != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_BUILDING_LEVEL);\r\n\t\t\t\tlCall.setParameter(\"id\", Std.string(pID));\r\n\t\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"level\", Std.string(pLevel));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur changeBuildingLevel\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function releaseBuildingMode(pID:String, pMode:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + MODE_BUILDINGS);\r\n\t\t\t\tlCall.setParameter(\"id\", pID);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"mode\", pMode);\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur mode Building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function addDestructible(pDestructibleType:String, pDestructibleId:String, pRegionX:Int, pRegionY:Int, pX:Int, pY:Int, pLayer:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pDestructibleType != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + NEW_DESTRUCTIBLE);\r\n\t\t\t\tlCall.setParameter(\"type\", pDestructibleType);\r\n\t\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"regionX\", Std.string(pRegionX));\r\n\t\t\t\tlCall.setParameter(\"regionY\", Std.string(pRegionY));\r\n\t\t\t\tlCall.setParameter(\"x\", Std.string(pX));\r\n\t\t\t\tlCall.setParameter(\"y\", Std.string(pY));\r\n\t\t\t\tlCall.setParameter(\"layer\", Std.string(pLayer));\r\n\t\t\t\tlCall.setParameter(\"destructableID\", pDestructibleId);\r\n\t\t\t\tlCall.onData = onAddDestructable;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"pas de type de building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function onAddDestructable(pData:Dynamic):Void\r\n\t{\r\n\t\ttrace(pData);\r\n\t\ttrace(\"pas d'erreur sur le add destructable\");\r\n\t\tif (pData != \"\")\r\n\t\t{\r\n\t\t\tvar lData:Dynamic = Json.parse(pData);\r\n\t\t\tDataManager.getInstance().saveBuildingJson(lData);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function destroyDestructible(pID:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + DESTROY_DESTRUCTIBLE);\r\n\t\t\t\tlCall.setParameter(\"id\", pID);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur destroy Destructible\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function releaseDestructibleMode(pName:String, pID:String, pMode:String):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + MODE_DESTRUCTIBLE);\r\n\t\t\t\tlCall.setParameter(\"id\", pID);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"mode\", pMode);\r\n\t\t\t\tlCall.setParameter(\"name\", pName);\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur mode Destructible\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\t\r\n\tpublic function releaseAlienMode(pAlienId:String, pMode:String, ?pTimeEnd:Date = null ):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pAlienId != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + MODE_ALIEN);\r\n\t\t\t\tlCall.setParameter(\"alienId\", MODE_ALIEN);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tif (pTimeEnd != null) lCall.setParameter(\"timeEnd\",Std.string(pTimeEnd));\r\n\t\t\t\tlCall.setParameter(\"mode\", pMode);\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur mode Destructible\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function changeEndTimeBuilding(pId:String, pEndTime:Date):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tif (pId != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_ENDTIME_BUILDING);\r\n\t\t\t\tlCall.setParameter(\"id\", pId);\r\n\t\t\t\tlCall.setParameter(\"endTime\", Std.string(pEndTime));\r\n\t\t\t\tlCall.onData = onData;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur no Building id\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function unlockRegion(regionX:Int, regionY:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\t//if (pID != null)\r\n\t\t\t{\r\n\t\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + ADD_REGION);\r\n\t\t\t\tlCall.setParameter(\"idPlayer\", Std.string(Player.getInstance().id));\r\n\t\t\t\tlCall.setParameter(\"x\", Std.string(regionX));\r\n\t\t\t\tlCall.setParameter(\"y\", Std.string(regionY));\r\n\t\t\t\tlCall.onData = onUnlockRegion;\r\n\t\t\t\tlCall.onError = onError;\r\n\t\t\t\tlCall.request(true);\r\n\t\t\t}\r\n\t\t\t/*else\r\n\t\t\t{\r\n\t\t\t\ttrace(\"Erreur position Building\");\r\n\t\t\t\treturn null;\r\n\t\t\t}*/\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function onUnlockRegion(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData != \"\")\r\n\t\t{\r\n\t\t\ttrace(\"onData : \" + pData);\r\n\t\t\ttrace(Json.parse(pData));\r\n\t\t}\r\n\t\tif (firstCo) addBuilding(\"AlienPaddock\", \"AlienPaddock\"+Date.now().getTime(), 0, 0, 8, 8, 0, 800, 1);\r\n\t}\r\n\r\n\tpublic function onData(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData != \"\")\r\n\t\t{\r\n\t\t\ttrace(\"onData : \" + pData);\r\n\t\t\ttrace(Json.parse(pData));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function onError(pError:Dynamic):Void\r\n\t{\r\n\t\ttrace(pError);\r\n\t\tif (pError != \"\")\r\n\t\t{\r\n\t\t\ttrace(\"onError : \" + pError);\r\n\t\t\ttrace(Json.parse(pError));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function changeCurrency(pIdPlayer:Int, pTypeValue:String, pValue:Int, ?isAddingBuilding:Bool = false):Void\r\n\t{\r\n\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHECK_VALUE);\r\n\t\t\tlCall.setParameter(\"idPlayer\", Std.string(pIdPlayer));\r\n\t\t\tlCall.setParameter(\"value\", Std.string(pValue));\r\n\t\t\tlCall.setParameter(\"typeValue\", pTypeValue);\r\n\t\t\tif (isAddingBuilding) lCall.onData = onChangeCurrencyToAddBuilding;\r\n\t\t\telse lCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function changeEnergy(pIdPlayer:Int, pEnergy:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_ENERGY);\r\n\t\t\tlCall.setParameter(\"idPlayer\", Std.string(pIdPlayer));\r\n\t\t\tlCall.setParameter(\"value\", Std.string(pEnergy));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function changeMaxEnergy(pIdPlayer:Int, pMaxEnergy:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + CHANGE_MAX_ENERGY);\r\n\t\t\tlCall.setParameter(\"idPlayer\", Std.string(pIdPlayer));\r\n\t\t\tlCall.setParameter(\"value\", Std.string(pMaxEnergy));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function onChangeCurrencyToAddBuilding(pData:Dynamic):Void\r\n\t{\r\n\r\n\t\taddBuilding(tempoBuilding.buildingType,tempoBuilding.buildingId, tempoBuilding.regionX, tempoBuilding.regionY, tempoBuilding.x, tempoBuilding.y, tempoBuilding.globalX, tempoBuilding.globalY, tempoBuilding.layer);\r\n\t}\r\n\r\n\tpublic function changeFtueStep(pIdPlayer:Int, pFTUEstep:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + FTUE_ADVANCE);\r\n\t\t\tlCall.setParameter(\"idPlayer\", Std.string(pIdPlayer));\r\n\t\t\tlCall.setParameter(\"value\", Std.string(pFTUEstep));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function getServerTime():Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + TIME);\r\n\t\t\tlCall.onData = onTime;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tprivate function onTime(pData:Dynamic):Void\r\n\t{\r\n\t\ttrace(pData);\r\n\t\tvar parsedData:Dynamic = Json.parse(pData);\r\n\t\ttrace(parsedData);\r\n\t\tvar time:Date = Date.fromString(Reflect.field(parsedData, \"NOW()\"));\r\n\t\t//DailyReward.getInstance().dateServer = time;\r\n\t\tTimeManager.getInstance().timeServer = time;\r\n\t\t//trace(TimeManager.getInstance().timeServer);\r\n\t}\r\n\r\n\tpublic function updateGene():Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + UPDATE_GENE);\r\n\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\tlCall.setParameter(\"gene1\", Std.string(Player.getInstance().gene1));\r\n\t\t\tlCall.setParameter(\"gene2\", Std.string(Player.getInstance().gene2));\r\n\t\t\tlCall.setParameter(\"gene3\", Std.string(Player.getInstance().gene3));\r\n\t\t\tlCall.setParameter(\"gene4\", Std.string(Player.getInstance().gene4));\r\n\t\t\tlCall.setParameter(\"gene5\", Std.string(Player.getInstance().gene5));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tpublic function getAlienFriends(pList:Dynamic):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + \"getFriendAlien\");\r\n\t\t\tlCall.setParameter(\"friendsList\", Json.stringify(pList));\r\n\t\t\tlCall.onData = friendsAliensInfo;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\t\r\n\tprivate function friendsAliensInfo(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData == \"\") return;\r\n\t\tDataManager.getInstance().loadFriendsAliensInfo(pData);\r\n\t}\r\n\t\r\n\tpublic function getFriends(pList:Dynamic):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + \"getFriends\");\r\n\t\t\tlCall.setParameter(\"friendsList\", pList);\r\n\t\t\tlCall.onData = friendsInfo;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t}\r\n\t\telse return null;\r\n\t}\r\n\r\n\tprivate function friendsInfo(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData == \"\") return;\r\n\t\tDataManager.getInstance().loadFriendsInfo(pData);\r\n\t}\r\n\r\n\tpublic function getSchemaTimeToDecrypt(pSchemaID:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\ttrace(\"MON ID DE SCHEMA \" + pSchemaID);\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + GET_DECRYPT_TIME);\r\n\t\t\tlCall.setParameter(\"schemaID\", Std.string(pSchemaID));\r\n\t\t\tlCall.onData = onGetDecryptTime;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttrace(\"pas pu attraper le Dcrypt Time\");\r\n\t\t\treturn null;\r\n\t\t}\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate function onGetDecryptTime(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData != \"\") DataManager.getInstance().getSchemaTimeToDecrypt(Json.parse(pData).decryptTime);\r\n\t}\r\n\t\r\n\t\r\n\tpublic function addSchema(pSchemaId:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + ADD_SCHEMA);\r\n\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\tlCall.setParameter(\"schemaID\", Std.string(pSchemaId));\r\n\t\t\tlCall.onData = onAddSchema;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\r\n\t\t\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttrace(\"pas pu ajouter le schema\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate function onAddSchema(pData:Dynamic):Void\r\n\t{\r\n\t\tif (pData != \"\") trace(pData); \r\n\t}\r\n\t\r\n\tpublic function startUnlockSchema(pIdSchema:Int, pStartDecrypt:Date, pEndDecrypt:Date):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + START_UNLOCK_SCHEMA);\r\n\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\tlCall.setParameter(\"schemaID\", Std.string(pIdSchema));\r\n\t\t\tlCall.setParameter(\"start\", Std.string(pStartDecrypt));\r\n\t\t\tlCall.setParameter(\"end\", Std.string(pEndDecrypt));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttrace(\"pas pu decrypt le schema\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic function unlockSchema(pSchemaId:Int):Void\r\n\t{\r\n\t\tif (activeData)\r\n\t\t{\r\n\t\t\tvar lCall:Http = new Http(\"php/action.php?action=\" + UNLOCK_SCHEMA);\r\n\t\t\tlCall.setParameter(\"playerID\", Std.string(Player.getInstance().id));\r\n\t\t\tlCall.setParameter(\"schemaID\", Std.string(pSchemaId));\r\n\t\t\tlCall.onData = onData;\r\n\t\t\tlCall.onError = onError;\r\n\t\t\tlCall.request(true);\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttrace(\"pas pu decrypt le schema\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.save;\r\n\r\nimport com.isartdigital.ruby.game.player.Player;\r\nimport com.isartdigital.ruby.game.specialFeature.managers.SpecialFeatureAliens;\r\nimport com.isartdigital.ruby.game.sprites.elements.Building;\r\nimport com.isartdigital.ruby.game.sprites.elements.ElementType;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.Alien;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienElement;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.AlienEsthetique;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienBuffer;\r\nimport com.isartdigital.ruby.game.sprites.elements.aliens.alienspaddockable.AlienProducer;\r\nimport com.isartdigital.ruby.game.sprites.elements.destructible.Destructible;\r\nimport com.isartdigital.ruby.game.sprites.elements.urbanbuilding.translationClass.Schemas;\r\nimport com.isartdigital.ruby.game.world.Layer;\r\nimport com.isartdigital.ruby.game.world.Region;\r\nimport com.isartdigital.ruby.game.world.World;\r\nimport com.isartdigital.ruby.ui.popin.incubator.Incubator;\r\nimport com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.ruby.ui.popin.codex.CodexData;\r\nimport com.isartdigital.ruby.utils.TimeManager;\r\nimport js.Lib;\r\n//import com.isartdigital.ruby.ui.popin.building.Incubator;\r\n//import com.isartdigital.ruby.ui.popin.building.datas.IncubatorSchema;\r\nimport com.isartdigital.utils.game.clipping.CellManager;\r\nimport com.isartdigital.utils.game.clipping.IClippable.Element;\r\nimport com.isartdigital.utils.game.iso.IsoManager;\r\nimport com.isartdigital.utils.game.pooling.PoolManager;\r\nimport com.isartdigital.utils.game.pooling.PoolObject;\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.save.BuildingTypes.BuildingType;\r\nimport haxe.Json;\r\nimport js.Browser;\r\nimport pixi.core.math.Point;\r\nimport pixi.interaction.EventEmitter;\r\n\r\ntypedef FriendSave =\r\n{\r\n\tvar id:Int;\r\n\tvar idFb:String;\r\n\tvar langue:String;\r\n\tvar hardCurrency:Int;\r\n\tvar softCurrency:Int;\r\n\tvar ressource:Int;\r\n\tvar currentEnergy:Int;\r\n\tvar level:Int;\r\n\tvar xp:UInt;\r\n\tvar FTUESteps:Int;\r\n\tvar maxEnergy:Int;\r\n\t@:optional var gene1:Int;\r\n\t@:optional var gene2:Int;\r\n\t@:optional var gene3:Int;\r\n\t@:optional var gene4:Int;\r\n\t@:optional var gene5:Int;\r\n\t@:optional var schemas:Int;\r\n\t@:optional var dateConnexion:String;\r\n\t@:optional var daysPlayed:Int;\r\n\t@:optional var nameFb:String;\r\n}\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass DataManager // extends EventEmitter\r\n{\r\n\tprivate var toSave:Array<RegionSave> = [];\r\n\tprivate var loadedData:Map<String,Element> = new Map<String,Element>();\r\n\r\n\t//social : contient la liste d'amis du joueur et la liste des aliens des amis du joueurs\r\n\tpublic var friendsList:Array<FriendSave> = new Array<FriendSave>();\r\n\tpublic var alienFriendsList:Array<AlienElement> = new Array<AlienElement>();\r\n\r\n\tpublic var schemasList:Array<Schemas> = [];\r\n\r\n\tprivate var TOKEN_WORLD:String = \"world\";\r\n\r\n\tprivate var TOKEN_TIME:Float;\r\n\r\n\tprivate var buildingSave:Dynamic;\r\n\tprivate var regionSave:Dynamic;\r\n\r\n\tpublic var playerSave(default, null):Dynamic;\r\n\tpublic var listBuildingTypes:Map<String, Dynamic> = new Map<String, BuildingType>();\r\n\tpublic var listDestructableTypes(default,null):Map<String, Dynamic> = new Map<String, DestructableType>();\r\n\tprivate var noDataToLoad:EventEmitter;\r\n\tprivate var dataToLoad:EventEmitter;\r\n\r\n\t/**\r\n\t * instance unique de la classe DataManager\r\n\t */\r\n\tprivate static var instance: DataManager;\r\n\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): DataManager\r\n\t{\r\n\t\tif (instance == null) instance = new DataManager();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new()\r\n\t{\r\n\t\t//Browser.window.addEventListener(\"onunload\", unload);\r\n\t}\r\n\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void\r\n\t{\r\n\t\tinstance = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Sauvegarde recuperer en BDD des buildings du joueur\r\n\t * @param\tpData le json recuper\r\n\t */\r\n\tpublic function savePlayerInfo(pData:Dynamic)\r\n\t{\r\n\t\tplayerSave = pData;\r\n\t}\r\n\r\n\t/**\r\n\t * Sauvegarde recuperer en BDD des buildings du joueur\r\n\t * @param\tpData le json recuper\r\n\t */\r\n\tpublic function saveBuildingJson(pData:Dynamic)\r\n\t{\r\n\t\tbuildingSave = pData;\r\n\t}\r\n\r\n\t/**\r\n\t * Sauvegarde recuperer en BDD des regions du joueur\r\n\t * @param\tpData le json recuper\r\n\t */\r\n\tpublic function saveRegionsJson(pData:Dynamic):Void\r\n\t{\r\n\t\tregionSave = pData;\r\n\t}\r\n\r\n\tpublic function save(pList:Map<String,Element>):Void\r\n\t{\r\n\t\t//Data.getInstance().world = pList;\r\n\t\t//Browser.getLocalStorage().setItem(TOKEN_WORLD, Json.stringify(pList));\r\n\t}\r\n\r\n\t/*public function getLocalStorage():Bool\r\n\t{\r\n\t\tvar myLoadedData:String = Browser.getLocalStorage().getItem(TOKEN_WORLD);\r\n\r\n\t\tif (myLoadedData != null)\r\n\t\t{\r\n\t\t\t//loadData(myLoadedData);\r\n\t\t}\r\n\r\n\t\treturn myLoadedData != null;\r\n\t}*/\r\n\r\n\t/**\r\n\t * Chargement inGame des donnes recuperer en bdd, si c'est la 1ere fois qu'un joueur se connecte, rien ne se passe\r\n\t */\r\n\tpublic function loadData():Void\r\n\t{\r\n\t\tif (playerSave != null)\r\n\t\t{\r\n\t\t\tvar lPlayerSave:PlayerSave =\r\n\t\t\t{\r\n\t\t\t\tid : playerSave.playerInfo.id,\r\n\t\t\t\tfbID : playerSave.playerInfo.idFb,\r\n\t\t\t\tlevel : Std.parseInt(playerSave.playerInfo.level),\r\n\t\t\t\txp : Std.parseInt(playerSave.playerInfo.xp),\r\n\t\t\t\thardCurrency : Std.parseInt(playerSave.playerInfo.hardCurrency),\r\n\t\t\t\tsoftCurrency : Std.parseInt(playerSave.playerInfo.softCurrency),\r\n\t\t\t\tressource : Std.parseInt(playerSave.playerInfo.ressource),\r\n\t\t\t\tcurrentEnergy : Std.parseInt(playerSave.playerInfo.currentEnergy),\r\n\t\t\t\tmaxEnergy : Std.parseInt(playerSave.playerInfo.maxEnergy),\r\n\t\t\t\tftueSteps : Std.parseInt(playerSave.playerInfo.FTUEsteps),\r\n\t\t\t\tgene1:Std.parseInt(playerSave.playerInfo.gene1),\r\n\t\t\t\tgene2:Std.parseInt(playerSave.playerInfo.gene2),\r\n\t\t\t\tgene3:Std.parseInt(playerSave.playerInfo.gene3),\r\n\t\t\t\tgene4:Std.parseInt(playerSave.playerInfo.gene4),\r\n\t\t\t\tgene5:Std.parseInt(playerSave.playerInfo.gene5)\r\n\t\t\t};\r\n\r\n\t\t\tPlayer.getInstance().loadSave(lPlayerSave);\r\n\r\n\t\t\t/******* REGIONS ********/\r\n\t\t\tvar lRegions:Dynamic = Reflect.field(playerSave, \"region\");\r\n\t\t\tif (lRegions)\r\n\t\t\t{\r\n\t\t\t\tfor (region in Reflect.fields(lRegions))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar lRegion:Dynamic =  Reflect.field(lRegions, region);\r\n\t\t\t\t\tWorld.getInstance().unlockRegion(Std.parseInt(lRegion.x), Std.parseInt(lRegion.y));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/********* DESTRUCTIBLE **********/\r\n\t\t\tvar lDestructableType:Dynamic = Reflect.field(playerSave, \"destructableTypes\");\r\n\t\t\tif (lDestructableType)\r\n\t\t\t{\r\n\t\t\t\tvar destructableType:Dynamic;\r\n\t\t\t\tfor (type in Reflect.fields(lDestructableType))\r\n\t\t\t\t{\r\n\t\t\t\t\tdestructableType = Reflect.field(lDestructableType, type);\r\n\t\t\t\t\tvar lElemType:DestructableType =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname:Reflect.field(destructableType, \"destructableName\"),\r\n\t\t\t\t\t\tsoftCurrencyCost:Std.parseInt(Reflect.field(destructableType,\"softCurrencyCost\")),\r\n\t\t\t\t\t\tskipHCCost:Std.parseInt(Reflect.field(destructableType, \"skipCDcostHC\")),\r\n\t\t\t\t\t\tdestructionTime:Reflect.field(destructableType, \"destructableTime\"),\r\n\t\t\t\t\t\twidth:Std.parseInt(Reflect.field(destructableType, \"width\")),\r\n\t\t\t\t\t\theight:Std.parseInt(Reflect.field(destructableType, \"height\"))\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlistDestructableTypes.set(lElemType.name, lElemType);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar lDestructables:Dynamic = Reflect.field(playerSave, \"destructable\");\r\n\r\n\t\t\tfor (instance in Reflect.fields(lDestructables))\r\n\t\t\t{\r\n\t\t\t\tvar destructible:Dynamic = Reflect.field(lDestructables, instance);\r\n\r\n\t\t\t\tvar lDestructible:Destructible = new Destructible(destructible.type);\r\n\r\n\t\t\t\tvar lElement:Element =\r\n\t\t\t\t{\r\n\t\t\t\t\tinstanceID:destructible.destructableId,\r\n\t\t\t\t\ttype:\"Destructible\",\r\n\t\t\t\t\twidth:0,\r\n\t\t\t\t\theight:0,\r\n\t\t\t\t\tx:Std.parseInt(destructible.x),\r\n\t\t\t\t\ty:Std.parseInt(destructible.y),\r\n\t\t\t\t\tglobalX:Std.parseInt(destructible.globalX),\r\n\t\t\t\t\tglobalY:Std.parseInt(destructible.globalY),\r\n\t\t\t\t\tregionX:Std.parseInt(destructible.regionX),\r\n\t\t\t\t\tregionY:Std.parseInt(destructible.regionY),\r\n\t\t\t\t\tlayer:Std.parseInt(destructible.layer),\r\n\t\t\t\t\tmode:destructible.mode,\r\n\t\t\t\t\tassetName: destructible.type,\r\n\t\t\t\t\tsoftCurrency:listDestructableTypes.get(destructible.type).softCurrencyCost,\r\n\t\t\t\t\tdateEndBuilding:Date.fromString(destructible.endOfDestructionTime),\r\n\t\t\t\t\tdateStartBuilding:Date.fromString(destructible.destructionTime)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar lcurrentRegion:Region = World.getInstance().getRegion(lElement.regionX, lElement.regionY);\r\n\r\n\t\t\t\tlDestructible.localWidth = listDestructableTypes.get(lElement.assetName).width;\r\n\t\t\t\tlDestructible.localHeight = listDestructableTypes.get(lElement.assetName).height;\r\n\r\n\t\t\t\tlDestructible.init(lElement);\r\n\t\t\t\tlDestructible.start();\r\n\r\n\t\t\t\tlcurrentRegion.layers[lElement.layer].add(lDestructible);\r\n\t\t\t\tlcurrentRegion.layers[lElement.layer].container.addChild(lDestructible);\r\n\r\n\t\t\t\tlDestructible.position = IsoManager.modelToIsoView(new Point(lElement.x, lElement.y));\r\n\r\n\t\t\t\tPoolObject.elementList.set(lElement.instanceID, lElement);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar lBuildingTypes:Dynamic = Reflect.field(playerSave, \"buildingTypes\");\r\n\t\t\tif (lBuildingTypes)\r\n\t\t\t{\r\n\t\t\t\tvar buildingType:Dynamic;\r\n\t\t\t\tfor (type in Reflect.fields(lBuildingTypes))\r\n\t\t\t\t{\r\n\t\t\t\t\tbuildingType = Reflect.field(lBuildingTypes, type);\r\n\t\t\t\t\tvar lElemType:BuildingType =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tSellingCost:Std.int(Reflect.field(buildingType, \"SellingCost\")),\r\n\t\t\t\t\t\tbuildingName:Reflect.field(buildingType, \"buildingName\"),\r\n\t\t\t\t\t\tbuildingTime:Date.fromString(Reflect.field(buildingType, \"buildingTime\")),\r\n\t\t\t\t\t\tcategory:Reflect.field(buildingType, \"category\"),\r\n\t\t\t\t\t\tdescription:Reflect.field(buildingType, \"description\"),\r\n\t\t\t\t\t\tenergyCost:Std.int(Reflect.field(buildingType, \"energyCost\")),\r\n\t\t\t\t\t\thardCurrencyCost:Std.int(Reflect.field(buildingType, \"hardCurrencyCost\")),\r\n\t\t\t\t\t\tid:Std.int(Reflect.field(buildingType, \"id\")),\r\n\t\t\t\t\t\trequiredPlayerLevel:Std.int(Reflect.field(buildingType, \"requiredPlayerLevel\")),\r\n\t\t\t\t\t\tressourcesCost:Std.int(Reflect.field(buildingType, \"ressourcesCost\")),\r\n\t\t\t\t\t\tskipCDcostHC:Std.int(Reflect.field(buildingType, \"skipCDcostHC\")),\r\n\t\t\t\t\t\tsoftCurrencyCost:Std.int(Reflect.field(buildingType, \"softCurrencyCost\")),\r\n\t\t\t\t\t\tupgradeNumber:Std.int(Reflect.field(buildingType, \"upgradeNumber\")),\r\n\t\t\t\t\t\tlevelUpgrade1:Std.int(Reflect.field(buildingType, \"levelUpgrade1\")),\r\n\t\t\t\t\t\tlevelUpgrade2:Std.int(Reflect.field(buildingType, \"levelUpgrade2\")),\r\n\t\t\t\t\t\tlevelUpgrade3:Std.int(Reflect.field(buildingType, \"levelUpgrade3\")),\r\n\t\t\t\t\t\tupgradeCost1:Std.int(Reflect.field(buildingType, \"upgradeCost1\")),\r\n\t\t\t\t\t\tupgradeCost2:Std.int(Reflect.field(buildingType, \"upgradeCost2\")),\r\n\t\t\t\t\t\tupgradeCost3:Std.int(Reflect.field(buildingType, \"upgradeCost3\")),\r\n\t\t\t\t\t\tupgradeTime1:Date.fromString(Reflect.field(buildingType, \"upgradeTime1\")),\r\n\t\t\t\t\t\tupgradeTime2:Date.fromString(Reflect.field(buildingType, \"upgradeTime2\")),\r\n\t\t\t\t\t\tupgradeTime3:Date.fromString(Reflect.field(buildingType, \"upgradeTime3\"))\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlistBuildingTypes.set(lElemType.buildingName, lElemType);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//chargement des types d'alien\r\n\t\t\tvar lTypes:Dynamic = Reflect.field(playerSave, \"bufferTypes\");\r\n\t\t\tAlienBuffer.loadTypes(lTypes);\r\n\t\t\tlTypes = Reflect.field(playerSave, \"producerTypes\");\r\n\t\t\tAlienProducer.loadTypes(lTypes);\r\n\t\t\tlTypes = Reflect.field(playerSave, \"esthetiqueTypes\");\r\n\t\t\tAlienEsthetique.loadTypes(lTypes);\r\n\t\t\tlTypes = Reflect.field(playerSave, \"speFeatTypes\");\r\n\t\t\tSpecialFeatureAliens.loadTypes(lTypes);\r\n\r\n\t\t\t//chargement des aliens\r\n\t\t\tvar alienList:Dynamic = Reflect.field(playerSave, \"aliens\");\r\n\r\n\t\t\tif (alienList)\r\n\t\t\t{\r\n\t\t\t\tvar lAlien:Dynamic;\r\n\t\t\t\tfor (alien in Reflect.fields(alienList))\r\n\t\t\t\t{\r\n\t\t\t\t\tlAlien =  Reflect.field(alienList, alien);\r\n\t\t\t\t\tvar lArray:Array<Dynamic> = getAlienArray(Reflect.field(lAlien, \"type\"));\r\n\t\t\t\t\tvar lType:Dynamic = Alien.getAlienType(Reflect.field(lAlien, \"name\"), lArray);\r\n\r\n\t\t\t\t\tvar lAlienElem:AlienElement =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tidAlien:Reflect.field(lAlien, \"idAlien\"),\r\n\t\t\t\t\t\tidBuilding:Reflect.field(lAlien, \"idBuilding\"),\r\n\t\t\t\t\t\tmode:Reflect.field(lAlien, \"mode\"),\r\n\t\t\t\t\t\tname:Reflect.field(lAlien, \"name\"),\r\n\t\t\t\t\t\ttype:Reflect.field(lAlien, \"type\"),\r\n\t\t\t\t\t\tnomPropre:Reflect.field(lAlien, \"nomPropre\"),\r\n\t\t\t\t\t\tstamina:Std.int(Reflect.field(lAlien, \"stamina\")),\r\n\t\t\t\t\t\tlevel:Std.int(Reflect.field(lAlien, \"level\")),\r\n\t\t\t\t\t\tstartTime:Reflect.field(lAlien, \"startTime\"),\r\n\t\t\t\t\t\tendTime:Reflect.field(lAlien, \"endTime\"),\r\n\t\t\t\t\t\tcarac:lType,\r\n\t\t\t\t\t\tidPlayer:Player.getInstance().id\r\n\t\t\t\t\t}\r\n\t\t\t\t\tAlien.alienElementList.push(lAlienElem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar lBuildings:Dynamic = Reflect.field(playerSave, \"buildings\");\r\n\t\t\tif (lBuildings)\r\n\t\t\t{\r\n\t\t\t\tfor (id in Reflect.fields(lBuildings))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar building:Dynamic = Reflect.field(lBuildings, id);\r\n\t\t\t\t\tvar currentRegion:Region;\r\n\t\t\t\t\tvar lElement:Element =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tinstanceID:building.buildingId,\r\n\t\t\t\t\t\ttype:building.type,\r\n\t\t\t\t\t\twidth:0,\r\n\t\t\t\t\t\theight:0,\r\n\t\t\t\t\t\tx:Std.parseInt(building.x),\r\n\t\t\t\t\t\ty:Std.parseInt(building.y),\r\n\t\t\t\t\t\tglobalX:Std.parseFloat(building.globalX),\r\n\t\t\t\t\t\tglobalY:Std.parseFloat(building.globalY),\r\n\t\t\t\t\t\tregionX:Std.parseInt(building.regionX),\r\n\t\t\t\t\t\tregionY:Std.parseInt(building.regionY),\r\n\t\t\t\t\t\tlayer:Std.parseInt(building.layer),\r\n\t\t\t\t\t\tmode:building.mode,\r\n\t\t\t\t\t\tlevelUpGrade:Std.parseInt(building.currentLevel),\r\n\t\t\t\t\t\tdateEndBuilding:Date.fromString(building.buildingEnd),\r\n\t\t\t\t\t\tdateStartBuilding:Date.fromString(building.buildingStart)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcurrentRegion = World.getInstance().getRegion(lElement.regionX, lElement.regionY);\r\n\r\n\t\t\t\t\tvar lBuilding:Building = cast (PoolManager.getFromPool(lElement.type), Building);\r\n\t\t\t\t\tlBuilding.init(lElement);\r\n\t\t\t\t\tlBuilding.start();\r\n\r\n\t\t\t\t\tcurrentRegion.layers[lElement.layer].add(lBuilding);\r\n\t\t\t\t\tcurrentRegion.layers[lElement.layer].container.addChild(lBuilding);\r\n\r\n\t\t\t\t\tlBuilding.position = IsoManager.modelToIsoView(new Point(lElement.x, lElement.y));\r\n\r\n\t\t\t\t\tPoolObject.elementList.set(lElement.instanceID, lElement);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar lSchemaList:Dynamic = Reflect.field(playerSave, \"schemaXenos\");\r\n\t\t\tif (lSchemaList)\r\n\t\t\t{\r\n\t\t\t\tfor (id in Reflect.fields(lSchemaList))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar schema:Dynamic = Reflect.field(lSchemaList, id);\r\n\t\t\t\t\tvar lSchema:IncubatorSchema =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tgene1:Std.parseInt(schema.gene1),\r\n\t\t\t\t\t\tgene2:Std.parseInt(schema.gene2),\r\n\t\t\t\t\t\tgene3:Std.parseInt(schema.gene3),\r\n\t\t\t\t\t\ttableXenos:schema.tableXenos,\r\n\t\t\t\t\t\ttype: schema.type,\r\n\t\t\t\t\t\tgene1quant:Std.parseInt(schema.gene1quant),\r\n\t\t\t\t\t\tgene2quant:Std.parseInt(schema.gene2quant),\r\n\t\t\t\t\t\tgene3quant:Std.parseInt(schema.gene3quant),\r\n\t\t\t\t\t\txenoName:schema.xenoName,\r\n\t\t\t\t\t\tdecryptTime:schema.decryptTime\r\n\t\t\t\t\t}\r\n\t\t\t\t\tIncubator.listSchema.set(schema.id, lSchema);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tloadSchemaPlayer(playerSave);\r\n\t\t}\r\n\t\tCodexData.getInstance().listAllAlienTypesInCodex();\r\n\r\n\t\tvar firstTime:Bool = playerSave.firstTime;\r\n\t\t/*if (firstTime)\r\n\t\t{\r\n\t\t\tDestructible.createFirstDestructible(\"DestructibleSkeleton\", 15,15);\r\n\t\t}*/\r\n\t\t\r\n\r\n\t}\r\n\r\n\tpublic function loadFriendsInfo(pData:Dynamic):Void\r\n\t{\r\n\t\tfriendsList = Json.parse(pData).friends;\r\n\r\n\t\tif (friendsList.length != null)\r\n\t\t{\r\n\t\t\tvar lArray:Array<Int> = new Array<Int>();\r\n\t\t\tfor (friend in friendsList)\r\n\t\t\t{\r\n\t\t\t\tif (friend.id != null) lArray.push(friend.id);\r\n\t\t\t}\r\n\t\t\tDataBaseAction.getInstance().getAlienFriends(lArray);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function loadFriendsAliensInfo(pData:Dynamic):Void\r\n\t{\r\n\t\talienFriendsList = Json.parse(pData).aliens;\r\n\t}\r\n\r\n\tpublic function getAlienArray(pType:String):Array<Dynamic>\r\n\t{\r\n\r\n\t\tif (pType == \"AlienBuffer\") return AlienBuffer.bufferTypes;\r\n\t\telse if (pType == \"AlienProducer\") return AlienProducer.prodTypes;\r\n\t\telse if (pType == \"AlienEsthetique\") return AlienEsthetique.esthetiqueTypes;\r\n\t\telse if (pType == \"AlienForeur\") return SpecialFeatureAliens.speFeatTypes;\r\n\t\telse return null;\r\n\t}\r\n\r\n\tprivate function sortTilesInRegions():Void\r\n\t{\r\n\t\tfor (lMap in World.getInstance().worldMap)\r\n\t\t{\r\n\t\t\tfor (lRegion in lMap)\r\n\t\t\t{\r\n\t\t\t\tif (lRegion.isActive) lRegion.layers[1].container.children = IsoManager.sortTiles(lRegion.layers[1].container.children);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate function loadSchemaPlayer(pSave)\r\n\t{\r\n\t\tschemasList = pSave.playerSchemas;\r\n\t\tPlayer.getInstance().setSchema(getPlayerSchemaCount());\r\n\r\n\t}\r\n\r\n\tpublic function getPlayerSchemaCount(?pLockedSchemaOnly:Bool=false):Int\r\n\t{\r\n\t\tvar counter:Int = 0;\r\n\t\tfor (shema in schemasList)\r\n\t\t{\r\n\t\t\tif (pLockedSchemaOnly)\r\n\t\t\t{\r\n\t\t\t\tif (shema.isLocked == 1) counter++;\r\n\t\t\t}\r\n\t\t\telse counter++;\r\n\t\t}\r\n\t\treturn counter;\r\n\t}\r\n\r\n\tpublic function addSchema(pSchemaID:Int):Void\r\n\t{\r\n\t\tvar lSchema:Schemas = {\r\n\t\t\tidPlayer: Player.getInstance().id,\r\n\t\t\tidSchema: pSchemaID,\r\n\t\t\tisLocked: 1,\r\n\t\t\tstartDecrypt:null,\r\n\t\t\tendDecrypt:null\r\n\t\t}\r\n\r\n\t\tDataBaseAction.getInstance().addSchema(pSchemaID);\r\n\t\t\t}\r\n\t\r\n\t\r\n\r\n\tpublic function getLockedSchemas():Array<Schemas>\r\n\t{\r\n\t\tvar lArray:Array<Schemas> = new Array<Schemas>();\r\n\t\tfor (schema in schemasList)\r\n\t\t{\r\n\t\t\tif (schema.isLocked == 1) lArray.push(schema);\r\n\t\t}\r\n\t\treturn lArray;\r\n\t}\r\n\r\n\tpublic function getUnlockedSchemas():Array<Schemas>\r\n\t{\r\n\t\tvar lArray:Array<Schemas> = new Array<Schemas>();\r\n\t\tfor (schema in schemasList)\r\n\t\t{\r\n\t\t\tif (schema.isLocked == 0)\r\n\t\t\t{\r\n\t\t\t\tlArray.push(schema);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn lArray;\r\n\t}\r\n\r\n\r\n\t\r\n\tpublic function translateSchema(pSchema:Schemas):Void\r\n\t{\r\n\t\tDataBaseAction.getInstance().getServerTime();\r\n\r\n\t\tDataBaseAction.getInstance().getSchemaTimeToDecrypt(pSchema.idSchema);\r\n\t\t\r\n\t\t/*var lSchema:Schemas = \r\n\t\t{\r\n\t\t\tidPlayer: pSchema.idPlayer,\r\n\t\t\tidSchema: pSchema.idSchema,\r\n\t\t\tisLocked:pSchema.idSchema,\r\n\t\t\tstartDecrypt: TimeManager.getInstance().timeServer,\r\n\t\t\tdecrypTime\r\n\t\t}*/\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t//lSchema.endDecrypt = DateTools.delta(currentSchema.startDecrypt, currentSchema.endDecrypt)\r\n\t\t\r\n\t\t//DataBaseAction.getInstance().startDecryptSchema(schema.idSchema);\t\r\n\t}\r\n\t\r\n\tpublic function getSchemaTimeToDecrypt(pData:Dynamic):Dynamic->Void\r\n\t{\r\n\t\treturn pData;\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.sounds;\r\n\r\nimport howler.Howl;\r\n\r\n\t\r\n/**\r\n * Manager centralis de Sons Howler\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass SoundManager\r\n{\r\n\t/**\r\n\t * liste de tous les sons du jeu\r\n\t */\r\n\tprivate static var list (default,null):Map<String,Howl>;\r\n\t\r\n\tprivate function new() {\r\n\t}\r\n\t\r\n\t/**\r\n\t * ajoute un son  la liste\r\n\t * @param\tpName identifiant du son\r\n\t * @param\tpSound son\r\n\t */\r\n\tpublic static function addSound (pName:String,pSound:Howl):Void {\r\n\t\tif (list == null) list = new Map<String,Howl>();\r\n\t\tlist[pName] = pSound;\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne une rfrence vers le son par l'intermdiaire de son identifiant\r\n\t * @param\tpName identifiant du son\r\n\t * @return le son\r\n\t */\r\n\tpublic static function getSound(pName:String): Howl {\r\n\t\treturn list[pName];\r\n\t}\r\n\r\n}","package com.isartdigital.utils.system;\r\n\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport js.Browser;\r\nimport js.html.Element;\r\nimport js.html.Event;\r\nimport js.html.Image;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\t\r\n/**\r\n * Classe Utilitaire donnant accs  des proprits du priphrique cible\r\n * Tous les priphriques ne se comportant pas comme on l'attend, DeviceCapabilities permet de\r\n * masquer les comportement diffrents et prsenter une facade unique au reste du code\r\n * @version 0.4.0\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass DeviceCapabilities \r\n{\t\t\r\n\r\n\tpublic static inline var SYSTEM_ANDROID: String = \"Android\";\r\n\tpublic static inline var SYSTEM_IOS: String = \"iOS\";\r\n\tpublic static inline var SYSTEM_BLACKBERRY: String = \"BlackBerry\";\r\n\tpublic static inline var SYSTEM_BB_PLAYBOOK: String = \"BlackBerry PlayBook\";\r\n\tpublic static inline var SYSTEM_WINDOWS_MOBILE: String = \"IEMobile\";\r\n\tpublic static inline var SYSTEM_DESKTOP: String = \"Desktop\";\t\r\n\t\r\n\tprivate static var fullScreenButton:Image;\r\n\tprivate static inline var ICON_SIZE:Float = 0.11;\r\n\r\n\tpublic static inline var TEXTURE_NO_SCALE: String = \"\";\r\n\tpublic static inline var TEXTURE_HD: String = \"hd\";\r\n\tpublic static inline var TEXTURE_MD: String = \"md\";\r\n\tpublic static inline var TEXTURE_LD: String = \"ld\";\t\r\n\t\r\n\tprivate static var texturesRatios: Map<String,Float> = [\"hd\"=>1,\"md\"=>0.5,\"ld\"=>0.25];\r\n\t\r\n\tpublic static var textureRatio (default,null):Float = 1;\r\n\tpublic static var textureType (default,null):String = TEXTURE_NO_SCALE;\t\r\n\t\r\n\tprivate static var screenRatio:Float = 1;\r\n\t\r\n\t/**\r\n\t  * hauteur du Canvas (change avec l'orientation)\r\n\t  */\r\n\tpublic static var height (get, never) : UInt;\r\n\t\r\n\tprivate static function get_height () {\r\n\t\treturn Browser.window.innerHeight;\r\n\t}\r\n\t\r\n\t/**\r\n\t  * largeur du Canvas (change avec l'orientation)\r\n\t  */\r\n\tpublic static var width (get, never) : UInt;\r\n\t\r\n\tprivate static function get_width () {\r\n\t\treturn Browser.window.innerWidth;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Systme d'exploitation du Device\r\n\t */\r\n\tpublic static var system (get, never) : String;\r\n\t\r\n\tprivate static function get_system( ) {\r\n\t\tif ( ~/IEMobile/i.match(Browser.navigator.userAgent)) return SYSTEM_WINDOWS_MOBILE;\t\r\n\t\telse if ( ~/iPhone|iPad|iPod/i.match(Browser.navigator.userAgent)) return SYSTEM_IOS;\r\n\t\telse if ( ~/BlackBerry/i.match(Browser.navigator.userAgent)) return SYSTEM_BLACKBERRY;\r\n\t\telse if ( ~/PlayBook/i.match(Browser.navigator.userAgent)) return SYSTEM_BB_PLAYBOOK;\r\n\t\telse if ( ~/Android/i.match(Browser.navigator.userAgent)) return SYSTEM_ANDROID;\r\n\t\telse return SYSTEM_DESKTOP;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Est-ce que le jeu est encapsul dans CocoonJs\r\n\t */\r\n\tpublic static var isCocoonJS (get, never) : Bool;\r\n\t\r\n\tprivate static function get_isCocoonJS () {\r\n\t\treturn untyped Browser.navigator.isCocoonJS || untyped Browser.window.CocoonJS!=null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Est-ce que le jeu tourne en mode Canvas+ ou Webview+ sous CocoonJS\r\n\t */\r\n\tpublic static var isCanvasPlus (get, never) : Bool;\r\n\t\r\n\tprivate static function get_isCanvasPlus () {\r\n\t\treturn untyped Browser.navigator.isCocoonJS && untyped Browser.window.CocoonJS != null;\r\n\t}\r\n\t\r\n\t/** \r\n\t\r\n\t/**\r\n\t * affiche le bouton de fullscreen\r\n\t */\r\n\tpublic static function displayFullScreenButton ():Void {\r\n\t\tif (isCocoonJS) return;\r\n\t\t\r\n\t\tif (!~/(iPad|iPhone|iPod)/g.match(Browser.navigator.userAgent) && !~/MSIE/i.match(Browser.navigator.userAgent) /*&& !(Browser.window.location.hash = !!Browser.window.MSInputMethodContext)*/) {\r\n\r\n\t\t\tBrowser.document.onfullscreenchange = onChangeFullScreen;\r\n\t\t\tuntyped Browser.document.onwebkitfullscreenchange = onChangeFullScreen;\r\n\t\t\tuntyped Browser.document.onmozfullscreenchange = onChangeFullScreen;\r\n\t\t\tuntyped Browser.document.onmsfullscreenchange = onChangeFullScreen;\r\n\t\t\t//Browser.document.addEventListener(\"MSFullscreenChange\", onChangeFullScreen );\r\n\t\t\t\r\n\t\t\tfullScreenButton = new Image();\r\n\t\t\tfullScreenButton.style.position = 'absolute';\r\n\t\t\tfullScreenButton.style.right = '0px';\r\n\t\t\tfullScreenButton.style.top = '0px';\r\n\t\t\tfullScreenButton.style.cursor = \"url(assets/Curseur.png), auto\";\r\n\t\t\tfullScreenButton.width = Std.int(getSizeFactor()*ICON_SIZE);\r\n\t\t\tfullScreenButton.height = Std.int(getSizeFactor()*ICON_SIZE);\r\n\t\t\tfullScreenButton.onclick = enterFullscreen;\r\n\t\t\tfullScreenButton.src = Config.assetsPath+\"fullscreen.png\";\r\n\t\t\t\r\n\t\t\tBrowser.document.body.appendChild(fullScreenButton);\r\n\r\n\t\t}\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * entre dans le mode fullscreen\r\n\t * @param\tpEvent\r\n\t */\r\n\tprivate static function enterFullscreen(pEvent:Event):Void {\r\n\t\tvar lDocElm:Element = Browser.document.documentElement;\r\n\t\tif (lDocElm.requestFullscreen!=null) lDocElm.requestFullscreen();\r\n\t\telse if (untyped lDocElm.mozRequestFullScreen!=null) untyped lDocElm.mozRequestFullScreen();\r\n\t\telse if (untyped lDocElm.webkitRequestFullScreen!=null) untyped lDocElm.webkitRequestFullScreen();\r\n\t\telse if (untyped lDocElm.msRequestFullscreen!=null) untyped lDocElm.msRequestFullscreen();\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * sort du mode fullscreen\r\n\t */\r\n\tprivate static function exitFullscreen():Void {\r\n\t\tif (Browser.document.exitFullscreen!=null) Browser.document.exitFullscreen();\r\n\t\telse if (untyped Browser.document.mozCancelFullScreen!=null) untyped Browser.document.mozCancelFullScreen();\r\n\t\telse if (untyped Browser.document.webkitCancelFullScreen!=null) untyped Browser.document.webkitCancelFullScreen();\r\n\t\telse if (untyped Browser.document.msExitFullscreen) untyped Browser.document.msExitFullscreen();\r\n\t}\r\n\r\n\t/**\r\n\t * callback appele sur changement d'tat fullscreen\r\n\t * @param\tpEvent\r\n\t */\r\n\tprivate static function onChangeFullScreen (pEvent:Event):Void {\r\n\t\tif (untyped Browser.document.fullScreen || untyped Browser.document.mozFullScreen || untyped Browser.document.webkitIsFullScreen || untyped Browser.document.msFullscreenElement) {\r\n\t\t\tfullScreenButton.style.display = 'none';\r\n\t\t} else {\r\n\t\t\tfullScreenButton.style.display = 'block';\r\n\t\t}\r\n\t\tpEvent.preventDefault();\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * Calcul la dimension idale du bouton en fonction du device\r\n\t * @return fullscreen ideal size\r\n\t */\r\n\tpublic static function getSizeFactor ():Float {\r\n\t\tvar lSize:Float=Math.floor(Math.min(width,height));\r\n\t\tif (system == SYSTEM_DESKTOP) lSize /= 3;\r\n\r\n\t\treturn lSize;\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * retourne un objet Rectangle correspondant aux dimensions de l'cran dans le repre du DisplayObject pass en paramtre\r\n\t * @param pTarget repre cible\r\n\t * @return objet Rectangle\r\n\t */\r\n\tpublic static function getScreenRect(pTarget:DisplayObject):Rectangle {\r\n\r\n\t\tvar lTopLeft:Point = new Point (0, 0);\r\n\t\tvar lBottomRight:Point = new Point (width, height);\r\n\t\t\r\n\t\tlTopLeft = pTarget.toLocal(lTopLeft);\r\n\t\tlBottomRight = pTarget.toLocal(lBottomRight);\r\n\t\t\r\n\t\treturn new Rectangle(lTopLeft.x, lTopLeft.y, lBottomRight.x - lTopLeft.x, lBottomRight.y - lTopLeft.y);\r\n\t}\r\n\r\n\t/**\r\n\t * Calibre le viewport pour que le Browser affiche la rsolution reelle du Device\r\n\t */\r\n\tpublic static function scaleViewport (): Void {\r\n\t\t\r\n\t\t//TODO: COCOONJS\r\n\t\tif (system == SYSTEM_WINDOWS_MOBILE) return;\r\n\t\t\r\n\t\tscreenRatio = Browser.window.devicePixelRatio;\r\n\t\tif (!isCocoonJS) Browser.document.write('<meta name=\"viewport\" content=\"initial-scale=' + Math.round(100 / screenRatio) / 100 + ', user-scalable=no, minimal-ui\">');\t\t\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dfini les ratios de texture\r\n\t * @param\tpHd ratio texture pour HD\r\n\t * @param\tpMd ratio texture pour MD\r\n\t * @param\tpLd ratio texture pour LD\r\n\t */\r\n\tpublic static function init(?pHd:Float = 1, ?pMd:Float = 0.75, ?pLd:Float = 0.5):Void {\r\n\r\n\t\ttexturesRatios[TEXTURE_HD]=pHd;\r\n\t\ttexturesRatios[TEXTURE_MD]=pMd;\r\n\t\ttexturesRatios[TEXTURE_LD]=pLd;\r\n\t\t\r\n\t\tif (Config.data.texture != null && Config.data.texture!=\"\") textureType = Config.data.texture;\r\n\t\telse {\r\n\t\t\tvar lBW:Float = Math.max (Browser.window.screen.width, Browser.window.screen.height);\r\n\t\t\tvar lBH:Float = Math.min (Browser.window.screen.width, Browser.window.screen.height);\r\n\t\t\tvar lW:Float = Math.max (GameStage.getInstance().safeZone.width,GameStage.getInstance().safeZone.height);\r\n\t\t\tvar lH:Float = Math.min (GameStage.getInstance().safeZone.width,GameStage.getInstance().safeZone.height);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tvar lRatio:Float = Math.min(lBW * screenRatio / lW, lBH * screenRatio / lH);\r\n\t\t\t\r\n\t\t\tif (lRatio <= pLd) textureType = TEXTURE_LD;\r\n\t\t\telse if (lRatio <= pMd) textureType = TEXTURE_MD;\r\n\t\t\telse textureType = TEXTURE_HD;\r\n\t\t}\r\n\t\ttextureRatio = texturesRatios[textureType];\r\n\t\t\r\n\t}\r\n\r\n}","package com.isartdigital.utils.system;\r\nimport haxe.Json;\r\n\r\n\t\r\n/**\r\n * ...\r\n * @author Adrien Bourdon\r\n */\r\nclass Localization \r\n{\r\n\t\r\n\t/**\r\n\t * instance unique de la classe Localization\r\n\t */\r\n\tprivate static var instance: Localization;\r\n\t\r\n\tprivate static var labels:Dynamic;\r\n\tprivate static var langue:String;\r\n\t/**\r\n\t * Retourne l'instance unique de la classe, et la cre si elle n'existait pas au pralable\r\n\t * @return instance unique\r\n\t */\r\n\tpublic static function getInstance (): Localization {\r\n\t\tif (instance == null) instance = new Localization();\r\n\t\treturn instance;\r\n\t}\r\n\t\r\n\t/**\r\n\t * constructeur priv pour viter qu'une instance soit cre directement\r\n\t */\r\n\tprivate function new() \r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic static function init(pLabel:Dynamic, pLanguage:String):Void\r\n\t{\r\n\t\tlabels = pLabel;\r\n\t\tlangue = pLanguage;\r\n\t}\r\n\t\r\n\tpublic static function setLangue(pLangue:String):Void\r\n\t{\r\n\t\tlangue = pLangue;\r\n\t}\r\n\t\r\n\t/**\r\n\t * recupre le texte correspondant au label en fonction de la langue\r\n\t * @param\tpText\r\n\t * @return texte traduit\r\n\t */\r\n\tpublic static function getLabel(pText:String):String \r\n\t{\r\n\t\tvar lLabel:Dynamic = Reflect.field(labels, pText);\r\n\t\treturn Std.string(Reflect.field(lLabel, langue));\r\n\t}\r\n\t\r\n\t/**\r\n\t * dtruit l'instance unique et met sa rfrence interne  null\r\n\t */\r\n\tpublic function destroy (): Void {\r\n\t\tinstance = null;\r\n\t}\r\n\r\n}","package com.isartdigital.utils.ui;\r\nimport com.isartdigital.utils.events.MouseEventType;\r\nimport com.isartdigital.utils.events.TouchEventType;\r\nimport com.isartdigital.utils.game.BoxType;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\nimport pixi.core.text.Text;\r\nimport pixi.interaction.EventTarget;\r\n\r\n/**\r\n * Classe de base des boutons\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass Button extends StateGraphic\r\n{\r\n\t\r\n\tprivate static inline var UP:Int = 0;\r\n\tprivate static inline var OVER:Int = 1;\r\n\tprivate static inline var DOWN:Int = 2;\r\n\t\r\n\tprivate var txt:Text;\r\n\t\r\n\tprivate var upStyle:TextStyle;\r\n\tprivate var overStyle:TextStyle;\r\n\tprivate var downStyle:TextStyle;\r\n\t\r\n\tpublic function new() \r\n\t{\r\n\t\t\r\n\t\tsuper();\r\n\t\tboxType = BoxType.SELF;\r\n\t\tinteractive = true;\r\n\t\tbuttonMode = true;\r\n\t\t\r\n\t\ton(MouseEventType.MOUSE_OVER, _mouseOver);\r\n\t\ton(MouseEventType.MOUSE_DOWN, _mouseDown);\r\n\t\ton(MouseEventType.CLICK, _click);\r\n\t\ton(MouseEventType.MOUSE_OUT, _mouseOut);\r\n\t\ton(MouseEventType.MOUSE_UP_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t\ton(TouchEventType.TOUCH_START, _mouseDown);\r\n\t\ton(TouchEventType.TAP, _click);\r\n\t\ton(TouchEventType.TOUCH_END, _mouseOut);\r\n\t\ton(TouchEventType.TOUCH_END_OUTSIDE, _mouseOut);\r\n\r\n\t\tcreateText();\r\n\t\t\r\n\t\tstart();\r\n\t\t\r\n\t}\t\r\n\t\r\n\tpublic function registerClick (pCallBack:EventTarget->Void):Void {\r\n\t\ton(MouseEventType.CLICK, pCallBack);\r\n\t\ton(TouchEventType.TAP, pCallBack);\r\n\t}\r\n\t\r\n\tpublic function unregisterClick (pCallBack:EventTarget->Void):Void {\r\n\t\toff(MouseEventType.CLICK, pCallBack);\r\n\t\toff(TouchEventType.TAP, pCallBack);\r\n\t}\r\n\t\r\n\tprivate function createText ():Void {\r\n\t\tupStyle={ font: \"80px Arial\", fill: \"#000000\", align:\"center\"};\r\n\t\toverStyle={ font: \"80px Arial\", fill: \"#AAAAAA\", align:\"center\"};\r\n\t\tdownStyle = { font: \"80px Arial\", fill: \"#FFFFFF\", align:\"center\" };\r\n\t\ttxt = new Text(\"\",upStyle);\r\n\t\ttxt.anchor.set(0.5, 0.5);\r\n\t}\r\n\t\r\n\tpublic function setText(pText:String):Void {\r\n\t\ttxt.text=pText;\r\n\t}\r\n\t\r\n\toverride private function setModeNormal ():Void {\r\n\t\tsetState(DEFAULT_STATE);\t\t\r\n\t\tuntyped anim.gotoAndStop(UP);\r\n\t\taddChild(txt);\r\n\t\tsuper.setModeNormal();\r\n\t}\r\n\t\r\n\tprivate function _mouseVoid ():Void {}\r\n\r\n\tprivate function _click (pEvent:EventTarget): Void {\r\n\t\tuntyped anim.gotoAndStop(UP);\r\n\t\ttxt.style=upStyle;\r\n\t}\t\r\n\t\r\n\tprivate function _mouseDown (pEvent:EventTarget): Void {\r\n\t\tuntyped anim.gotoAndStop(DOWN);\r\n\t\ttxt.style=downStyle;\r\n\t}\r\n\t\r\n\tprivate function _mouseOver (pEvent:EventTarget): Void {\r\n\t\tuntyped anim.gotoAndStop(OVER);\r\n\t\ttxt.style=overStyle;\r\n\t}\r\n\t\r\n\tprivate function _mouseOut (pEvent:EventTarget): Void {\r\n\t\tuntyped anim.gotoAndStop(UP);\r\n\t\ttxt.style=upStyle;\r\n\t}\r\n\t\r\n\toverride public function destroy ():Void {\r\n\t\toff(MouseEventType.MOUSE_OVER, _mouseOver);\r\n\t\toff(MouseEventType.MOUSE_DOWN, _mouseDown);\r\n\t\toff(MouseEventType.CLICK, _click);\r\n\t\toff(MouseEventType.MOUSE_OUT, _mouseOut);\r\n\t\toff(MouseEventType.MOUSE_UP_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t\toff(TouchEventType.TOUCH_START, _mouseDown);\r\n\t\toff(TouchEventType.TAP, _click);\r\n\t\toff(TouchEventType.TOUCH_END, _mouseOut);\r\n\t\toff(TouchEventType.TOUCH_END_OUTSIDE, _mouseOut);\r\n\t\t\r\n\t\tsuper.destroy();\r\n\t}\r\n}","package com.isartdigital.utils.ui;\r\n\r\nimport com.isartdigital.ruby.game.controller.Controller;\r\nimport com.isartdigital.ruby.game.sprites.elements.GameElement;\r\nimport com.isartdigital.utils.game.GameStage;\r\nimport pixi.core.math.Point;\r\n\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.text.Text;\r\n\r\n/**\r\n * Classe utils qui permet d'ajouter un Container et un Timer\r\n * @author Julien Fournier\r\n */\r\nclass SmartText extends Container\r\n{\r\n\r\n\t\r\n\tprivate var timerBackground:Graphics;\r\n\tprivate var timerTxt:Text;\r\n\tprivate var element:GameElement;\r\n\r\n\tprivate var paramMarginX:Float;\r\n\tprivate var paramMarginY:Float;\r\n\t\r\n\tprivate var backgroundColor:Int=0x000000;\r\n\r\n\t/**\r\n\t * Cre un new SmarText (texte + background) entirement paramtrable et qui s'adpate au texte qu'il contient\r\n\t * @param\tpParent : l ou le timer doit tre addchild\r\n\t * @param\tpBackWidth : largeur du background\r\n\t * @param\tpBackHeight : hauteur du background\r\n\t * @param\tpTextSize : taille du texte\r\n\t * @param\tpFont : nom de la police  utiliser\r\n\t * @param\tpTxtColor : couleur du texte  utiliser (ex: white, black, ...)\r\n\t * @param\tpAlign : (left, right, center, ...)\r\n\t * @param\tpShadow = true : ombre en dessous du texte\r\n\t * @param\tpBackGrndColor : couleur du background\r\n\t * @param\tpBackGrndOpacity : opacit\r\n\t * @param\tpRadius : radius des bords arrondis\r\n\t * @param\tpBackGroundX\r\n\t * @param\tpBackGroundY\r\n\t * @param\tpTextPosX\r\n\t * @param\tpTextPosY\r\n\t * @param\tpRotation\r\n\t */\r\n\tpublic function new(pParent:Dynamic,\r\n\t\t\t\t\t\tpBackWidth:Float,\r\n\t\t\t\t\t\tpBackHeight:Float,\r\n\t\t\t\t\t\t?pTextSize:Int = 40, \r\n\t\t\t\t\t\t?pFont:String = \"Arial\", \r\n\t\t\t\t\t\t?pTxtColor:String = \"white\", \r\n\t\t\t\t\t\t?pAlign:String = \"left\",\r\n\t\t\t\t\t\t?pShadow = true,\r\n\t\t\t\t\t\t?pBackGrndColor:String = \"black\",\r\n\t\t\t\t\t\t?pBackGrndOpacity:Float = 0.9, \r\n\t\t\t\t\t\t?pRadius:Int = 30,\r\n\t\t\t\t\t\t?pBackGroundX:Float=0,\r\n\t\t\t\t\t\t?pBackGroundY:Float = 0,\r\n\t\t\t\t\t\t?pTextPosX:Float = 5,\r\n\t\t\t\t\t\t?pTextPosY:Float = 5,\r\n\t\t\t\t\t\t?pRotation:Float=0\r\n\t\t\t\t\t\t) \r\n\t{\r\n\t\tsuper();\r\n\t\t\r\n\t\telement = pParent;\r\n\t\trotation = Math.PI * pRotation / 180;\r\n\t\tparamMarginX = pTextPosX;\r\n\t\tparamMarginY = pTextPosY;\r\n\t\t\r\n\t\t\r\n\t\ttimerTxt = new Text(\"\", { font: pTextSize +\"px \"+ pFont, fill: pTxtColor, align: pAlign, dropShadow : pShadow } );\t\t\r\n\t\ttimerTxt.position.set(pTextPosX, pTextPosY);\t\r\n\r\n\t\ttimerBackground = new Graphics();\r\n\t\tbackgroundColor = castColor(pBackGrndColor);\r\n\t\ttimerBackground.beginFill(backgroundColor, pBackGrndOpacity);\r\n\t\ttimerBackground.drawRoundedRect(x, y, pBackWidth, pBackHeight, pRadius);\t\t\t\r\n\t\ttimerBackground.endFill();\r\n\t\ttimerBackground.x = pBackGroundX;\r\n\t\ttimerBackground.y = pBackGroundY;\t\t\r\n\t\t\r\n\t\taddChild(timerBackground);\r\n\t\taddChild(timerTxt);\t\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * cast de la couleur pour la transformer en code couleur\r\n\t * @param\tpBackGrndColor\r\n\t * @return\r\n\t */\r\n\tprivate function castColor(pBackGrndColor:String):Int\r\n\t{\r\n\t\tvar lColor:Int=null;\r\n\t\t\r\n\t\tif (pBackGrndColor == \"black\") lColor = 0x000000;\r\n\t\tif (pBackGrndColor == \"cyan\") lColor = 0x00bfbf;\r\n\t\tif (pBackGrndColor == \"blue\") lColor = 0x00486d;\r\n\t\tif (pBackGrndColor == \"green\") lColor = 0x70bf48;\r\n\t\tif (pBackGrndColor == \"orange\") lColor = 0xff751e;\r\n\t\tif (pBackGrndColor == \"pink\") lColor = 0xff7584;\r\n\t\tif (pBackGrndColor == \"yellow\") lColor = 0xffff00;\r\n\t\tif (pBackGrndColor == \"red\") lColor = 0xff0000;\r\n\t\treturn lColor;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Rafraichissement du timer  mettre dans une boucle\r\n\t * @param\ttimeToDisplay:String\r\n\t */\r\n\tpublic function refreshText(textToDisplay:String):Void\r\n\t{\r\n\t\tif (timerTxt.text  != textToDisplay)\r\n\t\t{\r\n\t\t\ttimerTxt.text = textToDisplay;\r\n\t\t\t//timerTxt.position.set(x+paramMarginX, y+paramMarginY);\r\n\t\t\t\r\n\t\t\ttimerBackground.width = timerTxt.width + paramMarginX * 2;\r\n\t\t\ttimerBackground.height = timerTxt.height  + paramMarginY;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Destuction du Timer\r\n\t */\r\n\tpublic function destroyTimer():Void\r\n\t{\r\n\t\tif(timerBackground != null) removeChild(timerBackground);\r\n\t\tif (timerTxt != null) removeChild(timerTxt);\r\n\t\tif(this != null && element != null) element.removeChild(this);\r\n\t\t\r\n\t\ttimerBackground = null;\r\n\t\ttimerTxt = null;\r\n\t\telement = null;\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\n\r\n/**\r\n * Classe utilitaire permettant de grer le repositionnement des lements d'interface dans l'cran\r\n * @author Mathieu ANTHOINE\r\n */\r\n\r\nclass UIPosition \r\n{\r\n\tpublic static inline var LEFT:String=\"left\";\r\n\tpublic static inline var RIGHT:String=\"right\";\r\n\tpublic static inline var TOP:String=\"top\";\r\n\tpublic static inline var BOTTOM:String=\"bottom\";\r\n\tpublic static inline var TOP_LEFT:String=\"topLeft\";\r\n\tpublic static inline var TOP_RIGHT:String=\"topRight\";\r\n\tpublic static inline var BOTTOM_LEFT:String=\"bottomLeft\";\r\n\tpublic static inline var BOTTOM_RIGHT:String=\"bottomRight\";\r\n\t\r\n\tpublic static inline var FIT_WIDTH:String=\"fitWidth\";\r\n\tpublic static inline var FIT_HEIGHT:String=\"fitHeight\";\r\n\tpublic static inline var FIT_SCREEN:String = \"fitScreen\";\r\n\t\r\n\tprivate function new() {}\r\n\t\r\n\t/**\r\n\t* \r\n\t* @param\tpTarget DisplayObject  positionner\r\n\t* @param\tpPosition type de positionnement\r\n\t* @param\tpOffsetX dcalage en X (positif si c'est vers l'interieur de la zone de jeu sinon en ngatif)\r\n\t* @param\tpOffsetY dcalage en Y (positif si c'est vers l'interieur de la zone de jeu sinon en ngatif)\r\n\t*/\r\n\tstatic public function setPosition (pTarget:DisplayObject, pPosition:String, pOffsetX:Float = 0, pOffsetY:Float = 0): Void {\r\n\t\t\t\t\r\n\t\tvar lScreen:Rectangle = DeviceCapabilities.getScreenRect(pTarget.parent);\r\n\t\t\r\n\t\tvar lTopLeft:Point = new Point (lScreen.x, lScreen.y);\r\n\t\tvar lBottomRight:Point = new Point (lScreen.x+lScreen.width,lScreen.y+lScreen.height);\r\n\t\t\r\n\t\tif (pPosition == TOP || pPosition == TOP_LEFT || pPosition == TOP_RIGHT) pTarget.y = lTopLeft.y + pOffsetY;\r\n\t\tif (pPosition == BOTTOM || pPosition == BOTTOM_LEFT || pPosition == BOTTOM_RIGHT) pTarget.y = lBottomRight.y - pOffsetY;\r\n\t\tif (pPosition == LEFT || pPosition == TOP_LEFT || pPosition == BOTTOM_LEFT) pTarget.x = lTopLeft.x + pOffsetX;\r\n\t\tif (pPosition == RIGHT || pPosition == TOP_RIGHT || pPosition == BOTTOM_RIGHT) pTarget.x = lBottomRight.x - pOffsetX;\r\n\t\t\r\n\t\tif (pPosition == FIT_WIDTH || pPosition == FIT_SCREEN) {\r\n\t\t\tpTarget.x = lTopLeft.x;\r\n\t\t\tuntyped pTarget.width = lBottomRight.x - lTopLeft.x;\r\n\t\t}\r\n\t\tif (pPosition == FIT_HEIGHT || pPosition == FIT_SCREEN) {\r\n\t\t\tpTarget.y = lTopLeft.y;\r\n\t\t\tuntyped pTarget.height = lBottomRight.y - lTopLeft.y;\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n}\r\n","package com.isartdigital.utils.ui.smart;\r\n\r\nimport pixi.core.display.Container;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.text.Text;\r\nimport pixi.core.text.Text.TextStyle;\r\n\r\ntypedef UITextStyle = {\r\n\tvar x: Float;\r\n\tvar y: Float;\r\n\tvar width: Float;\r\n\tvar height: Float;\r\n\tvar align: String;\r\n\tvar font: String;\r\n\tvar color: String;\r\n\tvar text:String;\r\n\tvar wordWrap:Int;\r\n\tvar verticalAlign:String;\r\n}\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass TextSprite extends Container\r\n{\r\n\r\n\t/**\r\n\t * assigner la mthode de parsing des textes pour localiser comme traiter des flags personnaliss\r\n\t */\r\n\tpublic static var parseText:String->String=defaultParseText;\r\n\t\r\n\t/**\r\n\t * accs en lecture  l'instance de Text\r\n\t */\r\n\tpublic var textField(default, null):Text;\r\n\t\r\n\t/**\r\n\t * raccourci pour acceder  la proprit text de l'instance de texte\r\n\t */\r\n\tpublic var text (get, set):String;\r\n\t\r\n\tprivate function get_text ():String {\r\n\t\treturn textField.text;\r\n\t}\r\n\t\r\n\tprivate function set_text (pText:String):String {\r\n\t\ttextField.text = pText;\r\n\t\treturn pText;\r\n\t}\r\n\t\r\n\tpublic function new(pData:UITextStyle) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tvar lStyle:TextStyle = {\r\n\t\t\tfont: StringTools.replace(pData.font,\"*\",\"\"),\r\n\t\t\tfill: pData.color,\r\n\t\t\talign: pData.align,\r\n\t\t\twordWrap: pData.wordWrap == 1,\r\n\t\t\twordWrapWidth: pData.width\r\n\t\t}\t\r\n\t\t\r\n\t\ttextField = new Text(parseText(StringTools.replace(pData.text,\"</BR>\",\"\\r\")), lStyle);\r\n\t\tif (pData.align == \"center\") textField.anchor.x = 0.5;\r\n\t\telse if (pData.align == \"right\") textField.anchor.x = 1;\r\n\t\t\r\n\t\tif (pData.verticalAlign == \"top\") textField.anchor.y = 0;\r\n\t\tif (pData.verticalAlign == \"bottom\") textField.anchor.y = 1;\r\n\t\telse textField.anchor.y = 0.5;\r\n\t\t\r\n\t\t\r\n\t\tif (Config.debug) {\r\n\t\t\tvar lGraph:Graphics = new Graphics();\r\n\t\t\tlGraph.beginFill(0xFFFF00);\r\n\t\t\tlGraph.drawRect(pData.x, pData.y, pData.width, pData.height);\r\n\t\t\tlGraph.endFill();\r\n\t\t\tlGraph.alpha = 0.5;\r\n\t\t\taddChild(lGraph);\r\n\t\t}\r\n\t\t\r\n\t\taddChild(textField);\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tprivate static function defaultParseText (pTxt:String):String {\r\n\t\treturn pTxt;\r\n\t}\r\n\t\r\n}","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.loader.GameLoader;\r\nimport com.isartdigital.utils.system.DeviceCapabilities;\r\nimport com.isartdigital.utils.ui.UIPosition;\r\nimport flump.filters.AnimateTintFilter;\r\nimport flump.json.FlumpJSON;\r\nimport flump.library.Keyframe;\r\nimport flump.library.Layer;\r\nimport flump.library.MovieSymbol;\r\nimport flump.library.SpriteSymbol;\r\nimport haxe.Json;\r\nimport js.Lib;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.math.Point;\r\nimport pixi.flump.Movie;\r\nimport pixi.flump.Resource;\r\nimport pixi.flump.Sprite;\r\n\r\n/**\r\n * Construit un SmartComponent depuis un Movie Flump\r\n * @author Mathieu Anthoine\r\n */\r\nclass UIBuilder\r\n{\r\n\t\r\n\tprivate function new() {}\t\r\n\t\r\n\t/**\r\n\t * Cre les lments composant un UIComponent ou SmartComponent\r\n\t * @param\tpId assetName de l'cran\r\n\t */\r\n\tpublic static function build (pId:String,pFrame:Int=0) : Array<UIPositionable> {\r\n\t\t\r\n\t\tvar lMovie:MovieSymbol=untyped Resource.getResourceForMovie(pId).library.movies.h[pId];\r\n\t\t\r\n\t\tvar lObj:Container;\r\n\t\tvar lUIPos:Array<UIPositionable> = [];\r\n\t\tvar lLayer:Layer;\r\n\t\tvar lKeyFrame:Keyframe;\r\n\t\t\r\n\t\tfor (i in 0...lMovie.layers.length) {\r\n\t\t\tlObj = null;\r\n\t\t\tlLayer = lMovie.layers[i];\r\n\t\t\t\r\n\t\t\tlKeyFrame = lLayer.getKeyframeForFrame(pFrame);\r\n\t\t\tif (lKeyFrame == null || lKeyFrame.symbol==null) continue;\t\t\r\n\t\t\t\r\n\t\t\tif (lKeyFrame.symbol.data != null && lKeyFrame.symbol.data.className != null) {\r\n\t\t\t\tlObj=Type.createInstance(Type.resolveClass(lKeyFrame.symbol.data.className), []);\r\n\t\t\t}\r\n\t\t\telse if (lKeyFrame.symbol.baseClass == \"Flipbook\") lObj = new UIMovie(lKeyFrame.symbolId);\r\n\t\t\telse if (lKeyFrame.symbol.baseClass == \"TextSprite\") lObj = new TextSprite(lKeyFrame.symbol.data);\r\n\t\t\telse if (Std.is (lKeyFrame.symbol, SpriteSymbol)) lObj = new UISprite(lKeyFrame.symbolId);\r\n\t\t\telse if (lKeyFrame.symbol.baseClass == \"flash.display.SimpleButton\") lObj = new SmartButton(lKeyFrame.symbolId);\r\n\t\t\telse {\r\n\t\t\t\tvar lChild:MovieSymbol=untyped Resource.getResourceForMovie(lKeyFrame.symbolId).library.movies.h[lKeyFrame.symbolId];\r\n\t\t\t\tvar lChildLayer:Layer;\r\n\t\t\t\tfor (lChildLayer in lChild.layers) {\r\n\t\t\t\t\tif (lChildLayer.keyframes.length > 1) {\r\n\t\t\t\t\t\tlObj = new UIMovie(lKeyFrame.symbolId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (lObj == null) {\r\n\t\t\t\t\tlObj = new SmartComponent(lKeyFrame.symbolId);\r\n\t\t\t\t\tcast(lObj,SmartComponent).modal = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlObj.name = lLayer.name;\r\n\t\t\t\r\n\t\t\tlObj.position= new Point(lKeyFrame.location.x/DeviceCapabilities.textureRatio,lKeyFrame.location.y/DeviceCapabilities.textureRatio);\r\n\t\t\tlObj.scale= new Point(lKeyFrame.scale.x,lKeyFrame.scale.y);\r\n\t\t\tlObj.skew = new Point(lKeyFrame.skew.x, lKeyFrame.skew.y);\r\n\t\t\t\r\n\t\t\tif (lKeyFrame.tintMultiplier!=null &&  lKeyFrame.tintMultiplier!= 0) lObj.filters= [new AnimateTintFilter(lKeyFrame.tintColor, lKeyFrame.tintMultiplier)];\r\n\t\t\t\r\n\t\t\tvar lUIPosition:String = \"\";\r\n\t\t\tif (lKeyFrame.data != null) {\r\n\t\t\t\tif (Reflect.hasField(lKeyFrame.data,\"UIPosition_\"+DeviceCapabilities.system)) lUIPosition = Reflect.field(lKeyFrame.data,\"UIPosition_\"+DeviceCapabilities.system);\r\n\t\t\t\telse if (lKeyFrame.data.UIPosition != null) lUIPosition = lKeyFrame.data.UIPosition;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlUIPos.push(getUIPositionable(lObj,lUIPosition));\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn lUIPos;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * retourne un UIPositionable correctement construit\r\n\t * @param\tpObj Item d'interface\r\n\t * @param\tpPosition ancrage \"UIPosition\"\r\n\t * @return un UIPositionable\r\n\t */\r\n\tprivate static function getUIPositionable (pObj:Container,pPosition:String):UIPositionable {\r\n\t\t\r\n\t\tvar lOffset:Point = new Point (0, 0);\r\n\t\t\r\n\t\tif (pPosition == UIPosition.TOP || pPosition == UIPosition.TOP_LEFT || pPosition == UIPosition.TOP_RIGHT ||\r\n\t\t\tpPosition == UIPosition.BOTTOM || pPosition == UIPosition.BOTTOM_LEFT || pPosition == UIPosition.BOTTOM_RIGHT) lOffset.y = pObj.y;\r\n\t\tif (pPosition == UIPosition.LEFT || pPosition == UIPosition.TOP_LEFT || pPosition == UIPosition.BOTTOM_LEFT ||\r\n\t\t\tpPosition == UIPosition.RIGHT || pPosition == UIPosition.TOP_RIGHT || pPosition == UIPosition.BOTTOM_RIGHT) lOffset.x = pObj.x;\t\t\r\n\t\t\t\t\r\n\t\treturn {item:pObj, align:pPosition, offsetX:lOffset.x, offsetY:lOffset.y, update:true};\r\n\t}\r\n\t\r\n}\r\n\r\n","package com.isartdigital.utils.ui.smart;\r\n\r\nimport com.isartdigital.utils.game.factory.FlumpSpriteAnimFactory;\r\nimport com.isartdigital.utils.game.StateGraphic;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass UISprite extends StateGraphic\r\n{\r\n\r\n\tpublic function new(pAssetName:String) \r\n\t{\r\n\t\tsuper();\r\n\t\tassetName = pAssetName;\r\n\t\tfactory = new FlumpSpriteAnimFactory();\r\n\t\tsetState(DEFAULT_STATE);\r\n\t}\r\n\t\r\n}","package flump;\r\n\r\nimport flump.library.Keyframe;\r\n\r\n\r\nclass DisplayObjectKey {\r\n\r\n\tpublic var symbolId:String;\r\n\r\n\r\n\tpublic function new(symbolId:String){\r\n\t\tthis.symbolId = symbolId;\r\n\t}\r\n\r\n}","package flump;\r\n\r\nimport flump.DisplayObjectKey;\r\nimport flump.IFlumpMovie;\r\nimport flump.library.Keyframe;\r\nimport flump.library.Label;\r\nimport flump.library.Layer;\r\nimport flump.library.MovieSymbol;\r\nusing Std;\r\n\r\n\r\nclass MoviePlayer{\r\n\r\n\tprivate var symbol:MovieSymbol;\r\n\tprivate var movie:IFlumpMovie;\r\n\r\n\tprivate var elapsed:Float = 0.0; // Total time that has elapsed\r\n\tprivate var previousElapsed:Float = 0.0;\r\n\tprivate var advanced:Float = 0.0; // Time advanced since the last frame\r\n\t\r\n\t/** previous render \"position\" value ; -1 means no previous render */\r\n\tvar prevPosition\t\t\t\t\t\t\t: Float\t\t\t\t\t\t\t\t\t= -1;\r\n\t\r\n\tpublic var independantTimeline:Bool = true;\r\n\tpublic var independantControl:Bool = true;\r\n\r\n\tprivate var state:String;\r\n\tprivate var STATE_PLAYING:String = \"playing\";\r\n\tprivate var STATE_LOOPING:String = \"looping\";\r\n\tprivate var STATE_STOPPED:String = \"stopped\";\r\n\t\t\r\n\tprivate var currentChildrenKey = new Map<Layer, DisplayObjectKey>();\r\n\tprivate var createdChildren = new Map<DisplayObjectKey, Bool>();\r\n\tprivate var childPlayers = new Map<DisplayObjectKey, MoviePlayer>();\r\n\r\n\tprivate var labelsToFire = new Array<Label>();\r\n\tprivate var changed:Int = 0;\r\n\t//private var labelsToIgnore = new ObjectMap<Label, Label>();\r\n\tprivate var dirty:Bool = false;\r\n\tprivate var fullyGenerated:Bool = false;\r\n\r\n\tprivate var resolution:Float;\r\n\r\n\r\n\tpublic function new(symbol:MovieSymbol, movie:IFlumpMovie, resolution:Float){\r\n\t\tthis.symbol = symbol;\r\n\t\tthis.movie = movie;\r\n\t\tthis.resolution = resolution;\r\n\r\n\t\tfor(layer in symbol.layers){\r\n\t\t\tmovie.createLayer(layer);\r\n\t\t}\r\n\r\n\t\tstate = STATE_LOOPING;\r\n\t\tadvanceTime(0);\r\n\t\tfor (layer in symbol.layers) movie.setMask(layer);\r\n\t}\r\n\r\n\tpublic var labels(get, null):Iterator<Label>;\r\n\tpublic function get_labels():Iterator<Label>{\r\n\t\treturn symbol.labels.iterator();\r\n\t}\r\n\r\n\r\n\tpublic function getDisplayKey(layerId:String, keyframeIndex:UInt = 0):DisplayObjectKey{\r\n\t\tvar layer = symbol.getLayer(layerId);\r\n\t\tif(layer == null) throw(\"Layer \" + layerId + \" does not exist.\");\r\n\t\tvar keyframe = layer.getKeyframeForFrame(keyframeIndex);\r\n\t\tif(keyframe == null) throw(\"Keyframe does not exist at index \" + keyframeIndex);\r\n\t\tcreateChildIfNessessary(keyframe);\r\n\t\treturn keyframe.displayKey;\r\n\t}\r\n\r\n\r\n\tprivate function reset(){\r\n\t\telapsed = 0;\r\n\t\tpreviousElapsed = 0;\r\n\t\tprevPosition = -1;\r\n\t}\r\n\t\r\n\tprivate var position(get, null):Float = 0.0;\r\n\tpublic function get_position():Float{\r\n\t\tvar lModPos\t: Float\t= ( elapsed % symbol.duration + symbol.duration) % symbol.duration;\r\n\t\tvar lEndPos\t: Float;\r\n\t\t\r\n\t\tif ( state == STATE_PLAYING){\r\n\t\t\tlEndPos = symbol.duration - symbol.library.frameTime;\r\n\t\t\t\r\n\t\t\tif ( elapsed >= lEndPos) return lEndPos;\r\n\t\t\telse return lModPos;\r\n\t\t}else return lModPos;\r\n\t}\r\n\r\n\r\n\tpublic var totalFrames (get, null) :UInt;\r\n\tprivate function get_totalFrames(){\r\n\t\treturn symbol.totalFrames;\r\n\t}\r\n\r\n\r\n\tpublic function play(){\r\n\t\tsetState(STATE_PLAYING);\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tpublic function loop(){\r\n\t\tsetState(STATE_LOOPING);\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tpublic function stop(){\r\n\t\tsetState(STATE_STOPPED);\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tpublic function goToLabel(label:String){\r\n\t\tif(!labelExists(label)) throw(\"Symbol \" + symbol.name + \" does not have label \" + label + \".\" );\r\n\t\tcurrentFrame = getLabelFrame(label);\r\n\t\tfireHitFrames(getLabelFrame(label));\r\n\t\t//ignoreCurrentLabels();\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tpublic function goToFrame(frame:Int){\r\n\t\tcurrentFrame = frame;\r\n\t\tfireHitFrames(frame);\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tprivate function fireHitFrames(frame:Int){\r\n\t\tchanged++;\r\n\t\tvar current = changed;\r\n\t\tvar time = frame * symbol.library.frameTime;\r\n\r\n\t\tfor(layer in symbol.layers){\r\n\t\t\tfor(kf in layer.keyframes){\r\n\t\t\t\tif(current != changed) return;\r\n\t\t\t\tif(kf.label != null){\r\n\t\t\t\t\tif(kf.timeInside(time)) movie.labelHit(kf.label);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic function goToPosition(time:Float){\r\n\t\telapsed = time;\r\n\t\tpreviousElapsed = time;\r\n\t\tclearLabels();\r\n\t\t//ignoreCurrentLabels();\r\n\t\t//fireLabels();\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tpublic var playing(get, null):Bool;\r\n\tprivate function get_playing(){\r\n\t\treturn state == STATE_PLAYING;\r\n\t}\r\n\r\n\r\n\tpublic var looping(get, null):Bool;\r\n\tprivate function get_looping(){\r\n\t\treturn state == STATE_LOOPING;\r\n\t}\r\n\r\n\r\n\tpublic var stopped(get, null):Bool;\r\n\tprivate function get_stopped(){\r\n\t\treturn state == STATE_STOPPED;\r\n\t}\r\n\r\n\r\n\tpublic function getLabelFrame(label:String):UInt{\r\n\t\tif(!labelExists(label)) throw(\"Symbol \" + symbol.name + \" does not have label \" + label + \".\" );\r\n\t\treturn symbol.labels.get(label).keyframe.index;\r\n\t}\r\n\t\r\n\t/*\r\n\tprivate function ignoreCurrentLabels(){\r\n\t\tfor(layer in symbol.layers){\r\n\t\t\tvar kf = layer.getKeyframeForFrame(currentFrame);\r\n\t\t\tif(kf != null){\r\n\t\t\t\tif(kf.label != null){\r\n\t\t\t\t\tlabelsToIgnore.set(kf.label, kf.label);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t*/\r\n\r\n\r\n\tpublic var currentFrame(get, set):Int;\r\n\tprivate function get_currentFrame():Int{\r\n\t\treturn Std.int(position / symbol.library.frameTime);\r\n\t}\r\n\tprivate function set_currentFrame(value:Int):Int{\r\n\t\tgoToPosition( symbol.library.frameTime * value);\r\n\t\treturn value;\r\n\t}\r\n\r\n\r\n\tpublic function labelExists(label:String):Bool{\r\n\t\treturn symbol.labels.exists(label);\r\n\t}\r\n\r\n\r\n\tpublic function advanceTime(ms:Float):Void{\r\n\t\tif(state != STATE_STOPPED){\r\n\t\t\telapsed += ms;\r\n\t\t\twhile(elapsed < 0){\r\n\t\t\t\telapsed += symbol.duration;\r\n\t\t\t\tpreviousElapsed += symbol.duration;\r\n\t\t\t}\r\n\t\t}\r\n\t\tadvanced += ms;\r\n\r\n\t\tif(state != STATE_STOPPED) fireLabels();\r\n\t\trender();\r\n\t}\r\n\r\n\r\n\tprivate function clearLabels(){\r\n\t\twhile(labelsToFire.length > 0) labelsToFire.pop();\r\n\t}\r\n\r\n\r\n\tprivate function fireLabels(){\r\n\t\tif(symbol.firstLabel == null) return;\r\n\t\tif(previousElapsed > elapsed) return;\r\n\t\t\r\n\t\t\r\n\t\tvar label:Label = previousElapsed <= elapsed\r\n\t\t\t? symbol.firstLabel\r\n\t\t\t: symbol.lastLabel;\r\n\t\t\r\n\t\tvar checking = true;\r\n\t\twhile(checking){\r\n\t\t\tif(label.keyframe.time > previousElapsed%symbol.duration){\r\n\t\t\t\tchecking = false;\r\n\t\t\t\t//trace(label.keyframe.index);\r\n\t\t\t\t//label = label.prev;\r\n\t\t\t}else if(label.next.keyframe.index <= label.keyframe.index){\r\n\t\t\t\tchecking = false;\r\n\t\t\t\tlabel = label.next;\r\n\t\t\t}else{\r\n\t\t\t\tlabel = label.next;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar firstChecked = label;\r\n\r\n\t\twhile(label != null){\r\n\t\t\tvar checkFrom = previousElapsed % symbol.duration;\r\n\t\t\tvar checkTo = elapsed % symbol.duration;\r\n\t\t\tif(label.keyframe.insideRangeStart(checkFrom, checkTo) && state != STATE_STOPPED){\r\n\t\t\t\tlabelsToFire.push(label);\r\n\t\t\t}\r\n\r\n\t\t\tlabel = label.next;\r\n\t\t\tif(label == firstChecked) label = null;\r\n\t\t}\r\n\r\n\t\twhile(labelsToFire.length > 0){\r\n\t\t\tvar label = labelsToFire.shift();\r\n\t\t\tmovie.labelPassed(label);\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tfor(key in labelsToIgnore.keys()){\r\n\t\t\tvar label = labelsToIgnore.get(key);\r\n\t\t\tlabelsToIgnore.remove(key);\r\n\t\t\ttrace(\"Label fire: \" + label.name);\r\n\t\t\tmovie.labelHit(label);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\r\n\r\n\tprivate function render():Void{\r\n\t\tvar lIsUpdate\t: Bool\t\t= true;\r\n\t\tvar next\t\t: Keyframe\t= null;\r\n\t\tvar interped\t: Float\t\t= -1;\r\n\t\tvar lColor\t\t:Int\t\t= -1;// AnimateTint\r\n\t\t\r\n\t\tif (state == STATE_PLAYING){\r\n\t\t\t// \"position\" could not be negative, this shouldn't occures\r\n\t\t\t/*if(position < 0){\r\n\t\t\t\telapsed = 0;\r\n\t\t\t\tstop();\r\n\t\t\t\tmovie.onAnimationComplete();\r\n\t\t\t}else */if(position >= symbol.duration - symbol.library.frameTime){\r\n\t\t\t\telapsed = symbol.duration - symbol.library.frameTime;\r\n\t\t\t\tstop();\r\n\t\t\t\tmovie.onAnimationComplete();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// there's no setter for \"position\", is there ? also, \"position\" calculation provides only positive values, from \"elapsed\" modulo\r\n\t\t//while(position < 0) position += symbol.duration;\r\n\t\t\r\n\t\tif ( position != prevPosition && ( prevPosition < 0 || totalFrames > 1)) prevPosition = position;\r\n\t\telse lIsUpdate = false;\r\n\t\t\r\n\t\tfor (layer in symbol.layers){\r\n\t\t\tvar keyframe\t: Keyframe\t= layer.getKeyframeForTime(position);\r\n\r\n\t\t\tif(keyframe.isEmpty == true){\r\n\t\t\t\tremoveChildIfNessessary(keyframe);\r\n\t\t\t}else if(keyframe.isEmpty == false){\r\n\t\t\t\tif ( lIsUpdate){\r\n\t\t\t\t\tinterped\t= getInterpolation( keyframe, position);\r\n\t\t\t\t\tnext\t\t= keyframe.next;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( next.isEmpty) next = keyframe;// NASTY! FIX THIS!!\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (keyframe.tintColor != next.tintColor) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar lPrevColor:Int = keyframe.tintColor;\r\n\t\t\t\t\t\tvar lNextColor:Int = next.tintColor;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar lPrevR:Int = (lPrevColor >> 16) & 0xFF;\r\n\t\t\t\t\t\tvar lPrevG:Int = (lPrevColor >> 8) & 0xFF;\r\n\t\t\t\t\t\tvar lPrevB:Int = lPrevColor & 0xFF;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar lNextR:Int = (lNextColor >> 16) & 0xFF;\r\n\t\t\t\t\t\tvar lNextG:Int = (lNextColor >> 8) & 0xFF;\r\n\t\t\t\t\t\tvar lNextB:Int = lNextColor & 0xFF;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlColor = Math.round(lPrevR + (lNextR - lPrevR) * interped) << 16 | Math.round(lPrevG + (lNextG - lPrevG) * interped) << 8 | Math.round(lPrevB + (lNextB - lPrevB) * interped);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else lColor = keyframe.tintColor;\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\tif(currentChildrenKey.get(layer) != keyframe.displayKey){\r\n\t\t\t\t\t\tcreateChildIfNessessary(keyframe);\r\n\t\t\t\t\t\tremoveChildIfNessessary(keyframe);\r\n\t\t\t\t\t\taddChildIfNessessary(keyframe);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(keyframe.symbol.is(MovieSymbol)){\r\n\t\t\t\t\tvar childMovie = movie.getChildPlayer(keyframe);\r\n\r\n\t\t\t\t\tif(childMovie.independantTimeline){\r\n\t\t\t\t\t\tchildMovie.advanceTime(advanced);\r\n\t\t\t\t\t\t// no need ? \"render\" call already included at the end of \"advanceTime\" : childMovie.render();\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tchildMovie.elapsed = position;\r\n\t\t\t\t\t\tchildMovie.render();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif ( lIsUpdate){\r\n\t\t\t\t\tmovie.renderFrame(\r\n\t\t\t\t\t\tkeyframe,\r\n\t\t\t\t\t\t(keyframe.location.x + (next.location.x - keyframe.location.x) * interped),\r\n\t\t\t\t\t\t(keyframe.location.y + (next.location.y - keyframe.location.y) * interped),\r\n\t\t\t\t\t\t(keyframe.scale.x + (next.scale.x - keyframe.scale.x) * interped),\r\n\t\t\t\t\t\t(keyframe.scale.y + (next.scale.y - keyframe.scale.y) * interped),\r\n\t\t\t\t\t\tkeyframe.skew.x + (next.skew.x - keyframe.skew.x) * interped,\r\n\t\t\t\t\t\tkeyframe.skew.y + (next.skew.y - keyframe.skew.y) * interped,\r\n\t\t\t\t\t\tkeyframe.alpha + (next.alpha - keyframe.alpha) * interped,\r\n\t\t\t\t\t\tkeyframe.tintMultiplier + (next.tintMultiplier - keyframe.tintMultiplier) * interped,\r\n\t\t\t\t\t\tlColor\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tadvanced = 0;\r\n\t\tpreviousElapsed = elapsed;\r\n\t}\r\n\r\n\r\n\tprivate function createChildIfNessessary(keyframe:Keyframe){\r\n\t\tif(keyframe.isEmpty) return;\r\n\t\tif(createdChildren.exists(keyframe.displayKey) == false){\r\n\t\t\tmovie.createFlumpChild(keyframe.displayKey);\r\n\t\t\tcreatedChildren[keyframe.displayKey] = true;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate function removeChildIfNessessary(keyframe:Keyframe){\r\n\t\tif(currentChildrenKey.exists(keyframe.layer)){\r\n\t\t\tmovie.removeFlumpChild(keyframe.layer, keyframe.displayKey);\r\n\t\t\tcurrentChildrenKey.remove(keyframe.layer);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate function addChildIfNessessary(keyframe:Keyframe){\r\n\t\tif(keyframe.isEmpty) return;\r\n\t\tcurrentChildrenKey[keyframe.layer] = keyframe.displayKey;\r\n\t\tmovie.addFlumpChild(keyframe.layer, keyframe.displayKey);\r\n\t}\r\n\r\n\r\n\t\r\n\t//////////////////////////////////////////////////////////////\r\n\t//\r\n\t//  Utilities\r\n\t//\r\n\t//////////////////////////////////////////////////////////////\r\n\r\n\tprivate function setState(state:String){\r\n\t\tthis.state = state;\r\n\r\n\t\tfor(layer in symbol.layers){\r\n\t\t\tvar keyframe = layer.getKeyframeForTime(position);\r\n\t\t\tcreateChildIfNessessary(keyframe);\r\n\r\n\t\t\tif(keyframe.symbol.is(MovieSymbol)){\r\n\t\t\t\tvar childMovie = movie.getChildPlayer(keyframe);\r\n\t\t\t\tif(childMovie.independantControl == false){\r\n\t\t\t\t\tchildMovie.setState(state);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tadvanceTime(0);\r\n\t}\r\n\r\n\r\n\tprivate function timeForLabel(label:String):Float{\r\n\t\treturn symbol.labels[label].keyframe.time;\r\n\t}\r\n\r\n\r\n\tprivate function getInterpolation(keyframe:Keyframe, time:Float){\r\n\t\tif(keyframe.tweened == false) return 0.0;\r\n\t\t\r\n\t\tvar interped = (time - keyframe.time) / keyframe.duration;\r\n\t\tvar ease:Float = keyframe.ease;\r\n\t\tif (ease != 0) {\r\n\t\t\tvar t :Float;\r\n\t\t\tif (ease < 0) {\r\n\t\t\t\t// Ease in\r\n\t\t\t\tvar inv:Float = 1 - interped;\r\n\t\t\t\tt = 1 - inv * inv;\r\n\t\t\t\tease = -ease;\r\n\t\t\t} else {\r\n\t\t\t\t// Ease out\r\n\t\t\t\tt = interped * interped;\r\n\t\t\t}\r\n\t\t\tinterped = ease * t + (1 - ease) * interped;\r\n\t\t}\r\n\t\treturn interped;\r\n\t}\r\n\r\n\r\n}\r\n\r\n","package flump.filters;\r\nimport pixi.core.renderers.webgl.filters.AbstractFilter;\r\n// pixi 4 class\r\n//import pixi.core.renderers.webgl.filters.Filter;\r\n\r\nprivate typedef Uniform = {\r\n\tvar type:String;\r\n\tvar value:Dynamic;\r\n}\r\n\r\nprivate typedef AnimateTint = {\r\n\tvar multiplier: Uniform;\r\n\tvar color : Uniform;\r\n}\r\n\r\nprivate typedef V3 = {\r\n\tvar x:Float;\r\n\tvar y:Float;\r\n\tvar z:Float;\r\n}\r\n\r\n/**\r\n * Filter that reproduce the behaviour of Tint in Adobe Flash/Animate\r\n * @author Mathieu Anthoine\r\n */\r\nclass AnimateTintFilter extends AbstractFilter\r\n// pixi 4 class\r\n//class AnimateTintFilter extends Filter\r\n{\r\n\r\n\tpublic var multiplier (default,null):Float;\r\n\tpublic var color (default, null):UInt;\r\n\t\r\n\tprivate var uniforms:AnimateTint;\r\n\t\r\n\tpublic function new(pColor:UInt,pMultiplier:Float=1) \r\n\t{\r\n\t\tcolor = pColor;\r\n\t\tmultiplier = pMultiplier;\r\n\t\tuniforms = {color: {type: \"v3\", value: hex2v3(color)}, multiplier: {type: \"1f\", value: multiplier}};\r\n\t\tsuper(null,getFragmentSrc(), uniforms);\r\n\r\n\t}\r\n\t\r\n\tprivate function getFragmentSrc ():String {\r\n\t\tvar lSrc:String = \"\";\r\n\t\tlSrc += \"precision mediump float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform vec3 color;uniform float multiplier;\";\r\n\t\tlSrc += \"void main () { gl_FragColor = texture2D(uSampler, vTextureCoord);\";\r\n\t\tlSrc += \"gl_FragColor.r = (color.r*multiplier+gl_FragColor.r*(1.0-multiplier)) * gl_FragColor.a;\";\r\n\t\tlSrc += \"gl_FragColor.g = (color.g*multiplier+gl_FragColor.g*(1.0-multiplier)) * gl_FragColor.a;\";\r\n\t\tlSrc += \"gl_FragColor.b = (color.b*multiplier+gl_FragColor.b*(1.0-multiplier)) * gl_FragColor.a;\";\r\n\t\tlSrc += \"}\";\r\n\t\treturn lSrc;\r\n\t}\r\n\t\r\n\tprivate function hex2v3(pColor:UInt):V3 {\r\n\t\treturn {x:(pColor >> 16 & 0xFF) / 255,y:(pColor >> 8 & 0xFF) / 255,z: (pColor & 0xFF) / 255};\r\n\t}\r\n\t\r\n\tpublic function update(pColor:UInt, pMultiplier:Float = 1) : Void {\r\n\t\tuniforms.color.value = hex2v3(color=pColor);\r\n\t\tuniforms.multiplier.value = multiplier= pMultiplier;\r\n\t}\r\n\t\r\n}","package flump.json;\r\n\r\ntypedef FlumpJSON = {\r\n\tvar md5:String;\r\n\tvar movies:Array<MovieSpec>;\r\n\tvar textureGroups:Array<TextureGroupSpec>;\r\n\tvar frameRate: UInt;\r\n}\r\n\r\n\r\nabstract FlumpPointSpec(Array<Float>){\r\n\r\n\tpublic var x(get, never):Float;\r\n\tpublic var y(get, never):Float;\r\n\r\n\tinline public function get_x():Float{\r\n\t\treturn this[0];\r\n\t}\r\n\r\n\tinline public function get_y():Float{\r\n\t\treturn this[1];\r\n\t}\r\n}\r\n\r\n\r\nabstract FlumpRectSpec(Array<Float>){\r\n\r\n\tpublic var x(get, never):Float;\r\n\tpublic var y(get, never):Float;\r\n\tpublic var width(get, never):Float;\r\n\tpublic var height(get, never):Float;\r\n\r\n\tinline public function get_x():Float{\r\n\t\treturn this[0];\r\n\t}\r\n\r\n\tinline public function get_y():Float{\r\n\t\treturn this[1];\r\n\t}\r\n\r\n\tinline public function get_width():Float{\r\n\t\treturn this[2];\r\n\t}\r\n\r\n\tinline public function get_height():Float{\r\n\t\treturn this[3];\r\n\t}\r\n}\r\n\r\ntypedef MovieSpec = {\r\n\tvar layers:Array<LayerSpec>;\r\n\tvar id:ReferenceSpec;\r\n\t@:optional var baseClass:String;\r\n\t@:optional var data:Dynamic;\r\n}\r\n\r\ntypedef ReferenceSpec = String;\r\n\r\ntypedef KeyframeSpec = {\r\n\tvar pivot:FlumpPointSpec;\r\n\tvar duration:UInt;\r\n\tvar loc:FlumpPointSpec;\r\n\tvar index:UInt;\r\n\tvar ref:ReferenceSpec;\r\n\tvar scale:FlumpPointSpec;\r\n\tvar skew:FlumpPointSpec;\r\n\tvar ease:Float;\r\n\tvar tweened:Bool;\r\n\tvar label:String;\r\n\tvar alpha:Float;\r\n\t@:optional var tint:Array<Dynamic>;\r\n\t@:optional var data:Dynamic;\r\n}\r\n\r\n\r\ntypedef TextureSpec = {\r\n\tvar symbol:ReferenceSpec;\r\n\tvar rect:FlumpRectSpec;\r\n\tvar origin:FlumpPointSpec;\r\n\t@:optional var baseClass:String;\r\n\t@:optional var data:Dynamic;\r\n}\r\n\r\n\r\ntypedef TextureGroupSpec = {\r\n\tvar atlases:Array<AtlasSpec>;\r\n\tvar scaleFactor:UInt;\r\n}\r\n\r\n\r\ntypedef AtlasSpec = {\r\n\tvar file:String;\r\n\tvar textures:Array<TextureSpec>;\r\n}\r\n\r\n\r\ntypedef LayerSpec = {\r\n\tvar name:String;\r\n\tvar keyframes:Array<KeyframeSpec>;\r\n\t@:optional var mask:String;\r\n}\r\n\r\n\r\n\r\n","package flump.library;\r\n\r\nimport flump.DisplayObjectKey;\r\nimport flump.json.FlumpJSON;\r\nimport flump.library.Label;\r\nusing Lambda;\r\n\r\n\r\nclass FlumpLibrary{\r\n\r\n\tpublic var movies = new Map<String, MovieSymbol>();\r\n\tpublic var sprites = new Map<String, SpriteSymbol>();\r\n\tpublic var atlases = new Array<AtlasSpec>();\r\n\tpublic var framerate:Float;\r\n\tpublic var frameTime:Float;\r\n\tpublic var md5:String;\r\n\tpublic var resolution:Float;\r\n\r\n\r\n\tfunction new(resolution:Float){\r\n\t\tthis.resolution = resolution;\r\n\t}\r\n\r\n\r\n\tpublic static function create(flumpData:Dynamic, resolution:Float):FlumpLibrary{\r\n\t\tvar lib:FlumpJSON = cast flumpData;\r\n\t\t\r\n\t\tvar spriteSymbols = new Map<String, SpriteSymbol>();\r\n\t\tvar movieSymbols = new Map<String, MovieSymbol>();\r\n\r\n\t\tvar flumpLibrary = new FlumpLibrary(resolution);\r\n\t\tflumpLibrary.sprites = spriteSymbols;\r\n\t\tflumpLibrary.movies = movieSymbols;\r\n\t\tflumpLibrary.framerate = lib.frameRate;\r\n\t\tflumpLibrary.frameTime = 1000/flumpLibrary.framerate;\t\t\r\n\t\tflumpLibrary.md5 = lib.md5;\r\n\r\n\t\tvar atlasSpecs = new Array<flump.json.FlumpJSON.AtlasSpec>();\r\n\t\tvar textureGroup = null;\r\n\r\n\t\t// Find best suited resolution from available textures\r\n\t\tfor(tg in lib.textureGroups){\r\n\t\t\tif(tg.scaleFactor >= resolution && textureGroup == null) textureGroup = tg;\r\n\t\t}\r\n\t\tif(textureGroup == null) textureGroup =  lib.textureGroups[lib.textureGroups.length-1];\r\n\r\n\r\n\t\tfor(atlas in textureGroup.atlases){\r\n\t\t\tflumpLibrary.atlases.push(atlas);\r\n\t\t\tatlasSpecs.push(atlas);\r\n\t\t}\r\n\r\n\r\n\t\tfor(spec in atlasSpecs){\t\t\t\r\n\t\t\tfor(textureSpec in spec.textures){\r\n\t\t\t\tvar frame = new Rectangle(textureSpec.rect.x, textureSpec.rect.y, textureSpec.rect.width, textureSpec.rect.height);\r\n\t\t\t\tvar origin = new Point(textureSpec.origin.x, textureSpec.origin.y);\r\n\t\t\t\r\n\t\t\t\tvar symbol = new SpriteSymbol();\r\n\t\t\t\tsymbol.name = textureSpec.symbol;\r\n\t\t\t\tsymbol.data = textureSpec.data;\r\n\t\t\t\tsymbol.baseClass = textureSpec.baseClass;\t\t\t\t\r\n\t\t\t\tsymbol.origin = origin;\r\n\t\t\t\tsymbol.texture = textureSpec.symbol;\r\n\t\t\t\tspriteSymbols[symbol.name] = symbol;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar pendingSymbolAttachments = new Map<Keyframe, String>();\r\n\t\tfor(movieSpec in lib.movies){\r\n\t\t\tvar symbol = new MovieSymbol();\r\n\t\t\tsymbol.name = movieSpec.id;\r\n\t\t\tsymbol.data = movieSpec.data;\r\n\t\t\tsymbol.baseClass = movieSpec.baseClass;\r\n\t\t\tsymbol.library = flumpLibrary;\r\n\t\t\tfor(layerSpec in movieSpec.layers){\r\n\t\t\t\tvar layer = new Layer(layerSpec.name);\r\n\t\t\t\tlayer.movie = symbol;\r\n\t\t\t\tlayer.mask = layerSpec.mask;\r\n\t\t\t\tvar layerDuration:Float = 0;\r\n\t\t\t\tvar previousKeyframe:Keyframe = null;\r\n\t\t\t\tfor(keyframeSpec in layerSpec.keyframes){\r\n\t\t\t\t\tvar keyframe = new Keyframe();\r\n\t\t\t\t\tkeyframe.prev = previousKeyframe;\r\n\t\t\t\t\tif(previousKeyframe != null) previousKeyframe.next = keyframe;\r\n\t\t\t\t\tkeyframe.layer = layer;\r\n\t\t\t\t\tkeyframe.numFrames = keyframeSpec.duration;\r\n\t\t\t\t\tkeyframe.duration = keyframeSpec.duration * flumpLibrary.frameTime;\r\n\t\t\t\t\tkeyframe.index = keyframeSpec.index;\r\n\r\n\t\t\t\t\tvar time = keyframe.index * flumpLibrary.frameTime;\r\n\t\t\t\t\ttime *= 10;\r\n\t\t\t\t\ttime = Math.floor(time);\r\n\t\t\t\t\ttime /= 10;\r\n\t\t\t\t\tkeyframe.time = time;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(keyframeSpec.ref == null){\r\n\t\t\t\t\t\tkeyframe.isEmpty = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tkeyframe.isEmpty = false;\r\n\t\t\t\t\t\tkeyframe.symbolId = keyframeSpec.ref;\r\n\t\t\t\t\t\tkeyframe.pivot = keyframeSpec.pivot == null ? new Point(0,0) : new Point( keyframeSpec.pivot.x * resolution, keyframeSpec.pivot.y * resolution);\r\n\t\t\t\t\t\tkeyframe.location = keyframeSpec.loc == null ? new Point(0,0) : new Point( keyframeSpec.loc.x * resolution, keyframeSpec.loc.y * resolution);\r\n\t\t\t\t\t\tkeyframe.tweened = keyframeSpec.tweened == false ? false : true;\r\n\t\t\t\t\t\tkeyframe.symbol = null;\r\n\t\t\t\t\t\tkeyframe.scale = keyframeSpec.scale == null ? new Point(1,1) : new Point(keyframeSpec.scale.x, keyframeSpec.scale.y);\r\n\t\t\t\t\t\tkeyframe.skew = keyframeSpec.skew == null ? new Point(0,0) : new Point(keyframeSpec.skew.x, keyframeSpec.skew.y);\r\n\t\t\t\t\t\tkeyframe.alpha = keyframeSpec.alpha == null ? 1 : keyframeSpec.alpha;\r\n\t\t\t\t\t\tkeyframe.tintMultiplier = keyframeSpec.tint == null ? 0 : keyframeSpec.tint[0];\r\n\t\t\t\t\t\tkeyframe.tintColor = keyframeSpec.tint == null ? 0 : Std.parseInt(StringTools.replace(cast(keyframeSpec.tint[1], String), \"#\", \"0x\"));\r\n\t\t\t\t\t\tkeyframe.data = keyframeSpec.data;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tkeyframe.ease = keyframeSpec.ease == null ? 0 : keyframeSpec.ease;\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(layer.keyframes.length == 0) layer.firstKeyframe = keyframe;\r\n\r\n\t\t\t\t\tif(keyframeSpec.label != null){\r\n\t\t\t\t\t\tkeyframe.label = new Label();\r\n\t\t\t\t\t\tkeyframe.label.keyframe = keyframe;\r\n\t\t\t\t\t\tkeyframe.label.name = keyframeSpec.label;\r\n\t\t\t\t\t\tsymbol.labels.set(keyframe.label.name, keyframe.label);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(keyframe.time + keyframe.duration > layer.duration){\r\n\t\t\t\t\t\tlayerDuration = keyframe.time + keyframe.duration;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpendingSymbolAttachments[keyframe] = keyframeSpec.ref;\r\n\t\t\t\t\tlayer.keyframes.push(keyframe);\r\n\t\t\t\t\tpreviousKeyframe = keyframe;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlayer.lastKeyframe = layer.keyframes[layer.keyframes.length - 1];\r\n\t\t\t\tlayer.keyframes[0].prev = layer.lastKeyframe;\r\n\t\t\t\tlayer.lastKeyframe.next = layer.keyframes[0];\r\n\t\t\t\tsymbol.layers.push(layer);\r\n\r\n\t\t\t\tvar allAreEmpty = layer.keyframes.foreach(function(keyframe) return keyframe.isEmpty);\r\n\r\n\t\t\t\tif(allAreEmpty){\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tfor(keyframe in layer.keyframes){\r\n\t\t\t\t\t\tvar hasNonEmptySibling = layer.keyframes.exists(function(checkedKeyframe) return checkedKeyframe.isEmpty == false && checkedKeyframe != keyframe);\r\n\t\t\t\t\t\tif(hasNonEmptySibling){\r\n\t\t\t\t\t\t\tvar checked = keyframe.prev;\r\n\t\t\t\t\t\t\twhile(checked.isEmpty) checked = checked.prev;\r\n\t\t\t\t\t\t\tkeyframe.prevNonEmptyKeyframe = checked;\r\n\r\n\t\t\t\t\t\t\tchecked = keyframe.next;\r\n\t\t\t\t\t\t\twhile(checked.isEmpty) checked = checked.next;\r\n\t\t\t\t\t\t\tkeyframe.nextNonEmptyKeyframe = checked;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tkeyframe.prevNonEmptyKeyframe = keyframe;\r\n\t\t\t\t\t\t\tkeyframe.nextNonEmptyKeyframe = keyframe;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Set up diplay keys\r\n\t\t\t\t\tvar firstNonEmpty = layer.keyframes.find(function(checkedKeyframe) return checkedKeyframe.isEmpty == false);\r\n\t\t\t\t\tif(firstNonEmpty != null) firstNonEmpty.displayKey = new DisplayObjectKey(firstNonEmpty.symbolId);\r\n\t\t\t\t\tvar checked = firstNonEmpty.nextNonEmptyKeyframe;\r\n\t\t\t\t\twhile(checked != firstNonEmpty){\r\n\t\t\t\t\t\tif(checked.symbolId == checked.prevNonEmptyKeyframe.symbolId) checked.displayKey = checked.prevNonEmptyKeyframe.displayKey;\r\n\t\t\t\t\t\telse checked.displayKey = new DisplayObjectKey(checked.symbolId);\r\n\t\t\t\t\t\tchecked = checked.nextNonEmptyKeyframe;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\r\n\t\t\t}\r\n\r\n\t\t\tfunction getHighestFrameNumber(layer:Layer, accum:UInt){\r\n\t\t\t\tvar layerLength = layer.lastKeyframe.index + layer.lastKeyframe.numFrames;\r\n\t\t\t\treturn layerLength > accum\r\n\t\t\t\t\t? layerLength\r\n\t\t\t\t\t: accum;\r\n\t\t\t}\r\n\r\n\t\t\tsymbol.totalFrames = symbol.layers.fold( getHighestFrameNumber, 0 );\r\n\t\t\tsymbol.duration = symbol.totalFrames * flumpLibrary.frameTime;\r\n\r\n\t\t\tvar labels = new Array<Label>();\r\n\t\t\tfor(layer in symbol.layers){\r\n\t\t\t\tfor(keyframe in layer.keyframes){\r\n\t\t\t\t\tif(keyframe.label != null){\r\n\t\t\t\t\t\tlabels.push(keyframe.label);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\thaxe.ds.ArraySort.sort(labels, sortLabel);\r\n\t\t\tfor(i in 0...labels.length){\r\n\t\t\t\tvar nextIndex = i+1;\r\n\t\t\t\tif(nextIndex >= labels.length) nextIndex = 0;\r\n\r\n\t\t\t\tvar label = labels[i];\r\n\t\t\t\tvar nextLabel = labels[nextIndex];\r\n\t\t\t\tlabel.next = nextLabel;\r\n\t\t\t\tnextLabel.prev = label;\r\n\t\t\t}\r\n\t\t\tsymbol.firstLabel = labels[0];\r\n\t\t\tsymbol.lastLabel = labels[labels.length-1];\r\n\t\t\t\r\n\t\t\tmovieSymbols[symbol.name] = symbol;\t\t\t\r\n\t\t}\r\n\r\n\t\tfor(keyframe in pendingSymbolAttachments.keys()){\r\n\t\t\tvar symbolId = pendingSymbolAttachments[keyframe];\r\n\t\t\tkeyframe.symbol = spriteSymbols[symbolId] != null ? spriteSymbols[symbolId] : movieSymbols[symbolId];\r\n\t\t}\r\n\r\n\t\treturn flumpLibrary;\r\n\t}\r\n\r\n\r\n\tprivate static function sortLabel(a:Label, b:Label):Int{\r\n\t\tif(a.keyframe.index < b.keyframe.index) return -1;\r\n\t\telse if(a.keyframe.index > b.keyframe.index) return 1;\r\n\t\treturn 0;\r\n\t}\r\n\r\n\r\n\r\n}","package flump.library;\r\n\r\n\r\nclass Keyframe{\r\n\r\n\tpublic var layer:Layer;\r\n\tpublic var symbolId:String;\r\n\tpublic var pivot:Point;\r\n\t\r\n\tpublic var location:Point;\r\n\tpublic var tweened:Bool;\r\n\r\n\tpublic var index:UInt;\r\n\tpublic var numFrames:UInt;\r\n\r\n\tpublic var time:Float;\r\n\tpublic var duration:Float;\r\n\t\r\n\tpublic var symbol:Symbol;\r\n\tpublic var scale:Point;\r\n\tpublic var skew:Point;\r\n\tpublic var ease:Float;\r\n\tpublic var label:Label;\r\n\tpublic var isEmpty:Bool;\r\n\tpublic var alpha:Float;\r\n\tpublic var data:Dynamic;\r\n\tpublic var tintMultiplier:Float;\r\n\tpublic var tintColor:UInt;\r\n\tpublic var next:Keyframe;\r\n\tpublic var prev:Keyframe;\r\n\tpublic var nextNonEmptyKeyframe:Keyframe;\r\n\tpublic var prevNonEmptyKeyframe:Keyframe;\r\n\tpublic var displayKey:DisplayObjectKey;\r\n\r\n\tpublic function new(){}\r\n\r\n\t// Does the time fall inside of the the keyframe frames\r\n\tpublic function timeInside(time:Float):Bool{\r\n\t\treturn (this.time <= time) && (this.time + duration) > time;\r\n\t}\r\n\r\n\t// Does the range fit inside of the keyframe frames\r\n\tpublic function rangeInside(from:Float, to:Float):Bool{\r\n\t\treturn timeInside(from) && timeInside(to);\r\n\t}\r\n\r\n\t// Does the range intersect with the keyframe frames\r\n\tpublic function rangeIntersect(from:Float, to:Float):Bool{\r\n\t\treturn timeInside(from) || timeInside(to);\r\n\t}\r\n\r\n\t// Does the start of the keyframe frames fall inside the range. (Checks for a range that wraps around)\r\n\tpublic function insideRangeStart(from:Float, to:Float):Bool{\r\n\t\t//if(from > to && to == time) return true;\r\n\t\treturn from <= to \r\n\t\t\t? time > from && time <= to\r\n\t\t\t: time > from || time <= to;\r\n\t}\r\n\r\n\t// Does the end of the keyframe frames fall inside the range. (Checks for a range that wraps around, and assuming backward playback);\r\n\tpublic function insideRangeEnd(from:Float, to:Float):Bool{\r\n\t\tif(from == to && to == time + duration) return true;\r\n\t\treturn from > to\r\n\t\t\t? to <= time + duration && from > time + duration\r\n\t\t\t: to <= time + duration || from > time + duration;\r\n\t}\r\n\r\n}\r\n\r\n","package flump.library;\r\n\r\nclass Label{\r\n\r\n\tpublic var name:String;\r\n\tpublic var keyframe:Keyframe;\r\n\tpublic var next:Label;\r\n\tpublic var prev:Label;\r\n\r\n\tpublic static var LABEL_ENTER:String = \"labelEnter\";\r\n\tpublic static var LABEL_EXIT:String = \"labelExit\";\r\n\tpublic static var LABEL_UPDATE:String = \"labelUpdate\";\r\n\r\n\tpublic function new(){}\r\n\r\n}","package flump.library;\r\nimport flump.filters.AnimateTintFilter;\r\n\r\nclass Layer{\r\n\r\n\tpublic var keyframes = new Array<Keyframe>();\r\n\tpublic var duration:Float;\r\n\tpublic var name:String;\r\n\tpublic var movie:MovieSymbol;\r\n\tpublic var numFrames:UInt;\r\n\tpublic var mask:String;\r\n\tpublic var firstKeyframe:Keyframe;\r\n\tpublic var lastKeyframe:Keyframe;\r\n\tpublic var refAnimatedTint:AnimateTintFilter;\r\n\r\n\tpublic function new(name:String){\r\n\t\tthis.name = name;\r\n\t}\r\n\r\n\r\n\tpublic function getKeyframeForFrame(index:UInt):Keyframe{\r\n\t\tfor(keyframe in keyframes){\r\n\t\t\tif(keyframe.index <= index && keyframe.index + keyframe.numFrames > index){\r\n\t\t\t\treturn keyframe;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\r\n\tpublic function getKeyframeForTime(time:Float){\r\n\t\tvar keyframe = lastKeyframe;\r\n\t\twhile(keyframe.time > time % movie.duration) keyframe = keyframe.prev;\r\n\t\treturn keyframe;\r\n\t}\r\n\r\n}","package flump.library;\r\n\r\n\r\nclass Symbol{\r\n\r\n\tpublic var name:String;\r\n\tpublic var data:Dynamic;\r\n\tpublic var baseClass:String;\r\n\t\r\n\tpublic function new(){}\r\n\r\n}","package flump.library;\r\n\r\nimport flump.library.FlumpLibrary;\r\n\r\n\r\nclass MovieSymbol extends Symbol{\r\n\r\n\tpublic var layers = new Array<Layer>();\r\n\tpublic var labels = new Map<String, Label>();\r\n\tpublic var library:FlumpLibrary;\r\n\r\n\tpublic var duration:Float;\r\n\tpublic var totalFrames:UInt;\r\n\tpublic var firstLabel:Label;\r\n\tpublic var lastLabel:Label;\r\n\r\n\r\n\tpublic function new(){\r\n\t\tsuper();\r\n\t}\r\n\r\n\r\n\tpublic function getLayer(name:String):Layer{\r\n\t\tfor(layer in layers) if(layer.name == name) return layer;\r\n\t\treturn null;\r\n\t}\r\n\r\n\r\n\tpublic function debug(){\r\n\t\tvar largestLayerChars = Lambda.fold(layers, function(layer, result) return layer.name.length > result ? layer.name.length : result, 0);\r\n\r\n\t\tfunction repeat(character, amount){\r\n\t\t\tvar output = \"\";\r\n\t\t\twhile(amount > 0){\r\n\t\t\t\toutput += character;\r\n\t\t\t\tamount--;\r\n\t\t\t}\r\n\t\t\treturn output;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tvar output = \"asdfsadf\\n\";\r\n\r\n\t\toutput += repeat(\" \", largestLayerChars);\t\r\n\t\toutput += \"   \";\r\n\t\tfor(i in 0...totalFrames){\r\n\t\t\tif(i%5 == 0) output += i;\r\n\t\t\telse{\r\n\t\t\t\tif(i % 6 != 0 || i < 10) output += \" \";\r\n\t\t\t}\r\n\t\t}\r\n\t\toutput += \"\\n\";\r\n\r\n\t\toutput += repeat(\" \", largestLayerChars);\t\r\n\t\toutput += \"   \";\r\n\t\tfor(i in 0...totalFrames){\r\n\t\t\tif(i%5 == 0) output += \"\";\r\n\t\t\telse output += \" \";\r\n\t\t}\r\n\t\toutput += \"\\n\";\r\n\r\n\r\n\t\tfor(i in 0...layers.length){\r\n\t\t\tvar layer = layers[i];\r\n\r\n\t\t\toutput += layer.name + repeat(\" \", largestLayerChars-layer.name.length); \r\n\t\t\toutput += \" : \";\r\n\t\t\tfor(keyframe in layer.keyframes){\r\n\t\t\t\tif(keyframe.symbolId != null){\r\n\t\t\t\t\toutput += \"\";\r\n\t\t\t\t\tif(keyframe.tweened) output += repeat(\"\", keyframe.numFrames-1);\r\n\t\t\t\t\telse output += repeat(\"\", keyframe.numFrames-1) ;\r\n\t\t\t\t}else{\r\n\t\t\t\t\toutput += \"\";\r\n\t\t\t\t\toutput += repeat(\"\", keyframe.numFrames-1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\toutput += '\\n';\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n}","package flump.library;\r\n\r\nclass Point{\r\n\r\n\tpublic var x:Float;\r\n\tpublic var y:Float;\r\n\r\n\r\n\tpublic function new(x:Float, y:Float){\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n}","package flump.library;\r\n\r\nclass Rectangle{\r\n\r\n\tpublic var x:Float;\r\n\tpublic var y:Float;\r\n\tpublic var width:Float;\r\n\tpublic var height:Float;\r\n\r\n\r\n\tpublic function new(x:Float, y:Float, width:Float, height:Float){\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t}\r\n\r\n}","package flump.library;\r\n\r\nclass SpriteSymbol extends Symbol{\r\n\r\n\tpublic var texture:String;\r\n\tpublic var origin:Point;\r\n\r\n\r\n\tpublic function new(){\r\n\t\tsuper();\r\n\t}\r\n\r\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tLog primarily provides the `trace()` method, which is invoked upon a call to\n\t`trace()` in Haxe code.\n**/\nclass Log {\n\n\t/**\n\t\tOutputs `v` in a platform-dependent way.\n\n\t\tThe second parameter `infos` is injected by the compiler and contains\n\t\tinformation about the position where the `trace()` call was made.\n\n\t\tThis method can be rebound to a custom function:\n\t\t\tvar oldTrace = haxe.Log.trace; // store old function\n\t\t\thaxe.Log.trace = function(v,infos) { // handle trace }\n\t\t\t...\n\t\t\thaxe.Log.trace = oldTrace;\n\n\t\tIf it is bound to null, subsequent calls to `trace()` will cause an\n\t\texception.\n\t**/\n\tpublic static dynamic function trace( v : Dynamic, ?infos : PosInfos ) : Void {\n\t\t#if flash\n\t\t\t#if (fdb || native_trace)\n\t\t\t\tvar pstr = infos == null ? \"(null)\" : infos.fileName + \":\" + infos.lineNumber;\n\t\t\t\tvar str = flash.Boot.__string_rec(v, \"\");\n\t\t\t\tif( infos != null && infos.customParams != null ) for( v in infos.customParams ) str += \",\" + flash.Boot.__string_rec(v, \"\");\n\t\t\t\tuntyped __global__[\"trace\"](pstr+\": \"+str);\n\t\t\t#else\n\t\t\t\tuntyped flash.Boot.__trace(v,infos);\n\t\t\t#end\n\t\t#elseif neko\n\t\t\tuntyped {\n\t\t\t\t$print(infos.fileName + \":\" + infos.lineNumber + \": \", v);\n\t\t\t\tif( infos.customParams != null ) for( v in infos.customParams ) $print(\",\", v);\n\t\t\t\t$print(\"\\n\");\n\t\t\t}\n\t\t#elseif js\n\t\t\tuntyped js.Boot.__trace(v,infos);\n\t\t#elseif php\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __call__('_hx_trace', v + extra, infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __call__('_hx_trace', v, infos);\n\t\t#elseif cpp\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __trace(v + extra,infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __trace(v,infos);\n\t\t#elseif (cs || java || lua)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + infos.lineNumber + \": \" + v;\n\t\t\t\tif (infos.customParams != null)\n\t\t\t\t{\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\t#if cs\n\t\t\tcs.system.Console.WriteLine(str);\n\t\t\t#elseif java\n\t\t\tuntyped __java__(\"java.lang.System.out.println(str)\");\n\t\t\t#elseif lua\n\t\t\tuntyped __lua__(\"_hx_print({0})\", lua.Boot.__string_rec(str));\n\t\t\t#end\n\t\t#elseif (python)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + Std.string(infos.lineNumber) + \": \" + v;\n\t\t\t\tif (infos.customParams != null) {\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\tpython.Lib.println(str);\n\t\t#elseif hl\n\t\t\tvar pstr = infos == null ? \"(null)\" : infos.fileName + \":\" + infos.lineNumber;\n\t\t\tvar str = Std.string(v);\n\t\t\tif( infos != null && infos.customParams != null ) for( v in infos.customParams ) str += \",\" + Std.string(v);\n\t\t\tSys.println(pstr+\": \"+str);\n\t\t#end\n\t}\n\n\t#if (flash || js)\n\t/**\n\t\tClears the trace output.\n\t**/\n\tpublic static dynamic function clear() : Void {\n\t\t#if flash\n\t\tuntyped flash.Boot.__clear_trace();\n\t\t#elseif js\n\t\tuntyped js.Boot.__clear_trace();\n\t\t#end\n\t}\n\t#end\n\n\t#if flash\n\t/**\n\t\tSets the color of the trace output to `rgb`.\n\t**/\n\tpublic static dynamic function setColor( rgb : Int ) {\n\t\tuntyped flash.Boot.__set_trace_color(rgb);\n\t}\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit\n\tautomatically when main() returns.\n\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#else\n\t\tprivate var event : MainLoop.MainEvent;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\n\t\tAfter creating the Timer instance, it calls `this.run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#else\n\t\t\tvar dt = time_ms / 1000;\n\t\t\tevent = MainLoop.add(function() {\n\t\t\t\t@:privateAccess event.nextRun += dt;\n\t\t\t\trun();\n\t\t\t});\n\t\t\tevent.delay(dt);\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\tif(timer != null) {\n\t\t\t\ttimer.cancel();\n\t\t\t\ttimer = null;\n\t\t\t}\n\t\t\ttask = null;\n\t\t#else\n\t\t\tif( event != null ) {\n\t\t\t\tevent.stop();\n\t\t\t\tevent = null;\n\t\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload override public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.ds;\n\n/**\n\tArraySort provides a stable implementation of merge sort through its `sort`\n\tmethod. It should be used instead of `Array.sort` in cases where the order\n\tof equal elements has to be retained on all targets.\n**/\nclass ArraySort {\n\n\t/**\n\t\tSorts Array `a` according to the comparison function `cmp`, where\n\t\t`cmp(x,y)` returns 0 if `x == y`, a positive Int if `x > y` and a\n\t\tnegative Int if `x < y`.\n\n\t\tThis operation modifies Array `a` in place.\n\n\t\tThis operation is stable: The order of equal elements is preserved.\n\n\t\tIf `a` or `cmp` are null, the result is unspecified.\n\t**/\n\tstatic public function sort<T>(a:Array<T>, cmp:T -> T -> Int) {\n\t\trec(a, cmp, 0, a.length);\n\t}\n\n\tstatic function rec<T>(a:Array<T>, cmp, from, to) {\n\t\tvar middle = (from + to) >> 1;\n\t\tif (to - from < 12) {\n\t\t\tif (to <= from) return;\n\t\t\tfor (i in (from + 1)...to) {\n\t\t\t\tvar j = i;\n\t\t\t\twhile (j > from) {\n\t\t\t\t\tif (compare(a, cmp, j, j - 1) < 0)\n\t\t\t\t\t\tswap(a, j - 1, j);\n\t\t\t\t\telse\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tj--;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\trec(a, cmp, from, middle);\n\t\trec(a, cmp, middle, to);\n\t\tdoMerge(a, cmp, from, middle, to, middle - from, to - middle);\n\t}\n\n\tstatic function doMerge<T>(a:Array<T>, cmp, from, pivot, to, len1, len2) {\n\t\tvar first_cut, second_cut, len11, len22, new_mid;\n\t\tif (len1 == 0 || len2 == 0)\n\t\t\treturn;\n\t\tif (len1 + len2 == 2) {\n\t\t\tif (compare(a, cmp, pivot, from) < 0)\n\t\t\t\tswap(a, pivot, from);\n\t\t\treturn;\n\t\t}\n\t\tif (len1 > len2) {\n\t\t\tlen11 = len1 >> 1;\n\t\t\tfirst_cut = from + len11;\n\t\t\tsecond_cut = lower(a, cmp, pivot, to, first_cut);\n\t\t\tlen22 = second_cut - pivot;\n\t\t} else {\n\t\t\tlen22 = len2 >> 1;\n\t\t\tsecond_cut = pivot + len22;\n\t\t\tfirst_cut = upper(a, cmp, from, pivot, second_cut);\n\t\t\tlen11 = first_cut - from;\n\t\t}\n\t\trotate(a, cmp, first_cut, pivot, second_cut);\n\t\tnew_mid = first_cut + len22;\n\t\tdoMerge(a, cmp, from, first_cut, new_mid, len11, len22);\n\t\tdoMerge(a, cmp, new_mid, second_cut, to, len1 - len11, len2 - len22);\n\t}\n\n\tstatic function rotate<T>(a:Array<T>, cmp, from, mid, to) {\n\t\tvar n;\n\t\tif (from == mid || mid == to) return;\n\t\tn = gcd(to - from, mid - from);\n\t\twhile (n-- != 0) {\n\t\t\tvar val = a[from + n];\n\t\t\tvar shift = mid - from;\n\t\t\tvar p1 = from + n, p2 = from + n + shift;\n\t\t\twhile (p2 != from + n) {\n\t\t\t\ta[p1] = a[p2];\n\t\t\t\tp1 = p2;\n\t\t\t\tif (to - p2 > shift) p2 += shift;\n\t\t\t\telse p2 = from + (shift - (to - p2));\n\t\t\t}\n\t\t\ta[p1] = val;\n\t\t}\n\t}\n\n\tstatic function gcd(m, n) {\n\t\twhile (n != 0) {\n\t\t\tvar t = m % n;\n\t\t\tm = n;\n\t\t\tn = t;\n\t\t}\n\t\treturn m;\n\t}\n\n\tstatic function upper<T>(a:Array<T>, cmp, from, to, val) {\n\t\tvar len = to - from, half, mid;\n\t\twhile (len > 0) {\n\t\t\thalf = len >> 1;\n\t\t\tmid = from + half;\n\t\t\tif (compare(a, cmp, val, mid) < 0)\n\t\t\t\tlen = half;\n\t\t\telse {\n\t\t\t\tfrom = mid + 1;\n\t\t\t\tlen = len - half - 1;\n\t\t\t}\n\t\t}\n\t\treturn from;\n\t}\n\n\tstatic function lower<T>(a:Array<T>, cmp, from, to, val) {\n\t\tvar len = to - from, half, mid;\n\t\twhile (len > 0) {\n\t\t\thalf = len >> 1;\n\t\t\tmid = from + half;\n\t\t\tif (compare(a, cmp, mid, val) < 0) {\n\t\t\t\tfrom = mid + 1;\n\t\t\t\tlen = len - half - 1;\n\t\t\t} else\n\t\t\t\tlen = half;\n\t\t}\n\t\treturn from;\n\t}\n\n\tstatic function swap<T>(a:Array<T>, i, j) {\n\t\tvar tmp = a[i];\n\t\ta[i] = a[j];\n\t\ta[j] = tmp;\n\t}\n\n\tstatic inline function compare<T>(a:Array<T>, cmp, i, j) {\n\t\treturn cmp(a[i], a[j]);\n\t}\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n@:coreApi class IntMap<T> implements haxe.Constraints.IMap<Int,T> {\n\n\tprivate var h : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tpublic inline function set( key : Int, value : T ) : Void {\n\t\tuntyped h[key] = value;\n\t}\n\n\tpublic inline function get( key : Int ) : Null<T> {\n\t\treturn untyped h[key];\n\t}\n\n\tpublic inline function exists( key : Int ) : Bool {\n\t\treturn untyped h.hasOwnProperty(key);\n\t}\n\n\tpublic function remove( key : Int ) : Bool {\n\t\tif( untyped !h.hasOwnProperty(key) ) return false;\n\t\tuntyped  __js__(\"delete\")(h[key]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<Int> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for( var key in {0} ) {1}\", h, if( h.hasOwnProperty(key) ) a.push(key|0));\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<T> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[i]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of h software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and h permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.ds;\n\n@:coreApi\nclass ObjectMap<K:{ }, V> implements haxe.Constraints.IMap<K,V> {\n\n\tstatic var count = 0;\n\n\tstatic inline function assignId(obj: { } ):Int {\n\t\treturn untyped obj.__id__ = ++count;\n\t}\n\n\tstatic inline function getId(obj: { } ):Int {\n\t\treturn untyped obj.__id__;\n\t}\n\n\tvar h : { };\n\n\tpublic function new() : Void {\n\t\th = { __keys__: {} };\n\t}\n\n\tpublic function set(key:K, value:V):Void untyped {\n\t\tvar id : Int = getId(key) || assignId(key);\n\t\th[id] = value;\n\t\th.__keys__[id] = key;\n\t}\n\n\tpublic inline function get(key:K):Null<V> {\n\t\treturn untyped h[getId(key)];\n\t}\n\n\tpublic inline function exists(key:K):Bool {\n\t\treturn untyped h.__keys__[getId(key)] != null;\n\t}\n\n\tpublic function remove( key : K ) : Bool {\n\t\tvar id = getId(key);\n\t\tif ( untyped h.__keys__[id] == null ) return false;\n\t\tuntyped  __js__(\"delete\")(h[id]);\n\t\tuntyped  __js__(\"delete\")(h.__keys__[id]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<K> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h.__keys__ ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(h.__keys__[key]);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<V> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[getId(i)]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(Std.string(i));\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\nprivate class StringMapIterator<T> {\n\tvar map : StringMap<T>;\n\tvar keys : Array<String>;\n\tvar index : Int;\n\tvar count : Int;\n\tpublic inline function new(map:StringMap<T>, keys:Array<String>) {\n\t\tthis.map = map;\n\t\tthis.keys = keys;\n\t\tthis.index = 0;\n\t\tthis.count = keys.length;\n\t}\n\tpublic inline function hasNext() {\n\t\treturn index < count;\n\t}\n\tpublic inline function next() {\n\t\treturn map.get(keys[index++]);\n\t}\n}\n\n@:coreApi class StringMap<T> implements haxe.Constraints.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\tprivate var rh : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tinline function isReserved(key:String) : Bool {\n\t\treturn untyped __js__(\"__map_reserved\")[key] != null;\n\t}\n\n\tpublic inline function set( key : String, value : T ) : Void {\n\t\tif( isReserved(key) )\n\t\t\tsetReserved(key, value);\n\t\telse\n\t\t\th[cast key] = value;\n\t}\n\n\tpublic inline function get( key : String ) : Null<T> {\n\t\tif( isReserved(key) )\n\t\t\treturn getReserved(key);\n\t\treturn h[cast key];\n\t}\n\n\tpublic inline function exists( key : String ) : Bool {\n\t\tif( isReserved(key) )\n\t\t\treturn existsReserved(key);\n\t\treturn h.hasOwnProperty(key);\n\t}\n\n\tfunction setReserved( key : String, value : T ) : Void {\n\t\tif( rh == null ) rh = {};\n\t\trh[cast \"$\"+key] = value;\n\t}\n\n\tfunction getReserved( key : String ) : Null<T> {\n\t\treturn rh == null ? null : rh[cast \"$\"+key];\n\t}\n\n\tfunction existsReserved( key : String ) : Bool {\n\t\tif( rh == null ) return false;\n\t\treturn untyped rh.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tif( isReserved(key) ) {\n\t\t\tkey = \"$\" + key;\n\t\t\tif( rh == null || !rh.hasOwnProperty(key) ) return false;\n\t\t\tuntyped __js__(\"delete\")(rh[key]);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( !h.hasOwnProperty(key) )\n\t\t\t\treturn false;\n\t\t\tuntyped __js__(\"delete\")(h[key]);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\treturn arrayKeys().iterator();\n\t}\n\t\n\tfunction arrayKeys() : Array<String> {\n\t\tvar out = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\tout.push(key);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\tif( rh != null ) untyped {\n\t\t\t__js__(\"for( var key in this.rh ) {\");\n\t\t\t\tif( key.charCodeAt(0) == \"$\".code )\n\t\t\t\t\tout.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn out;\n\t}\n\n\tpublic inline function iterator() : Iterator<T> {\n\t\treturn new StringMapIterator(this, arrayKeys());\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar keys = arrayKeys();\n\t\tfor( i in 0...keys.length ) {\n\t\t\tvar k = keys[i];\n\t\t\ts.add(k);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(k)));\n\t\t\tif( i < keys.length-1 )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __js__(\"var __map_reserved = {}\");\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.xml;\n\nusing StringTools;\n\n/* poor'man enum : reduce code size + a bit faster since inlined */\nextern private class S {\n\tpublic static inline var IGNORE_SPACES \t= 0;\n\tpublic static inline var BEGIN\t\t\t= 1;\n\tpublic static inline var BEGIN_NODE\t\t= 2;\n\tpublic static inline var TAG_NAME\t\t= 3;\n\tpublic static inline var BODY\t\t\t= 4;\n\tpublic static inline var ATTRIB_NAME\t= 5;\n\tpublic static inline var EQUALS\t\t\t= 6;\n\tpublic static inline var ATTVAL_BEGIN\t= 7;\n\tpublic static inline var ATTRIB_VAL\t\t= 8;\n\tpublic static inline var CHILDS\t\t\t= 9;\n\tpublic static inline var CLOSE\t\t\t= 10;\n\tpublic static inline var WAIT_END\t\t= 11;\n\tpublic static inline var WAIT_END_RET\t= 12;\n\tpublic static inline var PCDATA\t\t\t= 13;\n\tpublic static inline var HEADER\t\t\t= 14;\n\tpublic static inline var COMMENT\t\t= 15;\n\tpublic static inline var DOCTYPE\t\t= 16;\n\tpublic static inline var CDATA\t\t\t= 17;\n\tpublic static inline var ESCAPE\t\t\t= 18;\n}\n\nclass XmlParserException\n{\n\t/**\n\t * the XML parsing error message\n\t */\n\tpublic var message:String;\n\t\n\t/**\n\t * the line number at which the XML parsing error occured\n\t */\n\tpublic var lineNumber:Int;\n\t\n\t/**\n\t * the character position in the reported line at which the parsing error occured\n\t */\n\tpublic var positionAtLine:Int;\n\t\n\t/**\n\t * the character position in the XML string at which the parsing error occured\n\t */\n\tpublic var position:Int;\n\t\n\t/**\n\t * the invalid XML string\n\t */\n\tpublic var xml:String;\n\t\n\tpublic function new(message:String, xml:String, position:Int)\n\t{\n\t\tthis.xml = xml;\n\t\tthis.message = message;\n\t\tthis.position = position;\n\t\tlineNumber = 1;\n\t\tpositionAtLine = 0;\n\t\t\n\t\tfor( i in 0...position)\n\t\t{\n\t\t\tvar c = xml.fastCodeAt(i);\n\t\t\tif (c == '\\n'.code) {\n\t\t\t\tlineNumber++;\n\t\t\t\tpositionAtLine = 0;\n\t\t\t} else {\n\t\t\t\tif (c != '\\r'.code) positionAtLine++;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic function toString():String\n\t{\n\t\treturn Type.getClassName(Type.getClass(this)) + \": \" + message + \" at line \" + lineNumber + \" char \" + positionAtLine;\n\t}\n}\n\nclass Parser\n{\n\tstatic var escapes = {\n\t\tvar h = new haxe.ds.StringMap();\n\t\th.set(\"lt\", \"<\");\n\t\th.set(\"gt\", \">\");\n\t\th.set(\"amp\", \"&\");\n\t\th.set(\"quot\", '\"');\n\t\th.set(\"apos\", \"'\");\n\t\th;\n\t}\n\n\t/**\n\t * Parses the String into an XML Document. Set strict parsing to true in order to enable a strict check of XML attributes and entities.\n\t * \n\t * @throws haxe.xml.XmlParserException\n\t */\n\tstatic public function parse(str:String, strict = false)\n\t{\n\t\tvar doc = Xml.createDocument();\n\t\tdoParse(str, strict, 0, doc);\n\t\treturn doc;\n\t}\n\n\tstatic function doParse(str:String, strict:Bool, p:Int = 0, ?parent:Xml):Int\n\t{\n\t\tvar xml:Xml = null;\n\t\tvar state = S.BEGIN;\n\t\tvar next = S.BEGIN;\n\t\tvar aname = null;\n\t\tvar start = 0;\n\t\tvar nsubs = 0;\n\t\tvar nbrackets = 0;\n\t\tvar c = str.fastCodeAt(p);\n\t\tvar buf = new StringBuf();\n\t\t// need extra state because next is in use\n\t\tvar escapeNext = S.BEGIN;\n\t\tvar attrValQuote = -1;\n\t\tinline function addChild(xml:Xml) {\n\t\t\tparent.addChild(xml);\n\t\t\tnsubs++;\n\t\t}\n\t\twhile (!StringTools.isEof(c))\n\t\t{\n\t\t\tswitch(state)\n\t\t\t{\n\t\t\t\tcase S.IGNORE_SPACES:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase\n\t\t\t\t\t\t\t'\\n'.code,\n\t\t\t\t\t\t\t'\\r'.code,\n\t\t\t\t\t\t\t'\\t'.code,\n\t\t\t\t\t\t\t' '.code:\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = next;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.BEGIN:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '<'.code:\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.BEGIN_NODE;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tstate = S.PCDATA;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.PCDATA:\n\t\t\t\t\tif (c == '<'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\tvar child = Xml.createPCData(buf.toString());\n\t\t\t\t\t\tbuf = new StringBuf();\n\t\t\t\t\t\taddChild(child);\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.BEGIN_NODE;\n\t\t\t\t\t} else if (c == '&'.code) {\n\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\tstate = S.ESCAPE;\n\t\t\t\t\t\tescapeNext = S.PCDATA;\n\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t}\n\t\t\t\tcase S.CDATA:\n\t\t\t\t\tif (c == ']'.code && str.fastCodeAt(p + 1) == ']'.code && str.fastCodeAt(p + 2) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar child = Xml.createCData(str.substr(start, p - start));\n\t\t\t\t\t\taddChild(child);\n\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.BEGIN_NODE:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '!'.code:\n\t\t\t\t\t\t\tif (str.fastCodeAt(p + 1) == '['.code)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\t\t\tif (str.substr(p, 6).toUpperCase() != \"CDATA[\")\n\t\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected <![CDATA[\", str, p);\n\t\t\t\t\t\t\t\tp += 5;\n\t\t\t\t\t\t\t\tstate = S.CDATA;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (str.fastCodeAt(p + 1) == 'D'.code || str.fastCodeAt(p + 1) == 'd'.code)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(str.substr(p + 2, 6).toUpperCase() != \"OCTYPE\")\n\t\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected <!DOCTYPE\", str, p);\n\t\t\t\t\t\t\t\tp += 8;\n\t\t\t\t\t\t\t\tstate = S.DOCTYPE;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if( str.fastCodeAt(p + 1) != '-'.code || str.fastCodeAt(p + 2) != '-'.code )\n\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected <!--\", str, p);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\t\t\tstate = S.COMMENT;\n\t\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tcase '?'.code:\n\t\t\t\t\t\t\tstate = S.HEADER;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\tcase '/'.code:\n\t\t\t\t\t\t\tif( parent == null )\n\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected node name\", str, p);\n\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.CLOSE;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = S.TAG_NAME;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.TAG_NAME:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tif( p == start )\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected node name\", str, p);\n\t\t\t\t\t\txml = Xml.createElement(str.substr(start, p - start));\n\t\t\t\t\t\taddChild(xml);\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.BODY;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.BODY:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '/'.code:\n\t\t\t\t\t\t\tstate = S.WAIT_END;\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tstate = S.CHILDS;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = S.ATTRIB_NAME;\n\t\t\t\t\t\t\tstart = p;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTRIB_NAME:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\tif( start == p )\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected attribute name\", str, p);\n\t\t\t\t\t\ttmp = str.substr(start,p-start);\n\t\t\t\t\t\taname = tmp;\n\t\t\t\t\t\tif( xml.exists(aname) )\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Duplicate attribute [\" + aname + \"]\", str, p);\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.EQUALS;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.EQUALS:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '='.code:\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.ATTVAL_BEGIN;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected =\", str, p);\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTVAL_BEGIN:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '\"'.code | '\\''.code:\n\t\t\t\t\t\t\tbuf = new StringBuf();\n\t\t\t\t\t\t\tstate = S.ATTRIB_VAL;\n\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\t\tattrValQuote = c;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected \\\"\", str, p);\n\t\t\t\t\t}\n\t\t\t\tcase S.ATTRIB_VAL:\n\t\t\t\t\tswitch (c) {\n\t\t\t\t\t\tcase '&'.code:\n\t\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\t\tstate = S.ESCAPE;\n\t\t\t\t\t\t\tescapeNext = S.ATTRIB_VAL;\n\t\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\tcase '>'.code | '<'.code if( strict ):\n\t\t\t\t\t\t\t// HTML allows these in attributes values\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Invalid unescaped \" + String.fromCharCode(c) + \" in attribute value\", str, p);\n\t\t\t\t\t\tcase _ if (c == attrValQuote):\n\t\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\t\tvar val = buf.toString();\n\t\t\t\t\t\t\tbuf = new StringBuf();\n\t\t\t\t\t\t\txml.set(aname, val);\n\t\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\t\tnext = S.BODY;\n\t\t\t\t\t}\n\t\t\t\tcase S.CHILDS:\n\t\t\t\t\tp = doParse(str, strict, p, xml);\n\t\t\t\t\tstart = p;\n\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\tcase S.WAIT_END:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t\tdefault :\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected >\", str, p);\n\t\t\t\t\t}\n\t\t\t\tcase S.WAIT_END_RET:\n\t\t\t\t\tswitch(c)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase '>'.code:\n\t\t\t\t\t\t\tif( nsubs == 0 )\n\t\t\t\t\t\t\t\tparent.addChild(Xml.createPCData(\"\"));\n\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\tdefault :\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected >\", str, p);\n\t\t\t\t\t}\n\t\t\t\tcase S.CLOSE:\n\t\t\t\t\tif (!isValidChar(c))\n\t\t\t\t\t{\n\t\t\t\t\t\tif( start == p )\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected node name\", str, p);\n\n\t\t\t\t\t\tvar v = str.substr(start,p - start);\n\t\t\t\t\t\tif (v != parent.nodeName)\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Expected </\" +parent.nodeName + \">\", str, p);\n\n\t\t\t\t\t\tstate = S.IGNORE_SPACES;\n\t\t\t\t\t\tnext = S.WAIT_END_RET;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\tcase S.COMMENT:\n\t\t\t\t\tif (c == '-'.code && str.fastCodeAt(p +1) == '-'.code && str.fastCodeAt(p + 2) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\taddChild(Xml.createComment(str.substr(start, p - start)));\n\t\t\t\t\t\tp += 2;\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.DOCTYPE:\n\t\t\t\t\tif(c == '['.code)\n\t\t\t\t\t\tnbrackets++;\n\t\t\t\t\telse if(c == ']'.code)\n\t\t\t\t\t\tnbrackets--;\n\t\t\t\t\telse if (c == '>'.code && nbrackets == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\taddChild(Xml.createDocType(str.substr(start, p - start)));\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.HEADER:\n\t\t\t\t\tif (c == '?'.code && str.fastCodeAt(p + 1) == '>'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tp++;\n\t\t\t\t\t\tvar str = str.substr(start + 1, p - start - 2);\n\t\t\t\t\t\taddChild(Xml.createProcessingInstruction(str));\n\t\t\t\t\t\tstate = S.BEGIN;\n\t\t\t\t\t}\n\t\t\t\tcase S.ESCAPE:\n\t\t\t\t\tif (c == ';'.code)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar s = str.substr(start, p - start);\n\t\t\t\t\t\tif (s.fastCodeAt(0) == '#'.code) {\n\t\t\t\t\t\t\tvar c = s.fastCodeAt(1) == 'x'.code\n\t\t\t\t\t\t\t\t? Std.parseInt(\"0\" +s.substr(1, s.length - 1))\n\t\t\t\t\t\t\t\t: Std.parseInt(s.substr(1, s.length - 1));\n\t\t\t\t\t\t\t#if (neko || cpp || php || lua)\n\t\t\t\t\t\t\tif( c >= 128 ) {\n\t\t\t\t\t\t\t\t// UTF8-encode it\n\t\t\t\t\t\t\t\tif( c <= 0x7FF ) {\n\t\t\t\t\t\t\t\t\tbuf.addChar(0xC0 | (c >> 6));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | (c & 63));\n\t\t\t\t\t\t\t\t} else if( c <= 0xFFFF ) {\n\t\t\t\t\t\t\t\t\tbuf.addChar(0xE0 | (c >> 12));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | ((c >> 6) & 63));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | (c & 63));\n\t\t\t\t\t\t\t\t} else if( c <= 0x10FFFF ) {\n\t\t\t\t\t\t\t\t\tbuf.addChar(0xF0 | (c >> 18));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | ((c >> 12) & 63));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | ((c >> 6) & 63));\n\t\t\t\t\t\t\t\t\tbuf.addChar(0x80 | (c & 63));\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Cannot encode UTF8-char \" + c, str, p);\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t#end\n\t\t\t\t\t\t\tbuf.addChar(c);\n\t\t\t\t\t\t} else if (!escapes.exists(s)) {\n\t\t\t\t\t\t\tif( strict )\n\t\t\t\t\t\t\t\tthrow new XmlParserException(\"Undefined entity: \" + s, str, p);\n\t\t\t\t\t\t\tbuf.add('&$s;');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuf.add(escapes.get(s));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\tstate = escapeNext;\n\t\t\t\t\t} else if (!isValidChar(c) && c != \"#\".code) {\n\t\t\t\t\t\tif( strict )\n\t\t\t\t\t\t\tthrow new XmlParserException(\"Invalid character in entity: \" + String.fromCharCode(c), str, p);\n\t\t\t\t\t\tbuf.addChar(\"&\".code);\n\t\t\t\t\t\tbuf.addSub(str, start, p - start);\n\t\t\t\t\t\tp--;\n\t\t\t\t\t\tstart = p + 1;\n\t\t\t\t\t\tstate = escapeNext;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tc = str.fastCodeAt(++p);\n\t\t}\n\n\t\tif (state == S.BEGIN)\n\t\t{\n\t\t\tstart = p;\n\t\t\tstate = S.PCDATA;\n\t\t}\n\n\t\tif (state == S.PCDATA)\n\t\t{\n\t\t\tif (p != start || nsubs == 0) {\n\t\t\t\tbuf.addSub(str, start, p-start);\n\t\t\t\taddChild(Xml.createPCData(buf.toString()));\n\t\t\t}\n\t\t\treturn p;\n\t\t}\n\n\t\tif( !strict && state == S.ESCAPE && escapeNext == S.PCDATA ) {\n\t\t\tbuf.addChar(\"&\".code);\n\t\t\tbuf.addSub(str, start, p - start);\n\t\t\taddChild(Xml.createPCData(buf.toString()));\n\t\t\treturn p;\n\t\t}\n\n\t\tthrow new XmlParserException(\"Unexpected end\", str, p);\n\t}\n\n\tstatic inline function isValidChar(c) {\n\t\treturn (c >= 'a'.code && c <= 'z'.code) || (c >= 'A'.code && c <= 'Z'.code) || (c >= '0'.code && c <= '9'.code) || c == ':'.code || c == '.'.code || c == '_'.code || c == '-'.code;\n\t}\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nprivate class HaxeError extends js.Error {\n\n\tvar val:Dynamic;\n\n\tpublic function new(val:Dynamic) untyped {\n\t\tsuper();\n\t\tthis.val = __define_feature__(\"js.Boot.HaxeError\", val);\n\t\tthis.message = String(val);\n\t\tif (js.Error.captureStackTrace) js.Error.captureStackTrace(this, HaxeError);\n\t}\n\n\tpublic static function wrap(val:Dynamic):Dynamic untyped {\n\t\treturn if (__instanceof__(val, js.Error)) val else new HaxeError(val);\n\t}\n}\n\n@:dox(hide)\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") && __typeof__(tostr) == \"function\" ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\" && untyped __js__(\"(o|0) === o\");\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if ( (untyped __js__(\"typeof\"))(cl) == \"object\" && __isNativeObj(cl) ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n\tstatic var __toStr = untyped ({}).toString;\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name = untyped __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) {\n\t\treturn untyped js.Lib.global[name];\n\t}\n\n}\n","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nimport js.html.Storage;\nimport js.html.XMLHttpRequest;\n\nclass Browser {\n\t/** The global window object. */\n\tpublic static var window(get, never):js.html.Window;\n\tinline static function get_window() return untyped __js__(\"window\");\n\n\t/** Shortcut to Window.document. */\n\tpublic static var document(get, never):js.html.HTMLDocument;\n\tinline static function get_document() return untyped __js__(\"window.document\");\n\n\t/** Shortcut to Window.location. */\n\tpublic static var location(get, never):js.html.Location;\n\tinline static function get_location() return untyped __js__(\"window.location\");\n\n\t/** Shortcut to Window.navigator. */\n\tpublic static var navigator(get, never):js.html.Navigator;\n\tinline static function get_navigator() return untyped __js__(\"window.navigator\");\n\n\t/** Shortcut to Window.console. */\n\tpublic static var console(get, never):js.html.Console;\n\tinline static function get_console() return untyped __js__(\"window.console\");\n\n\t/**\n\t * True if a window object exists, false otherwise.\n\t *\n\t * This can be used to check if the code is being executed in a non-browser\n\t * environment such as node.js.\n\t */\n\tpublic static var supported(get, never):Bool;\n\tinline static function get_supported() return untyped __typeof__(window) != \"undefined\";\n\n\t/**\n\t * Safely gets the browser's local storage, or returns null if localStorage is unsupported or\n\t * disabled.\n\t */\n\tpublic static function getLocalStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.localStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Safely gets the browser's session storage, or returns null if sessionStorage is unsupported\n\t * or disabled.\n\t */\n\tpublic static function getSessionStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.sessionStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Creates an XMLHttpRequest, with a fallback to ActiveXObject for ancient versions of Internet\n\t * Explorer.\n\t */\n\tpublic static function createXMLHttpRequest() : XMLHttpRequest\n\t{\n\t\tif( untyped __js__(\"typeof XMLHttpRequest\") != \"undefined\" ) {\n\t\t\treturn new XMLHttpRequest();\n\t\t}\n\t\tif( untyped __js__(\"typeof ActiveXObject\") != \"undefined\" ) {\n\t\t\treturn untyped __new__(\"ActiveXObject\",\"Microsoft.XMLHTTP\");\n\t\t}\n\t\tthrow \"Unable to create XMLHttpRequest object.\";\n\t}\n\n\t/**\n\t\tDisplay an alert message box containing the given message. See also `Window.alert()`.\n\t**/\n\tpublic static function alert( v : Dynamic ) {\n\t\t@:privateAccess window.alert(Boot.__string_rec(v,\"\"));\n\t}\n}\n","package pixi.flump;\r\n\r\nimport flump.*;\r\nimport flump.filters.AnimateTintFilter;\r\nimport flump.library.*;\r\nimport pixi.core.display.Container;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.graphics.Graphics;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.core.sprites.Sprite;\r\nimport pixi.core.ticker.Ticker;\r\nimport pixi.flump.Resource;\r\n\r\n\r\n@:access(pixi.flump.Resource)\r\nclass Movie extends Container implements IFlumpMovie {\r\n\r\n\tpublic var player:MoviePlayer;\r\n\tprivate var symbol:MovieSymbol;\r\n\tprivate var layers = new Map<Layer, Container>();\r\n\tprivate var layerLookup = new Map<String, Container>();\r\n\tprivate var movieChildren = new Map<DisplayObjectKey, DisplayObject>();\r\n\tprivate var displaying = new Map<Layer, DisplayObjectKey>();\r\n\tprivate var ticker:Ticker = untyped __js__ (\"PIXI.ticker.shared\");\r\n\tprivate var master:Bool;\r\n\r\n\tprivate var resolution:Float;\r\n\tprivate var resource:Resource;\r\n\tprivate var resourceId:String;\r\n\r\n\tpublic function new(symbolId:String, resourceId:String = null){\r\n\t\t\r\n\t\tsuper();\r\n\t\tthis.resourceId = resourceId;\r\n\r\n\t\tif(resourceId == null){\r\n\t\t\tresource = Resource.getResourceForMovie(symbolId);\r\n\t\t\tif(resource == null) throw(\"Flump movie does not exist: \" + symbolId);\r\n\t\t}else{\r\n\t\t\tresource = Resource.get(resourceId);\r\n\t\t\tif(resource == null) throw(\"Flump resource does not exist: \" + resourceId);\r\n\t\t}\r\n\r\n\t\tthis.resolution = resource.resolution;\r\n\r\n\t\tthis.symbol = resource.library.movies.get(symbolId);\r\n\t\t\r\n\t\tplayer = new MoviePlayer(symbol, this, resolution);\t\r\n\t\tthis.loop = true;\r\n\r\n\t\tmaster = true;\r\n\t\tonce(\"added\", onAdded);\r\n\t}\r\n\r\n\r\n\tprivate function disableAsMaster(){\r\n\t\tmaster = false;\r\n\t\toff(\"added\", onAdded);\r\n\t}\r\n\r\n\r\n\t/////////////////////////////////////////////////////\r\n\t//\r\n\t//   API\r\n\t//\r\n\t/////////////////////////////////////////////////////\r\n\r\n\tpublic var animationSpeed(default, default):Float = 1.0;\r\n\r\n\tpublic var resX(get, set):Float;\r\n\tpublic function get_resX():Float{\r\n\t\treturn x / resolution;\r\n\t}\r\n\tpublic function set_resX(value:Float):Float{\r\n\t\tx = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resY(get, set):Float;\r\n\tpublic function get_resY():Float{\r\n\t\treturn y / resolution;\r\n\t}\r\n\tpublic function set_resY(value:Float):Float{\r\n\t\ty = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resScaleX(get, set):Float;\r\n\tpublic function get_resScaleX():Float{\r\n\t\treturn scale.x / resolution;\r\n\t}\r\n\tpublic function set_resScaleX(value:Float):Float{\r\n\t\tscale.x = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resScaleY(get, set):Float;\r\n\tpublic function get_resScaleY():Float{\r\n\t\treturn scale.y / resolution;\r\n\t}\r\n\tpublic function set_resScaleY(value:Float):Float{\r\n\t\tscale.y = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\t\r\n\tpublic function getLayer(layerId:String):Container{\r\n\t\tif(layerLookup.exists(layerId) == false) throw(\"Layer \" + layerId + \"does not exist\");\r\n\t\treturn layerLookup[layerId];\r\n\t}\r\n\r\n\r\n\tpublic function getChildDisplayObject(layerId:String, keyframeIndex:UInt = 0):DisplayObject{\r\n\t\tvar key = player.getDisplayKey(layerId, keyframeIndex);\r\n\t\treturn movieChildren[key];\r\n\t}\r\n\r\n\r\n\tpublic function getChildMovie(layerId, keyframeIndex:UInt = 0):Movie{\r\n\t\tvar child = getChildDisplayObject(layerId, keyframeIndex);\r\n\t\tif(Std.is(child, Movie) == false) throw(\"Child on layer \" + layerId + \" at keyframeIndex \" + keyframeIndex + \" is not of type flump.Movie!\");\r\n\t\treturn cast child;\r\n\t}\r\n\r\n\r\n\tpublic var symbolId(get, null):String;\r\n\tprivate function get_symbolId(){\r\n\t\treturn symbol.name;\r\n\t}\r\n\r\n\tpublic var loop(default, set):Bool;\r\n\tprivate function set_loop(value){\r\n\t\tif(value && player.playing) player.loop();\r\n\t\telse if(value == false && player.looping) player.play();\r\n\t\treturn loop = value;\r\n\t}\r\n\r\n\r\n\tpublic var onComplete(default, set):Void -> Void;\r\n\tprivate function set_onComplete(value){\r\n\t\treturn onComplete = value;\r\n\t}\r\n\r\n\tpublic var currentFrame(get, set):Int;\r\n\tprivate function set_currentFrame(value){\r\n\t\tplayer.currentFrame = value;\r\n\t\treturn value;\r\n\t}\r\n\tprivate function get_currentFrame():Int{\r\n\t\treturn player.currentFrame;\r\n\t}\r\n\r\n\tpublic var playing(get, null):Bool;\r\n\tprivate function get_playing(){\r\n\t\treturn player.playing || player.looping;\r\n\t}\r\n\r\n\r\n\tpublic var independantTimeline(get, set):Bool;\r\n\tprivate function get_independantTimeline(){\r\n\t\treturn player.independantTimeline;\r\n\t}\r\n\tprivate function set_independantTimeline(value:Bool){\r\n\t\tplayer.independantTimeline = value;\r\n\t\treturn value;\r\n\t}\r\n\r\n\r\n\tpublic var independantControl(get, set):Bool;\r\n\tprivate function get_independantControl(){\r\n\t\treturn player.independantControl;\r\n\t}\r\n\tprivate function set_independantControl(value:Bool){\r\n\t\tplayer.independantControl = value;\r\n\t\treturn value;\r\n\t}\r\n\r\n\r\n\tpublic var totalFrames(get, null):Int;\r\n\t\r\n\tpublic var tint(default, set):Int;\r\n\t\r\n\tprivate function get_totalFrames() {\r\n\t\treturn player.totalFrames;\r\n\t}\r\n\t\r\n\tprivate function set_tint(pTint:Int):Int {\r\n\t\tfor (child in movieChildren) {\r\n\t\t\tif (Std.is(child, pixi.flump.Sprite)) {\r\n\t\t\t\tcast(child, pixi.flump.Sprite).tint = pTint;\r\n\t\t\t} else if (Std.is(child, pixi.flump.Movie)) {\r\n\t\t\t\tcast(child, pixi.flump.Movie).tint = pTint;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn tint = pTint;\r\n\t}\r\n\r\n\r\n\tpublic function stop():Void{\r\n\t\tplayer.stop();\r\n\t}\r\n\r\n\r\n\tpublic function play():Void{\r\n\t\tif(loop) player.loop();\r\n\t\telse player.play();\r\n\t}\r\n\r\n\r\n\tpublic function gotoAndStop(frameNumber:Int):Void{\r\n\t\tif(!loop){\r\n\t\t\tif(frameNumber > player.totalFrames-1) frameNumber = player.totalFrames - 1;\r\n\t\t\telse if(frameNumber < 0) frameNumber = 0;\r\n\t\t}\r\n\t\tplayer.goToFrame(frameNumber).stop();\r\n\t}\r\n\r\n\r\n\tpublic function gotoAndPlay(frameNumber:Int):Void{\r\n\t\tif(!loop){\r\n\t\t\tif(frameNumber > player.totalFrames-1) frameNumber = player.totalFrames - 1;\r\n\t\t\telse if(frameNumber < 0) frameNumber = 0;\r\n\t\t}\r\n\t\tif(loop) player.goToFrame(frameNumber).loop();\r\n\t\telse player.goToFrame(frameNumber).play();\r\n\t}\r\n\r\n\r\n\tpublic function getLabelFrame(label:String):UInt{\r\n\t\treturn player.getLabelFrame(label);\r\n\t}\r\n\r\n\r\n\t/////////////////////////////////////////////////////\r\n\t//\r\n\t//   Other\r\n\t//\r\n\t/////////////////////////////////////////////////////\r\n\r\n\tprivate function tick(){\r\n\t\tplayer.advanceTime(ticker.elapsedMS * animationSpeed);\r\n\t}\r\n\r\n\r\n\tprivate function onAdded(to){\r\n\t\tonce(\"removed\", onRemoved);\r\n\t\tticker.add(tick);\r\n\t}\r\n\r\n\r\n\tprivate function onRemoved(from){\r\n\t\tonce(\"added\", onAdded);\r\n\t\tticker.remove(tick);\r\n\t}\r\n\r\n\r\n\r\n\t/////////////////////////////////////////////////////\r\n\t//\r\n\t//   IFlumpMovie\r\n\t//\r\n\t/////////////////////////////////////////////////////\r\n\r\n\t\r\n\t\r\n\tprivate function createLayer(layer:Layer):Void{\r\n\t\tlayers[layer] = new Container();\r\n\t\tlayers[layer].name = layer.name;\r\n\t\tlayerLookup[layer.name] = layers[layer];\r\n\t\taddChild(layers[layer]);\r\n\t}\r\n\r\n\r\n\tprivate function getChildPlayer(keyframe:Keyframe):MoviePlayer{\r\n\t\tvar movie:Movie = cast movieChildren[keyframe.displayKey];\r\n\t\treturn movie.player;\r\n\t}\r\n\r\n\r\n\tprivate function createFlumpChild(displayKey:DisplayObjectKey):Void{\r\n\t\tmovieChildren[displayKey] = resource.createDisplayObject(displayKey.symbolId);\r\n\t}\r\n\r\n\r\n\tprivate function removeFlumpChild(layer:Layer, displayKey:DisplayObjectKey):Void{\r\n\t\tvar layer = layers[layer];\r\n\t\tlayer.removeChildren();\r\n\t}\r\n\r\n\r\n\tprivate function addFlumpChild(layer:Layer, displayKey:DisplayObjectKey):Void{\r\n\t\tvar layer = layers[layer];\r\n\t\tlayer.addChild( movieChildren[displayKey] );\r\n\t}\r\n\r\n\r\n\tprivate function onAnimationComplete():Void{\r\n\t\tif(onComplete != null) onComplete();\r\n\t}\r\n\r\n\r\n\tprivate function renderFrame(keyframe:Keyframe, x:Float, y:Float, scaleX:Float, scaleY:Float, skewX:Float, skewY:Float, alpha:Float, tintMultiplier:Float, tintColor:UInt):Void{\r\n\t\tvar layer\t\t\t: Container\t\t\t= layers[ keyframe.layer];\r\n\t\tvar lChild \t\t\t: DisplayObject\t\t= null;\r\n\t\tvar spriteSymbol\t: SpriteSymbol\t\t= null;\r\n\t\t\r\n\t\tlayer.x\t= x;\r\n\t\tlayer.y\t= y;\r\n\t\t\r\n\t\t// pixi 4 hack :)\r\n\t\t//skewX = -skewX;\r\n\t\t\r\n\t\tif ( master){\r\n\t\t\tlayer.x /= resolution;\r\n\t\t\tlayer.y /= resolution;\r\n\t\t}\r\n\t\t\r\n\t\tif ( layer.children.length > 0){\r\n\t\t\tlChild\t\t\t= layer.getChildAt( 0);\r\n\t\t\tlChild.scale.x\t= scaleX;\r\n\t\t\tlChild.scale.y\t= scaleY;\r\n\t\t\t\r\n\t\t\tif ( master){\r\n\t\t\t\tlChild.scale.x /= resolution;\r\n\t\t\t\tlChild.scale.y /= resolution;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif ( layer.name != \"flipbook\"){\r\n\t\t\tif ( Std.is( keyframe.symbol, SpriteSymbol)){\r\n\t\t\t\tif ( lChild != null){\r\n\t\t\t\t\tspriteSymbol\t= cast keyframe.symbol;\r\n\t\t\t\t\t\r\n\t\t\t\t\tlChild.pivot.x\t= keyframe.pivot.x - spriteSymbol.origin.x;\r\n\t\t\t\t\tlChild.pivot.y\t= keyframe.pivot.y - spriteSymbol.origin.y;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( master){\r\n\t\t\t\t\t\tlChild.pivot.x /= resolution;\r\n\t\t\t\t\t\tlChild.pivot.y /= resolution;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else if ( lChild != null && Std.is( lChild, Container) && cast( lChild, Container).children.length > 0 && cast( lChild, Container).getChildAt( 0).name == \"flipbook\"){\r\n\t\t\t\tlChild.pivot.x\t= keyframe.pivot.x;\r\n\t\t\t\tlChild.pivot.y\t= keyframe.pivot.y;\r\n\t\t\t\t\r\n\t\t\t\tif ( master){\r\n\t\t\t\t\tlChild.pivot.x /= resolution;\r\n\t\t\t\t\tlChild.pivot.y /= resolution;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif ( lChild != null){\r\n\t\t\t\t\tlChild.x\t= -scaleX * keyframe.pivot.x;\r\n\t\t\t\t\tlChild.y\t= -scaleY * keyframe.pivot.y;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( master){\r\n\t\t\t\t\t\tlChild.x /= resolution;\r\n\t\t\t\t\t\tlChild.y /= resolution;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlayer.skew.x = skewX;\r\n\t\tlayer.skew.y = skewY;\r\n\t\tlayer.alpha  = alpha;\r\n\t\t\r\n\t\tif (keyframe.layer.refAnimatedTint == null) keyframe.layer.refAnimatedTint = new AnimateTintFilter(tintColor, tintMultiplier);\r\n\t\telse keyframe.layer.refAnimatedTint.update(tintColor, tintMultiplier);\r\n\t\t\r\n\t\tif (tintMultiplier != 0) layer.filters=[keyframe.layer.refAnimatedTint];\r\n\t\telse if (layer.filters != null) layer.filters = null;\r\n\r\n\t}\r\n\r\n\tprivate function setMask(layer:Layer):Void{\r\n\t\tif (layer.mask != null) {\r\n\t\t\t\r\n\t\t\t//TODO: Need to create again the mask movie to make it work\r\n\t\t\t// Is the mask movie not available at this stage of the Movie build ?\r\n\t\t\t// Where can we call setMask to avoid this inelegant patch ?\r\n\t\t\t\r\n\t\t\tvar lRect:Rectangle=getLayer(layer.mask).getChildAt(0).getBounds();\t\r\n\t\t\tgetLayer(layer.mask).removeChildAt(0);\r\n\t\t\tvar lGraph:Graphics = new Graphics();\r\n\t\t\tlGraph.beginFill(0);\r\n\t\t\tlGraph.drawRect(lRect.x, lRect.y, lRect.width, lRect.height);\r\n\t\t\tlGraph.endFill();\r\n\t\t\tgetLayer(layer.mask).addChild(lGraph);\r\n\t\t\tlayers[layer].mask = lGraph;\r\n\t\t\t\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tprivate function labelPassed(label:Label){\r\n\t\temit(\"labelPassed\", label.name);\r\n\t}\r\n\t\r\n\t\tprivate function labelHit(label:Label){\r\n\t\temit(\"labelHit\", label.name);\r\n\t}\r\n\t\r\n\r\n\toverride public function destroy(): Void {\r\n\t\tstop();\r\n\t\tonComplete = null;\r\n\t\tfor (layer in layers) layer.removeChildren();\r\n\t\tsymbol = null;\r\n\t\tplayer = null;\r\n\t\tsuper.destroy(true);\r\n\t}\r\n\t\r\n\t/////////////////////////////////////////////////////\r\n\t//\r\n\t//   custom Data\r\n\t//\r\n\t/////////////////////////////////////////////////////\r\n\t\r\n\tpublic function getBaseClass (): String {\r\n\t\treturn symbol.baseClass;\r\n\t}\r\n\t\r\n\tpublic function getCustomData (): Dynamic {\r\n\t\treturn symbol.data;\r\n\t}\r\n\r\n\tpublic function getLayerCustomData (layerId:String, keyframeIndex:UInt = 0): Dynamic {\r\n\t\tvar layer = symbol.getLayer(layerId);\r\n\t\tif(layer == null) throw(\"Layer \" + layerId + \" does not exist.\");\r\n\t\tvar keyframe = symbol.getLayer(layerId).getKeyframeForFrame(keyframeIndex);\r\n\t\tif (keyframe == null) throw(\"Keyframe does not exist at index \" + keyframeIndex);\r\n\t\treturn keyframe.data;\r\n\t}\r\n}","package pixi.flump;\r\n\r\nimport flump.library.FlumpLibrary;\r\nimport pixi.core.math.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.core.textures.BaseTexture;\r\nimport pixi.loaders.Loader;\r\nimport pixi.loaders.Resource;\r\n\r\nusing Reflect;\r\n\r\n@:access(pixi.flump.Resource)\r\nclass Parser{\r\n\r\n\r\n\tpublic static function parse(resolution:Float, ?loadFromCache:Bool = true){\r\n\t\treturn function(resource:Resource, next:Void->Void){\r\n\t\t\tif(resource.data == null || resource.isJson == false) return;\r\n\t\t\tif(!resource.data.hasField(\"md5\") || !resource.data.hasField(\"movies\") || !resource.data.hasField(\"textureGroups\") || !resource.data.hasField(\"frameRate\")) return;\r\n\t\t\t\r\n\t\t\tvar lib:FlumpLibrary = FlumpLibrary.create(resource.data, resolution);\r\n\t\t\tvar textures = new Map<String, Texture>();\r\n\t\t\t\r\n\t\t\tvar atlasLoader = new Loader();\r\n\t\t\tatlasLoader.baseUrl = ~/\\/(.[^\\/]*)$/i.replace(resource.url, \"\");\r\n\r\n\t\t\tfor(atlasSpec in lib.atlases){\r\n\t\t\t\tatlasSpec.file += loadFromCache ? '' : \"?\" + Date.now().getTime();\r\n\t\t\t\tatlasLoader.add(atlasSpec.file, function(atlasResource){\r\n\t\t\t\t\tvar atlasTexture = new BaseTexture(atlasResource.data);\r\n\t\t\t\t\tatlasTexture.resolution = resolution;\r\n\r\n\t\t\t\t\tfor(textureSpec in atlasSpec.textures){\r\n\t\t\t\t\t\tvar frame = new Rectangle(textureSpec.rect.x, textureSpec.rect.y, textureSpec.rect.width, textureSpec.rect.height);\r\n\t\t\t\t\t\tvar origin = new Point(textureSpec.origin.x, textureSpec.origin.y);\r\n\t\t\t\t\t\torigin.x = origin.x / frame.width;\r\n\t\t\t\t\t\torigin.y = origin.y / frame.height;\r\n\t\t\t\t\t\ttextures[textureSpec.symbol] = new Texture(atlasTexture, frame);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\tatlasLoader.once(\"complete\", function(loader:Loader){\r\n\t\t\t\tvar flumpResource = new pixi.flump.Resource(lib, textures, resource.name, resolution);\r\n\t\t\t\tif(resource.name != null) pixi.flump.Resource.resources[resource.name] = flumpResource;\r\n\t\t\t\tresource.data = flumpResource;\r\n\t\t\t\tnext();\r\n\t\t\t});\r\n\t\t\tatlasLoader.load();\r\n\t\t}\r\n\t}\r\n\r\n\r\n}","package pixi.flump;\r\n\r\nimport flump.library.FlumpLibrary;\r\nimport flump.library.SpriteSymbol;\r\nimport flump.library.MovieSymbol;\r\nimport flump.library.Point;\r\nimport pixi.core.math.shapes.Rectangle;\r\nimport pixi.core.display.DisplayObject;\r\nimport pixi.core.textures.BaseTexture;\r\nimport pixi.core.textures.Texture;\r\nimport pixi.core.ticker.Ticker;\r\nimport pixi.loaders.Resource;\r\nimport pixi.loaders.Loader;\r\n\r\nusing Type;\r\n\r\n\r\n@:access(pixi.flump.Movie)\r\nclass Resource{\r\n\t\r\n\tprivate var library:FlumpLibrary;\r\n\tprivate var textures:Map<String, Texture>;\r\n\tprivate var resourceId:String;\r\n\tprivate var resolution:Float;\r\n\r\n\tpublic static var flumpFactory:Factory;\r\n\r\n\r\n\r\n\tprivate static var resources = new Map<String, Resource>();\r\n\r\n\r\n\tpublic static function exists(resourceName:String){\r\n\t\treturn resources.exists(resourceName);\r\n\t}\r\n\r\n\r\n\tpublic static function destroy(resourceName:String){\r\n\t\tif(resources.exists(resourceName) == false) throw(\"Cannot destroy FlumpResource: \" + resourceName + \" as it does not exist.\");\r\n\t\t\r\n\t\tvar resource = resources[resourceName];\r\n\t\tfor(texture in resource.textures)texture.destroy();\r\n\t\tresource.library = null;\r\n\t\tresources.remove(resourceName);\r\n\t}\r\n\r\n\r\n\tprivate static function get(resourceName:String){\r\n\t\tif(!resources.exists(resourceName)) throw(\"Flump resource: \" + resourceName + \" does not exist.\");\r\n\t\treturn resources[resourceName];\r\n\t}\r\n\r\n\t\r\n\tprivate static function getResourceForMovie(symbolId:String):Resource{\r\n\t\tfor(resource in resources){\r\n\t\t\tif(resource.library.movies.exists(symbolId)){\r\n\t\t\t\treturn resource;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthrow(\"Movie: \" + symbolId + \"does not exists in any loaded flump resources.\");\r\n\t}\r\n\r\n\r\n\tprivate static function getResourceForSprite(symbolId:String):Resource{\r\n\t\tfor(resource in resources){\r\n\t\t\tif(resource.library.sprites.exists(symbolId)){\r\n\t\t\t\treturn resource;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthrow(\"Sprite: \" + symbolId + \" does not exists in any loaded flump resources.\");\r\n\t}\r\n\t\r\n\r\n\r\n\tprivate function new(library:FlumpLibrary, textures:Map<String, Texture>, resourceId:String, resolution:Float){\r\n\t\tthis.library = library;\r\n\t\tthis.textures = textures;\r\n\t\tthis.resourceId = resourceId;\r\n\t\tthis.resolution = resolution;\r\n\t}\r\n\r\n\r\n\tprivate function createMovie(id:String):Movie{\r\n\t\tvar movie:Movie;\r\n\t\tif(flumpFactory != null && flumpFactory.displayClassExists(id)){\r\n\t\t\tmovie = flumpFactory.getMovieClass(id).createInstance([]);\r\n\t\t}else{\r\n\t\t\tmovie = new Movie(id, this.resourceId);\r\n\t\t}\r\n\r\n\t\tmovie.disableAsMaster();\r\n\t\treturn movie;\r\n\t}\r\n\r\n\r\n\tprivate function createSprite(id:String):Sprite{\r\n\t\tif(flumpFactory != null && flumpFactory.displayClassExists(id)){\r\n\t\t\treturn flumpFactory.getSpriteClass(id).createInstance([]);\r\n\t\t}else{\r\n\t\t\treturn new Sprite(id, this.resourceId);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate function createDisplayObject(id:String):DisplayObject {\r\n\t\tvar displayObject:DisplayObject = library.movies.exists(id)\r\n\t\t? createMovie(id)\r\n\t\t: createSprite(id);\r\n\t\t\r\n\t\tdisplayObject.name = id;\r\n\t\t\r\n\t\treturn displayObject;\r\n\t}\r\n\r\n}\r\n","package pixi.flump;\r\n\r\nimport flump.library.FlumpLibrary;\r\n\r\n\r\n@:access(pixi.flump.Resource)\r\nclass Sprite extends pixi.core.sprites.Sprite{\r\n\r\n\tpublic var symbolId:String;\r\n\tpublic var resourceId:String;\r\n\tprivate var resolution:Float;\r\n\tprivate var data:Dynamic;\r\n\tprivate var baseClass:String;\r\n\t\r\n\r\n\tpublic function new(symbolId:String, resourceId:String = null){\r\n\t\tthis.symbolId = symbolId;\r\n\t\tthis.resourceId = resourceId;\r\n\r\n\t\tvar resource:Resource;\r\n\t\tif(resourceId != null){\r\n\t\t\tresource = Resource.get(resourceId);\r\n\t\t\tif(resource == null) throw(\"Library: \" + resourceId + \"does has not been loaded.\");\r\n\t\t}else{\r\n\t\t\tresource = Resource.getResourceForSprite(symbolId);\r\n\t\t}\r\n\t\tthis.resolution = resource.resolution;\r\n\r\n\t\tvar symbol = resource.library.sprites[symbolId];\r\n\t\tvar texture = resource.textures[symbol.texture];\r\n\t\tsuper(texture);\r\n\r\n\t\tdata = symbol.data;\r\n\t\tbaseClass = symbol.baseClass;\r\n\r\n\t\tanchor.x = symbol.origin.x / texture.width;\r\n\t\tanchor.y = symbol.origin.y / texture.height;\r\n\r\n\t\t//pivot.x = symbol.origin.x;\r\n\t\t//pivot.y = symbol.origin.y;\r\n\t}\r\n\t\r\n\tpublic var resX(get, set):Float;\r\n\t\r\n\tpublic function get_resX():Float{\r\n\t\treturn x / resolution;\r\n\t}\r\n\tpublic function set_resX(value:Float):Float{\r\n\t\tx = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resY(get, set):Float;\r\n\tpublic function get_resY():Float{\r\n\t\treturn y / resolution;\r\n\t}\r\n\tpublic function set_resY(value:Float):Float{\r\n\t\ty = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resScaleX(get, set):Float;\r\n\tpublic function get_resScaleX():Float{\r\n\t\treturn scale.x / resolution;\r\n\t}\r\n\tpublic function set_resScaleX(value:Float):Float{\r\n\t\tscale.x = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tpublic var resScaleY(get, set):Float;\r\n\tpublic function get_resScaleY():Float{\r\n\t\treturn scale.y / resolution;\r\n\t}\r\n\tpublic function set_resScaleY(value:Float):Float{\r\n\t\tscale.y = value * resolution;\r\n\t\treturn value;\r\n\t}\r\n\t\r\n\t/////////////////////////////////////////////////////\r\n\t//\r\n\t//   custom Data\r\n\t//\r\n\t/////////////////////////////////////////////////////\r\n\t\r\n\tpublic function getBaseClass (): String {\r\n\t\treturn baseClass;\r\n\t}\r\n\t\r\n\tpublic function getCustomData (): Dynamic {\r\n\t\treturn data;\r\n\t}\r\n}","/*\n * Copyright (C)2005-2016 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage;\n\n// Can't enable @:coreApi because some fields are now inline getters\n// @:coreApi\n@:keepInit\nextern class Math\n{\n\tstatic var PI(default,null) : Float;\n\n\tstatic var NEGATIVE_INFINITY(get, null) : Float;\n\tprivate static inline function get_NEGATIVE_INFINITY () : Float {\n\t\treturn -(untyped __js__(\"Infinity\"));\n\t}\n\n\tstatic var POSITIVE_INFINITY(get,null) : Float;\n\tprivate static inline function get_POSITIVE_INFINITY () : Float {\n\t\treturn (untyped __js__(\"Infinity\"));\n\t}\n\n\tstatic var NaN(get, null) : Float;\n\tprivate static inline function get_NaN () : Float {\n\t\treturn (untyped __js__(\"NaN\"));\n\t}\n\n\tstatic function abs(v:Float):Float;\n\tstatic function acos(v:Float):Float;\n\tstatic function asin(v:Float):Float;\n\tstatic function atan(v:Float):Float;\n\tstatic function atan2(y:Float, x:Float):Float;\n\tstatic function ceil(v:Float):Int;\n\tstatic function cos(v:Float):Float;\n\tstatic function exp(v:Float):Float;\n\tstatic function floor(v:Float):Int;\n\tstatic function log(v:Float):Float;\n\tstatic function max(a:Float, b:Float):Float;\n\tstatic function min(a:Float, b:Float):Float;\n\tstatic function pow(v:Float, exp:Float):Float;\n\tstatic function random() : Float;\n\tstatic function round(v:Float):Int;\n\tstatic function sin(v:Float):Float;\n\tstatic function sqrt(v:Float):Float;\n\tstatic function tan(v:Float):Float;\n\n\tstatic inline function ffloor( v : Float ) : Float {\n\t\treturn floor(v);\n\t}\n\n\tstatic inline function fceil( v : Float ) : Float {\n\t\treturn ceil(v);\n\t}\n\n\tstatic inline function fround( v : Float ) : Float {\n\t\treturn round(v);\n\t}\n\n\tstatic inline function isFinite( f : Float ) : Bool {\n\t\treturn (untyped __js__(\"isFinite\"))(f);\n\t}\n\n\tstatic inline function isNaN( f : Float ) : Bool {\n\t\treturn (untyped __js__(\"isNaN\"))(f);\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __feature__(\"Type.resolveClass\", $hxClasses[\"Math\"] = Math);\n\t}\n}\n","package com.isartdigital.ruby.game.player;\r\n\r\n/**\r\n * ...\r\n * @author Michael Wilkins\r\n */\r\nclass XpToLevel\r\n{\r\n\r\n\tpublic static var ref:Array<Int> = [0, 100, 150, 225, 350, 500, 750, 1150, 1750, 2600, 4000, 6000, 9000, 13500, 25000, 37500, 55500, 85000, 130000, 195000];\r\n\tpublic static var xpToNextLevel:Array<Int> = [0,100,50,75,125,150,250,400,600,850,1400,2000,3000,4500,11500,12500,18000,29500,45000,65000];\r\n\t\r\n\t\r\n}","package com.isartdigital.ruby.game.sprites.elements;\r\n\r\n/**\r\n * ...\r\n * @author Guillaume Zegoudia\r\n */\r\nclass ElementType\r\n{\r\n\tpublic static inline var INCUBATOR:String = \"AlienIncubator\";\t\r\n\tpublic static inline var PADDOCK_TINY:String = \"AlienPaddockTiny\";\t\r\n\tpublic static inline var PADDOCK_SMALL:String = \"AlienPaddockSmall\";\t\r\n\tpublic static inline var PADDOCK_MEDIUM:String = \"AlienPaddockMedium\";\t\r\n\tpublic static inline var PADDOCK_BIG:String = \"AlienPaddockBig\";\t\r\n\tpublic static inline var RESEARCH_CENTER:String = \"AlienResearchCenter\";\r\n\tpublic static inline var TRAINING_CENTER:String = \"AlienTrainingCenter\";\r\n\tpublic static inline var CRYO_CENTER:String = \"AlienCryoCenter\";\r\n\t\r\n\tpublic static inline var COSMETIC:String = \"CosmeticBuilding\";\t\r\n\tpublic static inline var COSMETIC_CASPULE1:String = \"BuildingCosmeticCapsule1\";\t\r\n\tpublic static inline var COSMETIC_CASPULE2:String = \"BuildingCosmeticCapsule2\";\t\r\n\tpublic static inline var COSMETIC_CASPULE3:String = \"BuildingCosmeticCapsule3\";\r\n\t\r\n\tpublic static inline var COSMETIC_PLANT1:String = \"BuildingCosmeticPlant1\";\r\n\tpublic static inline var COSMETIC_PLANT2:String = \"BuildingCosmeticPlant2\";\r\n\tpublic static inline var COSMETIC_PLANT3:String = \"BuildingCosmeticPlant3\";\r\n\t\r\n\tpublic static inline var ANTENNA:String = \"UrbanAntenna\";\r\n\tpublic static inline var COMMUNICATION:String = \"UrbanCommunication\";\r\n\tpublic static inline var HQ:String = \"UrbanHeadQuarter\";\r\n\tpublic static inline var POWERSTATION:String = \"UrbanPowerStation\";\r\n\tpublic static inline var TRANSLATION:String = \"UrbanTranslation\";\r\n\t\r\n\tpublic static inline var DRILLING_AUTO_OUTPOST:String = \"DrillingAutoOutPost\";\r\n\tpublic static inline var DRILLING_CENTER:String = \"DrillingCenter\";\r\n\tpublic static inline var DRILLING_OUTPOST:String = \"DrillingOutPost\";\r\n\t\r\n\tpublic static inline var DESTRUCTIBLE:String = \"Destructible\";\r\n\t\r\n\tpublic static inline var RESSOURCE_BUBBLE:String = \"Bubble\";\r\n\tpublic static inline var RESSOURCE_SC:String = \"RessourceSoftCurrency\";\r\n\tpublic static inline var RESSOURCE_HC:String = \"RessourceHardCurrency\";\r\n\t\r\n\tpublic static inline var ALIEN_1:String = \"Alien1\";\r\n\tpublic static inline var ALIEN_2:String = \"Alien2\";\r\n\tpublic static inline var ALIEN_3:String = \"Alien3\";\r\n\t\r\n\tpublic static inline var WALL_BOT:String = \"WallBot\";\r\n\tpublic static inline var WALL_TOP:String = \"WallTop\";\r\n\tpublic static inline var WALL_LEFT:String = \"WallLeft\";\r\n\tpublic static inline var WALL_RIGHT:String = \"WallRight\";\r\n\t\r\n\t\r\n\tpublic static inline var CLUE:String = \"Clue\";\r\n\tpublic static inline var CLUE_RESSOURCE:String = \"ClueRessource\";\r\n\r\n\t\r\n\tpublic static inline var CLUE_BLUEPRINT:String = \"ClueBluePrint\";\r\n\r\n\t\r\n\tpublic static inline var CLUE_EMPTY:String = \"ClueEmpty\";\r\n\r\n\t\r\n\tpublic static inline var CLUE_EMPTY_ORANGE:String = \"ClueEmptyOrange\";\r\n\tpublic static inline var CLUE_EMPTY_BLUE:String = \"ClueEmptyBlue\";\r\n\tpublic static inline var CLUE_EMPTY_GREEN:String = \"ClueEmptyOrange\";\r\n\t\r\n\tpublic static inline var HARDBRICK:String = \"HardBrick\";\r\n\r\n\t\r\n\tpublic static inline var LAVA:String = \"Lava\";\r\n\r\n\t\r\n\tpublic static inline var ITEM:String = \t\"Item\";\r\n\t\r\n\tpublic static inline var ITEM_GENEFIVE:String = \t\"ItemGeneFive\";\r\n\tpublic static inline var ITEM_GENEFOUR:String = \t\"ItemGeneFour\";\r\n\tpublic static inline var ITEM_GENETHREE:String = \t\"ItemGeneThree\";\r\n\tpublic static inline var ITEM_GENETWO:String = \t\"ItemGeneTwo\";\r\n\tpublic static inline var ITEM_GENEONE:String = \t\"ItemGeneOne\";\r\n\t\r\n\tpublic static inline var ITEM_DARKMATTER:String = \"ItemDarkMatter\";\t\r\n\tpublic static inline var ITEM_BLUEPRINT_PART:String = \"ItemBluePrintPart\";\r\n\tpublic static inline var ITEM_BLUEPRINT:String = \t\"ItemBluePrint\";\r\n\t\r\n\tpublic static inline var ITEM_HC:String = \"ItemHC\";\r\n\tpublic static inline var ITEM_SC:String = \"ItemSC\";\r\n\r\n\tpublic static inline var ALIEN_HEALER:String = \"Healer\";\r\n\tpublic static inline var ALIEN_BOMBER:String = \"Bomber\";\r\n\tpublic static inline var ALIEN_DRILLER:String = \"Driller\";\r\n\tpublic static inline var ALIEN_TANK:String = \"Tank\";\r\n\t\r\n\tpublic static inline var ALIEN_HEALER1:String = \"Healer1\";\r\n\tpublic static inline var ALIEN_HEALER2:String = \"Healer2\";\r\n\tpublic static inline var ALIEN_HEALER3:String = \"Healer3\";\r\n\t\r\n\tpublic static inline var ALIEN_BOMBER1:String = \"Bomber1\";\r\n\tpublic static inline var ALIEN_BOMBER2:String = \"Bomber2\";\r\n\tpublic static inline var ALIEN_BOMBER3:String = \"Bomber3\";\r\n\t\r\n\tpublic static inline var ALIEN_DRILLER1:String = \"Driller1\";\r\n\tpublic static inline var ALIEN_DRILLER2:String = \"Driller2\";\r\n\tpublic static inline var ALIEN_DRILLER3:String = \"Driller3\";\r\n\t\r\n\tpublic static inline var ALIEN_TANK1:String = \"Tank1\";\r\n\tpublic static inline var ALIEN_TANK2:String = \"Tank2\";\r\n\tpublic static inline var ALIEN_TANK3:String = \"Tank3\";\r\n\t\r\n\r\n\t\r\n}","package com.isartdigital.utils.events;\r\n\r\n/**\r\n * @author Mathieu ANTHOINE\r\n */\r\n\r\nclass EventType \r\n{\r\n\t\r\n\tpublic static inline var GAME_LOOP:String = \"gameLoop\";\r\n\tpublic static inline var RESIZE:String = \"resize\";\r\n\t\r\n\tpublic static inline var ADDED:String = \"added\";\r\n\tpublic static inline var REMOVED:String = \"removed\";\r\n\t\r\n}","package com.isartdigital.services.facebook.events;\r\nimport com.isartdigital.utils.events.EventType;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu Anthoine\r\n */\r\nclass FacebookEventType extends EventType\r\n{\r\n\r\n\tpublic static inline var CONNECTED:String = \"connected\";\r\n\tpublic static inline var NOT_AUTHORIZED:String = \"not_authorized\";\r\n\tpublic static inline var UNKNOWN:String = \"unknown\";\r\n\t\r\n}","package com.isartdigital.utils.events;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass LoadEventType extends EventType\r\n{\r\n\r\n\tpublic static inline var COMPLETE:String = \"complete\";\r\n\tpublic static inline var LOADED:String = \"load\";\r\n\tpublic static inline var PROGRESS:String = \"progress\";\r\n\tpublic static inline var ERROR:String = \"error\";\r\n\t\r\n}","package com.isartdigital.utils.events;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass MouseEventType extends EventType\r\n{\r\n\t\r\n\tpublic static inline var MOUSE_MOVE:String = \"mousemove\";\r\n\tpublic static inline var MOUSE_DOWN:String = \"mousedown\";\r\n\tpublic static inline var MOUSE_OUT:String = \"mouseout\";\r\n\tpublic static inline var MOUSE_OVER:String = \"mouseover\";\r\n\tpublic static inline var MOUSE_UP:String = \"mouseup\";\r\n\tpublic static inline var MOUSE_UP_OUTSIDE:String = \"mouseupoutside\";\r\n\tpublic static inline var CLICK:String = \"click\";\r\n\t\r\n\tpublic static inline var RIGHT_DOWN:String = \"rightdown\";\r\n\tpublic static inline var RIGHT_UP:String = \"rightup\";\r\n\tpublic static inline var RIGHT_UP_OUTSIDE:String = \"rightupoutside\";\r\n\tpublic static inline var RIGHT_CLICK:String = \"rightclick\";\r\n\t\r\n}","package com.isartdigital.utils.events;\r\n\r\n/**\r\n * ...\r\n * @author Mathieu ANTHOINE\r\n */\r\nclass TouchEventType extends EventType\r\n{\r\n\r\n\tpublic static inline var TOUCH_START:String = \"touchstart\";\r\n\tpublic static inline var TOUCH_MOVE:String = \"touchmove\";\r\n\tpublic static inline var TOUCH_END:String = \"touchend\";\r\n\tpublic static inline var TOUCH_END_OUTSIDE:String = \"touchendoutside\";\r\n\tpublic static inline var TAP:String = \"tap\";\r\n\t\r\n}"],
"names":[],
"mappings":"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;kFACC;mFC7BA;mFACD;wFACK;mFACL;oFKsCJ;uFAEG;uFACA;uFACA;4FACK;sFACL;0FAEG;kFACP;kFACA;kFACA;kFACA;kFACA;2FAGQ;wFACF;oFACH;iFACF;mFACE;mFACD;sFACG;oFACF;8FACU;0FAEN;wFACF;oGACY;mFAEjB;+FAGS;qDQ1DF;qDAEA;sCCuCL;sCAMb;sEC5BO,oDAAsB;uECiBZ;6DAmCX;oE2MlGK;uEACG;wEACC;yEACC;sEACH;0EACI;0EACA;sEACJ;mEAEH;4EACS;4EACA;4EACA;0EAEF;0EACA;0EACA;kEAER;wEACM;6DACX;uEACU;sEACD;gFAEU;0EACN;2EACC;uEAEJ;2EAEI;uEACJ;uEACA;kEAEL;kEACA;kEACA;mEAEC;mEACA;oEACC;qEACC;+DAGN;yEACU;yEAGA;qEAGJ;4EAGO;0EACF;2EACC;oEAEP;+DAGL;+DAGC;wEAES;wEACA;yEACC;uEACF;uEACA;0EAEE;8EACI;yEACJ;kEAER;kEACA;uEAEK;uEACA;wEACC;qEACH;wEAEG;wEACA;wEACA;wEAEA;wEACA;wEACA;yEAEC;yEACA;yEACA;sEAEH;sEACA;sEACA;0FxMpDM;+EAab;qFOzDyB;+FEOR;+FCmBD;gGQLkB;oFAC1B;qGClBwB;2FCD/B;qFIEI;0FGHA;6DEeG;4DACD;gEACI;iEACC;oEAEK;iEACL;+DAIF;gDORb;iDACE;qEEZS;kECWM;2DACP;sDMfE;uDAClB;oDGUgB;sDCVL;4DACI;iDACR;2DACO;0DACA;oEACO;8DACJ;+DACA;gEACC;gEACA;gEACA;8DACD;8DACA;8DACA;wDACL;2DACE;4DACC;6DACC;0DACF;8DACG;8DACA;0DACH;2DAEA;iEACK;sDACR;gEACO;+DACD;yEACQ;mEACL;oEACC;qEACC;sEACC;6DACP;gEACE;iEACC;kEACC;+DACH;mEACG;mEACA;+DACH;wDKtBQ;0DGjBhB;4DACI;2DACD;+CCiBF;mDACI;yDACM;4CEsBN;6CACC;+CACE;6CACF;8CACC;8CACA;0CAEL;0CACA;gDACM;yDAEU;wDACD;gDACR;gDACA;iDACC;gDAED;0CACN;8CAEI;oDACM;wDCpEP;yDEcE;yDACA;sDACH;mEACa;oEACC;+DIfpB;gEACC;wDACR;6DCFY;gEEHF;kEACE;+DACH;gEACC;iEACC;yEEST;iFAEe;0ECnBd;kECMF;sEACI;oEACF;oEGLR;gFACY;4ECEc;uEGHlB;6DMkBY;kEAIK;+DAEH;8DACD;gEAGE;6DAEH;4DACD;iEAGK;mEACE;0DACT;0DACA;0DACA;qDE3BA;oDACD;qDCFC;oDACD;mDCCF;sDACG;qDACD;2DGND;+DACI;kEACG;gEACF;oEACI;sEACE;0DACZ;4DACK;oDCAA;uDACG;uDACA;wDACC;uDIVX;0DACG;wDACF;sDACF;0EC4BiB;gFACM;uEACT;iEACN;oEACG;8DACN;wEAWL;sECtDY;mEACH;iEACT;iEACA;0EACgB;+DACX;oEACK;kEIgCL;2EACS;sEACL;oEACF;iEACH;2EACU;uEACJ;sEACD;uEACC;sEACD;mFACa;+EAEJ;0EAEL;2EACC;wEACH;mFACW;+EACJ;yEACN;qEACJ;6EACQ;mEACV;6EACG;kFG1BI;+EACF;4EACH;4EACA;mFAEM;+EACH;+EACA;+EACA;8EAEF;kFACK;yFACO;mFACN;mFAED;mFACC;kFACD;gFACF;yFACU;uFACD;uFACA;8DCjDf;6DACD;oDCAT;iEACa;4DACL;2DACD;2DAEA;0DACD;2DAEC;wDAEH;wDACA;0DACE;2DACC;oEEfS;oEEmCN;sEAEE;sEACA;gEAMe;4DC1ChB;iECNlB;kEACC;sDGamB;yDCGH;yDAGE;wDACD;wDACA;qDACH;qDACA;0DACK;0DACA;8DACI;4DACF;qEACS;8EIRb;+EAEC;+EAEA;qFACO;oFACD;kFAGH;kFAEA;+EACF;mFAEG;qECbX;qEACA;0DKvBK;4DAIT;oECFgB;sEACE;6DACT;6DACA;6DACA;6DACA;6DIDM;kEACK;yDEUL;yDACA;2DEJF;yDACF;4DACG;yDACH;sDAMI;AAAA;AAAA;;iBAC5C,UAAqC;QADO;AAAA,OAC5C,aAAqC;;CADO;iBAE5C,MAAiC;QAFW;AAAA,OAE5C,SAAiC;;CAFW;iBAG5C,aAAwC;QAHI;AAAA,OAG5C,gBAAwC;;CAHI,kBAI5C,0BAJ4C;iBAI5C,sBAAyC;QAJG;AAAA,OAI5C,yBAAyC;;CAJG;iBAK5C,WAA4C;QALA;AAAA,OAK5C,cAA4C;;CALA;iBAM5C,UAAqC;QANO;AAAA,OAM5C,aAAqC;;CANO;;;mDAmBF;qDCpBJ,UAAQ,gBAAc,iBAAe;0DAKnC,UAAQ;6DAKZ;oD6DtCG;iDACH;gDAED;kDACE;wECHE;6EACK;sEACP;sD7DoBC;yDAKG;wDAKD;wDAKA;mDAKJ;mDAKA;6DA4FE;4DACD;kEGvIK;uCEKL;uDyDXC;qDACF;uDACE;oDACH;0DCHK;0DACA;yDACD;0DACC;wDACF;gEACQ;qDACX;0DAEK;wDACF;gEACQ;2DACL;2DCXA;0DACD;yDACD;iEACQ;mDACd;oD1DcW;oDACA;wDEQA;yDAKC;kEGdR;mEACC;gEAGF;gEACA;yEKfc;uDGkCE;qDCbf;wDACG;0DACE;2DACC;yDACF;4DACG;+DACG;4DACH;wDACJ;qEACa;2DACV;+DACI;yDACN;0DACC;8DACI;+DACC;kEACG;kDAChB;uDACK;0DACG;mEACS;uDACZ;wDACC;qEACa;+DAEN;+DACA;4DACH;yDACH;wDAED;2DACG;iEACM;8DACH;kEGlDD;8DACJ;qEACO;sEACC;yEACG;kEACP;6DAGN;oEAEQ;8DACN;8DACA;8DACA;kEAES;AAAA;AAAA;;iBAAC,KAAM;QAAP;AAAA,OAAC,QAAM;;CAAP;iBAAS,KAAM;QAAf;AAAA,OAAS,QAAM;;CAAf;iBAAmB,KAAM;QAAzB;AAAA,OAAmB,QAAM;;CAAzB;;;gEAED;+DACA;+DAEf;sCE1BJ;wCACE;wCACA;4CEJA;6CACC;2CACF;8CACG;gDACE;iDACC;mDACE;oDACC;iDAEH;kDACC;kDACE;uDCOF;kCStBJ;iCACD;mCACE;0BWgBrB;0BE4EE;AAAA;AAAA,CACpB,QAAQ;CACR;gBAAM,KAAM;QAAZ;AAAA,MAAM,QAAM;;CACZ;gBAAM,KAAM;QAAZ;AAAA,MAAM,QAAM;;CACZ;gBAAM,MAAO;QAAb;AAAA,MAAM,SAAO;;CACb;gBAAM,OAAS;QAAf;AAAA,MAAM,UAAS;;CACf;gBAAM,OAAQ;QAAd;AAAA,MAAM,UAAQ;;CACd;;;kBC0H4B;gCI3ME;;;;"
}